<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CrIS Code Collection: jurassic.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CrIS Code Collection
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">jurassic.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>JURASSIC library declarations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;gsl/gsl_math.h&gt;</code><br />
<code>#include &lt;gsl/gsl_blas.h&gt;</code><br />
<code>#include &lt;gsl/gsl_linalg.h&gt;</code><br />
<code>#include &lt;gsl/gsl_randist.h&gt;</code><br />
<code>#include &lt;gsl/gsl_rng.h&gt;</code><br />
<code>#include &lt;gsl/gsl_statistics.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
</div>
<p><a href="jurassic_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structatm__t.html">atm_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Atmospheric profile data.  <a href="structatm__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structctl__t.html">ctl_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control parameters.  <a href="structctl__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlos__t.html">los_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Line-of-sight data.  <a href="structlos__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structobs__t.html">obs_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Observation geometry and radiance data.  <a href="structobs__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structret__t.html">ret_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieval control parameters.  <a href="structret__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtbl__t.html">tbl_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Emissivity look-up tables.  <a href="structtbl__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtbl__gas__index__t.html">tbl_gas_index_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">On-disk index entry describing one frequency table block in a gas file.  <a href="structtbl__gas__index__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtbl__gas__t.html">tbl_gas_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">In-memory representation of an open per-gas lookup-table file.  <a href="structtbl__gas__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a44779f18d87e71c78fc9fbf9dc88537d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a44779f18d87e71c78fc9fbf9dc88537d">C1</a>&#160;&#160;&#160;1.19104259e-8</td></tr>
<tr class="memdesc:a44779f18d87e71c78fc9fbf9dc88537d"><td class="mdescLeft">&#160;</td><td class="mdescRight">First spectroscopic constant (c_1 = 2 h c^2) [W/(m^2 sr cm^-4)].  <a href="jurassic_8h.html#a44779f18d87e71c78fc9fbf9dc88537d">More...</a><br /></td></tr>
<tr class="separator:a44779f18d87e71c78fc9fbf9dc88537d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6fc13322a4f1c314332ff34aa8b3fa0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad6fc13322a4f1c314332ff34aa8b3fa0">C2</a>&#160;&#160;&#160;1.43877506</td></tr>
<tr class="memdesc:ad6fc13322a4f1c314332ff34aa8b3fa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Second spectroscopic constant (c_2 = h c / k) [K/cm^-1].  <a href="jurassic_8h.html#ad6fc13322a4f1c314332ff34aa8b3fa0">More...</a><br /></td></tr>
<tr class="separator:ad6fc13322a4f1c314332ff34aa8b3fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0e57ca18d0438ab6804fc59e5f0359a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#af0e57ca18d0438ab6804fc59e5f0359a">EPSMIN</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:af0e57ca18d0438ab6804fc59e5f0359a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum emissivity.  <a href="jurassic_8h.html#af0e57ca18d0438ab6804fc59e5f0359a">More...</a><br /></td></tr>
<tr class="separator:af0e57ca18d0438ab6804fc59e5f0359a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac90736a71d789b9bf5cd070c8a700358"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ac90736a71d789b9bf5cd070c8a700358">EPSMAX</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ac90736a71d789b9bf5cd070c8a700358"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum emissivity.  <a href="jurassic_8h.html#ac90736a71d789b9bf5cd070c8a700358">More...</a><br /></td></tr>
<tr class="separator:ac90736a71d789b9bf5cd070c8a700358"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6440afc9207bc5eba00d9161ff744e16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a>&#160;&#160;&#160;9.80665</td></tr>
<tr class="memdesc:a6440afc9207bc5eba00d9161ff744e16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard gravity [m/s^2].  <a href="jurassic_8h.html#a6440afc9207bc5eba00d9161ff744e16">More...</a><br /></td></tr>
<tr class="separator:a6440afc9207bc5eba00d9161ff744e16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2091e935ef46727f066804a98a0d039f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>&#160;&#160;&#160;7.0</td></tr>
<tr class="memdesc:a2091e935ef46727f066804a98a0d039f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard scale height [km].  <a href="jurassic_8h.html#a2091e935ef46727f066804a98a0d039f">More...</a><br /></td></tr>
<tr class="separator:a2091e935ef46727f066804a98a0d039f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1841fd1a462d245d8c73dce55e2f45da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a>&#160;&#160;&#160;1.3806504e-23</td></tr>
<tr class="memdesc:a1841fd1a462d245d8c73dce55e2f45da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boltzmann constant [kg m^2/(K s^2)].  <a href="jurassic_8h.html#a1841fd1a462d245d8c73dce55e2f45da">More...</a><br /></td></tr>
<tr class="separator:a1841fd1a462d245d8c73dce55e2f45da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf8d34f3be20164c292bccfeb72898e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#adf8d34f3be20164c292bccfeb72898e5">ME</a>&#160;&#160;&#160;5.976e24</td></tr>
<tr class="memdesc:adf8d34f3be20164c292bccfeb72898e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mass of Earth [kg].  <a href="jurassic_8h.html#adf8d34f3be20164c292bccfeb72898e5">More...</a><br /></td></tr>
<tr class="separator:adf8d34f3be20164c292bccfeb72898e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68eddd535923d17ddbc8bb03bab70b3b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a68eddd535923d17ddbc8bb03bab70b3b">NA</a>&#160;&#160;&#160;6.02214199e23</td></tr>
<tr class="memdesc:a68eddd535923d17ddbc8bb03bab70b3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Avogadro's number.  <a href="jurassic_8h.html#a68eddd535923d17ddbc8bb03bab70b3b">More...</a><br /></td></tr>
<tr class="separator:a68eddd535923d17ddbc8bb03bab70b3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd864640121c7df2c19f61f7baa507e4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>&#160;&#160;&#160;0.78084</td></tr>
<tr class="memdesc:acd864640121c7df2c19f61f7baa507e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nitrogen concentration.  <a href="jurassic_8h.html#acd864640121c7df2c19f61f7baa507e4">More...</a><br /></td></tr>
<tr class="separator:acd864640121c7df2c19f61f7baa507e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31412dbd7c9b5771f1e7a5ff85d20ab9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a31412dbd7c9b5771f1e7a5ff85d20ab9">O2</a>&#160;&#160;&#160;0.20946</td></tr>
<tr class="memdesc:a31412dbd7c9b5771f1e7a5ff85d20ab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Oxygen concentration.  <a href="jurassic_8h.html#a31412dbd7c9b5771f1e7a5ff85d20ab9">More...</a><br /></td></tr>
<tr class="separator:a31412dbd7c9b5771f1e7a5ff85d20ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1583b00a62bc1138f99bbfcd8ef81a6a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a>&#160;&#160;&#160;1013.25</td></tr>
<tr class="memdesc:a1583b00a62bc1138f99bbfcd8ef81a6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard pressure [hPa].  <a href="jurassic_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">More...</a><br /></td></tr>
<tr class="separator:a1583b00a62bc1138f99bbfcd8ef81a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0600e3f227b6e9a3ae26f4d6e2a0581e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a>&#160;&#160;&#160;6367.421</td></tr>
<tr class="memdesc:a0600e3f227b6e9a3ae26f4d6e2a0581e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mean radius of Earth [km].  <a href="jurassic_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">More...</a><br /></td></tr>
<tr class="separator:a0600e3f227b6e9a3ae26f4d6e2a0581e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e71def3baefc10ec36f1dd48da4050e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a>&#160;&#160;&#160;8.3144598</td></tr>
<tr class="memdesc:a7e71def3baefc10ec36f1dd48da4050e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ideal gas constant [J/(mol K)].  <a href="jurassic_8h.html#a7e71def3baefc10ec36f1dd48da4050e">More...</a><br /></td></tr>
<tr class="separator:a7e71def3baefc10ec36f1dd48da4050e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad41b89d4eb6d63a0def5e5fd2a5ab326"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>&#160;&#160;&#160;273.15</td></tr>
<tr class="memdesc:ad41b89d4eb6d63a0def5e5fd2a5ab326"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard temperature [K].  <a href="jurassic_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">More...</a><br /></td></tr>
<tr class="separator:ad41b89d4eb6d63a0def5e5fd2a5ab326"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7e87bb3f38e7b4eed703578b90cd3a4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#af7e87bb3f38e7b4eed703578b90cd3a4">TMIN</a>&#160;&#160;&#160;100.</td></tr>
<tr class="memdesc:af7e87bb3f38e7b4eed703578b90cd3a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum temperature for source function [K].  <a href="jurassic_8h.html#af7e87bb3f38e7b4eed703578b90cd3a4">More...</a><br /></td></tr>
<tr class="separator:af7e87bb3f38e7b4eed703578b90cd3a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7a16e2716eaac90fb331c55876cf511"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#af7a16e2716eaac90fb331c55876cf511">TMAX</a>&#160;&#160;&#160;400.</td></tr>
<tr class="memdesc:af7a16e2716eaac90fb331c55876cf511"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum temperature for source function [K].  <a href="jurassic_8h.html#af7a16e2716eaac90fb331c55876cf511">More...</a><br /></td></tr>
<tr class="separator:af7a16e2716eaac90fb331c55876cf511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5244027c00b642d69d62392f5a60f8b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aa5244027c00b642d69d62392f5a60f8b">TSUN</a>&#160;&#160;&#160;5780.</td></tr>
<tr class="memdesc:aa5244027c00b642d69d62392f5a60f8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Effective temperature of the sun [K].  <a href="jurassic_8h.html#aa5244027c00b642d69d62392f5a60f8b">More...</a><br /></td></tr>
<tr class="separator:aa5244027c00b642d69d62392f5a60f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a368a0522dcd74f477a7858102b663b70"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a368a0522dcd74f477a7858102b663b70">UMIN</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a368a0522dcd74f477a7858102b663b70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum column density [molecules/cm^2].  <a href="jurassic_8h.html#a368a0522dcd74f477a7858102b663b70">More...</a><br /></td></tr>
<tr class="separator:a368a0522dcd74f477a7858102b663b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3376075b6c1085b71a316b5c03838992"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a3376075b6c1085b71a316b5c03838992">UMAX</a>&#160;&#160;&#160;1e30</td></tr>
<tr class="memdesc:a3376075b6c1085b71a316b5c03838992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum column density [molecules/cm^2].  <a href="jurassic_8h.html#a3376075b6c1085b71a316b5c03838992">More...</a><br /></td></tr>
<tr class="separator:a3376075b6c1085b71a316b5c03838992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5207491b45fa8881c40214d7ac0d214"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae5207491b45fa8881c40214d7ac0d214">NCL</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:ae5207491b45fa8881c40214d7ac0d214"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of cloud layer spectral grid points.  <a href="jurassic_8h.html#ae5207491b45fa8881c40214d7ac0d214">More...</a><br /></td></tr>
<tr class="separator:ae5207491b45fa8881c40214d7ac0d214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68d169e5b90cf721678bc7ab0f964a99"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>&#160;&#160;&#160;128</td></tr>
<tr class="memdesc:a68d169e5b90cf721678bc7ab0f964a99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of radiance channels.  <a href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">More...</a><br /></td></tr>
<tr class="separator:a68d169e5b90cf721678bc7ab0f964a99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac29517e805c6a27f76e87e634eaf2929"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:ac29517e805c6a27f76e87e634eaf2929"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of emitters.  <a href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">More...</a><br /></td></tr>
<tr class="separator:ac29517e805c6a27f76e87e634eaf2929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab04c88bedc6b2be8ddfe7aa8d3e93f06"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:ab04c88bedc6b2be8ddfe7aa8d3e93f06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of atmospheric data points.  <a href="jurassic_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">More...</a><br /></td></tr>
<tr class="separator:ab04c88bedc6b2be8ddfe7aa8d3e93f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af146485306ae74a2edf18636300fd107"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:af146485306ae74a2edf18636300fd107"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of ray paths.  <a href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">More...</a><br /></td></tr>
<tr class="separator:af146485306ae74a2edf18636300fd107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3c34ac35580d9f179172c9d99940327"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae3c34ac35580d9f179172c9d99940327">NSF</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:ae3c34ac35580d9f179172c9d99940327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of surface layer spectral grid points.  <a href="jurassic_8h.html#ae3c34ac35580d9f179172c9d99940327">More...</a><br /></td></tr>
<tr class="separator:ae3c34ac35580d9f179172c9d99940327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cccf331f045b89a9f12366df5f7687"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#af9cccf331f045b89a9f12366df5f7687">NW</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:af9cccf331f045b89a9f12366df5f7687"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of spectral windows.  <a href="jurassic_8h.html#af9cccf331f045b89a9f12366df5f7687">More...</a><br /></td></tr>
<tr class="separator:af9cccf331f045b89a9f12366df5f7687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05b49c662c073f89e86804f7856622a0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>&#160;&#160;&#160;10000</td></tr>
<tr class="memdesc:a05b49c662c073f89e86804f7856622a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length of ASCII data lines.  <a href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">More...</a><br /></td></tr>
<tr class="separator:a05b49c662c073f89e86804f7856622a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52037c938e3c1b126c6277da5ca689d0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a>&#160;&#160;&#160;(<a class="el" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>*<a class="el" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>)</td></tr>
<tr class="memdesc:a52037c938e3c1b126c6277da5ca689d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum size of measurement vector.  <a href="jurassic_8h.html#a52037c938e3c1b126c6277da5ca689d0">More...</a><br /></td></tr>
<tr class="separator:a52037c938e3c1b126c6277da5ca689d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0240ac851181b84ac374872dc5434ee4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>&#160;&#160;&#160;((2 + <a class="el" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a> + <a class="el" href="jurassic_8h.html#af9cccf331f045b89a9f12366df5f7687">NW</a>) * <a class="el" href="jurassic_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a> + <a class="el" href="jurassic_8h.html#ae5207491b45fa8881c40214d7ac0d214">NCL</a> + <a class="el" href="jurassic_8h.html#ae3c34ac35580d9f179172c9d99940327">NSF</a> + 3)</td></tr>
<tr class="memdesc:a0240ac851181b84ac374872dc5434ee4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum size of state vector.  <a href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">More...</a><br /></td></tr>
<tr class="separator:a0240ac851181b84ac374872dc5434ee4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68c2775fc4d7385df9c7bb96d23b482b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>&#160;&#160;&#160;(5 + <a class="el" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a> + <a class="el" href="jurassic_8h.html#af9cccf331f045b89a9f12366df5f7687">NW</a> + <a class="el" href="jurassic_8h.html#ae5207491b45fa8881c40214d7ac0d214">NCL</a> + <a class="el" href="jurassic_8h.html#ae3c34ac35580d9f179172c9d99940327">NSF</a>)</td></tr>
<tr class="memdesc:a68c2775fc4d7385df9c7bb96d23b482b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of quantities.  <a href="jurassic_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">More...</a><br /></td></tr>
<tr class="separator:a68c2775fc4d7385df9c7bb96d23b482b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecba64d582576f89695ab0ff97805b3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aecba64d582576f89695ab0ff97805b3e">NLOS</a>&#160;&#160;&#160;4096</td></tr>
<tr class="memdesc:aecba64d582576f89695ab0ff97805b3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of LOS points.  <a href="jurassic_8h.html#aecba64d582576f89695ab0ff97805b3e">More...</a><br /></td></tr>
<tr class="separator:aecba64d582576f89695ab0ff97805b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7705bd290b81177c733651a18441be93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a7705bd290b81177c733651a18441be93">NSHAPE</a>&#160;&#160;&#160;20000</td></tr>
<tr class="memdesc:a7705bd290b81177c733651a18441be93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of shape function grid points.  <a href="jurassic_8h.html#a7705bd290b81177c733651a18441be93">More...</a><br /></td></tr>
<tr class="separator:a7705bd290b81177c733651a18441be93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b12a17c57a92107c191e44599a2e315"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a1b12a17c57a92107c191e44599a2e315">NFOV</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:a1b12a17c57a92107c191e44599a2e315"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of ray paths used for FOV calculations.  <a href="jurassic_8h.html#a1b12a17c57a92107c191e44599a2e315">More...</a><br /></td></tr>
<tr class="separator:a1b12a17c57a92107c191e44599a2e315"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae24fde0b49cc53934d13a7ab3f95a4ef"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae24fde0b49cc53934d13a7ab3f95a4ef">TBLNP</a>&#160;&#160;&#160;41</td></tr>
<tr class="memdesc:ae24fde0b49cc53934d13a7ab3f95a4ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of pressure levels in emissivity tables.  <a href="jurassic_8h.html#ae24fde0b49cc53934d13a7ab3f95a4ef">More...</a><br /></td></tr>
<tr class="separator:ae24fde0b49cc53934d13a7ab3f95a4ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad9835e9e4be4ad8ed538f95bdceddea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aad9835e9e4be4ad8ed538f95bdceddea">TBLNT</a>&#160;&#160;&#160;30</td></tr>
<tr class="memdesc:aad9835e9e4be4ad8ed538f95bdceddea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of temperatures in emissivity tables.  <a href="jurassic_8h.html#aad9835e9e4be4ad8ed538f95bdceddea">More...</a><br /></td></tr>
<tr class="separator:aad9835e9e4be4ad8ed538f95bdceddea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a910036a8c83f3464c3de6bf398467c03"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a910036a8c83f3464c3de6bf398467c03">TBLNU</a>&#160;&#160;&#160;320</td></tr>
<tr class="memdesc:a910036a8c83f3464c3de6bf398467c03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of column densities in emissivity tables.  <a href="jurassic_8h.html#a910036a8c83f3464c3de6bf398467c03">More...</a><br /></td></tr>
<tr class="separator:a910036a8c83f3464c3de6bf398467c03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc1bfd45871746b198d5db5cd89beb63"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">TBLNS</a>&#160;&#160;&#160;1200</td></tr>
<tr class="memdesc:acc1bfd45871746b198d5db5cd89beb63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of source function temperature levels.  <a href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">More...</a><br /></td></tr>
<tr class="separator:acc1bfd45871746b198d5db5cd89beb63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f4cdd0162e9f2ab251fa5b23410c8da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a6f4cdd0162e9f2ab251fa5b23410c8da">MAX_TABLES</a>&#160;&#160;&#160;10000</td></tr>
<tr class="memdesc:a6f4cdd0162e9f2ab251fa5b23410c8da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of frequency-table entries allowed in a gas table file.  <a href="jurassic_8h.html#a6f4cdd0162e9f2ab251fa5b23410c8da">More...</a><br /></td></tr>
<tr class="separator:a6f4cdd0162e9f2ab251fa5b23410c8da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4afe3221b6cc7d990b27a05a924ee2a2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a4afe3221b6cc7d990b27a05a924ee2a2">RFMNPTS</a>&#160;&#160;&#160;10000000</td></tr>
<tr class="memdesc:a4afe3221b6cc7d990b27a05a924ee2a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of RFM spectral grid points.  <a href="jurassic_8h.html#a4afe3221b6cc7d990b27a05a924ee2a2">More...</a><br /></td></tr>
<tr class="separator:a4afe3221b6cc7d990b27a05a924ee2a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99c6798a64d9d5535a2b22b46ee31924"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a99c6798a64d9d5535a2b22b46ee31924"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index for pressure.  <a href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">More...</a><br /></td></tr>
<tr class="separator:a99c6798a64d9d5535a2b22b46ee31924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb33f030ad4a44d5f638f3903d13fe70"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:afb33f030ad4a44d5f638f3903d13fe70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index for temperature.  <a href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">More...</a><br /></td></tr>
<tr class="separator:afb33f030ad4a44d5f638f3903d13fe70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2f80a7a5ff9b54495c0c41d8571cafc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a>(ig)&#160;&#160;&#160;(2 + (ig))</td></tr>
<tr class="memdesc:af2f80a7a5ff9b54495c0c41d8571cafc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indices for volume mixing ratios.  <a href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">More...</a><br /></td></tr>
<tr class="separator:af2f80a7a5ff9b54495c0c41d8571cafc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a511d4808c85a5b5e1e600cf413eabbd6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a>(iw)&#160;&#160;&#160;(2 + (ctl-&gt;ng) + (iw))</td></tr>
<tr class="memdesc:a511d4808c85a5b5e1e600cf413eabbd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indices for extinction.  <a href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">More...</a><br /></td></tr>
<tr class="separator:a511d4808c85a5b5e1e600cf413eabbd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04eaf14380553f171f54680560527fe5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a04eaf14380553f171f54680560527fe5">IDXCLZ</a>&#160;&#160;&#160;(2 + (ctl-&gt;ng) + (ctl-&gt;nw))</td></tr>
<tr class="memdesc:a04eaf14380553f171f54680560527fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index for cloud layer height.  <a href="jurassic_8h.html#a04eaf14380553f171f54680560527fe5">More...</a><br /></td></tr>
<tr class="separator:a04eaf14380553f171f54680560527fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b420330ad2457758ef539d8c9e0bd99"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a3b420330ad2457758ef539d8c9e0bd99">IDXCLDZ</a>&#160;&#160;&#160;(3 + (ctl-&gt;ng) + (ctl-&gt;nw))</td></tr>
<tr class="memdesc:a3b420330ad2457758ef539d8c9e0bd99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index for cloud layer depth.  <a href="jurassic_8h.html#a3b420330ad2457758ef539d8c9e0bd99">More...</a><br /></td></tr>
<tr class="separator:a3b420330ad2457758ef539d8c9e0bd99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a809f947437669a6b3930302f30375d41"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a809f947437669a6b3930302f30375d41">IDXCLK</a>(icl)&#160;&#160;&#160;(4 + (ctl-&gt;ng) + (ctl-&gt;nw) + (icl))</td></tr>
<tr class="memdesc:a809f947437669a6b3930302f30375d41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indices for cloud layer extinction.  <a href="jurassic_8h.html#a809f947437669a6b3930302f30375d41">More...</a><br /></td></tr>
<tr class="separator:a809f947437669a6b3930302f30375d41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7abc6f3d1a1993a0337a736d79cf6ecc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a7abc6f3d1a1993a0337a736d79cf6ecc">IDXSFT</a>&#160;&#160;&#160;(4 + (ctl-&gt;ng) + (ctl-&gt;nw) + (ctl-&gt;ncl))</td></tr>
<tr class="memdesc:a7abc6f3d1a1993a0337a736d79cf6ecc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index for surface layer temperature.  <a href="jurassic_8h.html#a7abc6f3d1a1993a0337a736d79cf6ecc">More...</a><br /></td></tr>
<tr class="separator:a7abc6f3d1a1993a0337a736d79cf6ecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a803581fe3fed7a56dacec94c5c860f35"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35">IDXSFEPS</a>(isf)&#160;&#160;&#160;(5 + (ctl-&gt;ng) + (ctl-&gt;nw) + (ctl-&gt;ncl) + (isf))</td></tr>
<tr class="memdesc:a803581fe3fed7a56dacec94c5c860f35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indices for surface layer emissivity.  <a href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35">More...</a><br /></td></tr>
<tr class="separator:a803581fe3fed7a56dacec94c5c860f35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aee3e5daf3b1051597d21ab093adbd0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(ptr,  type,  n)</td></tr>
<tr class="memdesc:a9aee3e5daf3b1051597d21ab093adbd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for an array.  <a href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">More...</a><br /></td></tr>
<tr class="separator:a9aee3e5daf3b1051597d21ab093adbd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a064f8ccf1a30f33e2fd095884558364d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a064f8ccf1a30f33e2fd095884558364d">BRIGHT</a>(rad,  nu)&#160;&#160;&#160;  (<a class="el" href="jurassic_8h.html#ad6fc13322a4f1c314332ff34aa8b3fa0">C2</a> * (nu) / gsl_log1p(<a class="el" href="jurassic_8h.html#a44779f18d87e71c78fc9fbf9dc88537d">C1</a> * <a class="el" href="jurassic_8h.html#ab051a5ece45339feb3f4b19a4dddbcb2">POW3</a>(nu) / (rad)))</td></tr>
<tr class="memdesc:a064f8ccf1a30f33e2fd095884558364d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute brightness temperature from radiance.  <a href="jurassic_8h.html#a064f8ccf1a30f33e2fd095884558364d">More...</a><br /></td></tr>
<tr class="separator:a064f8ccf1a30f33e2fd095884558364d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3616a5af1a14b0a5a1b2f542066ae45"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(deg)&#160;&#160;&#160;((deg) * (M_PI / 180.0))</td></tr>
<tr class="memdesc:aa3616a5af1a14b0a5a1b2f542066ae45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert degrees to radians.  <a href="jurassic_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">More...</a><br /></td></tr>
<tr class="separator:aa3616a5af1a14b0a5a1b2f542066ae45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae733a5a3a9e9a85474da2105655a0dc4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae733a5a3a9e9a85474da2105655a0dc4">DIST</a>(a,  b)&#160;&#160;&#160;sqrt(<a class="el" href="jurassic_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a>(a, b))</td></tr>
<tr class="memdesc:ae733a5a3a9e9a85474da2105655a0dc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Cartesian distance between two 3D vectors.  <a href="jurassic_8h.html#ae733a5a3a9e9a85474da2105655a0dc4">More...</a><br /></td></tr>
<tr class="separator:ae733a5a3a9e9a85474da2105655a0dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af003cf5f79f68880f39a9a95d69f19bb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a>(a,  b)&#160;&#160;&#160;  ((a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1])+(a[2]-b[2])*(a[2]-b[2]))</td></tr>
<tr class="memdesc:af003cf5f79f68880f39a9a95d69f19bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute squared distance between two 3D vectors.  <a href="jurassic_8h.html#af003cf5f79f68880f39a9a95d69f19bb">More...</a><br /></td></tr>
<tr class="separator:af003cf5f79f68880f39a9a95d69f19bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f872a4cdfaa577c03b9dea8201028e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a>(a,  b)&#160;&#160;&#160;(a[0]*b[0]+a[1]*b[1]+a[2]*b[2])</td></tr>
<tr class="memdesc:a2f872a4cdfaa577c03b9dea8201028e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute dot product of two 3D vectors.  <a href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">More...</a><br /></td></tr>
<tr class="separator:a2f872a4cdfaa577c03b9dea8201028e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c13542ca31cfbccfc436aabd8851f6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(ptr,  type,  size,  out)</td></tr>
<tr class="memdesc:ae8c13542ca31cfbccfc436aabd8851f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read binary data from a file.  <a href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">More...</a><br /></td></tr>
<tr class="separator:ae8c13542ca31cfbccfc436aabd8851f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e67562ddd8fb52548a4ca02d3640bac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(ptr,  type,  size,  out)</td></tr>
<tr class="memdesc:a1e67562ddd8fb52548a4ca02d3640bac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write binary data to a file.  <a href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">More...</a><br /></td></tr>
<tr class="separator:a1e67562ddd8fb52548a4ca02d3640bac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebaef4a0f8136be064bf1d29ce1ced83"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(x0,  y0,  x1,  y1,  x)&#160;&#160;&#160;  ((y0)+((y1)-(y0))/((x1)-(x0))*((x)-(x0)))</td></tr>
<tr class="memdesc:aebaef4a0f8136be064bf1d29ce1ced83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute linear interpolation.  <a href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">More...</a><br /></td></tr>
<tr class="separator:aebaef4a0f8136be064bf1d29ce1ced83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a870fa40d24bd17e7cc7ec906662047b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3">LOGX</a>(x0,  y0,  x1,  y1,  x)</td></tr>
<tr class="memdesc:a870fa40d24bd17e7cc7ec906662047b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute logarithmic interpolation in x.  <a href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3">More...</a><br /></td></tr>
<tr class="separator:a870fa40d24bd17e7cc7ec906662047b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df174578bf85b1e9f33c597f5f8e5ca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca">LOGY</a>(x0,  y0,  x1,  y1,  x)</td></tr>
<tr class="memdesc:a6df174578bf85b1e9f33c597f5f8e5ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute logarithmic interpolation in y.  <a href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca">More...</a><br /></td></tr>
<tr class="separator:a6df174578bf85b1e9f33c597f5f8e5ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(a,  b)&#160;&#160;&#160;(((a)&gt;(b))?(a):(b))</td></tr>
<tr class="memdesc:afa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the maximum of two values.  <a href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">More...</a><br /></td></tr>
<tr class="separator:afa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(a,  b)&#160;&#160;&#160;(((a)&lt;(b))?(a):(b))</td></tr>
<tr class="memdesc:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the minimum of two values.  <a href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">More...</a><br /></td></tr>
<tr class="separator:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd8f7689ce8b91801aec9cdc7148159"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a0bd8f7689ce8b91801aec9cdc7148159">NEDT</a>(t_bg,  nesr,  nu)&#160;&#160;&#160;  (<a class="el" href="jurassic_8h.html#a064f8ccf1a30f33e2fd095884558364d">BRIGHT</a>(<a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a>((t_bg), (nu)) + (nesr), (nu)) - (t_bg))</td></tr>
<tr class="memdesc:a0bd8f7689ce8b91801aec9cdc7148159"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert noise-equivalent spectral radiance (NESR) to noise-equivalent delta temperature (NEDT).  <a href="jurassic_8h.html#a0bd8f7689ce8b91801aec9cdc7148159">More...</a><br /></td></tr>
<tr class="separator:a0bd8f7689ce8b91801aec9cdc7148159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b13e6dc6b9f6f73047e43a59c2e67fc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a0b13e6dc6b9f6f73047e43a59c2e67fc">NESR</a>(t_bg,  nedt,  nu)&#160;&#160;&#160;  (<a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a>((t_bg) + (nedt), (nu)) - <a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a>((t_bg), (nu)))</td></tr>
<tr class="memdesc:a0b13e6dc6b9f6f73047e43a59c2e67fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert noise-equivalent delta temperature (NEDT) to noise-equivalent spectral radiance (NESR).  <a href="jurassic_8h.html#a0b13e6dc6b9f6f73047e43a59c2e67fc">More...</a><br /></td></tr>
<tr class="separator:a0b13e6dc6b9f6f73047e43a59c2e67fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa3afb5cf2625deb1e859cbb93d2943"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a>(a)&#160;&#160;&#160;sqrt(<a class="el" href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a>(a, a))</td></tr>
<tr class="memdesc:a7fa3afb5cf2625deb1e859cbb93d2943"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the norm (magnitude) of a 3D vector.  <a href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">More...</a><br /></td></tr>
<tr class="separator:a7fa3afb5cf2625deb1e859cbb93d2943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab737f801dafc49850e131f6a42cd45ee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a>(T,  nu)&#160;&#160;&#160;  (<a class="el" href="jurassic_8h.html#a44779f18d87e71c78fc9fbf9dc88537d">C1</a> * <a class="el" href="jurassic_8h.html#ab051a5ece45339feb3f4b19a4dddbcb2">POW3</a>(nu) / gsl_expm1(<a class="el" href="jurassic_8h.html#ad6fc13322a4f1c314332ff34aa8b3fa0">C2</a> * (nu) / (T)))</td></tr>
<tr class="memdesc:ab737f801dafc49850e131f6a42cd45ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute spectral radiance using Plancks law.  <a href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">More...</a><br /></td></tr>
<tr class="separator:ab737f801dafc49850e131f6a42cd45ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac0abc7c913167ecaf81778d57e7a17"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(x)&#160;&#160;&#160;((x)*(x))</td></tr>
<tr class="memdesc:a1ac0abc7c913167ecaf81778d57e7a17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the square of a value.  <a href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">More...</a><br /></td></tr>
<tr class="separator:a1ac0abc7c913167ecaf81778d57e7a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab051a5ece45339feb3f4b19a4dddbcb2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ab051a5ece45339feb3f4b19a4dddbcb2">POW3</a>(x)&#160;&#160;&#160;((x)*(x)*(x))</td></tr>
<tr class="memdesc:ab051a5ece45339feb3f4b19a4dddbcb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the cube of a value.  <a href="jurassic_8h.html#ab051a5ece45339feb3f4b19a4dddbcb2">More...</a><br /></td></tr>
<tr class="separator:ab051a5ece45339feb3f4b19a4dddbcb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc958134b53425ec947541bb72ac8b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a>(rad)&#160;&#160;&#160;((rad) * (180.0 / M_PI))</td></tr>
<tr class="memdesc:aacc958134b53425ec947541bb72ac8b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert radians to degrees.  <a href="jurassic_8h.html#aacc958134b53425ec947541bb72ac8b1">More...</a><br /></td></tr>
<tr class="separator:aacc958134b53425ec947541bb72ac8b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfef660f42c1ea3245fcd48cd013754a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#adfef660f42c1ea3245fcd48cd013754a">REFRAC</a>(p,  T)&#160;&#160;&#160;(7.753e-05 * (p) / (T))</td></tr>
<tr class="memdesc:adfef660f42c1ea3245fcd48cd013754a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute air refractivity (n - 1).  <a href="jurassic_8h.html#adfef660f42c1ea3245fcd48cd013754a">More...</a><br /></td></tr>
<tr class="separator:adfef660f42c1ea3245fcd48cd013754a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90f5818bdcd4c17727d704c141c7cca8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a90f5818bdcd4c17727d704c141c7cca8">TIMER</a>(name,  mode)&#160;&#160;&#160;  {<a class="el" href="jurassic_8h.html#a14740e9d412eb3e810eb95e178be297b">timer</a>(name, __FILE__, __func__, __LINE__, mode);}</td></tr>
<tr class="memdesc:a90f5818bdcd4c17727d704c141c7cca8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start or stop a named timer.  <a href="jurassic_8h.html#a90f5818bdcd4c17727d704c141c7cca8">More...</a><br /></td></tr>
<tr class="separator:a90f5818bdcd4c17727d704c141c7cca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b61d1304377b77925b2802459ddae98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(line,  tok,  format,  var)</td></tr>
<tr class="memdesc:a8b61d1304377b77925b2802459ddae98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tokenize a string and parse a variable.  <a href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">More...</a><br /></td></tr>
<tr class="separator:a8b61d1304377b77925b2802459ddae98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c49f3ada06708693de9e60b449964c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aa0c49f3ada06708693de9e60b449964c">LOGLEV</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:aa0c49f3ada06708693de9e60b449964c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Level of log messages (0=none, 1=basic, 2=detailed, 3=debug).  <a href="jurassic_8h.html#aa0c49f3ada06708693de9e60b449964c">More...</a><br /></td></tr>
<tr class="separator:aa0c49f3ada06708693de9e60b449964c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaa1c3fa56061380a29889d703236251"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(level, ...)</td></tr>
<tr class="memdesc:acaa1c3fa56061380a29889d703236251"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a log message with a specified logging level.  <a href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">More...</a><br /></td></tr>
<tr class="separator:acaa1c3fa56061380a29889d703236251"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f75b971030a39ef811d3526a62b36b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(...)</td></tr>
<tr class="memdesc:a8f75b971030a39ef811d3526a62b36b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a warning message with contextual information.  <a href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">More...</a><br /></td></tr>
<tr class="separator:a8f75b971030a39ef811d3526a62b36b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0ae69dee4a8bb2e616526b5ebe6875"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(...)</td></tr>
<tr class="memdesc:a3e0ae69dee4a8bb2e616526b5ebe6875"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print an error message with contextual information and terminate the program.  <a href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">More...</a><br /></td></tr>
<tr class="separator:a3e0ae69dee4a8bb2e616526b5ebe6875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19e6b556dec9bcdb4e422d57633ce731"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a19e6b556dec9bcdb4e422d57633ce731">PRINT</a>(format,  var)</td></tr>
<tr class="memdesc:a19e6b556dec9bcdb4e422d57633ce731"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the value of a variable with contextual information.  <a href="jurassic_8h.html#a19e6b556dec9bcdb4e422d57633ce731">More...</a><br /></td></tr>
<tr class="separator:a19e6b556dec9bcdb4e422d57633ce731"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a04a9fd3342f5477d3cb1825fa60ed2a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a04a9fd3342f5477d3cb1825fa60ed2a9">analyze_avk</a> (const <a class="el" href="structret__t.html">ret_t</a> *ret, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const int *iqa, const int *ipa, const gsl_matrix *avk)</td></tr>
<tr class="memdesc:a04a9fd3342f5477d3cb1825fa60ed2a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyze averaging kernel (AVK) matrix for retrieval diagnostics.  <a href="jurassic_8h.html#a04a9fd3342f5477d3cb1825fa60ed2a9">More...</a><br /></td></tr>
<tr class="separator:a04a9fd3342f5477d3cb1825fa60ed2a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc0cac17f91169e812ecee2bc7fc990"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a> (const gsl_matrix *avk, const int iq, const int *ipa, const size_t *n0, const size_t *n1, double *cont, double *res)</td></tr>
<tr class="memdesc:acbc0cac17f91169e812ecee2bc7fc990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyze averaging kernel submatrix for a specific retrieved quantity.  <a href="jurassic_8h.html#acbc0cac17f91169e812ecee2bc7fc990">More...</a><br /></td></tr>
<tr class="separator:acbc0cac17f91169e812ecee2bc7fc990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfbb04487aa1c1d4175afca6e521e20b"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, gsl_vector *x, int *iqa, int *ipa)</td></tr>
<tr class="memdesc:adfbb04487aa1c1d4175afca6e521e20b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert atmospheric data to state vector elements.  <a href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b">More...</a><br /></td></tr>
<tr class="separator:adfbb04487aa1c1d4175afca6e521e20b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac332e50178e5439e72634fe03d191f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a> (const double value, const int value_iqa, const int value_ip, gsl_vector *x, int *iqa, int *ipa, size_t *n)</td></tr>
<tr class="memdesc:a5ac332e50178e5439e72634fe03d191f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append a single atmospheric value to the state vector.  <a href="jurassic_8h.html#a5ac332e50178e5439e72634fe03d191f">More...</a><br /></td></tr>
<tr class="separator:a5ac332e50178e5439e72634fe03d191f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf98f7230de0893b8dc4833d3c83c7a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a> (const double *x, double *z, double *lon, double *lat)</td></tr>
<tr class="memdesc:aaf98f7230de0893b8dc4833d3c83c7a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts Cartesian coordinates to geographic coordinates.  <a href="jurassic_8h.html#aaf98f7230de0893b8dc4833d3c83c7a4">More...</a><br /></td></tr>
<tr class="separator:aaf98f7230de0893b8dc4833d3c83c7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae324329aa277798b632b25de13faf1b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae324329aa277798b632b25de13faf1b2">climatology</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ae324329aa277798b632b25de13faf1b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes atmospheric climatology profiles.  <a href="jurassic_8h.html#ae324329aa277798b632b25de13faf1b2">More...</a><br /></td></tr>
<tr class="separator:ae324329aa277798b632b25de13faf1b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8c72b0bc66d214b4575c13a7a0eb6b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">cos_sza</a> (const double sec, const double lon, const double lat)</td></tr>
<tr class="memdesc:a1c8c72b0bc66d214b4575c13a7a0eb6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the cosine of the solar zenith angle.  <a href="jurassic_8h.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">More...</a><br /></td></tr>
<tr class="separator:a1c8c72b0bc66d214b4575c13a7a0eb6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a092636f1592a6e34378a13f3e03e2f87"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a092636f1592a6e34378a13f3e03e2f87">cost_function</a> (const gsl_vector *dx, const gsl_vector *dy, const gsl_matrix *s_a_inv, const gsl_vector *sig_eps_inv)</td></tr>
<tr class="memdesc:a092636f1592a6e34378a13f3e03e2f87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the normalized quadratic cost function for optimal estimation.  <a href="jurassic_8h.html#a092636f1592a6e34378a13f3e03e2f87">More...</a><br /></td></tr>
<tr class="separator:a092636f1592a6e34378a13f3e03e2f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a962bab37658297e87de9631c67707b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a9a962bab37658297e87de9631c67707b">ctmco2</a> (const double nu, const double p, const double t, const double u)</td></tr>
<tr class="memdesc:a9a962bab37658297e87de9631c67707b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute carbon dioxide continuum (optical depth).  <a href="jurassic_8h.html#a9a962bab37658297e87de9631c67707b">More...</a><br /></td></tr>
<tr class="separator:a9a962bab37658297e87de9631c67707b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b99f6f4581181857d4b89b27e8c2f87"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a5b99f6f4581181857d4b89b27e8c2f87">ctmh2o</a> (const double nu, const double p, const double t, const double q, const double u)</td></tr>
<tr class="memdesc:a5b99f6f4581181857d4b89b27e8c2f87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute water vapor continuum (optical depth).  <a href="jurassic_8h.html#a5b99f6f4581181857d4b89b27e8c2f87">More...</a><br /></td></tr>
<tr class="separator:a5b99f6f4581181857d4b89b27e8c2f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad788eb8a3a6df141d82f28adbd610668"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad788eb8a3a6df141d82f28adbd610668">ctmn2</a> (const double nu, const double p, const double t)</td></tr>
<tr class="memdesc:ad788eb8a3a6df141d82f28adbd610668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute N collision-induced absorption coefficient.  <a href="jurassic_8h.html#ad788eb8a3a6df141d82f28adbd610668">More...</a><br /></td></tr>
<tr class="separator:ad788eb8a3a6df141d82f28adbd610668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d55d073ef8855381487a486970152f5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a2d55d073ef8855381487a486970152f5">ctmo2</a> (const double nu, const double p, const double t)</td></tr>
<tr class="memdesc:a2d55d073ef8855381487a486970152f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute O collision-induced absorption coefficient.  <a href="jurassic_8h.html#a2d55d073ef8855381487a486970152f5">More...</a><br /></td></tr>
<tr class="separator:a2d55d073ef8855381487a486970152f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4d49729d85da58030daa13689c5edd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad4d49729d85da58030daa13689c5edd1">copy_atm</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm_dest, const <a class="el" href="structatm__t.html">atm_t</a> *atm_src, const int init)</td></tr>
<tr class="memdesc:ad4d49729d85da58030daa13689c5edd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy or initialize atmospheric profile data.  <a href="jurassic_8h.html#ad4d49729d85da58030daa13689c5edd1">More...</a><br /></td></tr>
<tr class="separator:ad4d49729d85da58030daa13689c5edd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa855e52716bd4b479bb0d2446b300a4e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aa855e52716bd4b479bb0d2446b300a4e">copy_obs</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structobs__t.html">obs_t</a> *obs_dest, const <a class="el" href="structobs__t.html">obs_t</a> *obs_src, const int init)</td></tr>
<tr class="memdesc:aa855e52716bd4b479bb0d2446b300a4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy or initialize observation geometry and radiance data.  <a href="jurassic_8h.html#aa855e52716bd4b479bb0d2446b300a4e">More...</a><br /></td></tr>
<tr class="separator:aa855e52716bd4b479bb0d2446b300a4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a556279802ef57635f9e81a062d8b6ce1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a556279802ef57635f9e81a062d8b6ce1">day2doy</a> (int year, int mon, int day, int *doy)</td></tr>
<tr class="memdesc:a556279802ef57635f9e81a062d8b6ce1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a calendar date to day-of-year.  <a href="jurassic_8h.html#a556279802ef57635f9e81a062d8b6ce1">More...</a><br /></td></tr>
<tr class="separator:a556279802ef57635f9e81a062d8b6ce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2b4738ae5b57d80da7a4c779c493f1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ab2b4738ae5b57d80da7a4c779c493f1a">doy2day</a> (int year, int doy, int *mon, int *day)</td></tr>
<tr class="memdesc:ab2b4738ae5b57d80da7a4c779c493f1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a day-of-year value to a calendar date.  <a href="jurassic_8h.html#ab2b4738ae5b57d80da7a4c779c493f1a">More...</a><br /></td></tr>
<tr class="separator:ab2b4738ae5b57d80da7a4c779c493f1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a832e63c37527025311d1886a60dff605"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a832e63c37527025311d1886a60dff605">find_emitter</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const char *emitter)</td></tr>
<tr class="memdesc:a832e63c37527025311d1886a60dff605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find gas species index by name.  <a href="jurassic_8h.html#a832e63c37527025311d1886a60dff605">More...</a><br /></td></tr>
<tr class="separator:a832e63c37527025311d1886a60dff605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe93da56294b380e322c18ca2838fd51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#abe93da56294b380e322c18ca2838fd51">formod</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, <a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:abe93da56294b380e322c18ca2838fd51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the selected forward model.  <a href="jurassic_8h.html#abe93da56294b380e322c18ca2838fd51">More...</a><br /></td></tr>
<tr class="separator:abe93da56294b380e322c18ca2838fd51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a363f5205cd58d7a22133f704f1137181"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a363f5205cd58d7a22133f704f1137181">formod_continua</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structlos__t.html">los_t</a> *los, const int ip, double *beta)</td></tr>
<tr class="memdesc:a363f5205cd58d7a22133f704f1137181"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute total extinction including gaseous continua.  <a href="jurassic_8h.html#a363f5205cd58d7a22133f704f1137181">More...</a><br /></td></tr>
<tr class="separator:a363f5205cd58d7a22133f704f1137181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c3109373d1d5edcf57840c288f6f53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ab0c3109373d1d5edcf57840c288f6f53">formod_fov</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:ab0c3109373d1d5edcf57840c288f6f53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply field-of-view (FOV) convolution to modeled radiances.  <a href="jurassic_8h.html#ab0c3109373d1d5edcf57840c288f6f53">More...</a><br /></td></tr>
<tr class="separator:ab0c3109373d1d5edcf57840c288f6f53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9727c4e0e5bc85384762b6ad81a8c3be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a9727c4e0e5bc85384762b6ad81a8c3be">formod_pencil</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structobs__t.html">obs_t</a> *obs, const int ir)</td></tr>
<tr class="memdesc:a9727c4e0e5bc85384762b6ad81a8c3be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute line-of-sight radiances using the pencil-beam forward model.  <a href="jurassic_8h.html#a9727c4e0e5bc85384762b6ad81a8c3be">More...</a><br /></td></tr>
<tr class="separator:a9727c4e0e5bc85384762b6ad81a8c3be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2caf20484e8e2f52ff3650321b7c704c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a2caf20484e8e2f52ff3650321b7c704c">formod_rfm</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:a2caf20484e8e2f52ff3650321b7c704c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface routine for the Reference Forward Model (RFM).  <a href="jurassic_8h.html#a2caf20484e8e2f52ff3650321b7c704c">More...</a><br /></td></tr>
<tr class="separator:a2caf20484e8e2f52ff3650321b7c704c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7826de16feb2eb6730b661bf8deba90"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ac7826de16feb2eb6730b661bf8deba90">formod_srcfunc</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const double t, double *src)</td></tr>
<tr class="memdesc:ac7826de16feb2eb6730b661bf8deba90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate the source function (Planck radiance) at a given temperature.  <a href="jurassic_8h.html#ac7826de16feb2eb6730b661bf8deba90">More...</a><br /></td></tr>
<tr class="separator:ac7826de16feb2eb6730b661bf8deba90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3aea782dfca9019f3f2d169f8cc0f6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a> (const double z, const double lon, const double lat, double *x)</td></tr>
<tr class="memdesc:ae3aea782dfca9019f3f2d169f8cc0f6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates.  <a href="jurassic_8h.html#ae3aea782dfca9019f3f2d169f8cc0f6d">More...</a><br /></td></tr>
<tr class="separator:ae3aea782dfca9019f3f2d169f8cc0f6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad69ab6edb8f722212fb01e12d8809643"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad69ab6edb8f722212fb01e12d8809643">hydrostatic</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ad69ab6edb8f722212fb01e12d8809643"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjust pressure profile using the hydrostatic equation.  <a href="jurassic_8h.html#ad69ab6edb8f722212fb01e12d8809643">More...</a><br /></td></tr>
<tr class="separator:ad69ab6edb8f722212fb01e12d8809643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a342f4954ef3678480cae2efb366a7b3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a342f4954ef3678480cae2efb366a7b3e">idx2name</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const int idx, char *quantity)</td></tr>
<tr class="memdesc:a342f4954ef3678480cae2efb366a7b3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a quantity index to a descriptive name string.  <a href="jurassic_8h.html#a342f4954ef3678480cae2efb366a7b3e">More...</a><br /></td></tr>
<tr class="separator:a342f4954ef3678480cae2efb366a7b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6852ec1675d0539a21df1fc4ecee1f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ab6852ec1675d0539a21df1fc4ecee1f0">init_srcfunc</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structtbl__t.html">tbl_t</a> *tbl)</td></tr>
<tr class="memdesc:ab6852ec1675d0539a21df1fc4ecee1f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the source-function (Planck radiance) lookup table.  <a href="jurassic_8h.html#ab6852ec1675d0539a21df1fc4ecee1f0">More...</a><br /></td></tr>
<tr class="separator:ab6852ec1675d0539a21df1fc4ecee1f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82151ea4448e70f46f7f3b770bb77612"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a82151ea4448e70f46f7f3b770bb77612">intpol_atm</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double z, double *p, double *t, double *q, double *k)</td></tr>
<tr class="memdesc:a82151ea4448e70f46f7f3b770bb77612"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate atmospheric state variables at a given altitude.  <a href="jurassic_8h.html#a82151ea4448e70f46f7f3b770bb77612">More...</a><br /></td></tr>
<tr class="separator:a82151ea4448e70f46f7f3b770bb77612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e22cd63c35ef6e2c9b9023e2c3945d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a5e22cd63c35ef6e2c9b9023e2c3945d8">intpol_tbl_cga</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const <a class="el" href="structlos__t.html">los_t</a> *los, const int ip, double tau_path[<a class="el" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>][<a class="el" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a>], double tau_seg[<a class="el" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>])</td></tr>
<tr class="memdesc:a5e22cd63c35ef6e2c9b9023e2c3945d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate emissivities and transmittances using the CurtisGodson approximation (CGA).  <a href="jurassic_8h.html#a5e22cd63c35ef6e2c9b9023e2c3945d8">More...</a><br /></td></tr>
<tr class="separator:a5e22cd63c35ef6e2c9b9023e2c3945d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b67aa3affea0dd3c6da502dab26d22d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a2b67aa3affea0dd3c6da502dab26d22d">intpol_tbl_ega</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const <a class="el" href="structlos__t.html">los_t</a> *los, const int ip, double tau_path[<a class="el" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>][<a class="el" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a>], double tau_seg[<a class="el" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>])</td></tr>
<tr class="memdesc:a2b67aa3affea0dd3c6da502dab26d22d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate emissivities and transmittances using the Emissivity Growth Approximation (EGA).  <a href="jurassic_8h.html#a2b67aa3affea0dd3c6da502dab26d22d">More...</a><br /></td></tr>
<tr class="separator:a2b67aa3affea0dd3c6da502dab26d22d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7683ce6b4628d0d910fdb9d360e2022a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a> (const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const int ig, const int id, const int ip, const int it, const double u)</td></tr>
<tr class="memdesc:a7683ce6b4628d0d910fdb9d360e2022a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate emissivity from lookup tables as a function of column density.  <a href="jurassic_8h.html#a7683ce6b4628d0d910fdb9d360e2022a">More...</a><br /></td></tr>
<tr class="separator:a7683ce6b4628d0d910fdb9d360e2022a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7134ded8183d6692b868ce0d411c6138"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a7134ded8183d6692b868ce0d411c6138">intpol_tbl_u</a> (const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const int ig, const int id, const int ip, const int it, const double eps)</td></tr>
<tr class="memdesc:a7134ded8183d6692b868ce0d411c6138"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate column density from lookup tables as a function of emissivity.  <a href="jurassic_8h.html#a7134ded8183d6692b868ce0d411c6138">More...</a><br /></td></tr>
<tr class="separator:a7134ded8183d6692b868ce0d411c6138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc0c1829ca7770d2dd6342f2cdf10bb9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a> (const double jsec, int *year, int *mon, int *day, int *hour, int *min, int *sec, double *remain)</td></tr>
<tr class="memdesc:acc0c1829ca7770d2dd6342f2cdf10bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts Julian seconds to calendar date and time components.  <a href="jurassic_8h.html#acc0c1829ca7770d2dd6342f2cdf10bb9">More...</a><br /></td></tr>
<tr class="separator:acc0c1829ca7770d2dd6342f2cdf10bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab49799958d13e57af5b20527f0990ce6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ab49799958d13e57af5b20527f0990ce6">kernel</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, <a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structobs__t.html">obs_t</a> *obs, gsl_matrix *k)</td></tr>
<tr class="memdesc:ab49799958d13e57af5b20527f0990ce6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the Jacobian (kernel) matrix by finite differences.  <a href="jurassic_8h.html#ab49799958d13e57af5b20527f0990ce6">More...</a><br /></td></tr>
<tr class="separator:ab49799958d13e57af5b20527f0990ce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1b87dc3c93a23c89f739adf10b60dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a> (const double *xx, const int n, const double x)</td></tr>
<tr class="memdesc:a4e1b87dc3c93a23c89f739adf10b60dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate index for interpolation on an irregular grid.  <a href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc">More...</a><br /></td></tr>
<tr class="separator:a4e1b87dc3c93a23c89f739adf10b60dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a3c8ab98f21179741b274439786726d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a> (const double *xx, const int n, const double x)</td></tr>
<tr class="memdesc:a2a3c8ab98f21179741b274439786726d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate index for interpolation on a regular (uniform) grid.  <a href="jurassic_8h.html#a2a3c8ab98f21179741b274439786726d">More...</a><br /></td></tr>
<tr class="separator:a2a3c8ab98f21179741b274439786726d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af353b2a27de539a038750c3224d31d8f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#af353b2a27de539a038750c3224d31d8f">locate_tbl</a> (const float *xx, const int n, const double x)</td></tr>
<tr class="memdesc:af353b2a27de539a038750c3224d31d8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate index for interpolation within emissivity table grids.  <a href="jurassic_8h.html#af353b2a27de539a038750c3224d31d8f">More...</a><br /></td></tr>
<tr class="separator:af353b2a27de539a038750c3224d31d8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab86061d2a35e1ebf8c06ba0d13cf652b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ab86061d2a35e1ebf8c06ba0d13cf652b">matrix_invert</a> (gsl_matrix *a)</td></tr>
<tr class="memdesc:ab86061d2a35e1ebf8c06ba0d13cf652b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Invert a square matrix, optimized for diagonal or symmetric positive-definite matrices.  <a href="jurassic_8h.html#ab86061d2a35e1ebf8c06ba0d13cf652b">More...</a><br /></td></tr>
<tr class="separator:ab86061d2a35e1ebf8c06ba0d13cf652b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aee3f51e782400eb3b82f7a68ac2209"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a4aee3f51e782400eb3b82f7a68ac2209">matrix_product</a> (const gsl_matrix *a, const gsl_vector *b, const int transpose, gsl_matrix *c)</td></tr>
<tr class="memdesc:a4aee3f51e782400eb3b82f7a68ac2209"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute structured matrix products of the form \(A^T B A\) or \(A B A^T\).  <a href="jurassic_8h.html#a4aee3f51e782400eb3b82f7a68ac2209">More...</a><br /></td></tr>
<tr class="separator:a4aee3f51e782400eb3b82f7a68ac2209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6380c9458cf356667952f9651932e27"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad6380c9458cf356667952f9651932e27">obs2y</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structobs__t.html">obs_t</a> *obs, gsl_vector *y, int *ida, int *ira)</td></tr>
<tr class="memdesc:ad6380c9458cf356667952f9651932e27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert observation radiances into a measurement vector.  <a href="jurassic_8h.html#ad6380c9458cf356667952f9651932e27">More...</a><br /></td></tr>
<tr class="separator:ad6380c9458cf356667952f9651932e27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a881a1d24ae59077428bb4548fdefa2ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a881a1d24ae59077428bb4548fdefa2ee">optimal_estimation</a> (<a class="el" href="structret__t.html">ret_t</a> *ret, <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, <a class="el" href="structobs__t.html">obs_t</a> *obs_meas, <a class="el" href="structobs__t.html">obs_t</a> *obs_i, <a class="el" href="structatm__t.html">atm_t</a> *atm_apr, <a class="el" href="structatm__t.html">atm_t</a> *atm_i, double *chisq)</td></tr>
<tr class="memdesc:a881a1d24ae59077428bb4548fdefa2ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform optimal estimation retrieval using LevenbergMarquardt minimization.  <a href="jurassic_8h.html#a881a1d24ae59077428bb4548fdefa2ee">More...</a><br /></td></tr>
<tr class="separator:a881a1d24ae59077428bb4548fdefa2ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44e1e4b6ab44e79d049f99a04e79df9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a44e1e4b6ab44e79d049f99a04e79df9f">raytrace</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structobs__t.html">obs_t</a> *obs, <a class="el" href="structlos__t.html">los_t</a> *los, const int ir)</td></tr>
<tr class="memdesc:a44e1e4b6ab44e79d049f99a04e79df9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform line-of-sight (LOS) ray tracing through the atmosphere.  <a href="jurassic_8h.html#a44e1e4b6ab44e79d049f99a04e79df9f">More...</a><br /></td></tr>
<tr class="separator:a44e1e4b6ab44e79d049f99a04e79df9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a7b8ec913874ba418cfb4280fd3b84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aa4a7b8ec913874ba418cfb4280fd3b84">read_atm</a> (const char *dirname, const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:aa4a7b8ec913874ba418cfb4280fd3b84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read atmospheric input data from a file.  <a href="jurassic_8h.html#aa4a7b8ec913874ba418cfb4280fd3b84">More...</a><br /></td></tr>
<tr class="separator:aa4a7b8ec913874ba418cfb4280fd3b84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad731b63e75c5d5f3350000401d7e2817"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad731b63e75c5d5f3350000401d7e2817">read_atm_asc</a> (FILE *in, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ad731b63e75c5d5f3350000401d7e2817"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read atmospheric data in ASCII format.  <a href="jurassic_8h.html#ad731b63e75c5d5f3350000401d7e2817">More...</a><br /></td></tr>
<tr class="separator:ad731b63e75c5d5f3350000401d7e2817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c68478f392d35086c456de7ce58a190"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a0c68478f392d35086c456de7ce58a190">read_atm_bin</a> (FILE *in, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a0c68478f392d35086c456de7ce58a190"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read atmospheric data in binary format.  <a href="jurassic_8h.html#a0c68478f392d35086c456de7ce58a190">More...</a><br /></td></tr>
<tr class="separator:a0c68478f392d35086c456de7ce58a190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3635d1716488dea37d1176c1fb02675f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a3635d1716488dea37d1176c1fb02675f">read_ctl</a> (int argc, char *argv[], <a class="el" href="structctl__t.html">ctl_t</a> *ctl)</td></tr>
<tr class="memdesc:a3635d1716488dea37d1176c1fb02675f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read model control parameters from command-line and configuration input.  <a href="jurassic_8h.html#a3635d1716488dea37d1176c1fb02675f">More...</a><br /></td></tr>
<tr class="separator:a3635d1716488dea37d1176c1fb02675f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1380c5f839b8a1cca792a83de445a4b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a1380c5f839b8a1cca792a83de445a4b3">read_matrix</a> (const char *dirname, const char *filename, gsl_matrix *matrix)</td></tr>
<tr class="memdesc:a1380c5f839b8a1cca792a83de445a4b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a numerical matrix from an ASCII file.  <a href="jurassic_8h.html#a1380c5f839b8a1cca792a83de445a4b3">More...</a><br /></td></tr>
<tr class="separator:a1380c5f839b8a1cca792a83de445a4b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92ca8109106ef5912a265d7c882038d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aa92ca8109106ef5912a265d7c882038d">read_obs</a> (const char *dirname, const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:aa92ca8109106ef5912a265d7c882038d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read observation data from an input file.  <a href="jurassic_8h.html#aa92ca8109106ef5912a265d7c882038d">More...</a><br /></td></tr>
<tr class="separator:aa92ca8109106ef5912a265d7c882038d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96625d07215f4c342fb3304618a07fd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a96625d07215f4c342fb3304618a07fd0">read_obs_asc</a> (FILE *in, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:a96625d07215f4c342fb3304618a07fd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read ASCII-formatted observation data from an open file stream.  <a href="jurassic_8h.html#a96625d07215f4c342fb3304618a07fd0">More...</a><br /></td></tr>
<tr class="separator:a96625d07215f4c342fb3304618a07fd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a252223bd58c083b0ef8a8ff3391d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aa1a252223bd58c083b0ef8a8ff3391d0">read_obs_bin</a> (FILE *in, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:aa1a252223bd58c083b0ef8a8ff3391d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read binary-formatted observation data from an open file stream.  <a href="jurassic_8h.html#aa1a252223bd58c083b0ef8a8ff3391d0">More...</a><br /></td></tr>
<tr class="separator:aa1a252223bd58c083b0ef8a8ff3391d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a134dbd60b73c18eda7032e58284dbade"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a134dbd60b73c18eda7032e58284dbade">read_obs_rfm</a> (const char *basename, const double z, const double *nu, const double *f, const int n)</td></tr>
<tr class="memdesc:a134dbd60b73c18eda7032e58284dbade"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read and spectrally convolve an RFM output spectrum.  <a href="jurassic_8h.html#a134dbd60b73c18eda7032e58284dbade">More...</a><br /></td></tr>
<tr class="separator:a134dbd60b73c18eda7032e58284dbade"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba21310ce74a394f3faad06002e14d46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aba21310ce74a394f3faad06002e14d46">read_ret</a> (int argc, char *argv[], const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structret__t.html">ret_t</a> *ret)</td></tr>
<tr class="memdesc:aba21310ce74a394f3faad06002e14d46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read retrieval configuration and error parameters.  <a href="jurassic_8h.html#aba21310ce74a394f3faad06002e14d46">More...</a><br /></td></tr>
<tr class="separator:aba21310ce74a394f3faad06002e14d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19d63e07e3eb8166cbf65ce079e4d156"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a19d63e07e3eb8166cbf65ce079e4d156">read_rfm_spec</a> (const char *filename, double *nu, double *rad, int *npts)</td></tr>
<tr class="memdesc:a19d63e07e3eb8166cbf65ce079e4d156"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a Reference Forward Model (RFM) ASCII spectrum.  <a href="jurassic_8h.html#a19d63e07e3eb8166cbf65ce079e4d156">More...</a><br /></td></tr>
<tr class="separator:a19d63e07e3eb8166cbf65ce079e4d156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6dc7f479ca53ad9866d0e1df8f5ffcd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd">read_shape</a> (const char *filename, double *x, double *y, int *n)</td></tr>
<tr class="memdesc:ad6dc7f479ca53ad9866d0e1df8f5ffcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a two-column shape function from an ASCII file.  <a href="jurassic_8h.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd">More...</a><br /></td></tr>
<tr class="separator:ad6dc7f479ca53ad9866d0e1df8f5ffcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accf7b334232cd5dbb8b2b58b0e81f39a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#accf7b334232cd5dbb8b2b58b0e81f39a">read_tbl</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl)</td></tr>
<tr class="memdesc:accf7b334232cd5dbb8b2b58b0e81f39a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read all emissivity lookup tables for all gases and frequencies.  <a href="jurassic_8h.html#accf7b334232cd5dbb8b2b58b0e81f39a">More...</a><br /></td></tr>
<tr class="separator:accf7b334232cd5dbb8b2b58b0e81f39a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac437f3db65946abc16a2e6776f2d9ce6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ac437f3db65946abc16a2e6776f2d9ce6">read_tbl_asc</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const int id, const int ig)</td></tr>
<tr class="memdesc:ac437f3db65946abc16a2e6776f2d9ce6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a single ASCII emissivity lookup table.  <a href="jurassic_8h.html#ac437f3db65946abc16a2e6776f2d9ce6">More...</a><br /></td></tr>
<tr class="separator:ac437f3db65946abc16a2e6776f2d9ce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a059d22792e64add177ebc6f8ea0a90ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a059d22792e64add177ebc6f8ea0a90ed">read_tbl_bin</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const int id, const int ig)</td></tr>
<tr class="memdesc:a059d22792e64add177ebc6f8ea0a90ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a single binary emissivity lookup table.  <a href="jurassic_8h.html#a059d22792e64add177ebc6f8ea0a90ed">More...</a><br /></td></tr>
<tr class="separator:a059d22792e64add177ebc6f8ea0a90ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8270286cb1940c8001c373d0dd70442b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a8270286cb1940c8001c373d0dd70442b">read_tbl_gas</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const int id, const int ig)</td></tr>
<tr class="memdesc:a8270286cb1940c8001c373d0dd70442b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read one frequency block from a per-gas binary table file.  <a href="jurassic_8h.html#a8270286cb1940c8001c373d0dd70442b">More...</a><br /></td></tr>
<tr class="separator:a8270286cb1940c8001c373d0dd70442b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad0096f4559d524126d7b849cee0fb7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#adad0096f4559d524126d7b849cee0fb7">read_tbl_gas_close</a> (<a class="el" href="structtbl__gas__t.html">tbl_gas_t</a> *g)</td></tr>
<tr class="memdesc:adad0096f4559d524126d7b849cee0fb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close a per-gas binary table file and optionally rewrite metadata.  <a href="jurassic_8h.html#adad0096f4559d524126d7b849cee0fb7">More...</a><br /></td></tr>
<tr class="separator:adad0096f4559d524126d7b849cee0fb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae21efb7a5b4d98c52355ee78cd4d0df5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae21efb7a5b4d98c52355ee78cd4d0df5">read_tbl_gas_open</a> (const char *path, <a class="el" href="structtbl__gas__t.html">tbl_gas_t</a> *g)</td></tr>
<tr class="memdesc:ae21efb7a5b4d98c52355ee78cd4d0df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a per-gas binary table file for reading and writing.  <a href="jurassic_8h.html#ae21efb7a5b4d98c52355ee78cd4d0df5">More...</a><br /></td></tr>
<tr class="separator:ae21efb7a5b4d98c52355ee78cd4d0df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3441d713489f5900d4d98235a9973653"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a3441d713489f5900d4d98235a9973653">read_tbl_gas_single</a> (const <a class="el" href="structtbl__gas__t.html">tbl_gas_t</a> *g, const double freq, <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const int id, const int ig)</td></tr>
<tr class="memdesc:a3441d713489f5900d4d98235a9973653"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read one emissivity table block from a per-gas table file.  <a href="jurassic_8h.html#a3441d713489f5900d4d98235a9973653">More...</a><br /></td></tr>
<tr class="separator:a3441d713489f5900d4d98235a9973653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6ce9b0361afe11cb23b8ac1e0c7fa3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a> (int argc, char *argv[], const char *varname, const int arridx, const char *defvalue, char *value)</td></tr>
<tr class="memdesc:abb6ce9b0361afe11cb23b8ac1e0c7fa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan control file or command-line arguments for a configuration variable.  <a href="jurassic_8h.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">More...</a><br /></td></tr>
<tr class="separator:abb6ce9b0361afe11cb23b8ac1e0c7fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9a11e5f03e0a307add4daf864977cec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae9a11e5f03e0a307add4daf864977cec">set_cov_apr</a> (const <a class="el" href="structret__t.html">ret_t</a> *ret, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const int *iqa, const int *ipa, gsl_matrix *s_a)</td></tr>
<tr class="memdesc:ae9a11e5f03e0a307add4daf864977cec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the a priori covariance matrix \(\mathbf{S_a}\) for retrieval parameters.  <a href="jurassic_8h.html#ae9a11e5f03e0a307add4daf864977cec">More...</a><br /></td></tr>
<tr class="separator:ae9a11e5f03e0a307add4daf864977cec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bb69eac608c4019c689bf8280912c1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a6bb69eac608c4019c689bf8280912c1f">set_cov_meas</a> (const <a class="el" href="structret__t.html">ret_t</a> *ret, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structobs__t.html">obs_t</a> *obs, gsl_vector *sig_noise, gsl_vector *sig_formod, gsl_vector *sig_eps_inv)</td></tr>
<tr class="memdesc:a6bb69eac608c4019c689bf8280912c1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct measurement error standard deviations and their inverse.  <a href="jurassic_8h.html#a6bb69eac608c4019c689bf8280912c1f">More...</a><br /></td></tr>
<tr class="separator:a6bb69eac608c4019c689bf8280912c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1500cc96441cf118acda392366397cc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad1500cc96441cf118acda392366397cc">sza</a> (double sec, double lon, double lat)</td></tr>
<tr class="memdesc:ad1500cc96441cf118acda392366397cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the solar zenith angle for a given time and location.  <a href="jurassic_8h.html#ad1500cc96441cf118acda392366397cc">More...</a><br /></td></tr>
<tr class="separator:ad1500cc96441cf118acda392366397cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9020f32787ea7be08486d537a4f5c0fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a9020f32787ea7be08486d537a4f5c0fc">tangent_point</a> (const <a class="el" href="structlos__t.html">los_t</a> *los, double *tpz, double *tplon, double *tplat)</td></tr>
<tr class="memdesc:a9020f32787ea7be08486d537a4f5c0fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the tangent point along a line of sight (LOS).  <a href="jurassic_8h.html#a9020f32787ea7be08486d537a4f5c0fc">More...</a><br /></td></tr>
<tr class="separator:a9020f32787ea7be08486d537a4f5c0fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a578e7ebaa62304182de8fe7ddf144b8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a578e7ebaa62304182de8fe7ddf144b8f">time2jsec</a> (const int year, const int mon, const int day, const int hour, const int min, const int sec, const double remain, double *jsec)</td></tr>
<tr class="memdesc:a578e7ebaa62304182de8fe7ddf144b8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts time components to seconds since January 1, 2000, 12:00:00 UTC.  <a href="jurassic_8h.html#a578e7ebaa62304182de8fe7ddf144b8f">More...</a><br /></td></tr>
<tr class="separator:a578e7ebaa62304182de8fe7ddf144b8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14740e9d412eb3e810eb95e178be297b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a14740e9d412eb3e810eb95e178be297b">timer</a> (const char *name, const char *file, const char *func, int line, int mode)</td></tr>
<tr class="memdesc:a14740e9d412eb3e810eb95e178be297b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple wall-clock timer for runtime diagnostics.  <a href="jurassic_8h.html#a14740e9d412eb3e810eb95e178be297b">More...</a><br /></td></tr>
<tr class="separator:a14740e9d412eb3e810eb95e178be297b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26be12322766162766071e8cd3587515"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a26be12322766162766071e8cd3587515">write_atm</a> (const char *dirname, const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a26be12322766162766071e8cd3587515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write atmospheric data to a file.  <a href="jurassic_8h.html#a26be12322766162766071e8cd3587515">More...</a><br /></td></tr>
<tr class="separator:a26be12322766162766071e8cd3587515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedaa4b13833a182bbff8034a3b2edae0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aedaa4b13833a182bbff8034a3b2edae0">write_atm_asc</a> (FILE *out, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:aedaa4b13833a182bbff8034a3b2edae0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write atmospheric data to an ASCII file.  <a href="jurassic_8h.html#aedaa4b13833a182bbff8034a3b2edae0">More...</a><br /></td></tr>
<tr class="separator:aedaa4b13833a182bbff8034a3b2edae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb2306151e16b13ed93d84d379c8bb0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#abb2306151e16b13ed93d84d379c8bb0e">write_atm_bin</a> (FILE *out, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:abb2306151e16b13ed93d84d379c8bb0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write atmospheric data to a binary file.  <a href="jurassic_8h.html#abb2306151e16b13ed93d84d379c8bb0e">More...</a><br /></td></tr>
<tr class="separator:abb2306151e16b13ed93d84d379c8bb0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a675d14cbd1ae26f72e86f828d8367240"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a675d14cbd1ae26f72e86f828d8367240">write_atm_rfm</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a675d14cbd1ae26f72e86f828d8367240"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write atmospheric profile in RFM-compatible format.  <a href="jurassic_8h.html#a675d14cbd1ae26f72e86f828d8367240">More...</a><br /></td></tr>
<tr class="separator:a675d14cbd1ae26f72e86f828d8367240"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d82cfc384f2845f2bd5ebbe66b6b26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ae4d82cfc384f2845f2bd5ebbe66b6b26">write_matrix</a> (const char *dirname, const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const gsl_matrix *matrix, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const <a class="el" href="structobs__t.html">obs_t</a> *obs, const char *rowspace, const char *colspace, const char *sort)</td></tr>
<tr class="memdesc:ae4d82cfc384f2845f2bd5ebbe66b6b26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a fully annotated matrix (e.g., Jacobian or gain matrix) to file.  <a href="jurassic_8h.html#ae4d82cfc384f2845f2bd5ebbe66b6b26">More...</a><br /></td></tr>
<tr class="separator:ae4d82cfc384f2845f2bd5ebbe66b6b26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa92bd5536bbf6cb6b4f541e24dac461"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aaa92bd5536bbf6cb6b4f541e24dac461">write_obs</a> (const char *dirname, const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:aaa92bd5536bbf6cb6b4f541e24dac461"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write observation data to an output file in ASCII or binary format.  <a href="jurassic_8h.html#aaa92bd5536bbf6cb6b4f541e24dac461">More...</a><br /></td></tr>
<tr class="separator:aaa92bd5536bbf6cb6b4f541e24dac461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78c1bf52aacddbf614a0c254868195f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a78c1bf52aacddbf614a0c254868195f6">write_obs_asc</a> (FILE *out, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:a78c1bf52aacddbf614a0c254868195f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write observation data to an ASCII text file.  <a href="jurassic_8h.html#a78c1bf52aacddbf614a0c254868195f6">More...</a><br /></td></tr>
<tr class="separator:a78c1bf52aacddbf614a0c254868195f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5b6b84f5c15574a22021a17a6afdca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a3c5b6b84f5c15574a22021a17a6afdca">write_obs_bin</a> (FILE *out, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:a3c5b6b84f5c15574a22021a17a6afdca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write observation data in binary format to an output file stream.  <a href="jurassic_8h.html#a3c5b6b84f5c15574a22021a17a6afdca">More...</a><br /></td></tr>
<tr class="separator:a3c5b6b84f5c15574a22021a17a6afdca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd649b0cdf3dc23af5ad95a0532c751b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#abd649b0cdf3dc23af5ad95a0532c751b">write_shape</a> (const char *filename, const double *x, const double *y, const int n)</td></tr>
<tr class="memdesc:abd649b0cdf3dc23af5ad95a0532c751b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write tabulated shape function data to a text file.  <a href="jurassic_8h.html#abd649b0cdf3dc23af5ad95a0532c751b">More...</a><br /></td></tr>
<tr class="separator:abd649b0cdf3dc23af5ad95a0532c751b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec8df2858073df466eb01b273cc888ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aec8df2858073df466eb01b273cc888ab">write_stddev</a> (const char *quantity, const <a class="el" href="structret__t.html">ret_t</a> *ret, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const gsl_matrix *s)</td></tr>
<tr class="memdesc:aec8df2858073df466eb01b273cc888ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write retrieval standard deviation profiles to disk.  <a href="jurassic_8h.html#aec8df2858073df466eb01b273cc888ab">More...</a><br /></td></tr>
<tr class="separator:aec8df2858073df466eb01b273cc888ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78815bfc5643350a3b2d2c04782ad93d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a78815bfc5643350a3b2d2c04782ad93d">write_tbl</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl)</td></tr>
<tr class="memdesc:a78815bfc5643350a3b2d2c04782ad93d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write all emissivity lookup tables in the format specified by the control structure.  <a href="jurassic_8h.html#a78815bfc5643350a3b2d2c04782ad93d">More...</a><br /></td></tr>
<tr class="separator:a78815bfc5643350a3b2d2c04782ad93d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5557d36bbbd2cb91a1e1d69c7ea8ecc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a5557d36bbbd2cb91a1e1d69c7ea8ecc5">write_tbl_asc</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl)</td></tr>
<tr class="memdesc:a5557d36bbbd2cb91a1e1d69c7ea8ecc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write all lookup tables in human-readable ASCII format.  <a href="jurassic_8h.html#a5557d36bbbd2cb91a1e1d69c7ea8ecc5">More...</a><br /></td></tr>
<tr class="separator:a5557d36bbbd2cb91a1e1d69c7ea8ecc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60b80f0d4d9036d4bf24f266258a86d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a60b80f0d4d9036d4bf24f266258a86d0">write_tbl_bin</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl)</td></tr>
<tr class="memdesc:a60b80f0d4d9036d4bf24f266258a86d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write all lookup tables in compact binary format.  <a href="jurassic_8h.html#a60b80f0d4d9036d4bf24f266258a86d0">More...</a><br /></td></tr>
<tr class="separator:a60b80f0d4d9036d4bf24f266258a86d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dcdafceae19d83c22645217a4e765c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a7dcdafceae19d83c22645217a4e765c7">write_tbl_gas</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl)</td></tr>
<tr class="memdesc:a7dcdafceae19d83c22645217a4e765c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write lookup tables into per-gas binary table files with indexed blocks.  <a href="jurassic_8h.html#a7dcdafceae19d83c22645217a4e765c7">More...</a><br /></td></tr>
<tr class="separator:a7dcdafceae19d83c22645217a4e765c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb6bd5214f6579580cf5882f5ed4a64"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#affb6bd5214f6579580cf5882f5ed4a64">write_tbl_gas_create</a> (const char *path)</td></tr>
<tr class="memdesc:affb6bd5214f6579580cf5882f5ed4a64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new per-gas table file with an empty index.  <a href="jurassic_8h.html#affb6bd5214f6579580cf5882f5ed4a64">More...</a><br /></td></tr>
<tr class="separator:affb6bd5214f6579580cf5882f5ed4a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a323a3d7eb6a7c3ffe9736a4b66ff385f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a323a3d7eb6a7c3ffe9736a4b66ff385f">write_tbl_gas_single</a> (<a class="el" href="structtbl__gas__t.html">tbl_gas_t</a> *g, const double freq, const <a class="el" href="structtbl__t.html">tbl_t</a> *tbl, const int id, const int ig)</td></tr>
<tr class="memdesc:a323a3d7eb6a7c3ffe9736a4b66ff385f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append or overwrite a single frequency-table block in a per-gas file.  <a href="jurassic_8h.html#a323a3d7eb6a7c3ffe9736a4b66ff385f">More...</a><br /></td></tr>
<tr class="separator:a323a3d7eb6a7c3ffe9736a4b66ff385f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e72c7cead4b4b7aaf096803bc7360c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c">x2atm</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const gsl_vector *x, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a59e72c7cead4b4b7aaf096803bc7360c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map retrieval state vector back to atmospheric structure.  <a href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c">More...</a><br /></td></tr>
<tr class="separator:a59e72c7cead4b4b7aaf096803bc7360c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeed7544a87d85474e33d05fe0adc992"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a> (double *value, const gsl_vector *x, size_t *n)</td></tr>
<tr class="memdesc:aaeed7544a87d85474e33d05fe0adc992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to extract a single value from the retrieval state vector.  <a href="jurassic_8h.html#aaeed7544a87d85474e33d05fe0adc992">More...</a><br /></td></tr>
<tr class="separator:aaeed7544a87d85474e33d05fe0adc992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad656b032866d6c7f93ca8cb4f3cace5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jurassic_8h.html#ad656b032866d6c7f93ca8cb4f3cace5e">y2obs</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const gsl_vector *y, <a class="el" href="structobs__t.html">obs_t</a> *obs)</td></tr>
<tr class="memdesc:ad656b032866d6c7f93ca8cb4f3cace5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy elements from the measurement vector <code>y</code> into the observation structure.  <a href="jurassic_8h.html#ad656b032866d6c7f93ca8cb4f3cace5e">More...</a><br /></td></tr>
<tr class="separator:ad656b032866d6c7f93ca8cb4f3cace5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >JURASSIC library declarations. </p>

<p class="definition">Definition in file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a44779f18d87e71c78fc9fbf9dc88537d" name="a44779f18d87e71c78fc9fbf9dc88537d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44779f18d87e71c78fc9fbf9dc88537d">&#9670;&nbsp;</a></span>C1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define C1&#160;&#160;&#160;1.19104259e-8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>First spectroscopic constant (c_1 = 2 h c^2) [W/(m^2 sr cm^-4)]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00128">128</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ad6fc13322a4f1c314332ff34aa8b3fa0" name="ad6fc13322a4f1c314332ff34aa8b3fa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6fc13322a4f1c314332ff34aa8b3fa0">&#9670;&nbsp;</a></span>C2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define C2&#160;&#160;&#160;1.43877506</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Second spectroscopic constant (c_2 = h c / k) [K/cm^-1]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00133">133</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="af0e57ca18d0438ab6804fc59e5f0359a" name="af0e57ca18d0438ab6804fc59e5f0359a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0e57ca18d0438ab6804fc59e5f0359a">&#9670;&nbsp;</a></span>EPSMIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EPSMIN&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimum emissivity. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00138">138</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ac90736a71d789b9bf5cd070c8a700358" name="ac90736a71d789b9bf5cd070c8a700358"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac90736a71d789b9bf5cd070c8a700358">&#9670;&nbsp;</a></span>EPSMAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EPSMAX&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum emissivity. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00143">143</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a6440afc9207bc5eba00d9161ff744e16" name="a6440afc9207bc5eba00d9161ff744e16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6440afc9207bc5eba00d9161ff744e16">&#9670;&nbsp;</a></span>G0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define G0&#160;&#160;&#160;9.80665</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Standard gravity [m/s^2]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00148">148</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a2091e935ef46727f066804a98a0d039f" name="a2091e935ef46727f066804a98a0d039f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2091e935ef46727f066804a98a0d039f">&#9670;&nbsp;</a></span>H0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define H0&#160;&#160;&#160;7.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Standard scale height [km]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00153">153</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a1841fd1a462d245d8c73dce55e2f45da" name="a1841fd1a462d245d8c73dce55e2f45da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1841fd1a462d245d8c73dce55e2f45da">&#9670;&nbsp;</a></span>KB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KB&#160;&#160;&#160;1.3806504e-23</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Boltzmann constant [kg m^2/(K s^2)]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00158">158</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="adf8d34f3be20164c292bccfeb72898e5" name="adf8d34f3be20164c292bccfeb72898e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf8d34f3be20164c292bccfeb72898e5">&#9670;&nbsp;</a></span>ME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ME&#160;&#160;&#160;5.976e24</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mass of Earth [kg]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00163">163</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a68eddd535923d17ddbc8bb03bab70b3b" name="a68eddd535923d17ddbc8bb03bab70b3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68eddd535923d17ddbc8bb03bab70b3b">&#9670;&nbsp;</a></span>NA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NA&#160;&#160;&#160;6.02214199e23</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Avogadro's number. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00168">168</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="acd864640121c7df2c19f61f7baa507e4" name="acd864640121c7df2c19f61f7baa507e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd864640121c7df2c19f61f7baa507e4">&#9670;&nbsp;</a></span>N2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define N2&#160;&#160;&#160;0.78084</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Nitrogen concentration. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00173">173</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a31412dbd7c9b5771f1e7a5ff85d20ab9" name="a31412dbd7c9b5771f1e7a5ff85d20ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31412dbd7c9b5771f1e7a5ff85d20ab9">&#9670;&nbsp;</a></span>O2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define O2&#160;&#160;&#160;0.20946</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Oxygen concentration. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00178">178</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a1583b00a62bc1138f99bbfcd8ef81a6a" name="a1583b00a62bc1138f99bbfcd8ef81a6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1583b00a62bc1138f99bbfcd8ef81a6a">&#9670;&nbsp;</a></span>P0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define P0&#160;&#160;&#160;1013.25</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Standard pressure [hPa]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00183">183</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a0600e3f227b6e9a3ae26f4d6e2a0581e" name="a0600e3f227b6e9a3ae26f4d6e2a0581e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0600e3f227b6e9a3ae26f4d6e2a0581e">&#9670;&nbsp;</a></span>RE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RE&#160;&#160;&#160;6367.421</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mean radius of Earth [km]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00188">188</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a7e71def3baefc10ec36f1dd48da4050e" name="a7e71def3baefc10ec36f1dd48da4050e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e71def3baefc10ec36f1dd48da4050e">&#9670;&nbsp;</a></span>RI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RI&#160;&#160;&#160;8.3144598</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ideal gas constant [J/(mol K)]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00193">193</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ad41b89d4eb6d63a0def5e5fd2a5ab326" name="ad41b89d4eb6d63a0def5e5fd2a5ab326"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad41b89d4eb6d63a0def5e5fd2a5ab326">&#9670;&nbsp;</a></span>T0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T0&#160;&#160;&#160;273.15</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Standard temperature [K]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00198">198</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="af7e87bb3f38e7b4eed703578b90cd3a4" name="af7e87bb3f38e7b4eed703578b90cd3a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7e87bb3f38e7b4eed703578b90cd3a4">&#9670;&nbsp;</a></span>TMIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMIN&#160;&#160;&#160;100.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimum temperature for source function [K]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00203">203</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="af7a16e2716eaac90fb331c55876cf511" name="af7a16e2716eaac90fb331c55876cf511"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7a16e2716eaac90fb331c55876cf511">&#9670;&nbsp;</a></span>TMAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMAX&#160;&#160;&#160;400.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum temperature for source function [K]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00208">208</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="aa5244027c00b642d69d62392f5a60f8b" name="aa5244027c00b642d69d62392f5a60f8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5244027c00b642d69d62392f5a60f8b">&#9670;&nbsp;</a></span>TSUN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TSUN&#160;&#160;&#160;5780.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Effective temperature of the sun [K]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00213">213</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a368a0522dcd74f477a7858102b663b70" name="a368a0522dcd74f477a7858102b663b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a368a0522dcd74f477a7858102b663b70">&#9670;&nbsp;</a></span>UMIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UMIN&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimum column density [molecules/cm^2]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00218">218</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a3376075b6c1085b71a316b5c03838992" name="a3376075b6c1085b71a316b5c03838992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3376075b6c1085b71a316b5c03838992">&#9670;&nbsp;</a></span>UMAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UMAX&#160;&#160;&#160;1e30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum column density [molecules/cm^2]. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00223">223</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ae5207491b45fa8881c40214d7ac0d214" name="ae5207491b45fa8881c40214d7ac0d214"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5207491b45fa8881c40214d7ac0d214">&#9670;&nbsp;</a></span>NCL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NCL&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of cloud layer spectral grid points. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00232">232</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a68d169e5b90cf721678bc7ab0f964a99" name="a68d169e5b90cf721678bc7ab0f964a99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68d169e5b90cf721678bc7ab0f964a99">&#9670;&nbsp;</a></span>ND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ND&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of radiance channels. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00237">237</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ac29517e805c6a27f76e87e634eaf2929" name="ac29517e805c6a27f76e87e634eaf2929"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac29517e805c6a27f76e87e634eaf2929">&#9670;&nbsp;</a></span>NG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NG&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of emitters. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00242">242</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ab04c88bedc6b2be8ddfe7aa8d3e93f06" name="ab04c88bedc6b2be8ddfe7aa8d3e93f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab04c88bedc6b2be8ddfe7aa8d3e93f06">&#9670;&nbsp;</a></span>NP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NP&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of atmospheric data points. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00247">247</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="af146485306ae74a2edf18636300fd107" name="af146485306ae74a2edf18636300fd107"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af146485306ae74a2edf18636300fd107">&#9670;&nbsp;</a></span>NR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NR&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of ray paths. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00252">252</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ae3c34ac35580d9f179172c9d99940327" name="ae3c34ac35580d9f179172c9d99940327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3c34ac35580d9f179172c9d99940327">&#9670;&nbsp;</a></span>NSF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NSF&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of surface layer spectral grid points. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00257">257</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="af9cccf331f045b89a9f12366df5f7687" name="af9cccf331f045b89a9f12366df5f7687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9cccf331f045b89a9f12366df5f7687">&#9670;&nbsp;</a></span>NW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NW&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of spectral windows. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00262">262</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a05b49c662c073f89e86804f7856622a0" name="a05b49c662c073f89e86804f7856622a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05b49c662c073f89e86804f7856622a0">&#9670;&nbsp;</a></span>LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LEN&#160;&#160;&#160;10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum length of ASCII data lines. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00267">267</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a52037c938e3c1b126c6277da5ca689d0" name="a52037c938e3c1b126c6277da5ca689d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52037c938e3c1b126c6277da5ca689d0">&#9670;&nbsp;</a></span>M</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M&#160;&#160;&#160;(<a class="el" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>*<a class="el" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum size of measurement vector. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00272">272</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a0240ac851181b84ac374872dc5434ee4" name="a0240ac851181b84ac374872dc5434ee4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0240ac851181b84ac374872dc5434ee4">&#9670;&nbsp;</a></span>N</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define N&#160;&#160;&#160;((2 + <a class="el" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a> + <a class="el" href="jurassic_8h.html#af9cccf331f045b89a9f12366df5f7687">NW</a>) * <a class="el" href="jurassic_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a> + <a class="el" href="jurassic_8h.html#ae5207491b45fa8881c40214d7ac0d214">NCL</a> + <a class="el" href="jurassic_8h.html#ae3c34ac35580d9f179172c9d99940327">NSF</a> + 3)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum size of state vector. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00277">277</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a68c2775fc4d7385df9c7bb96d23b482b" name="a68c2775fc4d7385df9c7bb96d23b482b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68c2775fc4d7385df9c7bb96d23b482b">&#9670;&nbsp;</a></span>NQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NQ&#160;&#160;&#160;(5 + <a class="el" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a> + <a class="el" href="jurassic_8h.html#af9cccf331f045b89a9f12366df5f7687">NW</a> + <a class="el" href="jurassic_8h.html#ae5207491b45fa8881c40214d7ac0d214">NCL</a> + <a class="el" href="jurassic_8h.html#ae3c34ac35580d9f179172c9d99940327">NSF</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of quantities. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00282">282</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="aecba64d582576f89695ab0ff97805b3e" name="aecba64d582576f89695ab0ff97805b3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecba64d582576f89695ab0ff97805b3e">&#9670;&nbsp;</a></span>NLOS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NLOS&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of LOS points. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00287">287</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a7705bd290b81177c733651a18441be93" name="a7705bd290b81177c733651a18441be93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7705bd290b81177c733651a18441be93">&#9670;&nbsp;</a></span>NSHAPE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NSHAPE&#160;&#160;&#160;20000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of shape function grid points. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00292">292</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a1b12a17c57a92107c191e44599a2e315" name="a1b12a17c57a92107c191e44599a2e315"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b12a17c57a92107c191e44599a2e315">&#9670;&nbsp;</a></span>NFOV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NFOV&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of ray paths used for FOV calculations. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00297">297</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ae24fde0b49cc53934d13a7ab3f95a4ef" name="ae24fde0b49cc53934d13a7ab3f95a4ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae24fde0b49cc53934d13a7ab3f95a4ef">&#9670;&nbsp;</a></span>TBLNP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TBLNP&#160;&#160;&#160;41</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of pressure levels in emissivity tables. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00302">302</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="aad9835e9e4be4ad8ed538f95bdceddea" name="aad9835e9e4be4ad8ed538f95bdceddea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad9835e9e4be4ad8ed538f95bdceddea">&#9670;&nbsp;</a></span>TBLNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TBLNT&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of temperatures in emissivity tables. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00307">307</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a910036a8c83f3464c3de6bf398467c03" name="a910036a8c83f3464c3de6bf398467c03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a910036a8c83f3464c3de6bf398467c03">&#9670;&nbsp;</a></span>TBLNU</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TBLNU&#160;&#160;&#160;320</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of column densities in emissivity tables. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00312">312</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="acc1bfd45871746b198d5db5cd89beb63" name="acc1bfd45871746b198d5db5cd89beb63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc1bfd45871746b198d5db5cd89beb63">&#9670;&nbsp;</a></span>TBLNS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TBLNS&#160;&#160;&#160;1200</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of source function temperature levels. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00317">317</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a6f4cdd0162e9f2ab251fa5b23410c8da" name="a6f4cdd0162e9f2ab251fa5b23410c8da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f4cdd0162e9f2ab251fa5b23410c8da">&#9670;&nbsp;</a></span>MAX_TABLES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_TABLES&#160;&#160;&#160;10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of frequency-table entries allowed in a gas table file. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00322">322</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a4afe3221b6cc7d990b27a05a924ee2a2" name="a4afe3221b6cc7d990b27a05a924ee2a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4afe3221b6cc7d990b27a05a924ee2a2">&#9670;&nbsp;</a></span>RFMNPTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RFMNPTS&#160;&#160;&#160;10000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of RFM spectral grid points. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00327">327</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a99c6798a64d9d5535a2b22b46ee31924" name="a99c6798a64d9d5535a2b22b46ee31924"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99c6798a64d9d5535a2b22b46ee31924">&#9670;&nbsp;</a></span>IDXP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDXP&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index for pressure. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00335">335</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="afb33f030ad4a44d5f638f3903d13fe70" name="afb33f030ad4a44d5f638f3903d13fe70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb33f030ad4a44d5f638f3903d13fe70">&#9670;&nbsp;</a></span>IDXT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDXT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index for temperature. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00338">338</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="af2f80a7a5ff9b54495c0c41d8571cafc" name="af2f80a7a5ff9b54495c0c41d8571cafc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2f80a7a5ff9b54495c0c41d8571cafc">&#9670;&nbsp;</a></span>IDXQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDXQ</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ig</td><td>)</td>
          <td>&#160;&#160;&#160;(2 + (ig))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indices for volume mixing ratios. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00341">341</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a511d4808c85a5b5e1e600cf413eabbd6" name="a511d4808c85a5b5e1e600cf413eabbd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a511d4808c85a5b5e1e600cf413eabbd6">&#9670;&nbsp;</a></span>IDXK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDXK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">iw</td><td>)</td>
          <td>&#160;&#160;&#160;(2 + (ctl-&gt;ng) + (iw))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indices for extinction. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00344">344</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a04eaf14380553f171f54680560527fe5" name="a04eaf14380553f171f54680560527fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04eaf14380553f171f54680560527fe5">&#9670;&nbsp;</a></span>IDXCLZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDXCLZ&#160;&#160;&#160;(2 + (ctl-&gt;ng) + (ctl-&gt;nw))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index for cloud layer height. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00347">347</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a3b420330ad2457758ef539d8c9e0bd99" name="a3b420330ad2457758ef539d8c9e0bd99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b420330ad2457758ef539d8c9e0bd99">&#9670;&nbsp;</a></span>IDXCLDZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDXCLDZ&#160;&#160;&#160;(3 + (ctl-&gt;ng) + (ctl-&gt;nw))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index for cloud layer depth. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00350">350</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a809f947437669a6b3930302f30375d41" name="a809f947437669a6b3930302f30375d41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a809f947437669a6b3930302f30375d41">&#9670;&nbsp;</a></span>IDXCLK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDXCLK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">icl</td><td>)</td>
          <td>&#160;&#160;&#160;(4 + (ctl-&gt;ng) + (ctl-&gt;nw) + (icl))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indices for cloud layer extinction. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00353">353</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a7abc6f3d1a1993a0337a736d79cf6ecc" name="a7abc6f3d1a1993a0337a736d79cf6ecc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7abc6f3d1a1993a0337a736d79cf6ecc">&#9670;&nbsp;</a></span>IDXSFT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDXSFT&#160;&#160;&#160;(4 + (ctl-&gt;ng) + (ctl-&gt;nw) + (ctl-&gt;ncl))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index for surface layer temperature. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00356">356</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a803581fe3fed7a56dacec94c5c860f35" name="a803581fe3fed7a56dacec94c5c860f35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a803581fe3fed7a56dacec94c5c860f35">&#9670;&nbsp;</a></span>IDXSFEPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDXSFEPS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">isf</td><td>)</td>
          <td>&#160;&#160;&#160;(5 + (ctl-&gt;ng) + (ctl-&gt;nw) + (ctl-&gt;ncl) + (isf))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indices for surface layer emissivity. </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00359">359</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a9aee3e5daf3b1051597d21ab093adbd0" name="a9aee3e5daf3b1051597d21ab093adbd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aee3e5daf3b1051597d21ab093adbd0">&#9670;&nbsp;</a></span>ALLOC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ALLOC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">if</span>((ptr=calloc((<span class="keywordtype">size_t</span>)(n), <span class="keyword">sizeof</span>(type)))==NULL)      \</div>
<div class="line">    ERRMSG(<span class="stringliteral">&quot;Out of memory!&quot;</span>);</div>
</div><!-- fragment -->
<p>Allocate memory for an array. </p>
<p >Allocates a contiguous block of memory for an array of <code>n</code> elements of type <code>type</code> and assigns the pointer to <code>ptr</code>. If allocation fails, the program prints an error message and terminates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ptr</td><td>Pointer to be allocated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>Data type of the elements to allocate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of elements to allocate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Wraps <code>malloc()</code> with built-in error handling.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6" title="Read binary data from a file.">FREAD</a>, <a class="el" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac" title="Write binary data to a file.">FWRITE</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00382">382</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a064f8ccf1a30f33e2fd095884558364d" name="a064f8ccf1a30f33e2fd095884558364d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a064f8ccf1a30f33e2fd095884558364d">&#9670;&nbsp;</a></span>BRIGHT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BRIGHT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rad, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nu&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (<a class="el" href="jurassic_8h.html#ad6fc13322a4f1c314332ff34aa8b3fa0">C2</a> * (nu) / gsl_log1p(<a class="el" href="jurassic_8h.html#a44779f18d87e71c78fc9fbf9dc88537d">C1</a> * <a class="el" href="jurassic_8h.html#ab051a5ece45339feb3f4b19a4dddbcb2">POW3</a>(nu) / (rad)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute brightness temperature from radiance. </p>
<p >Computes the equivalent blackbody (brightness) temperature corresponding to a given spectral radiance and wavenumber, using the inverse Planck function. This form assumes the spectroscopic constants <code>C1</code> and <code>C2</code> are defined for wavenumber units (cm).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rad</td><td>Spectral radiance [Wmsr(cm)]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Wavenumber [cm].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Brightness temperature [K].</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee" title="Compute spectral radiance using Plancks law.">PLANCK</a>, <a class="el" href="jurassic_8h.html#a44779f18d87e71c78fc9fbf9dc88537d" title="First spectroscopic constant (c_1 = 2 h c^2) [W/(m^2 sr cm^-4)].">C1</a>, <a class="el" href="jurassic_8h.html#ad6fc13322a4f1c314332ff34aa8b3fa0" title="Second spectroscopic constant (c_2 = h c / k) [K/cm^-1].">C2</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Based on Plancks law in wavenumber form: \( T_b = \frac{c_2 \nu}{\ln\!\left(1 + \frac{c_1 \nu^3}{L_\nu}\right)} \) where \(L_\nu\) is the radiance. The  dependence reflects the definition of <code>C1</code> for radiance per unit wavenumber in cm.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The radiance MUST be in Wmsr(cm). Using radiance per meter will produce brightness temperatures incorrect by six orders of magnitude.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00412">412</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="aa3616a5af1a14b0a5a1b2f542066ae45" name="aa3616a5af1a14b0a5a1b2f542066ae45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3616a5af1a14b0a5a1b2f542066ae45">&#9670;&nbsp;</a></span>DEG2RAD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEG2RAD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">deg</td><td>)</td>
          <td>&#160;&#160;&#160;((deg) * (M_PI / 180.0))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert degrees to radians. </p>
<p >Converts an angle measured in degrees to radians using: \( \text{radians} = \text{degrees} \times \frac{\pi}{180} \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">deg</td><td>Angle in degrees.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Angle in radians.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aacc958134b53425ec947541bb72ac8b1" title="Convert radians to degrees.">RAD2DEG</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00429">429</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ae733a5a3a9e9a85474da2105655a0dc4" name="ae733a5a3a9e9a85474da2105655a0dc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae733a5a3a9e9a85474da2105655a0dc4">&#9670;&nbsp;</a></span>DIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIST</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;sqrt(<a class="el" href="jurassic_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a>(a, b))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute Cartesian distance between two 3D vectors. </p>
<p >Computes the Euclidean distance between two 3D vectors or points.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>First vector (array of length 3). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Second vector (array of length 3).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Euclidean distance between a and b.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#af003cf5f79f68880f39a9a95d69f19bb" title="Compute squared distance between two 3D vectors.">DIST2</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Equivalent to \( \sqrt{(x_1-x_2)^2 + (y_1-y_2)^2 + (z_1-z_2)^2} \).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00447">447</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="af003cf5f79f68880f39a9a95d69f19bb" name="af003cf5f79f68880f39a9a95d69f19bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af003cf5f79f68880f39a9a95d69f19bb">&#9670;&nbsp;</a></span>DIST2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIST2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1])+(a[2]-b[2])*(a[2]-b[2]))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute squared distance between two 3D vectors. </p>
<p >Computes the square of the Euclidean distance between two 3D vectors. Useful when only relative distances are needed (avoids square root).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>First vector (array of length 3). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Second vector (array of length 3).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Squared distance between a and b.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#ae733a5a3a9e9a85474da2105655a0dc4" title="Compute Cartesian distance between two 3D vectors.">DIST</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00464">464</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a2f872a4cdfaa577c03b9dea8201028e8" name="a2f872a4cdfaa577c03b9dea8201028e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f872a4cdfaa577c03b9dea8201028e8">&#9670;&nbsp;</a></span>DOTP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DOTP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(a[0]*b[0]+a[1]*b[1]+a[2]*b[2])</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute dot product of two 3D vectors. </p>
<p >Computes the scalar (dot) product between two 3-element vectors: \( a \cdot b = a_x b_x + a_y b_y + a_z b_z \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>First vector (array of length 3). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Second vector (array of length 3).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Scalar dot product of a and b.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943" title="Compute the norm (magnitude) of a 3D vector.">NORM</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00482">482</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ae8c13542ca31cfbccfc436aabd8851f6" name="ae8c13542ca31cfbccfc436aabd8851f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c13542ca31cfbccfc436aabd8851f6">&#9670;&nbsp;</a></span>FREAD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FREAD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">size, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">out&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    { \</div>
<div class="line">    if(fread(ptr, <span class="keyword">sizeof</span>(type), size, out)!=size) \</div>
<div class="line">      ERRMSG(<span class="stringliteral">&quot;Error while reading!&quot;</span>); \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Read binary data from a file. </p>
<p >Reads <code>size</code> elements of type <code>type</code> from the file stream <code>out</code> into the memory pointed to by <code>ptr</code>. If the number of elements read differs from <code>size</code>, an error message is printed and the program terminates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ptr</td><td>Pointer to destination memory buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>Type of each element to read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Number of elements to read. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">out</td><td>File stream opened for reading.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac" title="Write binary data to a file.">FWRITE</a>, <a class="el" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0" title="Allocate memory for an array.">ALLOC</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Wraps <code>fread()</code> with error handling.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00502">502</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a1e67562ddd8fb52548a4ca02d3640bac" name="a1e67562ddd8fb52548a4ca02d3640bac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e67562ddd8fb52548a4ca02d3640bac">&#9670;&nbsp;</a></span>FWRITE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FWRITE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">size, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">out&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    { \</div>
<div class="line">    if(fwrite(ptr, <span class="keyword">sizeof</span>(type), size, out)!=size) \</div>
<div class="line">      ERRMSG(<span class="stringliteral">&quot;Error while writing!&quot;</span>); \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Write binary data to a file. </p>
<p >Writes <code>size</code> elements of type <code>type</code> from the memory pointed to by <code>ptr</code> to the file stream <code>out</code>. If the number of elements written differs from <code>size</code>, an error message is printed and the program terminates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ptr</td><td>Pointer to memory buffer containing data to write. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>Type of each element to write. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Number of elements to write. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">out</td><td>File stream opened for writing.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6" title="Read binary data from a file.">FREAD</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Wraps <code>fwrite()</code> with error handling.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00525">525</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="aebaef4a0f8136be064bf1d29ce1ced83" name="aebaef4a0f8136be064bf1d29ce1ced83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebaef4a0f8136be064bf1d29ce1ced83">&#9670;&nbsp;</a></span>LIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((y0)+((y1)-(y0))/((x1)-(x0))*((x)-(x0)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute linear interpolation. </p>
<p >Performs simple linear interpolation between two known points (x, y) and (x, y) to estimate the value of y at a given x.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x0</td><td>Lower x-value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y0</td><td>Function value at x. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x1</td><td>Upper x-value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y1</td><td>Function value at x. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Interpolation point.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Linearly interpolated y-value at x.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3" title="Compute logarithmic interpolation in x.">LOGX</a>, <a class="el" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca" title="Compute logarithmic interpolation in y.">LOGY</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00548">548</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a870fa40d24bd17e7cc7ec906662047b3" name="a870fa40d24bd17e7cc7ec906662047b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a870fa40d24bd17e7cc7ec906662047b3">&#9670;&nbsp;</a></span>LOGX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOGX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  (((x)/(x0)&gt;0 &amp;&amp; (x1)/(x0)&gt;0) \</div>
<div class="line">   ? ((y0)+((y1)-(y0))*log((x)/(x0))/log((x1)/(x0))) \</div>
<div class="line">   : <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(x0, y0, x1, y1, x))</div>
<div class="ttc" id="ajurassic_8h_html_aebaef4a0f8136be064bf1d29ce1ced83"><div class="ttname"><a href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a></div><div class="ttdeci">#define LIN(x0, y0, x1, y1, x)</div><div class="ttdoc">Compute linear interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00548">jurassic.h:548</a></div></div>
</div><!-- fragment -->
<p>Compute logarithmic interpolation in x. </p>
<p >Performs interpolation assuming logarithmic variation in the x-axis. If either x/x or x/x is nonpositive, reverts to linear interpolation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x0</td><td>Lower x-value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y0</td><td>Function value at x. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x1</td><td>Upper x-value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y1</td><td>Function value at x. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Interpolation point.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Interpolated y-value at x.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca" title="Compute logarithmic interpolation in y.">LOGY</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00569">569</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a6df174578bf85b1e9f33c597f5f8e5ca" name="a6df174578bf85b1e9f33c597f5f8e5ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df174578bf85b1e9f33c597f5f8e5ca">&#9670;&nbsp;</a></span>LOGY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOGY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  (((y1)/(y0)&gt;0) \</div>
<div class="line">   ? ((y0)*exp(log((y1)/(y0))/((x1)-(x0))*((x)-(x0)))) \</div>
<div class="line">   : <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(x0, y0, x1, y1, x))</div>
</div><!-- fragment -->
<p>Compute logarithmic interpolation in y. </p>
<p >Performs interpolation assuming exponential variation in the y-axis (logarithmic in y). If y/y is nonpositive, reverts to linear interpolation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x0</td><td>Lower x-value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y0</td><td>Function value at x. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x1</td><td>Upper x-value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y1</td><td>Function value at x. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Interpolation point.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Interpolated y-value at x.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3" title="Compute logarithmic interpolation in x.">LOGX</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00592">592</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="afa99ec4acc4ecb2dc3c2d05da15d0e3f" name="afa99ec4acc4ecb2dc3c2d05da15d0e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa99ec4acc4ecb2dc3c2d05da15d0e3f">&#9670;&nbsp;</a></span>MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((a)&gt;(b))?(a):(b))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the maximum of two values. </p>
<p >Returns the greater of two scalar values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>First value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Second value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Maximum of a and b.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f" title="Determine the minimum of two values.">MIN</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Both arguments are evaluated multiple times; avoid side effects.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00613">613</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a3acffbd305ee72dcd4593c0d8af64a4f" name="a3acffbd305ee72dcd4593c0d8af64a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acffbd305ee72dcd4593c0d8af64a4f">&#9670;&nbsp;</a></span>MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((a)&lt;(b))?(a):(b))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the minimum of two values. </p>
<p >Returns the smaller of two scalar values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>First value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Second value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Minimum of a and b.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f" title="Determine the maximum of two values.">MAX</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Both arguments are evaluated multiple times; avoid side effects.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00631">631</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a0bd8f7689ce8b91801aec9cdc7148159" name="a0bd8f7689ce8b91801aec9cdc7148159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bd8f7689ce8b91801aec9cdc7148159">&#9670;&nbsp;</a></span>NEDT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NEDT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t_bg, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nesr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nu&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (<a class="el" href="jurassic_8h.html#a064f8ccf1a30f33e2fd095884558364d">BRIGHT</a>(<a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a>((t_bg), (nu)) + (nesr), (nu)) - (t_bg))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert noise-equivalent spectral radiance (NESR) to noise-equivalent delta temperature (NEDT). </p>
<p >Computes the temperature noise level corresponding to a given NESR at a background radiance, using the inverse Planck function. The NEDT expresses radiometric sensitivity in temperature units, assuming blackbody emission.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t_bg</td><td>Background (scene) brightness temperature [K]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nesr</td><td>Noise-equivalent spectral radiance [Wmsr(cm)]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Wavenumber [cm].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Noise-equivalent delta temperature [K].</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This macro computes <p class="formulaDsp">
\[
         \mathrm{NEDT} = T_b(L_\nu(T_\mathrm{bg}) + \mathrm{NESR})
                       - T_\mathrm{bg}
      \]
</p>
 where \(T_b\) is the brightness temperature from the inverse Planck function.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>All units must be consistent with <code>PLANCK</code> and <code>BRIGHT</code>. Mixing radiance units per meter instead of per cm will yield incorrect results by orders of magnitude.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a0b13e6dc6b9f6f73047e43a59c2e67fc" title="Convert noise-equivalent delta temperature (NEDT) to noise-equivalent spectral radiance (NESR).">NESR</a>, <a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee" title="Compute spectral radiance using Plancks law.">PLANCK</a>, <a class="el" href="jurassic_8h.html#a064f8ccf1a30f33e2fd095884558364d" title="Compute brightness temperature from radiance.">BRIGHT</a>, <a class="el" href="jurassic_8h.html#a44779f18d87e71c78fc9fbf9dc88537d" title="First spectroscopic constant (c_1 = 2 h c^2) [W/(m^2 sr cm^-4)].">C1</a>, <a class="el" href="jurassic_8h.html#ad6fc13322a4f1c314332ff34aa8b3fa0" title="Second spectroscopic constant (c_2 = h c / k) [K/cm^-1].">C2</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00662">662</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a0b13e6dc6b9f6f73047e43a59c2e67fc" name="a0b13e6dc6b9f6f73047e43a59c2e67fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b13e6dc6b9f6f73047e43a59c2e67fc">&#9670;&nbsp;</a></span>NESR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NESR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t_bg, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nedt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nu&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (<a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a>((t_bg) + (nedt), (nu)) - <a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a>((t_bg), (nu)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert noise-equivalent delta temperature (NEDT) to noise-equivalent spectral radiance (NESR). </p>
<p >Computes the radiance difference corresponding to a temperature noise level at a given background temperature and wavenumber, using Plancks law. The NESR quantifies the radiometric sensitivity in spectral radiance units.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t_bg</td><td>Background (scene) brightness temperature [K]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nedt</td><td>Noise-equivalent delta temperature [K]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Wavenumber [cm].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Noise-equivalent spectral radiance [Wmsr(cm)].</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This macro computes <p class="formulaDsp">
\[
         \mathrm{NESR} = L_\nu(T_\mathrm{bg} + \mathrm{NEDT})
                       - L_\nu(T_\mathrm{bg})
      \]
</p>
 where \(L_\nu\) is spectral radiance from Plancks law.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>All units must be consistent with <code>PLANCK</code>. In particular, <code>nu</code> must be given in cm.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee" title="Compute spectral radiance using Plancks law.">PLANCK</a>, <a class="el" href="jurassic_8h.html#a0bd8f7689ce8b91801aec9cdc7148159" title="Convert noise-equivalent spectral radiance (NESR) to noise-equivalent delta temperature (NEDT).">NEDT</a>, <a class="el" href="jurassic_8h.html#a064f8ccf1a30f33e2fd095884558364d" title="Compute brightness temperature from radiance.">BRIGHT</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00691">691</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a7fa3afb5cf2625deb1e859cbb93d2943" name="a7fa3afb5cf2625deb1e859cbb93d2943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fa3afb5cf2625deb1e859cbb93d2943">&#9670;&nbsp;</a></span>NORM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NORM</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;sqrt(<a class="el" href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a>(a, a))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the norm (magnitude) of a 3D vector. </p>
<p >Computes the Euclidean norm using the dot product: \( |a| = \sqrt{a \cdot a} \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Input vector (array of length 3).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Magnitude (norm) of vector a.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8" title="Compute dot product of two 3D vectors.">DOTP</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00708">708</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ab737f801dafc49850e131f6a42cd45ee" name="ab737f801dafc49850e131f6a42cd45ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab737f801dafc49850e131f6a42cd45ee">&#9670;&nbsp;</a></span>PLANCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLANCK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">T, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nu&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (<a class="el" href="jurassic_8h.html#a44779f18d87e71c78fc9fbf9dc88537d">C1</a> * <a class="el" href="jurassic_8h.html#ab051a5ece45339feb3f4b19a4dddbcb2">POW3</a>(nu) / gsl_expm1(<a class="el" href="jurassic_8h.html#ad6fc13322a4f1c314332ff34aa8b3fa0">C2</a> * (nu) / (T)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute spectral radiance using Plancks law. </p>
<p >Evaluates Plancks blackbody spectral radiance for a given temperature and wavenumber. The expression is formulated in wavenumber space (cm) and uses the spectroscopic constants <code>C1</code> and <code>C2</code> in wavenumber units.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Wavenumber [cm]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T</td><td>Temperature [K].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Spectral radiance \(L_\nu\) in [Wmsr(cm)].</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The Planck law implemented here is <p class="formulaDsp">
\[
          L_\nu = \frac{C_{1}\,\nu^{3}}
                       {\exp\!\left(\frac{C_{2}\,\nu}{T}\right) - 1}
      \]
</p>
 with \(\nu\) in cm. The \(\nu^{3}\) dependence follows from the definition of <code>C1</code> for radiance per wavenumber in cm.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The units of all inputs MUST be consistent: <code>nu</code> in cm and <code>T</code> in kelvin. Mixing wavenumber and frequency formulations, or using radiance per meter instead of per cm, will produce results off by orders of magnitude.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a064f8ccf1a30f33e2fd095884558364d" title="Compute brightness temperature from radiance.">BRIGHT</a>, <a class="el" href="jurassic_8h.html#a44779f18d87e71c78fc9fbf9dc88537d" title="First spectroscopic constant (c_1 = 2 h c^2) [W/(m^2 sr cm^-4)].">C1</a>, <a class="el" href="jurassic_8h.html#ad6fc13322a4f1c314332ff34aa8b3fa0" title="Second spectroscopic constant (c_2 = h c / k) [K/cm^-1].">C2</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00739">739</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a1ac0abc7c913167ecaf81778d57e7a17" name="a1ac0abc7c913167ecaf81778d57e7a17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ac0abc7c913167ecaf81778d57e7a17">&#9670;&nbsp;</a></span>POW2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POW2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)*(x))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the square of a value. </p>
<p >Returns x. Inline alternative to <code>pow(x,2)</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Input value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x squared.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00753">753</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="ab051a5ece45339feb3f4b19a4dddbcb2" name="ab051a5ece45339feb3f4b19a4dddbcb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab051a5ece45339feb3f4b19a4dddbcb2">&#9670;&nbsp;</a></span>POW3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POW3</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)*(x)*(x))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the cube of a value. </p>
<p >Returns x. Inline alternative to <code>pow(x,3)</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Input value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x cubed.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00766">766</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="aacc958134b53425ec947541bb72ac8b1" name="aacc958134b53425ec947541bb72ac8b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc958134b53425ec947541bb72ac8b1">&#9670;&nbsp;</a></span>RAD2DEG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAD2DEG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rad</td><td>)</td>
          <td>&#160;&#160;&#160;((rad) * (180.0 / M_PI))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert radians to degrees. </p>
<p >Converts an angle measured in radians to degrees using: \( \text{degrees} = \text{radians} \times \frac{180}{\pi} \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rad</td><td>Angle in radians.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Angle in degrees.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45" title="Convert degrees to radians.">DEG2RAD</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00782">782</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="adfef660f42c1ea3245fcd48cd013754a" name="adfef660f42c1ea3245fcd48cd013754a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfef660f42c1ea3245fcd48cd013754a">&#9670;&nbsp;</a></span>REFRAC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REFRAC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">T&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(7.753e-05 * (p) / (T))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute air refractivity (n - 1). </p>
<p >Approximates the refractivity of air under standard conditions using: \( n - 1 = 7.753\times10^{-5} \frac{p}{T} \), where p is pressure (hPa) and T is temperature (K).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Pressure [hPa]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T</td><td>Temperature [K].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Refractivity (dimensionless, n - 1).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00798">798</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a90f5818bdcd4c17727d704c141c7cca8" name="a90f5818bdcd4c17727d704c141c7cca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90f5818bdcd4c17727d704c141c7cca8">&#9670;&nbsp;</a></span>TIMER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIMER</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mode&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  {<a class="el" href="jurassic_8h.html#a14740e9d412eb3e810eb95e178be297b">timer</a>(name, __FILE__, __func__, __LINE__, mode);}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start or stop a named timer. </p>
<p >Calls the <code><a class="el" href="jurassic_8h.html#a14740e9d412eb3e810eb95e178be297b" title="Simple wall-clock timer for runtime diagnostics.">timer()</a></code> function with contextual information (file name, function name, and line number) to start or stop timing. Useful for performance profiling.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>Name or label of the timer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>Operation mode (e.g., start or stop).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Relies on a user-defined <code><a class="el" href="jurassic_8h.html#a14740e9d412eb3e810eb95e178be297b" title="Simple wall-clock timer for runtime diagnostics.">timer()</a></code> function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00813">813</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a8b61d1304377b77925b2802459ddae98" name="a8b61d1304377b77925b2802459ddae98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b61d1304377b77925b2802459ddae98">&#9670;&nbsp;</a></span>TOK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">line, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tok, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">format, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">var&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    { \</div>
<div class="line">    if(((tok)=strtok((line), <span class="stringliteral">&quot; \t&quot;</span>))) { \</div>
<div class="line">      if(sscanf(tok, format, &amp;(var))!=1) continue; \</div>
<div class="line">    } else <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(&quot;Error while reading!&quot;); \</div>
<div class="line">  }</div>
<div class="ttc" id="ajurassic_8h_html_a3e0ae69dee4a8bb2e616526b5ebe6875"><div class="ttname"><a href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a></div><div class="ttdeci">#define ERRMSG(...)</div><div class="ttdoc">Print an error message with contextual information and terminate the program.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00948">jurassic.h:948</a></div></div>
</div><!-- fragment -->
<p>Tokenize a string and parse a variable. </p>
<p >Splits a text line into tokens separated by spaces or tabs, and reads a value from the first token using <code>sscanf()</code> and the provided format. If tokenization or parsing fails, an error message is printed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">line</td><td>Input string buffer to tokenize (modified by strtok()). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tok</td><td>Pointer to token string. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">format</td><td>Format string for <code>sscanf()</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">var</td><td>Variable to store parsed value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Uses <code>strtok()</code> internally and modifies the input buffer.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6" title="Read binary data from a file.">FREAD</a>, <a class="el" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac" title="Write binary data to a file.">FWRITE</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00834">834</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="aa0c49f3ada06708693de9e60b449964c" name="aa0c49f3ada06708693de9e60b449964c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c49f3ada06708693de9e60b449964c">&#9670;&nbsp;</a></span>LOGLEV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOGLEV&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Level of log messages (0=none, 1=basic, 2=detailed, 3=debug). </p>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00846">846</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="acaa1c3fa56061380a29889d703236251" name="acaa1c3fa56061380a29889d703236251"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaa1c3fa56061380a29889d703236251">&#9670;&nbsp;</a></span>LOG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">level, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                           \</div>
<div class="line">    if(level &gt;= 2)                                                      \</div>
<div class="line">      printf(<span class="stringliteral">&quot;  &quot;</span>);                                                     \</div>
<div class="line">    if(level &lt;= <a class="code hl_define" href="jurassic_8h.html#aa0c49f3ada06708693de9e60b449964c">LOGLEV</a>) {                                               \</div>
<div class="line">      printf(__VA_ARGS__);                                              \</div>
<div class="line">      printf(<span class="stringliteral">&quot;\n&quot;</span>);                                                     \</div>
<div class="line">    }                                                                   \</div>
<div class="line">  }</div>
<div class="ttc" id="ajurassic_8h_html_aa0c49f3ada06708693de9e60b449964c"><div class="ttname"><a href="jurassic_8h.html#aa0c49f3ada06708693de9e60b449964c">LOGLEV</a></div><div class="ttdeci">#define LOGLEV</div><div class="ttdoc">Level of log messages (0=none, 1=basic, 2=detailed, 3=debug).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00846">jurassic.h:846</a></div></div>
</div><!-- fragment -->
<p>Print a log message with a specified logging level. </p>
<p >This macro prints a formatted log message to the standard output if the specified logging level meets certain conditions. The message will be indented if the logging level is greater than or equal to 2.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">level</td><td>The logging level of the message. This should be an integer value. </td></tr>
    <tr><td class="paramname">...</td><td>The formatted message string and its arguments, similar to printf.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>LOG</code> macro provides a simple way to log messages with different levels of importance. The message is only printed if the specified <code>level</code> is less than or equal to the pre-defined <code>LOGLEV</code> macro. If the <code>level</code> is greater than or equal to 2, the message is preceded by two spaces for indentation.</p>
<p >The macro expands to a block of code that:</p><ul>
<li>Checks if the <code>level</code> is greater than or equal to 2, and if so, prints two spaces.</li>
<li>Checks if the <code>level</code> is less than or equal to <code>LOGLEV</code>, and if so, prints the formatted message followed by a newline.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The <code>LOGLEV</code> macro must be defined with an appropriate logging level before using the <code>LOG</code> macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00878">878</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a8f75b971030a39ef811d3526a62b36b8" name="a8f75b971030a39ef811d3526a62b36b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f75b971030a39ef811d3526a62b36b8">&#9670;&nbsp;</a></span>WARN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WARN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                                   \</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nWarning (%s, %s, l%d): &quot;</span>, __FILE__, __func__, __LINE__);  \</div>
<div class="line">    LOG(0, __VA_ARGS__);                                                \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Print a warning message with contextual information. </p>
<p >This macro prints a formatted warning message to the standard output, including the file name, function name, and line number where the warning occurred. The message is then passed to the <code>LOG</code> macro with a logging level of 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">...</td><td>The formatted warning message string and its arguments, similar to printf.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>WARN</code> macro is used to print warning messages with additional context about where the warning was triggered. The message includes the following contextual information:</p><ul>
<li>The name of the source file where the macro is called (<code>__FILE__</code>).</li>
<li>The name of the function where the macro is called (<code>__func__</code>).</li>
<li>The line number in the source file where the macro is called (<code>__LINE__</code>).</li>
</ul>
<p >After printing this contextual information, the macro uses the <code>LOG</code> macro with a logging level of 0 to print the actual warning message. This ensures that warning messages are always logged, regardless of the value of <code>LOGLEV</code>.</p>
<dl class="section note"><dt>Note</dt><dd>The <code>LOG</code> macro must be defined before using the <code>WARN</code> macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00915">915</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a3e0ae69dee4a8bb2e616526b5ebe6875" name="a3e0ae69dee4a8bb2e616526b5ebe6875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e0ae69dee4a8bb2e616526b5ebe6875">&#9670;&nbsp;</a></span>ERRMSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ERRMSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                                   \</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nError (%s, %s, l%d): &quot;</span>, __FILE__, __func__, __LINE__);    \</div>
<div class="line">    LOG(0, __VA_ARGS__);                                                \</div>
<div class="line">    exit(EXIT_FAILURE);                                                 \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Print an error message with contextual information and terminate the program. </p>
<p >This macro prints a formatted error message to the standard output, including the file name, function name, and line number where the error occurred. After printing the message, the program is terminated with an exit status indicating failure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">...</td><td>The formatted error message string and its arguments, similar to printf.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>ERRMSG</code> macro is used to report critical errors that require the program to terminate immediately. The message includes the following contextual information:</p><ul>
<li>The name of the source file where the macro is called (<code>__FILE__</code>).</li>
<li>The name of the function where the macro is called (<code>__func__</code>).</li>
<li>The line number in the source file where the macro is called (<code>__LINE__</code>).</li>
</ul>
<p >After printing this contextual information, the macro uses the <code>LOG</code> macro with a logging level of 0 to print the actual error message. Finally, the program exits with a failure status (<code>EXIT_FAILURE</code>).</p>
<dl class="section note"><dt>Note</dt><dd>The <code>LOG</code> macro must be defined before using the <code>ERRMSG</code> macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00948">948</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<a id="a19e6b556dec9bcdb4e422d57633ce731" name="a19e6b556dec9bcdb4e422d57633ce731"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19e6b556dec9bcdb4e422d57633ce731">&#9670;&nbsp;</a></span>PRINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">format, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">var&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  printf(<span class="stringliteral">&quot;Print (%s, %s, l%d): %s= &quot;</span>format<span class="stringliteral">&quot;\n&quot;</span>,                         \</div>
<div class="line">         __FILE__, __func__, __LINE__, #var, var);</div>
</div><!-- fragment -->
<p>Print the value of a variable with contextual information. </p>
<p >This macro prints the value of a variable to the standard output, including the file name, function name, and line number where the macro is called. The output also includes the variable's name and value in a formatted string.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">format</td><td>The format string used to print the variable's value, similar to printf. </td></tr>
    <tr><td class="paramname">var</td><td>The variable to be printed.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>PRINT</code> macro is used to output the value of a variable along with additional context about where the macro is called. The message includes:</p><ul>
<li>The name of the source file where the macro is called (<code>__FILE__</code>).</li>
<li>The name of the function where the macro is called (<code>__func__</code>).</li>
<li>The line number in the source file where the macro is called (<code>__LINE__</code>).</li>
<li>The name of the variable being printed (<code>#var</code>).</li>
<li>The value of the variable, formatted according to the provided format string (<code>format</code>).</li>
</ul>
<p >This macro is particularly useful for debugging purposes, providing a convenient way to trace variable values and their locations in the code.</p>
<dl class="section note"><dt>Note</dt><dd>The format string must be compatible with the type of the variable being printed.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8h_source.html#l00983">983</a> of file <a class="el" href="jurassic_8h_source.html">jurassic.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a04a9fd3342f5477d3cb1825fa60ed2a9" name="a04a9fd3342f5477d3cb1825fa60ed2a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04a9fd3342f5477d3cb1825fa60ed2a9">&#9670;&nbsp;</a></span>analyze_avk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void analyze_avk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structret__t.html">ret_t</a> *&#160;</td>
          <td class="paramname"><em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>iqa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_matrix *&#160;</td>
          <td class="paramname"><em>avk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Analyze averaging kernel (AVK) matrix for retrieval diagnostics. </p>
<p >Decomposes and evaluates the averaging kernel matrix \(\mathbf{A}\) to quantify the retrieval sensitivity and vertical resolution for each retrieved quantity (pressure, temperature, trace gases, extinction, etc.). The results are written to diagnostic atmospheric files for visualization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ret</td><td>Retrieval control and configuration structure (<code><a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a></code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Global control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) defining retrieval setup and quantities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Retrieved atmospheric state structure (<code><a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a></code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iqa</td><td>Array mapping state vector indices to physical quantities (e.g., IDXP, IDXT, <a class="el" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc" title="Indices for volume mixing ratios.">IDXQ(...)</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipa</td><td>Array mapping state vector indices to atmospheric grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">avk</td><td>Averaging kernel matrix \(\mathbf{A}\) (<code>gsl_matrix</code>, nn).</td></tr>
  </table>
  </dd>
</dl>
<p>The averaging kernel matrix \(\mathbf{A}\) describes the sensitivity of the retrieved state \(\hat{x}\) to the true state \(x\): </p><p class="formulaDsp">
\[
\hat{x} - x_a = \mathbf{A} (x - x_a)
\]
</p>
<p> where \(x_a\) is the a priori state. <br  />
 This function separates and evaluates:</p><ul>
<li><b>Contribution profiles:</b> diagonal dominance or total response (sensitivity).</li>
<li><b>Resolution profiles:</b> width or spread of the averaging kernels.</li>
</ul>
<p >Internally, this function:</p><ol type="1">
<li>Identifies submatrices of \(\mathbf{A}\) corresponding to each physical quantity (pressure, temperature, VMRs, extinction, clouds, surface).</li>
<li>Calls <code><a class="el" href="jurassic_8h.html#acbc0cac17f91169e812ecee2bc7fc990" title="Analyze averaging kernel submatrix for a specific retrieved quantity.">analyze_avk_quantity()</a></code> for each retrieved parameter type to compute quantitative measures of contribution and resolution.</li>
<li>Writes the results as atmospheric profiles:<ul>
<li><code>atm_cont.tab</code>  contribution functions (sensitivity).</li>
<li><code>atm_res.tab</code>  resolution functions (vertical response width).</li>
</ul>
</li>
</ol>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#acbc0cac17f91169e812ecee2bc7fc990" title="Analyze averaging kernel submatrix for a specific retrieved quantity.">analyze_avk_quantity</a>, <a class="el" href="jurassic_8h.html#a26be12322766162766071e8cd3587515" title="Write atmospheric data to a file.">write_atm</a>, <a class="el" href="jurassic_8h.html#ae9a11e5f03e0a307add4daf864977cec" title="Construct the a priori covariance matrix  for retrieval parameters.">set_cov_apr</a>, <a class="el" href="jurassic_8h.html#a6bb69eac608c4019c689bf8280912c1f" title="Construct measurement error standard deviations and their inverse.">set_cov_meas</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Submatrices are identified by matching the quantity index <code>iqa[i]</code> to the quantity constants (e.g., <code>IDXT</code>, <code><a class="el" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc" title="Indices for volume mixing ratios.">IDXQ(ig)</a></code>, etc.).</li>
<li>Cloud and surface quantities are treated as scalar elements.</li>
<li>Output files are written to the retrieval working directory (<code>ret-&gt;dir</code>).</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>The averaging kernel must be fully computed and dimensionally consistent with the state vector before calling this function.</li>
<li>File writing will overwrite existing diagnostics in <code>ret-&gt;dir</code>.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l00029">29</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>                         {</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  <span class="keyword">static</span> <a class="code hl_struct" href="structatm__t.html">atm_t</a> atm_cont, atm_res;</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>  <span class="keywordtype">size_t</span> i, n0[<a class="code hl_define" href="jurassic_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>], n1[<a class="code hl_define" href="jurassic_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>];</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>  <span class="comment">/* Get sizes... */</span></div>
<div class="line"><span class="lineno">   42</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = avk-&gt;size1;</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  <span class="comment">/* Find sub-matrices for different quantities... */</span></div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; <a class="code hl_define" href="jurassic_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>; iq++) {</div>
<div class="line"><span class="lineno">   46</span>    n0[iq] = <a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>;</div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno">   48</span>      <span class="keywordflow">if</span> (iqa[i] == iq &amp;&amp; n0[iq] == <a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</div>
<div class="line"><span class="lineno">   49</span>        n0[iq] = i;</div>
<div class="line"><span class="lineno">   50</span>      <span class="keywordflow">if</span> (iqa[i] == iq)</div>
<div class="line"><span class="lineno">   51</span>        n1[iq] = i - n0[iq] + 1;</div>
<div class="line"><span class="lineno">   52</span>    }</div>
<div class="line"><span class="lineno">   53</span>  }</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>  <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno">   56</span>  <a class="code hl_function" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1">copy_atm</a>(ctl, &amp;atm_cont, atm, 1);</div>
<div class="line"><span class="lineno">   57</span>  <a class="code hl_function" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1">copy_atm</a>(ctl, &amp;atm_res, atm, 1);</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>  <span class="comment">/* Analyze quantities... */</span></div>
<div class="line"><span class="lineno">   60</span>  <a class="code hl_function" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a>(avk, <a class="code hl_define" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a>, ipa, n0, n1, atm_cont.<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, atm_res.<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>);</div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_function" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a>(avk, <a class="code hl_define" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a>, ipa, n0, n1, atm_cont.<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>, atm_res.<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>);</div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno">   63</span>    <a class="code hl_function" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a>(avk, <a class="code hl_define" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a>(ig), ipa, n0, n1,</div>
<div class="line"><span class="lineno">   64</span>                         atm_cont.<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig], atm_res.<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig]);</div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_function" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a>(avk, <a class="code hl_define" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a>(iw), ipa, n0, n1,</div>
<div class="line"><span class="lineno">   67</span>                         atm_cont.<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw], atm_res.<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw]);</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_function" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a>(avk, <a class="code hl_define" href="jurassic_8h.html#a04eaf14380553f171f54680560527fe5">IDXCLZ</a>, ipa, n0, n1, &amp;atm_cont.<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>, &amp;atm_res.<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>);</div>
<div class="line"><span class="lineno">   69</span>  <a class="code hl_function" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a>(avk, <a class="code hl_define" href="jurassic_8h.html#a3b420330ad2457758ef539d8c9e0bd99">IDXCLDZ</a>, ipa, n0, n1, &amp;atm_cont.<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>,</div>
<div class="line"><span class="lineno">   70</span>                       &amp;atm_res.<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>);</div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno">   72</span>    <a class="code hl_function" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a>(avk, <a class="code hl_define" href="jurassic_8h.html#a809f947437669a6b3930302f30375d41">IDXCLK</a>(icl), ipa, n0, n1,</div>
<div class="line"><span class="lineno">   73</span>                         &amp;atm_cont.<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl], &amp;atm_res.<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl]);</div>
<div class="line"><span class="lineno">   74</span>  <a class="code hl_function" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a>(avk, <a class="code hl_define" href="jurassic_8h.html#a7abc6f3d1a1993a0337a736d79cf6ecc">IDXSFT</a>, ipa, n0, n1, &amp;atm_cont.<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>, &amp;atm_res.<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>);</div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_function" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a>(avk, <a class="code hl_define" href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35">IDXSFEPS</a>(isf), ipa, n0, n1,</div>
<div class="line"><span class="lineno">   77</span>                         &amp;atm_cont.<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf], &amp;atm_res.<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf]);</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>  <span class="comment">/* Write results to disk... */</span></div>
<div class="line"><span class="lineno">   80</span>  <a class="code hl_function" href="jurassic_8c.html#a26be12322766162766071e8cd3587515">write_atm</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;atm_cont.tab&quot;</span>, ctl, &amp;atm_cont);</div>
<div class="line"><span class="lineno">   81</span>  <a class="code hl_function" href="jurassic_8c.html#a26be12322766162766071e8cd3587515">write_atm</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;atm_res.tab&quot;</span>, ctl, &amp;atm_res);</div>
<div class="line"><span class="lineno">   82</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a26be12322766162766071e8cd3587515"><div class="ttname"><a href="jurassic_8c.html#a26be12322766162766071e8cd3587515">write_atm</a></div><div class="ttdeci">void write_atm(const char *dirname, const char *filename, const ctl_t *ctl, const atm_t *atm)</div><div class="ttdoc">Write atmospheric data to a file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06604">jurassic.c:6604</a></div></div>
<div class="ttc" id="ajurassic_8c_html_acbc0cac17f91169e812ecee2bc7fc990"><div class="ttname"><a href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990">analyze_avk_quantity</a></div><div class="ttdeci">void analyze_avk_quantity(const gsl_matrix *avk, const int iq, const int *ipa, const size_t *n0, const size_t *n1, double *cont, double *res)</div><div class="ttdoc">Analyze averaging kernel submatrix for a specific retrieved quantity.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l00086">jurassic.c:86</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ad4d49729d85da58030daa13689c5edd1"><div class="ttname"><a href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1">copy_atm</a></div><div class="ttdeci">void copy_atm(const ctl_t *ctl, atm_t *atm_dest, const atm_t *atm_src, const int init)</div><div class="ttdoc">Copy or initialize atmospheric profile data.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03258">jurassic.c:3258</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div><div class="ttdoc">Maximum size of state vector.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00277">jurassic.h:277</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a04eaf14380553f171f54680560527fe5"><div class="ttname"><a href="jurassic_8h.html#a04eaf14380553f171f54680560527fe5">IDXCLZ</a></div><div class="ttdeci">#define IDXCLZ</div><div class="ttdoc">Index for cloud layer height.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00347">jurassic.h:347</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a3b420330ad2457758ef539d8c9e0bd99"><div class="ttname"><a href="jurassic_8h.html#a3b420330ad2457758ef539d8c9e0bd99">IDXCLDZ</a></div><div class="ttdeci">#define IDXCLDZ</div><div class="ttdoc">Index for cloud layer depth.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00350">jurassic.h:350</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a511d4808c85a5b5e1e600cf413eabbd6"><div class="ttname"><a href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a></div><div class="ttdeci">#define IDXK(iw)</div><div class="ttdoc">Indices for extinction.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00344">jurassic.h:344</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a68c2775fc4d7385df9c7bb96d23b482b"><div class="ttname"><a href="jurassic_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a></div><div class="ttdeci">#define NQ</div><div class="ttdoc">Maximum number of quantities.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00282">jurassic.h:282</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a7abc6f3d1a1993a0337a736d79cf6ecc"><div class="ttname"><a href="jurassic_8h.html#a7abc6f3d1a1993a0337a736d79cf6ecc">IDXSFT</a></div><div class="ttdeci">#define IDXSFT</div><div class="ttdoc">Index for surface layer temperature.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00356">jurassic.h:356</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a803581fe3fed7a56dacec94c5c860f35"><div class="ttname"><a href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35">IDXSFEPS</a></div><div class="ttdeci">#define IDXSFEPS(isf)</div><div class="ttdoc">Indices for surface layer emissivity.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00359">jurassic.h:359</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a809f947437669a6b3930302f30375d41"><div class="ttname"><a href="jurassic_8h.html#a809f947437669a6b3930302f30375d41">IDXCLK</a></div><div class="ttdeci">#define IDXCLK(icl)</div><div class="ttdoc">Indices for cloud layer extinction.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00353">jurassic.h:353</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a99c6798a64d9d5535a2b22b46ee31924"><div class="ttname"><a href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a></div><div class="ttdeci">#define IDXP</div><div class="ttdoc">Index for pressure.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00335">jurassic.h:335</a></div></div>
<div class="ttc" id="ajurassic_8h_html_af2f80a7a5ff9b54495c0c41d8571cafc"><div class="ttname"><a href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a></div><div class="ttdeci">#define IDXQ(ig)</div><div class="ttdoc">Indices for volume mixing ratios.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00341">jurassic.h:341</a></div></div>
<div class="ttc" id="ajurassic_8h_html_afb33f030ad4a44d5f638f3903d13fe70"><div class="ttname"><a href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a></div><div class="ttdeci">#define IDXT</div><div class="ttdoc">Index for temperature.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00338">jurassic.h:338</a></div></div>
<div class="ttc" id="astructatm__t_html"><div class="ttname"><a href="structatm__t.html">atm_t</a></div><div class="ttdoc">Atmospheric profile data.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00998">jurassic.h:998</a></div></div>
<div class="ttc" id="astructatm__t_html_a09f5c1a2a0ecac7b481f3ea138b8a750"><div class="ttname"><a href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">atm_t::sfeps</a></div><div class="ttdeci">double sfeps[NSF]</div><div class="ttdoc">Surface emissivity.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01040">jurassic.h:1040</a></div></div>
<div class="ttc" id="astructatm__t_html_a18d3460f12bb187e3ae50e9f2547ede3"><div class="ttname"><a href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">atm_t::k</a></div><div class="ttdeci">double k[NW][NP]</div><div class="ttdoc">Extinction [km^-1].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01025">jurassic.h:1025</a></div></div>
<div class="ttc" id="astructatm__t_html_a306826df6fe870ab371fb945544cc13a"><div class="ttname"><a href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">atm_t::t</a></div><div class="ttdeci">double t[NP]</div><div class="ttdoc">Temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01019">jurassic.h:1019</a></div></div>
<div class="ttc" id="astructatm__t_html_a467184c9e87a139e18fa656c565ab8a6"><div class="ttname"><a href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">atm_t::clz</a></div><div class="ttdeci">double clz</div><div class="ttdoc">Cloud layer height [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01028">jurassic.h:1028</a></div></div>
<div class="ttc" id="astructatm__t_html_a49c74ec000bd9884836d6e8ae2b96a3a"><div class="ttname"><a href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">atm_t::cldz</a></div><div class="ttdeci">double cldz</div><div class="ttdoc">Cloud layer depth [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01031">jurassic.h:1031</a></div></div>
<div class="ttc" id="astructatm__t_html_a651f52626605a4dd79dd147ee245014f"><div class="ttname"><a href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">atm_t::sft</a></div><div class="ttdeci">double sft</div><div class="ttdoc">Surface temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01037">jurassic.h:1037</a></div></div>
<div class="ttc" id="astructatm__t_html_a8c50a0221df51f13b2f07987aab6ab19"><div class="ttname"><a href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">atm_t::clk</a></div><div class="ttdeci">double clk[NCL]</div><div class="ttdoc">Cloud layer extinction [km^-1].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01034">jurassic.h:1034</a></div></div>
<div class="ttc" id="astructatm__t_html_aa87ac5feb176468221bef178ae364d00"><div class="ttname"><a href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">atm_t::q</a></div><div class="ttdeci">double q[NG][NP]</div><div class="ttdoc">Volume mixing ratio [ppv].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01022">jurassic.h:1022</a></div></div>
<div class="ttc" id="astructatm__t_html_ae769ef14e4824d35f47ad9dec75a4087"><div class="ttname"><a href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">atm_t::p</a></div><div class="ttdeci">double p[NP]</div><div class="ttdoc">Pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01016">jurassic.h:1016</a></div></div>
<div class="ttc" id="astructctl__t_html_a094e10d6d25abb248ee383a3da02181a"><div class="ttname"><a href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">ctl_t::nw</a></div><div class="ttdeci">int nw</div><div class="ttdoc">Number of spectral windows.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01078">jurassic.h:1078</a></div></div>
<div class="ttc" id="astructctl__t_html_a7e0035514fe22254130c64c9fa317c8d"><div class="ttname"><a href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ctl_t::ng</a></div><div class="ttdeci">int ng</div><div class="ttdoc">Number of emitters.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01054">jurassic.h:1054</a></div></div>
<div class="ttc" id="astructctl__t_html_aaca3446ebb40caf6519044b624bc87d5"><div class="ttname"><a href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ctl_t::ncl</a></div><div class="ttdeci">int ncl</div><div class="ttdoc">Number of cloud layer spectral grid points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01084">jurassic.h:1084</a></div></div>
<div class="ttc" id="astructctl__t_html_adbb746bb71f7a71dffed2bfa519037c3"><div class="ttname"><a href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">ctl_t::nsf</a></div><div class="ttdeci">int nsf</div><div class="ttdoc">Number of surface layer spectral grid points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01090">jurassic.h:1090</a></div></div>
<div class="ttc" id="astructret__t_html_ada64429504782319cf47ceb02e6ceb3f"><div class="ttname"><a href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">ret_t::dir</a></div><div class="ttdeci">char dir[LEN]</div><div class="ttdoc">Working directory.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01332">jurassic.h:1332</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a04a9fd3342f5477d3cb1825fa60ed2a9_cgraph.png" border="0" usemap="#ajurassic_8h_a04a9fd3342f5477d3cb1825fa60ed2a9_cgraph" alt=""/></div>
<map name="ajurassic_8h_a04a9fd3342f5477d3cb1825fa60ed2a9_cgraph" id="ajurassic_8h_a04a9fd3342f5477d3cb1825fa60ed2a9_cgraph">
<area shape="rect" title="Analyze averaging kernel (AVK) matrix for retrieval diagnostics." alt="" coords="5,56,99,83"/>
<area shape="rect" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990" title="Analyze averaging kernel submatrix for a specific retrieved quantity." alt="" coords="147,5,292,32"/>
<area shape="rect" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1" title="Copy or initialize atmospheric profile data." alt="" coords="180,56,259,83"/>
<area shape="rect" href="jurassic_8c.html#a26be12322766162766071e8cd3587515" title="Write atmospheric data to a file." alt="" coords="180,107,259,133"/>
<area shape="rect" href="jurassic_8c.html#aedaa4b13833a182bbff8034a3b2edae0" title="Write atmospheric data to an ASCII file." alt="" coords="340,81,447,108"/>
<area shape="rect" href="jurassic_8c.html#abb2306151e16b13ed93d84d379c8bb0e" title="Write atmospheric data to a binary file." alt="" coords="342,132,445,159"/>
</map>
</div>

</div>
</div>
<a id="acbc0cac17f91169e812ecee2bc7fc990" name="acbc0cac17f91169e812ecee2bc7fc990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbc0cac17f91169e812ecee2bc7fc990">&#9670;&nbsp;</a></span>analyze_avk_quantity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void analyze_avk_quantity </td>
          <td>(</td>
          <td class="paramtype">const gsl_matrix *&#160;</td>
          <td class="paramname"><em>avk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t *&#160;</td>
          <td class="paramname"><em>n0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t *&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Analyze averaging kernel submatrix for a specific retrieved quantity. </p>
<p >Computes the contribution (sensitivity) and resolution (information density) profiles for a given physical quantity from its corresponding submatrix of the full averaging kernel matrix \(\mathbf{A}\).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">avk</td><td>Averaging kernel matrix \(\mathbf{A}\) (<code>gsl_matrix</code>, nn), describing the sensitivity of the retrieved state to the true state. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iq</td><td>Quantity index identifier (e.g., <code>IDXP</code>, <code>IDXT</code>, <code><a class="el" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc" title="Indices for volume mixing ratios.">IDXQ(ig)</a></code>, <code><a class="el" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6" title="Indices for extinction.">IDXK(iw)</a></code>, <code>IDXCLZ</code>, etc.). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipa</td><td>Array mapping state vector indices to atmospheric grid indices. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n0</td><td>Array of starting indices for each quantity sub-block in the state vector. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n1</td><td>Array of lengths (number of elements) for each quantity sub-block. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cont</td><td>Array of contribution values, representing the total sensitivity or response of the retrieval at each grid point. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">res</td><td>Array of resolution measures, representing the vertical information density or averaging kernel width at each grid point.</td></tr>
  </table>
  </dd>
</dl>
<p>For a given quantity \(q\), the function extracts its corresponding block \(\mathbf{A}_q\) from the full averaging kernel matrix and computes:</p>
<ul>
<li><b>Contribution function</b> <p class="formulaDsp">
\[
  \text{cont}_i = \sum_j A_{ij}^{(q)}
  \]
</p>
 giving the total response of retrieved element \(i\) to perturbations in all true elements \(j\) of the same quantity.</li>
<li><b>Resolution (information density)</b> <p class="formulaDsp">
\[
  \text{res}_i = \frac{1}{A_{ii}^{(q)}}
  \]
</p>
 approximating the degree of vertical resolution or smoothing at level \(i\).</li>
</ul>
<p >The results are stored in the provided arrays <code>cont[]</code> and <code>res[]</code>, indexed according to the atmospheric profile index via <code>ipa[]</code>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a04a9fd3342f5477d3cb1825fa60ed2a9" title="Analyze averaging kernel (AVK) matrix for retrieval diagnostics.">analyze_avk</a>, <a class="el" href="jurassic_8h.html#a26be12322766162766071e8cd3587515" title="Write atmospheric data to a file.">write_atm</a>, <a class="el" href="jurassic_8h.html#ae9a11e5f03e0a307add4daf864977cec" title="Construct the a priori covariance matrix  for retrieval parameters.">set_cov_apr</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Only elements associated with the specified quantity index (<code>iq</code>) are processed.</li>
<li>The function assumes the averaging kernel matrix is square and symmetric.</li>
<li>The contribution and resolution arrays must be preallocated to at least the number of atmospheric grid points (<code>atm-&gt;np</code>).</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>If the diagonal element <code>A_ii</code> is zero or near-zero, the corresponding resolution value may be undefined or numerically unstable.</li>
<li>Input indices <code>n0[iq]</code> and <code>n1[iq]</code> must have been computed by <code><a class="el" href="jurassic_8h.html#a04a9fd3342f5477d3cb1825fa60ed2a9" title="Analyze averaging kernel (AVK) matrix for retrieval diagnostics.">analyze_avk()</a></code>.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l00086">86</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   93</span>               {</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  <span class="comment">/* Loop over state vector elements... */</span></div>
<div class="line"><span class="lineno">   96</span>  <span class="keywordflow">if</span> (n0[iq] &lt; <a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n1[iq]; i++) {</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>      <span class="comment">/* Get area of averaging kernel... */</span></div>
<div class="line"><span class="lineno">  100</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n1[iq]; j++)</div>
<div class="line"><span class="lineno">  101</span>        cont[ipa[n0[iq] + i]] += gsl_matrix_get(avk, n0[iq] + i, n0[iq] + j);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>      <span class="comment">/* Get information density... */</span></div>
<div class="line"><span class="lineno">  104</span>      res[ipa[n0[iq] + i]] = 1 / gsl_matrix_get(avk, n0[iq] + i, n0[iq] + i);</div>
<div class="line"><span class="lineno">  105</span>    }</div>
<div class="line"><span class="lineno">  106</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adfbb04487aa1c1d4175afca6e521e20b" name="adfbb04487aa1c1d4175afca6e521e20b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfbb04487aa1c1d4175afca6e521e20b">&#9670;&nbsp;</a></span>atm2x()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t atm2x </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>iqa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ipa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert atmospheric data to state vector elements. </p>
<p >Extracts selected quantities from an atmospheric profile (<a class="el" href="structatm__t.html">atm_t</a>) according to retrieval settings in <a class="el" href="structctl__t.html">ctl_t</a>, and appends them to the state vector <code>x</code>. For each included quantity, the function also stores its quantity index (<code>iqa</code>) and profile index (<code>ipa</code>).</p>
<p >The function respects retrieval altitude limits defined in <code>ctl</code> (e.g., <code>retp_zmin/zmax</code>, <code>rett_zmin/zmax</code>, etc.) and includes only variables flagged for retrieval (e.g., <code>ret_clz</code>, <code>ret_sft</code>, etc.).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control settings defining retrieval configuration and limits. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Atmospheric profile data to extract from. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>GSL vector to store state-vector elements. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iqa</td><td>Quantity index array corresponding to elements in <code>x</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ipa</td><td>Profile index array corresponding to elements in <code>x</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of elements written to the state vector.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Internally calls <a class="el" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help()</a> to append individual values.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="jurassic_8h.html#a5ac332e50178e5439e72634fe03d191f" title="Append a single atmospheric value to the state vector.">atm2x_help</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l00110">110</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  115</span>            {</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  <span class="keywordtype">size_t</span> n = 0;</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  <span class="comment">/* Add pressure... */</span></div>
<div class="line"><span class="lineno">  120</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1184388515bcde02af618c43495164a1">retp_zmin</a> &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &lt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb1ec420b7e90ebf056640417572a225">retp_zmax</a>)</div>
<div class="line"><span class="lineno">  122</span>      <a class="code hl_function" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], <a class="code hl_define" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a>, ip, x, iqa, ipa, &amp;n);</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>  <span class="comment">/* Add temperature... */</span></div>
<div class="line"><span class="lineno">  125</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8df8e6875b7fe5ab5e2805390b3f9c3f">rett_zmin</a> &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &lt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4ceaa6f495415c535223541d957491d3">rett_zmax</a>)</div>
<div class="line"><span class="lineno">  127</span>      <a class="code hl_function" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip], <a class="code hl_define" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a>, ip, x, iqa, ipa, &amp;n);</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <span class="comment">/* Add volume mixing ratios... */</span></div>
<div class="line"><span class="lineno">  130</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno">  132</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7d487af5fe0e4d378d90865f589c7ddc">retq_zmin</a>[ig]</div>
<div class="line"><span class="lineno">  133</span>          &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &lt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a785678f0cb53cbf59f390ad671f262f3">retq_zmax</a>[ig])</div>
<div class="line"><span class="lineno">  134</span>        <a class="code hl_function" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip], <a class="code hl_define" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a>(ig), ip, x, iqa, ipa, &amp;n);</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  <span class="comment">/* Add extinction... */</span></div>
<div class="line"><span class="lineno">  137</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno">  139</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aab99fb086f49aee8e2aa5fd1c517a221">retk_zmin</a>[iw]</div>
<div class="line"><span class="lineno">  140</span>          &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &lt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26933d7ba71ac03f208a4c3b59c6c12a">retk_zmax</a>[iw])</div>
<div class="line"><span class="lineno">  141</span>        <a class="code hl_function" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip], <a class="code hl_define" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a>(iw), ip, x, iqa, ipa, &amp;n);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  <span class="comment">/* Add cloud parameters... */</span></div>
<div class="line"><span class="lineno">  144</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a59116b56f658e88f16fdadd8f8573b9b">ret_clz</a>)</div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_function" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>, <a class="code hl_define" href="jurassic_8h.html#a04eaf14380553f171f54680560527fe5">IDXCLZ</a>, 0, x, iqa, ipa, &amp;n);</div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae25be11810f5e53581c26f20fe22fe7d">ret_cldz</a>)</div>
<div class="line"><span class="lineno">  147</span>    <a class="code hl_function" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>, <a class="code hl_define" href="jurassic_8h.html#a3b420330ad2457758ef539d8c9e0bd99">IDXCLDZ</a>, 0, x, iqa, ipa, &amp;n);</div>
<div class="line"><span class="lineno">  148</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad6e4dce394bf7b0dd53d37cd9417cbd2">ret_clk</a>)</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno">  150</span>      <a class="code hl_function" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl], <a class="code hl_define" href="jurassic_8h.html#a809f947437669a6b3930302f30375d41">IDXCLK</a>(icl), 0, x, iqa, ipa, &amp;n);</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  <span class="comment">/* Add surface parameters... */</span></div>
<div class="line"><span class="lineno">  153</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5771f0852888a5ac64c5cdcc588f684b">ret_sft</a>)</div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_function" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>, <a class="code hl_define" href="jurassic_8h.html#a7abc6f3d1a1993a0337a736d79cf6ecc">IDXSFT</a>, 0, x, iqa, ipa, &amp;n);</div>
<div class="line"><span class="lineno">  155</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a563edaaec6157678618fed9fbc85b79c">ret_sfeps</a>)</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno">  157</span>      <a class="code hl_function" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf], <a class="code hl_define" href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35">IDXSFEPS</a>(isf), 0, x, iqa, ipa, &amp;n);</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  <span class="keywordflow">return</span> n;</div>
<div class="line"><span class="lineno">  160</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a5ac332e50178e5439e72634fe03d191f"><div class="ttname"><a href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f">atm2x_help</a></div><div class="ttdeci">void atm2x_help(const double value, const int value_iqa, const int value_ip, gsl_vector *x, int *iqa, int *ipa, size_t *n)</div><div class="ttdoc">Append a single atmospheric value to the state vector.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l00164">jurassic.c:164</a></div></div>
<div class="ttc" id="astructatm__t_html_a473366004c7195d5c455373296ee1833"><div class="ttname"><a href="structatm__t.html#a473366004c7195d5c455373296ee1833">atm_t::np</a></div><div class="ttdeci">int np</div><div class="ttdoc">Number of data points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01001">jurassic.h:1001</a></div></div>
<div class="ttc" id="astructatm__t_html_a84dad6b8069641faddf06baad38b82f8"><div class="ttname"><a href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">atm_t::z</a></div><div class="ttdeci">double z[NP]</div><div class="ttdoc">Altitude [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01007">jurassic.h:1007</a></div></div>
<div class="ttc" id="astructctl__t_html_a1184388515bcde02af618c43495164a1"><div class="ttname"><a href="structctl__t.html#a1184388515bcde02af618c43495164a1">ctl_t::retp_zmin</a></div><div class="ttdeci">double retp_zmin</div><div class="ttdoc">Minimum altitude for pressure retrieval [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01150">jurassic.h:1150</a></div></div>
<div class="ttc" id="astructctl__t_html_a26933d7ba71ac03f208a4c3b59c6c12a"><div class="ttname"><a href="structctl__t.html#a26933d7ba71ac03f208a4c3b59c6c12a">ctl_t::retk_zmax</a></div><div class="ttdeci">double retk_zmax[NW]</div><div class="ttdoc">Maximum altitude for extinction retrieval [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01171">jurassic.h:1171</a></div></div>
<div class="ttc" id="astructctl__t_html_a4ceaa6f495415c535223541d957491d3"><div class="ttname"><a href="structctl__t.html#a4ceaa6f495415c535223541d957491d3">ctl_t::rett_zmax</a></div><div class="ttdeci">double rett_zmax</div><div class="ttdoc">Maximum altitude for temperature retrieval [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01159">jurassic.h:1159</a></div></div>
<div class="ttc" id="astructctl__t_html_a563edaaec6157678618fed9fbc85b79c"><div class="ttname"><a href="structctl__t.html#a563edaaec6157678618fed9fbc85b79c">ctl_t::ret_sfeps</a></div><div class="ttdeci">int ret_sfeps</div><div class="ttdoc">Retrieve surface layer emissivity (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01186">jurassic.h:1186</a></div></div>
<div class="ttc" id="astructctl__t_html_a5771f0852888a5ac64c5cdcc588f684b"><div class="ttname"><a href="structctl__t.html#a5771f0852888a5ac64c5cdcc588f684b">ctl_t::ret_sft</a></div><div class="ttdeci">int ret_sft</div><div class="ttdoc">Retrieve surface layer temperature (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01183">jurassic.h:1183</a></div></div>
<div class="ttc" id="astructctl__t_html_a59116b56f658e88f16fdadd8f8573b9b"><div class="ttname"><a href="structctl__t.html#a59116b56f658e88f16fdadd8f8573b9b">ctl_t::ret_clz</a></div><div class="ttdeci">int ret_clz</div><div class="ttdoc">Retrieve cloud layer height (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01174">jurassic.h:1174</a></div></div>
<div class="ttc" id="astructctl__t_html_a785678f0cb53cbf59f390ad671f262f3"><div class="ttname"><a href="structctl__t.html#a785678f0cb53cbf59f390ad671f262f3">ctl_t::retq_zmax</a></div><div class="ttdeci">double retq_zmax[NG]</div><div class="ttdoc">Maximum altitude for volume mixing ratio retrieval [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01165">jurassic.h:1165</a></div></div>
<div class="ttc" id="astructctl__t_html_a7d487af5fe0e4d378d90865f589c7ddc"><div class="ttname"><a href="structctl__t.html#a7d487af5fe0e4d378d90865f589c7ddc">ctl_t::retq_zmin</a></div><div class="ttdeci">double retq_zmin[NG]</div><div class="ttdoc">Minimum altitude for volume mixing ratio retrieval [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01162">jurassic.h:1162</a></div></div>
<div class="ttc" id="astructctl__t_html_a8df8e6875b7fe5ab5e2805390b3f9c3f"><div class="ttname"><a href="structctl__t.html#a8df8e6875b7fe5ab5e2805390b3f9c3f">ctl_t::rett_zmin</a></div><div class="ttdeci">double rett_zmin</div><div class="ttdoc">Minimum altitude for temperature retrieval [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01156">jurassic.h:1156</a></div></div>
<div class="ttc" id="astructctl__t_html_aab99fb086f49aee8e2aa5fd1c517a221"><div class="ttname"><a href="structctl__t.html#aab99fb086f49aee8e2aa5fd1c517a221">ctl_t::retk_zmin</a></div><div class="ttdeci">double retk_zmin[NW]</div><div class="ttdoc">Minimum altitude for extinction retrieval [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01168">jurassic.h:1168</a></div></div>
<div class="ttc" id="astructctl__t_html_ad6e4dce394bf7b0dd53d37cd9417cbd2"><div class="ttname"><a href="structctl__t.html#ad6e4dce394bf7b0dd53d37cd9417cbd2">ctl_t::ret_clk</a></div><div class="ttdeci">int ret_clk</div><div class="ttdoc">Retrieve cloud layer extinction (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01180">jurassic.h:1180</a></div></div>
<div class="ttc" id="astructctl__t_html_ae25be11810f5e53581c26f20fe22fe7d"><div class="ttname"><a href="structctl__t.html#ae25be11810f5e53581c26f20fe22fe7d">ctl_t::ret_cldz</a></div><div class="ttdeci">int ret_cldz</div><div class="ttdoc">Retrieve cloud layer depth (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01177">jurassic.h:1177</a></div></div>
<div class="ttc" id="astructctl__t_html_afb1ec420b7e90ebf056640417572a225"><div class="ttname"><a href="structctl__t.html#afb1ec420b7e90ebf056640417572a225">ctl_t::retp_zmax</a></div><div class="ttdeci">double retp_zmax</div><div class="ttdoc">Maximum altitude for pressure retrieval [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01153">jurassic.h:1153</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_adfbb04487aa1c1d4175afca6e521e20b_cgraph.png" border="0" usemap="#ajurassic_8h_adfbb04487aa1c1d4175afca6e521e20b_cgraph" alt=""/></div>
<map name="ajurassic_8h_adfbb04487aa1c1d4175afca6e521e20b_cgraph" id="ajurassic_8h_adfbb04487aa1c1d4175afca6e521e20b_cgraph">
<area shape="rect" title="Convert atmospheric data to state vector elements." alt="" coords="5,5,63,32"/>
<area shape="rect" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f" title="Append a single atmospheric value to the state vector." alt="" coords="111,5,199,32"/>
</map>
</div>

</div>
</div>
<a id="a5ac332e50178e5439e72634fe03d191f" name="a5ac332e50178e5439e72634fe03d191f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac332e50178e5439e72634fe03d191f">&#9670;&nbsp;</a></span>atm2x_help()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void atm2x_help </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>value_iqa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>value_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>iqa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Append a single atmospheric value to the state vector. </p>
<p >Helper routine for <a class="el" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x()</a>. Inserts one scalar value and its corresponding quantity and profile indices into the state vector and tracking arrays, then increments the element counter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">value</td><td>Value to add to the state vector. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">value_iqa</td><td>Quantity index (e.g., <a class="el" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a>, <a class="el" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a>, etc.). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">value_ip</td><td>Profile index within the atmospheric profile. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>GSL vector containing state-vector elements (may be NULL). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iqa</td><td>Quantity index array corresponding to <code>x</code> (may be NULL). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ipa</td><td>Profile index array corresponding to <code>x</code> (may be NULL). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Current number of elements in the state vector; incremented on return.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function performs no range checking and assumes valid array bounds.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l00164">164</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  171</span>             {</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  <span class="comment">/* Add element to state vector... */</span></div>
<div class="line"><span class="lineno">  174</span>  <span class="keywordflow">if</span> (x != NULL)</div>
<div class="line"><span class="lineno">  175</span>    gsl_vector_set(x, *n, value);</div>
<div class="line"><span class="lineno">  176</span>  <span class="keywordflow">if</span> (iqa != NULL)</div>
<div class="line"><span class="lineno">  177</span>    iqa[*n] = value_iqa;</div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">if</span> (ipa != NULL)</div>
<div class="line"><span class="lineno">  179</span>    ipa[*n] = value_ip;</div>
<div class="line"><span class="lineno">  180</span>  (*n)++;</div>
<div class="line"><span class="lineno">  181</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf98f7230de0893b8dc4833d3c83c7a4" name="aaf98f7230de0893b8dc4833d3c83c7a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf98f7230de0893b8dc4833d3c83c7a4">&#9670;&nbsp;</a></span>cart2geo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cart2geo </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts Cartesian coordinates to geographic coordinates. </p>
<p >This function converts a point from Cartesian coordinates (x, y, z) to geographic coordinates (longitude, latitude, and altitude). It uses the spherical Earth approximation for the conversion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Pointer to an array containing the Cartesian coordinates (x, y, z) in kilometers. </td></tr>
    <tr><td class="paramname">z</td><td>Pointer to a double where the computed altitude (above the reference ellipsoid) will be stored, in kilometers. </td></tr>
    <tr><td class="paramname">lon</td><td>Pointer to a double where the computed longitude (in degrees) will be stored. </td></tr>
    <tr><td class="paramname">lat</td><td>Pointer to a double where the computed latitude (in degrees) will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l00185">185</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>               {</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> radius = <a class="code hl_define" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a>(x);</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  *lat = <a class="code hl_define" href="jurassic_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a>(asin(x[2] / radius));</div>
<div class="line"><span class="lineno">  194</span>  *lon = <a class="code hl_define" href="jurassic_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a>(atan2(x[1], x[0]));</div>
<div class="line"><span class="lineno">  195</span>  *z = radius - <a class="code hl_define" href="jurassic_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a>;</div>
<div class="line"><span class="lineno">  196</span>}</div>
<div class="ttc" id="ajurassic_8h_html_a0600e3f227b6e9a3ae26f4d6e2a0581e"><div class="ttname"><a href="jurassic_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a></div><div class="ttdeci">#define RE</div><div class="ttdoc">Mean radius of Earth [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00188">jurassic.h:188</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a7fa3afb5cf2625deb1e859cbb93d2943"><div class="ttname"><a href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a></div><div class="ttdeci">#define NORM(a)</div><div class="ttdoc">Compute the norm (magnitude) of a 3D vector.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00708">jurassic.h:708</a></div></div>
<div class="ttc" id="ajurassic_8h_html_aacc958134b53425ec947541bb72ac8b1"><div class="ttname"><a href="jurassic_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a></div><div class="ttdeci">#define RAD2DEG(rad)</div><div class="ttdoc">Convert radians to degrees.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00782">jurassic.h:782</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae324329aa277798b632b25de13faf1b2" name="ae324329aa277798b632b25de13faf1b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae324329aa277798b632b25de13faf1b2">&#9670;&nbsp;</a></span>climatology()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void climatology </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes atmospheric climatology profiles. </p>
<p >This function populates the atmospheric state (<code>atm</code>) with standard climatological profiles of pressure, temperature, and trace gas concentrations (e.g., H2O, CH4, CO, O3, etc.) as a function of altitude. The profiles are based on reference climatological datasets and are used for atmospheric modeling and radiative transfer calculations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control parameters structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">atm</td><td>Atmospheric state structure to be populated with climatological data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l00200">200</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  202</span>              {</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> z[121] = {</div>
<div class="line"><span class="lineno">  205</span>    0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,</div>
<div class="line"><span class="lineno">  206</span>    20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37,</div>
<div class="line"><span class="lineno">  207</span>    38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55,</div>
<div class="line"><span class="lineno">  208</span>    56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73,</div>
<div class="line"><span class="lineno">  209</span>    74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91,</div>
<div class="line"><span class="lineno">  210</span>    92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107,</div>
<div class="line"><span class="lineno">  211</span>    108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120</div>
<div class="line"><span class="lineno">  212</span>  };</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> pre[121] = {</div>
<div class="line"><span class="lineno">  215</span>    1017, 901.083, 796.45, 702.227, 617.614, 541.644, 473.437, 412.288,</div>
<div class="line"><span class="lineno">  216</span>    357.603, 308.96, 265.994, 228.348, 195.619, 167.351, 143.039, 122.198,</div>
<div class="line"><span class="lineno">  217</span>    104.369, 89.141, 76.1528, 65.0804, 55.641, 47.591, 40.7233, 34.8637,</div>
<div class="line"><span class="lineno">  218</span>    29.8633, 25.5956, 21.9534, 18.8445, 16.1909, 13.9258, 11.9913,</div>
<div class="line"><span class="lineno">  219</span>    10.34, 8.92988, 7.72454, 6.6924, 5.80701, 5.04654, 4.39238, 3.82902,</div>
<div class="line"><span class="lineno">  220</span>    3.34337, 2.92413, 2.56128, 2.2464, 1.97258, 1.73384, 1.52519, 1.34242,</div>
<div class="line"><span class="lineno">  221</span>    1.18197, 1.04086, 0.916546, 0.806832, 0.709875, 0.624101, 0.548176,</div>
<div class="line"><span class="lineno">  222</span>    0.480974, 0.421507, 0.368904, 0.322408, 0.281386, 0.245249, 0.213465,</div>
<div class="line"><span class="lineno">  223</span>    0.185549, 0.161072, 0.139644, 0.120913, 0.104568, 0.0903249, 0.0779269,</div>
<div class="line"><span class="lineno">  224</span>    0.0671493, 0.0577962, 0.0496902, 0.0426736, 0.0366093, 0.0313743,</div>
<div class="line"><span class="lineno">  225</span>    0.0268598, 0.0229699, 0.0196206, 0.0167399, 0.0142646, 0.0121397,</div>
<div class="line"><span class="lineno">  226</span>    0.0103181, 0.00875775, 0.00742226, 0.00628076, 0.00530519, 0.00447183,</div>
<div class="line"><span class="lineno">  227</span>    0.00376124, 0.00315632, 0.00264248, 0.00220738, 0.00184003, 0.00153095,</div>
<div class="line"><span class="lineno">  228</span>    0.00127204, 0.00105608, 0.000876652, 0.00072798, 0.00060492,</div>
<div class="line"><span class="lineno">  229</span>    0.000503201, 0.000419226, 0.000349896, 0.000292659, 0.000245421,</div>
<div class="line"><span class="lineno">  230</span>    0.000206394, 0.000174125, 0.000147441, 0.000125333, 0.000106985,</div>
<div class="line"><span class="lineno">  231</span>    9.173e-05, 7.90172e-05, 6.84172e-05, 5.95574e-05, 5.21183e-05,</div>
<div class="line"><span class="lineno">  232</span>    4.58348e-05, 4.05127e-05, 3.59987e-05, 3.21583e-05, 2.88718e-05,</div>
<div class="line"><span class="lineno">  233</span>    2.60322e-05, 2.35687e-05, 2.14263e-05, 1.95489e-05</div>
<div class="line"><span class="lineno">  234</span>  };</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> tem[121] = {</div>
<div class="line"><span class="lineno">  237</span>    285.14, 279.34, 273.91, 268.3, 263.24, 256.55, 250.2, 242.82, 236.17,</div>
<div class="line"><span class="lineno">  238</span>    229.87, 225.04, 221.19, 218.85, 217.19, 216.2, 215.68, 215.42, 215.55,</div>
<div class="line"><span class="lineno">  239</span>    215.92, 216.4, 216.93, 217.45, 218, 218.68, 219.39, 220.25, 221.3,</div>
<div class="line"><span class="lineno">  240</span>    222.41, 223.88, 225.42, 227.2, 229.52, 231.89, 234.51, 236.85, 239.42,</div>
<div class="line"><span class="lineno">  241</span>    241.94, 244.57, 247.36, 250.32, 253.34, 255.82, 258.27, 260.39,</div>
<div class="line"><span class="lineno">  242</span>    262.03, 263.45, 264.2, 264.78, 264.67, 264.38, 263.24, 262.03, 260.02,</div>
<div class="line"><span class="lineno">  243</span>    258.09, 255.63, 253.28, 250.43, 247.81, 245.26, 242.77, 240.38,</div>
<div class="line"><span class="lineno">  244</span>    237.94, 235.79, 233.53, 231.5, 229.53, 227.6, 225.62, 223.77, 222.06,</div>
<div class="line"><span class="lineno">  245</span>    220.33, 218.69, 217.18, 215.64, 214.13, 212.52, 210.86, 209.25,</div>
<div class="line"><span class="lineno">  246</span>    207.49, 205.81, 204.11, 202.22, 200.32, 198.39, 195.92, 193.46,</div>
<div class="line"><span class="lineno">  247</span>    190.94, 188.31, 185.82, 183.57, 181.43, 179.74, 178.64, 178.1, 178.25,</div>
<div class="line"><span class="lineno">  248</span>    178.7, 179.41, 180.67, 182.31, 184.18, 186.6, 189.53, 192.66, 196.54,</div>
<div class="line"><span class="lineno">  249</span>    201.13, 205.93, 211.73, 217.86, 225, 233.53, 242.57, 252.14, 261.48,</div>
<div class="line"><span class="lineno">  250</span>    272.97, 285.26, 299.12, 312.2, 324.17, 338.34, 352.56, 365.28</div>
<div class="line"><span class="lineno">  251</span>  };</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> c2h2[121] = {</div>
<div class="line"><span class="lineno">  254</span>    1.352e-09, 2.83e-10, 1.269e-10, 6.926e-11, 4.346e-11, 2.909e-11,</div>
<div class="line"><span class="lineno">  255</span>    2.014e-11, 1.363e-11, 8.71e-12, 5.237e-12, 2.718e-12, 1.375e-12,</div>
<div class="line"><span class="lineno">  256</span>    5.786e-13, 2.16e-13, 7.317e-14, 2.551e-14, 1.055e-14, 4.758e-15,</div>
<div class="line"><span class="lineno">  257</span>    2.056e-15, 7.703e-16, 2.82e-16, 1.035e-16, 4.382e-17, 1.946e-17,</div>
<div class="line"><span class="lineno">  258</span>    9.638e-18, 5.2e-18, 2.811e-18, 1.494e-18, 7.925e-19, 4.213e-19,</div>
<div class="line"><span class="lineno">  259</span>    1.998e-19, 8.78e-20, 3.877e-20, 1.728e-20, 7.743e-21, 3.536e-21,</div>
<div class="line"><span class="lineno">  260</span>    1.623e-21, 7.508e-22, 3.508e-22, 1.65e-22, 7.837e-23, 3.733e-23,</div>
<div class="line"><span class="lineno">  261</span>    1.808e-23, 8.77e-24, 4.285e-24, 2.095e-24, 1.032e-24, 5.082e-25,</div>
<div class="line"><span class="lineno">  262</span>    2.506e-25, 1.236e-25, 6.088e-26, 2.996e-26, 1.465e-26, 0, 0, 0,</div>
<div class="line"><span class="lineno">  263</span>    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div>
<div class="line"><span class="lineno">  264</span>    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div>
<div class="line"><span class="lineno">  265</span>    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0</div>
<div class="line"><span class="lineno">  266</span>  };</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> c2h6[121] = {</div>
<div class="line"><span class="lineno">  269</span>    2.667e-09, 2.02e-09, 1.658e-09, 1.404e-09, 1.234e-09, 1.109e-09,</div>
<div class="line"><span class="lineno">  270</span>    1.012e-09, 9.262e-10, 8.472e-10, 7.71e-10, 6.932e-10, 6.216e-10,</div>
<div class="line"><span class="lineno">  271</span>    5.503e-10, 4.87e-10, 4.342e-10, 3.861e-10, 3.347e-10, 2.772e-10,</div>
<div class="line"><span class="lineno">  272</span>    2.209e-10, 1.672e-10, 1.197e-10, 8.536e-11, 5.783e-11, 3.846e-11,</div>
<div class="line"><span class="lineno">  273</span>    2.495e-11, 1.592e-11, 1.017e-11, 6.327e-12, 3.895e-12, 2.403e-12,</div>
<div class="line"><span class="lineno">  274</span>    1.416e-12, 8.101e-13, 4.649e-13, 2.686e-13, 1.557e-13, 9.14e-14,</div>
<div class="line"><span class="lineno">  275</span>    5.386e-14, 3.19e-14, 1.903e-14, 1.14e-14, 6.875e-15, 4.154e-15,</div>
<div class="line"><span class="lineno">  276</span>    2.538e-15, 1.553e-15, 9.548e-16, 5.872e-16, 3.63e-16, 2.244e-16,</div>
<div class="line"><span class="lineno">  277</span>    1.388e-16, 8.587e-17, 5.308e-17, 3.279e-17, 2.017e-17, 1.238e-17,</div>
<div class="line"><span class="lineno">  278</span>    7.542e-18, 4.585e-18, 2.776e-18, 1.671e-18, 9.985e-19, 5.937e-19,</div>
<div class="line"><span class="lineno">  279</span>    3.518e-19, 2.07e-19, 1.215e-19, 7.06e-20, 4.097e-20, 2.37e-20,</div>
<div class="line"><span class="lineno">  280</span>    1.363e-20, 7.802e-21, 4.441e-21, 2.523e-21, 1.424e-21, 8.015e-22,</div>
<div class="line"><span class="lineno">  281</span>    4.497e-22, 2.505e-22, 1.391e-22, 7.691e-23, 4.238e-23, 2.331e-23,</div>
<div class="line"><span class="lineno">  282</span>    1.274e-23, 6.929e-24, 3.752e-24, 2.02e-24, 1.083e-24, 5.774e-25,</div>
<div class="line"><span class="lineno">  283</span>    3.041e-25, 1.593e-25, 8.308e-26, 4.299e-26, 2.195e-26, 1.112e-26,</div>
<div class="line"><span class="lineno">  284</span>    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div>
<div class="line"><span class="lineno">  285</span>    0, 0, 0, 0, 0, 0, 0, 0, 0</div>
<div class="line"><span class="lineno">  286</span>  };</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> ccl4[121] = {</div>
<div class="line"><span class="lineno">  289</span>    1.075e-10, 1.075e-10, 1.075e-10, 1.075e-10, 1.075e-10, 1.075e-10,</div>
<div class="line"><span class="lineno">  290</span>    1.075e-10, 1.075e-10, 1.075e-10, 1.06e-10, 1.024e-10, 9.69e-11,</div>
<div class="line"><span class="lineno">  291</span>    8.93e-11, 8.078e-11, 7.213e-11, 6.307e-11, 5.383e-11, 4.49e-11,</div>
<div class="line"><span class="lineno">  292</span>    3.609e-11, 2.705e-11, 1.935e-11, 1.385e-11, 8.35e-12, 5.485e-12,</div>
<div class="line"><span class="lineno">  293</span>    3.853e-12, 2.22e-12, 5.875e-13, 3.445e-13, 1.015e-13, 6.075e-14,</div>
<div class="line"><span class="lineno">  294</span>    4.383e-14, 2.692e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14,</div>
<div class="line"><span class="lineno">  295</span>    1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14,</div>
<div class="line"><span class="lineno">  296</span>    1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14,</div>
<div class="line"><span class="lineno">  297</span>    1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14,</div>
<div class="line"><span class="lineno">  298</span>    1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14,</div>
<div class="line"><span class="lineno">  299</span>    1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14,</div>
<div class="line"><span class="lineno">  300</span>    1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14,</div>
<div class="line"><span class="lineno">  301</span>    1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14,</div>
<div class="line"><span class="lineno">  302</span>    1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14, 1e-14,</div>
<div class="line"><span class="lineno">  303</span>    1e-14, 1e-14, 1e-14</div>
<div class="line"><span class="lineno">  304</span>  };</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> ch3oh[121] = {</div>
<div class="line"><span class="lineno">  307</span>    5.01099e-10, 5.01099e-10, 5.01099e-10, 5.01099e-10, 5.01099e-10,</div>
<div class="line"><span class="lineno">  308</span>    5.01099e-10, 5.50999e-10, 5.7313e-10, 5.75638e-10, 5.4086e-10,</div>
<div class="line"><span class="lineno">  309</span>    4.77601e-10, 4.12907e-10, 3.6274e-10, 3.26448e-10, 2.9706e-10,</div>
<div class="line"><span class="lineno">  310</span>    2.27698e-10, 1.96999e-10, 1.66212e-10, 1.17941e-10, 1.19844e-10,</div>
<div class="line"><span class="lineno">  311</span>    1.11211e-10, 1.02714e-10, 9.86138e-11, 9.45133e-11, 9.04127e-11,</div>
<div class="line"><span class="lineno">  312</span>    8.05243e-11, 6.3678e-11, 4.68317e-11, 4.00618e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  313</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  314</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  315</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  316</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  317</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  318</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  319</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  320</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  321</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  322</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  323</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  324</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  325</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  326</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  327</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  328</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  329</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  330</span>    3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11, 3.95786e-11,</div>
<div class="line"><span class="lineno">  331</span>    3.95786e-11</div>
<div class="line"><span class="lineno">  332</span>  };</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> ch4[121] = {</div>
<div class="line"><span class="lineno">  335</span>    1.864e-06, 1.835e-06, 1.819e-06, 1.805e-06, 1.796e-06, 1.788e-06,</div>
<div class="line"><span class="lineno">  336</span>    1.782e-06, 1.776e-06, 1.769e-06, 1.761e-06, 1.749e-06, 1.734e-06,</div>
<div class="line"><span class="lineno">  337</span>    1.716e-06, 1.692e-06, 1.654e-06, 1.61e-06, 1.567e-06, 1.502e-06,</div>
<div class="line"><span class="lineno">  338</span>    1.433e-06, 1.371e-06, 1.323e-06, 1.277e-06, 1.232e-06, 1.188e-06,</div>
<div class="line"><span class="lineno">  339</span>    1.147e-06, 1.108e-06, 1.07e-06, 1.027e-06, 9.854e-07, 9.416e-07,</div>
<div class="line"><span class="lineno">  340</span>    8.933e-07, 8.478e-07, 7.988e-07, 7.515e-07, 7.07e-07, 6.64e-07,</div>
<div class="line"><span class="lineno">  341</span>    6.239e-07, 5.864e-07, 5.512e-07, 5.184e-07, 4.87e-07, 4.571e-07,</div>
<div class="line"><span class="lineno">  342</span>    4.296e-07, 4.04e-07, 3.802e-07, 3.578e-07, 3.383e-07, 3.203e-07,</div>
<div class="line"><span class="lineno">  343</span>    3.032e-07, 2.889e-07, 2.76e-07, 2.635e-07, 2.519e-07, 2.409e-07,</div>
<div class="line"><span class="lineno">  344</span>    2.302e-07, 2.219e-07, 2.144e-07, 2.071e-07, 1.999e-07, 1.93e-07,</div>
<div class="line"><span class="lineno">  345</span>    1.862e-07, 1.795e-07, 1.731e-07, 1.668e-07, 1.607e-07, 1.548e-07,</div>
<div class="line"><span class="lineno">  346</span>    1.49e-07, 1.434e-07, 1.38e-07, 1.328e-07, 1.277e-07, 1.227e-07,</div>
<div class="line"><span class="lineno">  347</span>    1.18e-07, 1.134e-07, 1.089e-07, 1.046e-07, 1.004e-07, 9.635e-08,</div>
<div class="line"><span class="lineno">  348</span>    9.245e-08, 8.867e-08, 8.502e-08, 8.15e-08, 7.809e-08, 7.48e-08,</div>
<div class="line"><span class="lineno">  349</span>    7.159e-08, 6.849e-08, 6.55e-08, 6.262e-08, 5.98e-08, 5.708e-08,</div>
<div class="line"><span class="lineno">  350</span>    5.448e-08, 5.194e-08, 4.951e-08, 4.72e-08, 4.5e-08, 4.291e-08,</div>
<div class="line"><span class="lineno">  351</span>    4.093e-08, 3.905e-08, 3.729e-08, 3.563e-08, 3.408e-08, 3.265e-08,</div>
<div class="line"><span class="lineno">  352</span>    3.128e-08, 2.996e-08, 2.87e-08, 2.76e-08, 2.657e-08, 2.558e-08,</div>
<div class="line"><span class="lineno">  353</span>    2.467e-08, 2.385e-08, 2.307e-08, 2.234e-08, 2.168e-08, 2.108e-08,</div>
<div class="line"><span class="lineno">  354</span>    2.05e-08, 1.998e-08, 1.947e-08, 1.902e-08, 1.86e-08, 1.819e-08,</div>
<div class="line"><span class="lineno">  355</span>    1.782e-08</div>
<div class="line"><span class="lineno">  356</span>  };</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> clo[121] = {</div>
<div class="line"><span class="lineno">  359</span>    7.419e-15, 1.061e-14, 1.518e-14, 2.195e-14, 3.175e-14, 4.666e-14,</div>
<div class="line"><span class="lineno">  360</span>    6.872e-14, 1.03e-13, 1.553e-13, 2.375e-13, 3.664e-13, 5.684e-13,</div>
<div class="line"><span class="lineno">  361</span>    8.915e-13, 1.402e-12, 2.269e-12, 4.125e-12, 7.501e-12, 1.257e-11,</div>
<div class="line"><span class="lineno">  362</span>    2.048e-11, 3.338e-11, 5.44e-11, 8.846e-11, 1.008e-10, 1.082e-10,</div>
<div class="line"><span class="lineno">  363</span>    1.157e-10, 1.232e-10, 1.312e-10, 1.539e-10, 1.822e-10, 2.118e-10,</div>
<div class="line"><span class="lineno">  364</span>    2.387e-10, 2.687e-10, 2.875e-10, 3.031e-10, 3.23e-10, 3.648e-10,</div>
<div class="line"><span class="lineno">  365</span>    4.117e-10, 4.477e-10, 4.633e-10, 4.794e-10, 4.95e-10, 5.104e-10,</div>
<div class="line"><span class="lineno">  366</span>    5.259e-10, 5.062e-10, 4.742e-10, 4.443e-10, 4.051e-10, 3.659e-10,</div>
<div class="line"><span class="lineno">  367</span>    3.305e-10, 2.911e-10, 2.54e-10, 2.215e-10, 1.927e-10, 1.675e-10,</div>
<div class="line"><span class="lineno">  368</span>    1.452e-10, 1.259e-10, 1.09e-10, 9.416e-11, 8.119e-11, 6.991e-11,</div>
<div class="line"><span class="lineno">  369</span>    6.015e-11, 5.163e-11, 4.43e-11, 3.789e-11, 3.24e-11, 2.769e-11,</div>
<div class="line"><span class="lineno">  370</span>    2.361e-11, 2.011e-11, 1.71e-11, 1.453e-11, 1.233e-11, 1.045e-11,</div>
<div class="line"><span class="lineno">  371</span>    8.851e-12, 7.48e-12, 6.316e-12, 5.326e-12, 4.487e-12, 3.778e-12,</div>
<div class="line"><span class="lineno">  372</span>    3.176e-12, 2.665e-12, 2.234e-12, 1.87e-12, 1.563e-12, 1.304e-12,</div>
<div class="line"><span class="lineno">  373</span>    1.085e-12, 9.007e-13, 7.468e-13, 6.179e-13, 5.092e-13, 4.188e-13,</div>
<div class="line"><span class="lineno">  374</span>    3.442e-13, 2.816e-13, 2.304e-13, 1.885e-13, 1.542e-13, 1.263e-13,</div>
<div class="line"><span class="lineno">  375</span>    1.035e-13, 8.5e-14, 7.004e-14, 5.783e-14, 4.795e-14, 4.007e-14,</div>
<div class="line"><span class="lineno">  376</span>    3.345e-14, 2.792e-14, 2.33e-14, 1.978e-14, 1.686e-14, 1.438e-14,</div>
<div class="line"><span class="lineno">  377</span>    1.234e-14, 1.07e-14, 9.312e-15, 8.131e-15, 7.164e-15, 6.367e-15,</div>
<div class="line"><span class="lineno">  378</span>    5.67e-15, 5.088e-15, 4.565e-15, 4.138e-15, 3.769e-15, 3.432e-15,</div>
<div class="line"><span class="lineno">  379</span>    3.148e-15</div>
<div class="line"><span class="lineno">  380</span>  };</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> clono2[121] = {</div>
<div class="line"><span class="lineno">  383</span>    1.011e-13, 1.515e-13, 2.272e-13, 3.446e-13, 5.231e-13, 8.085e-13,</div>
<div class="line"><span class="lineno">  384</span>    1.253e-12, 1.979e-12, 3.149e-12, 5.092e-12, 8.312e-12, 1.366e-11,</div>
<div class="line"><span class="lineno">  385</span>    2.272e-11, 3.791e-11, 6.209e-11, 9.101e-11, 1.334e-10, 1.951e-10,</div>
<div class="line"><span class="lineno">  386</span>    2.853e-10, 3.94e-10, 4.771e-10, 5.771e-10, 6.675e-10, 7.665e-10,</div>
<div class="line"><span class="lineno">  387</span>    8.504e-10, 8.924e-10, 9.363e-10, 8.923e-10, 8.411e-10, 7.646e-10,</div>
<div class="line"><span class="lineno">  388</span>    6.525e-10, 5.576e-10, 4.398e-10, 3.403e-10, 2.612e-10, 1.915e-10,</div>
<div class="line"><span class="lineno">  389</span>    1.407e-10, 1.028e-10, 7.455e-11, 5.42e-11, 3.708e-11, 2.438e-11,</div>
<div class="line"><span class="lineno">  390</span>    1.618e-11, 1.075e-11, 7.17e-12, 4.784e-12, 3.205e-12, 2.147e-12,</div>
<div class="line"><span class="lineno">  391</span>    1.44e-12, 9.654e-13, 6.469e-13, 4.332e-13, 2.891e-13, 1.926e-13,</div>
<div class="line"><span class="lineno">  392</span>    1.274e-13, 8.422e-14, 5.547e-14, 3.636e-14, 2.368e-14, 1.536e-14,</div>
<div class="line"><span class="lineno">  393</span>    9.937e-15, 6.39e-15, 4.101e-15, 2.61e-15, 1.659e-15, 1.052e-15,</div>
<div class="line"><span class="lineno">  394</span>    6.638e-16, 4.172e-16, 2.61e-16, 1.63e-16, 1.013e-16, 6.275e-17,</div>
<div class="line"><span class="lineno">  395</span>    3.879e-17, 2.383e-17, 1.461e-17, 8.918e-18, 5.43e-18, 3.301e-18,</div>
<div class="line"><span class="lineno">  396</span>    1.997e-18, 1.203e-18, 7.216e-19, 4.311e-19, 2.564e-19, 1.519e-19,</div>
<div class="line"><span class="lineno">  397</span>    8.911e-20, 5.203e-20, 3.026e-20, 1.748e-20, 9.99e-21, 5.673e-21,</div>
<div class="line"><span class="lineno">  398</span>    3.215e-21, 1.799e-21, 1.006e-21, 5.628e-22, 3.146e-22, 1.766e-22,</div>
<div class="line"><span class="lineno">  399</span>    9.94e-23, 5.614e-23, 3.206e-23, 1.841e-23, 1.071e-23, 6.366e-24,</div>
<div class="line"><span class="lineno">  400</span>    3.776e-24, 2.238e-24, 1.326e-24, 8.253e-25, 5.201e-25, 3.279e-25,</div>
<div class="line"><span class="lineno">  401</span>    2.108e-25, 1.395e-25, 9.326e-26, 6.299e-26, 4.365e-26, 3.104e-26,</div>
<div class="line"><span class="lineno">  402</span>    2.219e-26, 1.621e-26, 1.185e-26, 8.92e-27, 6.804e-27, 5.191e-27,</div>
<div class="line"><span class="lineno">  403</span>    4.041e-27</div>
<div class="line"><span class="lineno">  404</span>  };</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> co[121] = {</div>
<div class="line"><span class="lineno">  407</span>    1.907e-07, 1.553e-07, 1.362e-07, 1.216e-07, 1.114e-07, 1.036e-07,</div>
<div class="line"><span class="lineno">  408</span>    9.737e-08, 9.152e-08, 8.559e-08, 7.966e-08, 7.277e-08, 6.615e-08,</div>
<div class="line"><span class="lineno">  409</span>    5.884e-08, 5.22e-08, 4.699e-08, 4.284e-08, 3.776e-08, 3.274e-08,</div>
<div class="line"><span class="lineno">  410</span>    2.845e-08, 2.479e-08, 2.246e-08, 2.054e-08, 1.991e-08, 1.951e-08,</div>
<div class="line"><span class="lineno">  411</span>    1.94e-08, 2.009e-08, 2.1e-08, 2.201e-08, 2.322e-08, 2.45e-08,</div>
<div class="line"><span class="lineno">  412</span>    2.602e-08, 2.73e-08, 2.867e-08, 2.998e-08, 3.135e-08, 3.255e-08,</div>
<div class="line"><span class="lineno">  413</span>    3.352e-08, 3.426e-08, 3.484e-08, 3.53e-08, 3.593e-08, 3.671e-08,</div>
<div class="line"><span class="lineno">  414</span>    3.759e-08, 3.945e-08, 4.192e-08, 4.49e-08, 5.03e-08, 5.703e-08,</div>
<div class="line"><span class="lineno">  415</span>    6.538e-08, 7.878e-08, 9.644e-08, 1.196e-07, 1.498e-07, 1.904e-07,</div>
<div class="line"><span class="lineno">  416</span>    2.422e-07, 3.055e-07, 3.804e-07, 4.747e-07, 5.899e-07, 7.272e-07,</div>
<div class="line"><span class="lineno">  417</span>    8.91e-07, 1.071e-06, 1.296e-06, 1.546e-06, 1.823e-06, 2.135e-06,</div>
<div class="line"><span class="lineno">  418</span>    2.44e-06, 2.714e-06, 2.967e-06, 3.189e-06, 3.391e-06, 3.58e-06,</div>
<div class="line"><span class="lineno">  419</span>    3.773e-06, 4.022e-06, 4.346e-06, 4.749e-06, 5.199e-06, 5.668e-06,</div>
<div class="line"><span class="lineno">  420</span>    6.157e-06, 6.688e-06, 7.254e-06, 7.867e-06, 8.539e-06, 9.26e-06,</div>
<div class="line"><span class="lineno">  421</span>    1.009e-05, 1.119e-05, 1.228e-05, 1.365e-05, 1.506e-05, 1.641e-05,</div>
<div class="line"><span class="lineno">  422</span>    1.784e-05, 1.952e-05, 2.132e-05, 2.323e-05, 2.531e-05, 2.754e-05,</div>
<div class="line"><span class="lineno">  423</span>    3.047e-05, 3.459e-05, 3.922e-05, 4.439e-05, 4.825e-05, 5.077e-05,</div>
<div class="line"><span class="lineno">  424</span>    5.34e-05, 5.618e-05, 5.909e-05, 6.207e-05, 6.519e-05, 6.845e-05,</div>
<div class="line"><span class="lineno">  425</span>    6.819e-05, 6.726e-05, 6.622e-05, 6.512e-05, 6.671e-05, 6.862e-05,</div>
<div class="line"><span class="lineno">  426</span>    7.048e-05, 7.264e-05, 7.3e-05, 7.3e-05, 7.3e-05, 7.3e-05, 7.3e-05</div>
<div class="line"><span class="lineno">  427</span>  };</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> cof2[121] = {</div>
<div class="line"><span class="lineno">  430</span>    7.5e-14, 1.055e-13, 1.485e-13, 2.111e-13, 3.001e-13, 4.333e-13,</div>
<div class="line"><span class="lineno">  431</span>    6.269e-13, 9.221e-13, 1.364e-12, 2.046e-12, 3.093e-12, 4.703e-12,</div>
<div class="line"><span class="lineno">  432</span>    7.225e-12, 1.113e-11, 1.66e-11, 2.088e-11, 2.626e-11, 3.433e-11,</div>
<div class="line"><span class="lineno">  433</span>    4.549e-11, 5.886e-11, 7.21e-11, 8.824e-11, 1.015e-10, 1.155e-10,</div>
<div class="line"><span class="lineno">  434</span>    1.288e-10, 1.388e-10, 1.497e-10, 1.554e-10, 1.606e-10, 1.639e-10,</div>
<div class="line"><span class="lineno">  435</span>    1.64e-10, 1.64e-10, 1.596e-10, 1.542e-10, 1.482e-10, 1.382e-10,</div>
<div class="line"><span class="lineno">  436</span>    1.289e-10, 1.198e-10, 1.109e-10, 1.026e-10, 9.484e-11, 8.75e-11,</div>
<div class="line"><span class="lineno">  437</span>    8.086e-11, 7.49e-11, 6.948e-11, 6.446e-11, 5.961e-11, 5.505e-11,</div>
<div class="line"><span class="lineno">  438</span>    5.085e-11, 4.586e-11, 4.1e-11, 3.665e-11, 3.235e-11, 2.842e-11,</div>
<div class="line"><span class="lineno">  439</span>    2.491e-11, 2.11e-11, 1.769e-11, 1.479e-11, 1.197e-11, 9.631e-12,</div>
<div class="line"><span class="lineno">  440</span>    7.74e-12, 6.201e-12, 4.963e-12, 3.956e-12, 3.151e-12, 2.507e-12,</div>
<div class="line"><span class="lineno">  441</span>    1.99e-12, 1.576e-12, 1.245e-12, 9.83e-13, 7.742e-13, 6.088e-13,</div>
<div class="line"><span class="lineno">  442</span>    4.782e-13, 3.745e-13, 2.929e-13, 2.286e-13, 1.782e-13, 1.388e-13,</div>
<div class="line"><span class="lineno">  443</span>    1.079e-13, 8.362e-14, 6.471e-14, 4.996e-14, 3.85e-14, 2.96e-14,</div>
<div class="line"><span class="lineno">  444</span>    2.265e-14, 1.729e-14, 1.317e-14, 9.998e-15, 7.549e-15, 5.683e-15,</div>
<div class="line"><span class="lineno">  445</span>    4.273e-15, 3.193e-15, 2.385e-15, 1.782e-15, 1.331e-15, 9.957e-16,</div>
<div class="line"><span class="lineno">  446</span>    7.461e-16, 5.601e-16, 4.228e-16, 3.201e-16, 2.438e-16, 1.878e-16,</div>
<div class="line"><span class="lineno">  447</span>    1.445e-16, 1.111e-16, 8.544e-17, 6.734e-17, 5.341e-17, 4.237e-17,</div>
<div class="line"><span class="lineno">  448</span>    3.394e-17, 2.759e-17, 2.254e-17, 1.851e-17, 1.54e-17, 1.297e-17,</div>
<div class="line"><span class="lineno">  449</span>    1.096e-17, 9.365e-18, 8e-18, 6.938e-18, 6.056e-18, 5.287e-18,</div>
<div class="line"><span class="lineno">  450</span>    4.662e-18</div>
<div class="line"><span class="lineno">  451</span>  };</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> f11[121] = {</div>
<div class="line"><span class="lineno">  454</span>    2.65e-10, 2.65e-10, 2.65e-10, 2.65e-10, 2.65e-10, 2.65e-10, 2.65e-10,</div>
<div class="line"><span class="lineno">  455</span>    2.65e-10, 2.65e-10, 2.65e-10, 2.65e-10, 2.65e-10, 2.635e-10, 2.536e-10,</div>
<div class="line"><span class="lineno">  456</span>    2.44e-10, 2.348e-10, 2.258e-10, 2.153e-10, 2.046e-10, 1.929e-10,</div>
<div class="line"><span class="lineno">  457</span>    1.782e-10, 1.648e-10, 1.463e-10, 1.291e-10, 1.1e-10, 8.874e-11,</div>
<div class="line"><span class="lineno">  458</span>    7.165e-11, 5.201e-11, 3.744e-11, 2.577e-11, 1.64e-11, 1.048e-11,</div>
<div class="line"><span class="lineno">  459</span>    5.993e-12, 3.345e-12, 1.839e-12, 9.264e-13, 4.688e-13, 2.329e-13,</div>
<div class="line"><span class="lineno">  460</span>    1.129e-13, 5.505e-14, 2.825e-14, 1.492e-14, 7.997e-15, 5.384e-15,</div>
<div class="line"><span class="lineno">  461</span>    3.988e-15, 2.955e-15, 2.196e-15, 1.632e-15, 1.214e-15, 9.025e-16,</div>
<div class="line"><span class="lineno">  462</span>    6.708e-16, 4.984e-16, 3.693e-16, 2.733e-16, 2.013e-16, 1.481e-16,</div>
<div class="line"><span class="lineno">  463</span>    1.087e-16, 7.945e-17, 5.782e-17, 4.195e-17, 3.038e-17, 2.19e-17,</div>
<div class="line"><span class="lineno">  464</span>    1.577e-17, 1.128e-17, 8.063e-18, 5.753e-18, 4.09e-18, 2.899e-18,</div>
<div class="line"><span class="lineno">  465</span>    2.048e-18, 1.444e-18, 1.015e-18, 7.12e-19, 4.985e-19, 3.474e-19,</div>
<div class="line"><span class="lineno">  466</span>    2.417e-19, 1.677e-19, 1.161e-19, 8.029e-20, 5.533e-20, 3.799e-20,</div>
<div class="line"><span class="lineno">  467</span>    2.602e-20, 1.776e-20, 1.209e-20, 8.202e-21, 5.522e-21, 3.707e-21,</div>
<div class="line"><span class="lineno">  468</span>    2.48e-21, 1.652e-21, 1.091e-21, 7.174e-22, 4.709e-22, 3.063e-22,</div>
<div class="line"><span class="lineno">  469</span>    1.991e-22, 1.294e-22, 8.412e-23, 5.483e-23, 3.581e-23, 2.345e-23,</div>
<div class="line"><span class="lineno">  470</span>    1.548e-23, 1.027e-23, 6.869e-24, 4.673e-24, 3.173e-24, 2.153e-24,</div>
<div class="line"><span class="lineno">  471</span>    1.461e-24, 1.028e-24, 7.302e-25, 5.188e-25, 3.739e-25, 2.753e-25,</div>
<div class="line"><span class="lineno">  472</span>    2.043e-25, 1.528e-25, 1.164e-25, 9.041e-26, 7.051e-26, 5.587e-26,</div>
<div class="line"><span class="lineno">  473</span>    4.428e-26, 3.588e-26, 2.936e-26, 2.402e-26, 1.995e-26</div>
<div class="line"><span class="lineno">  474</span>  };</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> f113[121] = {</div>
<div class="line"><span class="lineno">  477</span>    1.9e-11, 1.9e-11, 1.899e-11, 1.899e-11, 1.898e-11, 1.898e-11,</div>
<div class="line"><span class="lineno">  478</span>    1.897e-11, 1.896e-11, 1.895e-11, 1.894e-11, 1.893e-11, 1.89e-11,</div>
<div class="line"><span class="lineno">  479</span>    1.887e-11, 1.871e-11, 1.854e-11, 1.803e-11, 1.751e-11, 1.664e-11,</div>
<div class="line"><span class="lineno">  480</span>    1.576e-11, 1.466e-11, 1.356e-11, 1.236e-11, 1.116e-11, 9.931e-12,</div>
<div class="line"><span class="lineno">  481</span>    8.702e-12, 7.515e-12, 6.4238e-12, 5.3326e-12, 4.3652e-12, 3.5216e-12,</div>
<div class="line"><span class="lineno">  482</span>    2.678e-12, 2.1532e-12, 1.6284e-12, 1.2202e-12, 9.286e-13, 6.37e-13,</div>
<div class="line"><span class="lineno">  483</span>    4.95e-13, 3.53e-13, 2.5004e-13, 1.8612e-13, 1.222e-13, 9.704e-14,</div>
<div class="line"><span class="lineno">  484</span>    7.188e-14, 5.3338e-14, 4.1414e-14, 2.949e-14, 2.3722e-14, 1.7954e-14,</div>
<div class="line"><span class="lineno">  485</span>    1.37794e-14, 1.11982e-14, 8.617e-15, 7.6036e-15, 6.5902e-15,</div>
<div class="line"><span class="lineno">  486</span>    5.5768e-15, 4.5634e-15, 3.55e-15, 3.1008e-15, 2.6516e-15, 2.2024e-15,</div>
<div class="line"><span class="lineno">  487</span>    1.7532e-15, 1.304e-15, 1.1354e-15, 9.668e-16, 7.982e-16, 6.296e-16,</div>
<div class="line"><span class="lineno">  488</span>    4.61e-16, 3.9734e-16, 3.3368e-16, 2.7002e-16, 2.0636e-16, 1.427e-16,</div>
<div class="line"><span class="lineno">  489</span>    1.22804e-16, 1.02908e-16, 8.3012e-17, 6.3116e-17, 4.322e-17,</div>
<div class="line"><span class="lineno">  490</span>    3.6838e-17, 3.0456e-17, 2.4074e-17, 1.7692e-17, 1.131e-17,</div>
<div class="line"><span class="lineno">  491</span>    9.6202e-18, 7.9304e-18, 6.2406e-18, 4.5508e-18, 2.861e-18,</div>
<div class="line"><span class="lineno">  492</span>    2.40476e-18, 1.94852e-18, 1.49228e-18, 1.03604e-18, 5.798e-19,</div>
<div class="line"><span class="lineno">  493</span>    4.8502e-19, 3.9024e-19, 2.9546e-19, 2.0068e-19, 1.059e-19,</div>
<div class="line"><span class="lineno">  494</span>    8.7084e-20, 6.8268e-20, 4.9452e-20, 3.0636e-20, 1.182e-20,</div>
<div class="line"><span class="lineno">  495</span>    9.64344e-21, 7.46688e-21, 5.29032e-21, 3.11376e-21, 9.372e-22,</div>
<div class="line"><span class="lineno">  496</span>    7.5685e-22, 5.765e-22, 3.9615e-22, 2.158e-22, 3.545e-23,</div>
<div class="line"><span class="lineno">  497</span>    2.86046e-23, 2.17592e-23, 1.49138e-23, 8.0684e-24, 1.223e-24,</div>
<div class="line"><span class="lineno">  498</span>    9.92358e-25, 7.61716e-25, 5.31074e-25, 3.00432e-25, 6.979e-26</div>
<div class="line"><span class="lineno">  499</span>  };</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> f114[121] = {</div>
<div class="line"><span class="lineno">  502</span>    1.2e-11, 1.2e-11, 1.2e-11, 1.2e-11, 1.199e-11, 1.199e-11,</div>
<div class="line"><span class="lineno">  503</span>    1.199e-11, 1.199e-11, 1.198e-11, 1.198e-11, 1.198e-11, 1.197e-11,</div>
<div class="line"><span class="lineno">  504</span>    1.196e-11, 1.191e-11, 1.185e-11, 1.167e-11, 1.149e-11, 1.12e-11,</div>
<div class="line"><span class="lineno">  505</span>    1.09e-11, 1.053e-11, 1.015e-11, 9.731e-12, 9.311e-12, 8.865e-12,</div>
<div class="line"><span class="lineno">  506</span>    8.419e-12, 7.949e-12, 7.4774e-12, 7.0058e-12, 6.54e-12, 6.08e-12,</div>
<div class="line"><span class="lineno">  507</span>    5.62e-12, 5.1908e-12, 4.7616e-12, 4.3622e-12, 3.9926e-12, 3.623e-12,</div>
<div class="line"><span class="lineno">  508</span>    3.3274e-12, 3.0318e-12, 2.7702e-12, 2.5426e-12, 2.315e-12, 2.1514e-12,</div>
<div class="line"><span class="lineno">  509</span>    1.9878e-12, 1.8448e-12, 1.7224e-12, 1.6e-12, 1.51e-12, 1.42e-12,</div>
<div class="line"><span class="lineno">  510</span>    1.3462e-12, 1.2886e-12, 1.231e-12, 1.1922e-12, 1.1534e-12, 1.1146e-12,</div>
<div class="line"><span class="lineno">  511</span>    1.0758e-12, 1.037e-12, 1.0025e-12, 9.68e-13, 9.335e-13, 8.99e-13,</div>
<div class="line"><span class="lineno">  512</span>    8.645e-13, 8.344e-13, 8.043e-13, 7.742e-13, 7.441e-13, 7.14e-13,</div>
<div class="line"><span class="lineno">  513</span>    6.8718e-13, 6.6036e-13, 6.3354e-13, 6.0672e-13, 5.799e-13, 5.5612e-13,</div>
<div class="line"><span class="lineno">  514</span>    5.3234e-13, 5.0856e-13, 4.8478e-13, 4.61e-13, 4.394e-13, 4.178e-13,</div>
<div class="line"><span class="lineno">  515</span>    3.962e-13, 3.746e-13, 3.53e-13, 3.3288e-13, 3.1276e-13, 2.9264e-13,</div>
<div class="line"><span class="lineno">  516</span>    2.7252e-13, 2.524e-13, 2.3368e-13, 2.1496e-13, 1.9624e-13, 1.7752e-13,</div>
<div class="line"><span class="lineno">  517</span>    1.588e-13, 1.4221e-13, 1.2562e-13, 1.0903e-13, 9.244e-14, 7.585e-14,</div>
<div class="line"><span class="lineno">  518</span>    6.4942e-14, 5.4034e-14, 4.3126e-14, 3.2218e-14, 2.131e-14, 1.76694e-14,</div>
<div class="line"><span class="lineno">  519</span>    1.40288e-14, 1.03882e-14, 6.7476e-15, 3.107e-15, 2.52738e-15,</div>
<div class="line"><span class="lineno">  520</span>    1.94776e-15, 1.36814e-15, 7.8852e-16, 2.089e-16, 1.69288e-16,</div>
<div class="line"><span class="lineno">  521</span>    1.29676e-16, 9.0064e-17, 5.0452e-17, 1.084e-17, 8.85136e-18,</div>
<div class="line"><span class="lineno">  522</span>    6.86272e-18, 4.87408e-18, 2.88544e-18, 8.968e-19</div>
<div class="line"><span class="lineno">  523</span>  };</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> f12[121] = {</div>
<div class="line"><span class="lineno">  526</span>    5.45e-10, 5.45e-10, 5.45e-10, 5.45e-10, 5.45e-10, 5.45e-10, 5.45e-10,</div>
<div class="line"><span class="lineno">  527</span>    5.45e-10, 5.45e-10, 5.45e-10, 5.45e-10, 5.45e-10, 5.429e-10, 5.291e-10,</div>
<div class="line"><span class="lineno">  528</span>    5.155e-10, 5.022e-10, 4.893e-10, 4.772e-10, 4.655e-10, 4.497e-10,</div>
<div class="line"><span class="lineno">  529</span>    4.249e-10, 4.015e-10, 3.632e-10, 3.261e-10, 2.858e-10, 2.408e-10,</div>
<div class="line"><span class="lineno">  530</span>    2.03e-10, 1.685e-10, 1.4e-10, 1.163e-10, 9.65e-11, 8.02e-11, 6.705e-11,</div>
<div class="line"><span class="lineno">  531</span>    5.624e-11, 4.764e-11, 4.249e-11, 3.792e-11, 3.315e-11, 2.819e-11,</div>
<div class="line"><span class="lineno">  532</span>    2.4e-11, 1.999e-11, 1.64e-11, 1.352e-11, 1.14e-11, 9.714e-12,</div>
<div class="line"><span class="lineno">  533</span>    8.28e-12, 7.176e-12, 6.251e-12, 5.446e-12, 4.72e-12, 4.081e-12,</div>
<div class="line"><span class="lineno">  534</span>    3.528e-12, 3.08e-12, 2.699e-12, 2.359e-12, 2.111e-12, 1.901e-12,</div>
<div class="line"><span class="lineno">  535</span>    1.709e-12, 1.534e-12, 1.376e-12, 1.233e-12, 1.103e-12, 9.869e-13,</div>
<div class="line"><span class="lineno">  536</span>    8.808e-13, 7.859e-13, 7.008e-13, 6.241e-13, 5.553e-13, 4.935e-13,</div>
<div class="line"><span class="lineno">  537</span>    4.383e-13, 3.889e-13, 3.447e-13, 3.054e-13, 2.702e-13, 2.389e-13,</div>
<div class="line"><span class="lineno">  538</span>    2.11e-13, 1.862e-13, 1.643e-13, 1.448e-13, 1.274e-13, 1.121e-13,</div>
<div class="line"><span class="lineno">  539</span>    9.844e-14, 8.638e-14, 7.572e-14, 6.62e-14, 5.782e-14, 5.045e-14,</div>
<div class="line"><span class="lineno">  540</span>    4.394e-14, 3.817e-14, 3.311e-14, 2.87e-14, 2.48e-14, 2.142e-14,</div>
<div class="line"><span class="lineno">  541</span>    1.851e-14, 1.599e-14, 1.383e-14, 1.196e-14, 1.036e-14, 9e-15,</div>
<div class="line"><span class="lineno">  542</span>    7.828e-15, 6.829e-15, 5.992e-15, 5.254e-15, 4.606e-15, 4.037e-15,</div>
<div class="line"><span class="lineno">  543</span>    3.583e-15, 3.19e-15, 2.841e-15, 2.542e-15, 2.291e-15, 2.07e-15,</div>
<div class="line"><span class="lineno">  544</span>    1.875e-15, 1.71e-15, 1.57e-15, 1.442e-15, 1.333e-15, 1.232e-15,</div>
<div class="line"><span class="lineno">  545</span>    1.147e-15, 1.071e-15, 1.001e-15, 9.396e-16</div>
<div class="line"><span class="lineno">  546</span>  };</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> f14[121] = {</div>
<div class="line"><span class="lineno">  549</span>    9e-11, 9e-11, 9e-11, 9e-11, 9e-11, 9e-11, 9e-11, 9e-11, 9e-11, 9e-11,</div>
<div class="line"><span class="lineno">  550</span>    9e-11, 9e-11, 9e-11, 9e-11, 9e-11, 8.91e-11, 8.73e-11, 8.46e-11,</div>
<div class="line"><span class="lineno">  551</span>    8.19e-11, 7.92e-11, 7.74e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  552</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  553</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  554</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  555</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  556</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  557</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  558</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  559</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  560</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  561</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  562</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  563</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  564</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11,</div>
<div class="line"><span class="lineno">  565</span>    7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11, 7.65e-11</div>
<div class="line"><span class="lineno">  566</span>  };</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> f22[121] = {</div>
<div class="line"><span class="lineno">  569</span>    1.4e-10, 1.4e-10, 1.4e-10, 1.4e-10, 1.4e-10, 1.4e-10, 1.4e-10,</div>
<div class="line"><span class="lineno">  570</span>    1.4e-10, 1.4e-10, 1.4e-10, 1.372e-10, 1.317e-10, 1.235e-10, 1.153e-10,</div>
<div class="line"><span class="lineno">  571</span>    1.075e-10, 1.002e-10, 9.332e-11, 8.738e-11, 8.194e-11, 7.7e-11,</div>
<div class="line"><span class="lineno">  572</span>    7.165e-11, 6.753e-11, 6.341e-11, 5.971e-11, 5.6e-11, 5.229e-11,</div>
<div class="line"><span class="lineno">  573</span>    4.859e-11, 4.488e-11, 4.118e-11, 3.83e-11, 3.568e-11, 3.308e-11,</div>
<div class="line"><span class="lineno">  574</span>    3.047e-11, 2.82e-11, 2.594e-11, 2.409e-11, 2.237e-11, 2.065e-11,</div>
<div class="line"><span class="lineno">  575</span>    1.894e-11, 1.771e-11, 1.647e-11, 1.532e-11, 1.416e-11, 1.332e-11,</div>
<div class="line"><span class="lineno">  576</span>    1.246e-11, 1.161e-11, 1.087e-11, 1.017e-11, 9.471e-12, 8.853e-12,</div>
<div class="line"><span class="lineno">  577</span>    8.235e-12, 7.741e-12, 7.247e-12, 6.836e-12, 6.506e-12, 6.176e-12,</div>
<div class="line"><span class="lineno">  578</span>    5.913e-12, 5.65e-12, 5.419e-12, 5.221e-12, 5.024e-12, 4.859e-12,</div>
<div class="line"><span class="lineno">  579</span>    4.694e-12, 4.546e-12, 4.414e-12, 4.282e-12, 4.15e-12, 4.019e-12,</div>
<div class="line"><span class="lineno">  580</span>    3.903e-12, 3.805e-12, 3.706e-12, 3.607e-12, 3.508e-12, 3.41e-12,</div>
<div class="line"><span class="lineno">  581</span>    3.31e-12, 3.212e-12, 3.129e-12, 3.047e-12, 2.964e-12, 2.882e-12,</div>
<div class="line"><span class="lineno">  582</span>    2.8e-12, 2.734e-12, 2.668e-12, 2.602e-12, 2.537e-12, 2.471e-12,</div>
<div class="line"><span class="lineno">  583</span>    2.421e-12, 2.372e-12, 2.322e-12, 2.273e-12, 2.224e-12, 2.182e-12,</div>
<div class="line"><span class="lineno">  584</span>    2.141e-12, 2.1e-12, 2.059e-12, 2.018e-12, 1.977e-12, 1.935e-12,</div>
<div class="line"><span class="lineno">  585</span>    1.894e-12, 1.853e-12, 1.812e-12, 1.77e-12, 1.73e-12, 1.688e-12,</div>
<div class="line"><span class="lineno">  586</span>    1.647e-12, 1.606e-12, 1.565e-12, 1.524e-12, 1.483e-12, 1.441e-12,</div>
<div class="line"><span class="lineno">  587</span>    1.4e-12, 1.359e-12, 1.317e-12, 1.276e-12, 1.235e-12, 1.194e-12,</div>
<div class="line"><span class="lineno">  588</span>    1.153e-12, 1.112e-12, 1.071e-12, 1.029e-12, 9.883e-13</div>
<div class="line"><span class="lineno">  589</span>  };</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> h2co[121] = {</div>
<div class="line"><span class="lineno">  592</span>    8.71857e-11, 8.71857e-11, 8.71857e-11, 8.71857e-11, 8.71857e-11,</div>
<div class="line"><span class="lineno">  593</span>    8.71857e-11, 7.72315e-11, 6.85464e-11, 6.0758e-11, 5.32087e-11,</div>
<div class="line"><span class="lineno">  594</span>    4.5719e-11, 3.79458e-11, 3.07607e-11, 2.46025e-11, 1.94038e-11,</div>
<div class="line"><span class="lineno">  595</span>    1.40882e-11, 1.0623e-11, 8.35457e-12, 6.87427e-12, 7.09071e-12,</div>
<div class="line"><span class="lineno">  596</span>    8.96183e-12, 1.09012e-11, 1.50545e-11, 1.92077e-11, 2.3361e-11,</div>
<div class="line"><span class="lineno">  597</span>    2.7054e-11, 3.01936e-11, 3.33333e-11, 3.69281e-11, 4.08069e-11,</div>
<div class="line"><span class="lineno">  598</span>    4.57318e-11, 5.1348e-11, 5.69642e-11, 6.33173e-11, 6.98984e-11,</div>
<div class="line"><span class="lineno">  599</span>    7.63144e-11, 8.22774e-11, 8.82405e-11, 9.3746e-11, 9.92074e-11,</div>
<div class="line"><span class="lineno">  600</span>    1.04669e-10, 1.10055e-10, 1.15293e-10, 1.20531e-10, 1.26293e-10,</div>
<div class="line"><span class="lineno">  601</span>    1.32585e-10, 1.35966e-10, 1.36242e-10, 1.36519e-10, 1.61155e-10,</div>
<div class="line"><span class="lineno">  602</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  603</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  604</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  605</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  606</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  607</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  608</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  609</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  610</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  611</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  612</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  613</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  614</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  615</span>    1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10, 1.99157e-10,</div>
<div class="line"><span class="lineno">  616</span>    1.99157e-10</div>
<div class="line"><span class="lineno">  617</span>  };</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> h2o[121] = {</div>
<div class="line"><span class="lineno">  620</span>    0.01166, 0.008269, 0.005742, 0.003845, 0.00277, 0.001897, 0.001272,</div>
<div class="line"><span class="lineno">  621</span>    0.000827, 0.000539, 0.0003469, 0.0001579, 3.134e-05, 1.341e-05,</div>
<div class="line"><span class="lineno">  622</span>    6.764e-06, 4.498e-06, 3.703e-06, 3.724e-06, 3.899e-06, 4.002e-06,</div>
<div class="line"><span class="lineno">  623</span>    4.122e-06, 4.277e-06, 4.438e-06, 4.558e-06, 4.673e-06, 4.763e-06,</div>
<div class="line"><span class="lineno">  624</span>    4.809e-06, 4.856e-06, 4.936e-06, 5.021e-06, 5.114e-06, 5.222e-06,</div>
<div class="line"><span class="lineno">  625</span>    5.331e-06, 5.414e-06, 5.488e-06, 5.563e-06, 5.633e-06, 5.704e-06,</div>
<div class="line"><span class="lineno">  626</span>    5.767e-06, 5.819e-06, 5.872e-06, 5.914e-06, 5.949e-06, 5.984e-06,</div>
<div class="line"><span class="lineno">  627</span>    6.015e-06, 6.044e-06, 6.073e-06, 6.104e-06, 6.136e-06, 6.167e-06,</div>
<div class="line"><span class="lineno">  628</span>    6.189e-06, 6.208e-06, 6.226e-06, 6.212e-06, 6.185e-06, 6.158e-06,</div>
<div class="line"><span class="lineno">  629</span>    6.114e-06, 6.066e-06, 6.018e-06, 5.877e-06, 5.728e-06, 5.582e-06,</div>
<div class="line"><span class="lineno">  630</span>    5.437e-06, 5.296e-06, 5.156e-06, 5.02e-06, 4.886e-06, 4.754e-06,</div>
<div class="line"><span class="lineno">  631</span>    4.625e-06, 4.498e-06, 4.374e-06, 4.242e-06, 4.096e-06, 3.955e-06,</div>
<div class="line"><span class="lineno">  632</span>    3.817e-06, 3.683e-06, 3.491e-06, 3.204e-06, 2.94e-06, 2.696e-06,</div>
<div class="line"><span class="lineno">  633</span>    2.47e-06, 2.252e-06, 2.019e-06, 1.808e-06, 1.618e-06, 1.445e-06,</div>
<div class="line"><span class="lineno">  634</span>    1.285e-06, 1.105e-06, 9.489e-07, 8.121e-07, 6.938e-07, 5.924e-07,</div>
<div class="line"><span class="lineno">  635</span>    5.04e-07, 4.288e-07, 3.648e-07, 3.103e-07, 2.642e-07, 2.252e-07,</div>
<div class="line"><span class="lineno">  636</span>    1.921e-07, 1.643e-07, 1.408e-07, 1.211e-07, 1.048e-07, 9.063e-08,</div>
<div class="line"><span class="lineno">  637</span>    7.835e-08, 6.774e-08, 5.936e-08, 5.221e-08, 4.592e-08, 4.061e-08,</div>
<div class="line"><span class="lineno">  638</span>    3.62e-08, 3.236e-08, 2.902e-08, 2.62e-08, 2.383e-08, 2.171e-08,</div>
<div class="line"><span class="lineno">  639</span>    1.989e-08, 1.823e-08, 1.684e-08, 1.562e-08, 1.449e-08, 1.351e-08</div>
<div class="line"><span class="lineno">  640</span>  };</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> h2o2[121] = {</div>
<div class="line"><span class="lineno">  643</span>    1.779e-10, 7.938e-10, 8.953e-10, 8.032e-10, 6.564e-10, 5.159e-10,</div>
<div class="line"><span class="lineno">  644</span>    4.003e-10, 3.026e-10, 2.222e-10, 1.58e-10, 1.044e-10, 6.605e-11,</div>
<div class="line"><span class="lineno">  645</span>    3.413e-11, 1.453e-11, 1.062e-11, 1.009e-11, 9.597e-12, 1.175e-11,</div>
<div class="line"><span class="lineno">  646</span>    1.572e-11, 2.091e-11, 2.746e-11, 3.603e-11, 4.791e-11, 6.387e-11,</div>
<div class="line"><span class="lineno">  647</span>    8.239e-11, 1.007e-10, 1.23e-10, 1.363e-10, 1.489e-10, 1.585e-10,</div>
<div class="line"><span class="lineno">  648</span>    1.608e-10, 1.632e-10, 1.576e-10, 1.502e-10, 1.423e-10, 1.302e-10,</div>
<div class="line"><span class="lineno">  649</span>    1.192e-10, 1.085e-10, 9.795e-11, 8.854e-11, 8.057e-11, 7.36e-11,</div>
<div class="line"><span class="lineno">  650</span>    6.736e-11, 6.362e-11, 6.087e-11, 5.825e-11, 5.623e-11, 5.443e-11,</div>
<div class="line"><span class="lineno">  651</span>    5.27e-11, 5.098e-11, 4.931e-11, 4.769e-11, 4.611e-11, 4.458e-11,</div>
<div class="line"><span class="lineno">  652</span>    4.308e-11, 4.102e-11, 3.887e-11, 3.682e-11, 3.521e-11, 3.369e-11,</div>
<div class="line"><span class="lineno">  653</span>    3.224e-11, 3.082e-11, 2.946e-11, 2.814e-11, 2.687e-11, 2.566e-11,</div>
<div class="line"><span class="lineno">  654</span>    2.449e-11, 2.336e-11, 2.227e-11, 2.123e-11, 2.023e-11, 1.927e-11,</div>
<div class="line"><span class="lineno">  655</span>    1.835e-11, 1.746e-11, 1.661e-11, 1.58e-11, 1.502e-11, 1.428e-11,</div>
<div class="line"><span class="lineno">  656</span>    1.357e-11, 1.289e-11, 1.224e-11, 1.161e-11, 1.102e-11, 1.045e-11,</div>
<div class="line"><span class="lineno">  657</span>    9.895e-12, 9.369e-12, 8.866e-12, 8.386e-12, 7.922e-12, 7.479e-12,</div>
<div class="line"><span class="lineno">  658</span>    7.06e-12, 6.656e-12, 6.274e-12, 5.914e-12, 5.575e-12, 5.257e-12,</div>
<div class="line"><span class="lineno">  659</span>    4.959e-12, 4.679e-12, 4.42e-12, 4.178e-12, 3.954e-12, 3.75e-12,</div>
<div class="line"><span class="lineno">  660</span>    3.557e-12, 3.372e-12, 3.198e-12, 3.047e-12, 2.908e-12, 2.775e-12,</div>
<div class="line"><span class="lineno">  661</span>    2.653e-12, 2.544e-12, 2.442e-12, 2.346e-12, 2.26e-12, 2.183e-12,</div>
<div class="line"><span class="lineno">  662</span>    2.11e-12, 2.044e-12, 1.98e-12, 1.924e-12, 1.871e-12, 1.821e-12,</div>
<div class="line"><span class="lineno">  663</span>    1.775e-12</div>
<div class="line"><span class="lineno">  664</span>  };</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> hcl[121] = {</div>
<div class="line"><span class="lineno">  667</span>    3.70385e-11, 3.70385e-11, 3.70385e-11, 3.70385e-11, 3.70385e-11,</div>
<div class="line"><span class="lineno">  668</span>    3.70385e-11, 2.21247e-11, 1.88117e-11, 2.36957e-11, 3.72192e-11,</div>
<div class="line"><span class="lineno">  669</span>    5.79399e-11, 8.04158e-11, 1.01779e-10, 1.2301e-10, 1.53924e-10,</div>
<div class="line"><span class="lineno">  670</span>    1.93737e-10, 2.5561e-10, 3.84228e-10, 6.18248e-10, 6.31222e-10,</div>
<div class="line"><span class="lineno">  671</span>    7.84907e-10, 9.36932e-10, 1.03508e-09, 1.13323e-09, 1.23138e-09,</div>
<div class="line"><span class="lineno">  672</span>    1.31985e-09, 1.39669e-09, 1.47352e-09, 1.56375e-09, 1.66234e-09,</div>
<div class="line"><span class="lineno">  673</span>    1.78086e-09, 1.91256e-09, 2.04425e-09, 2.16629e-09, 2.28535e-09,</div>
<div class="line"><span class="lineno">  674</span>    2.39439e-09, 2.47597e-09, 2.55755e-09, 2.60873e-09, 2.65696e-09,</div>
<div class="line"><span class="lineno">  675</span>    2.70519e-09, 2.75658e-09, 2.81422e-09, 2.87187e-09, 2.94013e-09,</div>
<div class="line"><span class="lineno">  676</span>    3.01911e-09, 3.09497e-09, 3.16749e-09, 3.24001e-09, 3.30525e-09,</div>
<div class="line"><span class="lineno">  677</span>    3.3665e-09, 3.42424e-09, 3.4619e-09, 3.49956e-09, 3.52273e-09,</div>
<div class="line"><span class="lineno">  678</span>    3.54214e-09, 3.56154e-09, 3.57918e-09, 3.59049e-09, 3.6018e-09,</div>
<div class="line"><span class="lineno">  679</span>    3.6132e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  680</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  681</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  682</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  683</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  684</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  685</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  686</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  687</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  688</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  689</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  690</span>    3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09, 3.62476e-09,</div>
<div class="line"><span class="lineno">  691</span>    3.62476e-09</div>
<div class="line"><span class="lineno">  692</span>  };</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> hcn[121] = {</div>
<div class="line"><span class="lineno">  695</span>    5.5e-10, 5.5e-10, 5.5e-10, 5.5e-10, 5.5e-10, 5.5e-10, 5.5e-10,</div>
<div class="line"><span class="lineno">  696</span>    5.5e-10, 5.5e-10, 5.5e-10, 5.5e-10, 5.498e-10, 5.495e-10, 5.493e-10,</div>
<div class="line"><span class="lineno">  697</span>    5.49e-10, 5.488e-10, 4.717e-10, 3.946e-10, 3.174e-10, 2.4e-10,</div>
<div class="line"><span class="lineno">  698</span>    1.626e-10, 1.619e-10, 1.612e-10, 1.602e-10, 1.593e-10, 1.582e-10,</div>
<div class="line"><span class="lineno">  699</span>    1.572e-10, 1.56e-10, 1.549e-10, 1.539e-10, 1.53e-10, 1.519e-10,</div>
<div class="line"><span class="lineno">  700</span>    1.506e-10, 1.487e-10, 1.467e-10, 1.449e-10, 1.43e-10, 1.413e-10,</div>
<div class="line"><span class="lineno">  701</span>    1.397e-10, 1.382e-10, 1.368e-10, 1.354e-10, 1.337e-10, 1.315e-10,</div>
<div class="line"><span class="lineno">  702</span>    1.292e-10, 1.267e-10, 1.241e-10, 1.215e-10, 1.19e-10, 1.165e-10,</div>
<div class="line"><span class="lineno">  703</span>    1.141e-10, 1.118e-10, 1.096e-10, 1.072e-10, 1.047e-10, 1.021e-10,</div>
<div class="line"><span class="lineno">  704</span>    9.968e-11, 9.739e-11, 9.539e-11, 9.339e-11, 9.135e-11, 8.898e-11,</div>
<div class="line"><span class="lineno">  705</span>    8.664e-11, 8.439e-11, 8.249e-11, 8.075e-11, 7.904e-11, 7.735e-11,</div>
<div class="line"><span class="lineno">  706</span>    7.565e-11, 7.399e-11, 7.245e-11, 7.109e-11, 6.982e-11, 6.863e-11,</div>
<div class="line"><span class="lineno">  707</span>    6.755e-11, 6.657e-11, 6.587e-11, 6.527e-11, 6.476e-11, 6.428e-11,</div>
<div class="line"><span class="lineno">  708</span>    6.382e-11, 6.343e-11, 6.307e-11, 6.272e-11, 6.238e-11, 6.205e-11,</div>
<div class="line"><span class="lineno">  709</span>    6.17e-11, 6.137e-11, 6.102e-11, 6.072e-11, 6.046e-11, 6.03e-11,</div>
<div class="line"><span class="lineno">  710</span>    6.018e-11, 6.01e-11, 6.001e-11, 5.992e-11, 5.984e-11, 5.975e-11,</div>
<div class="line"><span class="lineno">  711</span>    5.967e-11, 5.958e-11, 5.95e-11, 5.941e-11, 5.933e-11, 5.925e-11,</div>
<div class="line"><span class="lineno">  712</span>    5.916e-11, 5.908e-11, 5.899e-11, 5.891e-11, 5.883e-11, 5.874e-11,</div>
<div class="line"><span class="lineno">  713</span>    5.866e-11, 5.858e-11, 5.85e-11, 5.841e-11, 5.833e-11, 5.825e-11,</div>
<div class="line"><span class="lineno">  714</span>    5.817e-11, 5.808e-11, 5.8e-11, 5.792e-11, 5.784e-11</div>
<div class="line"><span class="lineno">  715</span>  };</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> hf[121] = {</div>
<div class="line"><span class="lineno">  718</span>    2.64279e-11, 2.64279e-11, 2.64279e-11, 2.64279e-11, 2.64279e-11,</div>
<div class="line"><span class="lineno">  719</span>    2.64279e-11, 2.64279e-11, 2.64279e-11, 2.64279e-11, 2.64279e-11,</div>
<div class="line"><span class="lineno">  720</span>    2.64279e-11, 2.64279e-11, 2.64279e-11, 3.86691e-11, 5.22002e-11,</div>
<div class="line"><span class="lineno">  721</span>    6.92471e-11, 9.13979e-11, 1.37918e-10, 2.24918e-10, 2.29824e-10,</div>
<div class="line"><span class="lineno">  722</span>    2.94241e-10, 3.58363e-10, 4.12881e-10, 4.67399e-10, 5.21917e-10,</div>
<div class="line"><span class="lineno">  723</span>    5.74229e-10, 6.23889e-10, 6.73549e-10, 7.24119e-10, 7.75256e-10,</div>
<div class="line"><span class="lineno">  724</span>    8.319e-10, 8.92185e-10, 9.52469e-10, 1.01325e-09, 1.07419e-09,</div>
<div class="line"><span class="lineno">  725</span>    1.13565e-09, 1.19856e-09, 1.26146e-09, 1.31439e-09, 1.36635e-09,</div>
<div class="line"><span class="lineno">  726</span>    1.41831e-09, 1.46549e-09, 1.50321e-09, 1.54093e-09, 1.57986e-09,</div>
<div class="line"><span class="lineno">  727</span>    1.62e-09, 1.66286e-09, 1.70863e-09, 1.75439e-09, 1.79827e-09,</div>
<div class="line"><span class="lineno">  728</span>    1.84111e-09, 1.88125e-09, 1.90603e-09, 1.93081e-09, 1.9413e-09,</div>
<div class="line"><span class="lineno">  729</span>    1.94807e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  730</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  731</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  732</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  733</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  734</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  735</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  736</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  737</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  738</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  739</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  740</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  741</span>    1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09, 1.95485e-09,</div>
<div class="line"><span class="lineno">  742</span>    1.95485e-09</div>
<div class="line"><span class="lineno">  743</span>  };</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> hno3[121] = {</div>
<div class="line"><span class="lineno">  746</span>    1.809e-10, 7.234e-10, 5.899e-10, 4.342e-10, 3.277e-10, 2.661e-10,</div>
<div class="line"><span class="lineno">  747</span>    2.35e-10, 2.267e-10, 2.389e-10, 2.651e-10, 3.255e-10, 4.099e-10,</div>
<div class="line"><span class="lineno">  748</span>    5.42e-10, 6.978e-10, 8.807e-10, 1.112e-09, 1.405e-09, 2.04e-09,</div>
<div class="line"><span class="lineno">  749</span>    3.111e-09, 4.5e-09, 5.762e-09, 7.37e-09, 7.852e-09, 8.109e-09,</div>
<div class="line"><span class="lineno">  750</span>    8.067e-09, 7.554e-09, 7.076e-09, 6.268e-09, 5.524e-09, 4.749e-09,</div>
<div class="line"><span class="lineno">  751</span>    3.909e-09, 3.223e-09, 2.517e-09, 1.942e-09, 1.493e-09, 1.122e-09,</div>
<div class="line"><span class="lineno">  752</span>    8.449e-10, 6.361e-10, 4.787e-10, 3.611e-10, 2.804e-10, 2.215e-10,</div>
<div class="line"><span class="lineno">  753</span>    1.758e-10, 1.441e-10, 1.197e-10, 9.953e-11, 8.505e-11, 7.334e-11,</div>
<div class="line"><span class="lineno">  754</span>    6.325e-11, 5.625e-11, 5.058e-11, 4.548e-11, 4.122e-11, 3.748e-11,</div>
<div class="line"><span class="lineno">  755</span>    3.402e-11, 3.088e-11, 2.8e-11, 2.536e-11, 2.293e-11, 2.072e-11,</div>
<div class="line"><span class="lineno">  756</span>    1.871e-11, 1.687e-11, 1.52e-11, 1.368e-11, 1.23e-11, 1.105e-11,</div>
<div class="line"><span class="lineno">  757</span>    9.922e-12, 8.898e-12, 7.972e-12, 7.139e-12, 6.385e-12, 5.708e-12,</div>
<div class="line"><span class="lineno">  758</span>    5.099e-12, 4.549e-12, 4.056e-12, 3.613e-12, 3.216e-12, 2.862e-12,</div>
<div class="line"><span class="lineno">  759</span>    2.544e-12, 2.259e-12, 2.004e-12, 1.776e-12, 1.572e-12, 1.391e-12,</div>
<div class="line"><span class="lineno">  760</span>    1.227e-12, 1.082e-12, 9.528e-13, 8.379e-13, 7.349e-13, 6.436e-13,</div>
<div class="line"><span class="lineno">  761</span>    5.634e-13, 4.917e-13, 4.291e-13, 3.745e-13, 3.267e-13, 2.854e-13,</div>
<div class="line"><span class="lineno">  762</span>    2.494e-13, 2.181e-13, 1.913e-13, 1.68e-13, 1.479e-13, 1.31e-13,</div>
<div class="line"><span class="lineno">  763</span>    1.159e-13, 1.025e-13, 9.067e-14, 8.113e-14, 7.281e-14, 6.535e-14,</div>
<div class="line"><span class="lineno">  764</span>    5.892e-14, 5.348e-14, 4.867e-14, 4.439e-14, 4.073e-14, 3.76e-14,</div>
<div class="line"><span class="lineno">  765</span>    3.476e-14, 3.229e-14, 3e-14, 2.807e-14, 2.635e-14, 2.473e-14,</div>
<div class="line"><span class="lineno">  766</span>    2.332e-14</div>
<div class="line"><span class="lineno">  767</span>  };</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> hno4[121] = {</div>
<div class="line"><span class="lineno">  770</span>    6.118e-12, 3.594e-12, 2.807e-12, 3.04e-12, 4.458e-12, 7.986e-12,</div>
<div class="line"><span class="lineno">  771</span>    1.509e-11, 2.661e-11, 3.738e-11, 4.652e-11, 4.429e-11, 3.992e-11,</div>
<div class="line"><span class="lineno">  772</span>    3.347e-11, 3.005e-11, 3.173e-11, 4.055e-11, 5.812e-11, 8.489e-11,</div>
<div class="line"><span class="lineno">  773</span>    1.19e-10, 1.482e-10, 1.766e-10, 2.103e-10, 2.35e-10, 2.598e-10,</div>
<div class="line"><span class="lineno">  774</span>    2.801e-10, 2.899e-10, 3e-10, 2.817e-10, 2.617e-10, 2.332e-10,</div>
<div class="line"><span class="lineno">  775</span>    1.933e-10, 1.605e-10, 1.232e-10, 9.285e-11, 6.941e-11, 4.951e-11,</div>
<div class="line"><span class="lineno">  776</span>    3.539e-11, 2.402e-11, 1.522e-11, 9.676e-12, 6.056e-12, 3.745e-12,</div>
<div class="line"><span class="lineno">  777</span>    2.34e-12, 1.463e-12, 9.186e-13, 5.769e-13, 3.322e-13, 1.853e-13,</div>
<div class="line"><span class="lineno">  778</span>    1.035e-13, 7.173e-14, 5.382e-14, 4.036e-14, 3.401e-14, 2.997e-14,</div>
<div class="line"><span class="lineno">  779</span>    2.635e-14, 2.316e-14, 2.034e-14, 1.783e-14, 1.56e-14, 1.363e-14,</div>
<div class="line"><span class="lineno">  780</span>    1.19e-14, 1.037e-14, 9.032e-15, 7.846e-15, 6.813e-15, 5.912e-15,</div>
<div class="line"><span class="lineno">  781</span>    5.121e-15, 4.431e-15, 3.829e-15, 3.306e-15, 2.851e-15, 2.456e-15,</div>
<div class="line"><span class="lineno">  782</span>    2.114e-15, 1.816e-15, 1.559e-15, 1.337e-15, 1.146e-15, 9.811e-16,</div>
<div class="line"><span class="lineno">  783</span>    8.389e-16, 7.162e-16, 6.109e-16, 5.203e-16, 4.425e-16, 3.76e-16,</div>
<div class="line"><span class="lineno">  784</span>    3.184e-16, 2.692e-16, 2.274e-16, 1.917e-16, 1.61e-16, 1.35e-16,</div>
<div class="line"><span class="lineno">  785</span>    1.131e-16, 9.437e-17, 7.874e-17, 6.57e-17, 5.481e-17, 4.579e-17,</div>
<div class="line"><span class="lineno">  786</span>    3.828e-17, 3.204e-17, 2.691e-17, 2.264e-17, 1.912e-17, 1.626e-17,</div>
<div class="line"><span class="lineno">  787</span>    1.382e-17, 1.174e-17, 9.972e-18, 8.603e-18, 7.45e-18, 6.453e-18,</div>
<div class="line"><span class="lineno">  788</span>    5.623e-18, 4.944e-18, 4.361e-18, 3.859e-18, 3.443e-18, 3.096e-18,</div>
<div class="line"><span class="lineno">  789</span>    2.788e-18, 2.528e-18, 2.293e-18, 2.099e-18, 1.929e-18, 1.773e-18,</div>
<div class="line"><span class="lineno">  790</span>    1.64e-18</div>
<div class="line"><span class="lineno">  791</span>  };</div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> hocl[121] = {</div>
<div class="line"><span class="lineno">  794</span>    1.056e-12, 1.194e-12, 1.35e-12, 1.531e-12, 1.737e-12, 1.982e-12,</div>
<div class="line"><span class="lineno">  795</span>    2.263e-12, 2.599e-12, 2.991e-12, 3.459e-12, 4.012e-12, 4.662e-12,</div>
<div class="line"><span class="lineno">  796</span>    5.438e-12, 6.35e-12, 7.425e-12, 8.686e-12, 1.016e-11, 1.188e-11,</div>
<div class="line"><span class="lineno">  797</span>    1.389e-11, 1.659e-11, 2.087e-11, 2.621e-11, 3.265e-11, 4.064e-11,</div>
<div class="line"><span class="lineno">  798</span>    4.859e-11, 5.441e-11, 6.09e-11, 6.373e-11, 6.611e-11, 6.94e-11,</div>
<div class="line"><span class="lineno">  799</span>    7.44e-11, 7.97e-11, 8.775e-11, 9.722e-11, 1.064e-10, 1.089e-10,</div>
<div class="line"><span class="lineno">  800</span>    1.114e-10, 1.106e-10, 1.053e-10, 1.004e-10, 9.006e-11, 7.778e-11,</div>
<div class="line"><span class="lineno">  801</span>    6.739e-11, 5.636e-11, 4.655e-11, 3.845e-11, 3.042e-11, 2.368e-11,</div>
<div class="line"><span class="lineno">  802</span>    1.845e-11, 1.442e-11, 1.127e-11, 8.814e-12, 6.544e-12, 4.763e-12,</div>
<div class="line"><span class="lineno">  803</span>    3.449e-12, 2.612e-12, 1.999e-12, 1.526e-12, 1.16e-12, 8.793e-13,</div>
<div class="line"><span class="lineno">  804</span>    6.655e-13, 5.017e-13, 3.778e-13, 2.829e-13, 2.117e-13, 1.582e-13,</div>
<div class="line"><span class="lineno">  805</span>    1.178e-13, 8.755e-14, 6.486e-14, 4.799e-14, 3.54e-14, 2.606e-14,</div>
<div class="line"><span class="lineno">  806</span>    1.916e-14, 1.403e-14, 1.026e-14, 7.48e-15, 5.446e-15, 3.961e-15,</div>
<div class="line"><span class="lineno">  807</span>    2.872e-15, 2.076e-15, 1.498e-15, 1.077e-15, 7.726e-16, 5.528e-16,</div>
<div class="line"><span class="lineno">  808</span>    3.929e-16, 2.785e-16, 1.969e-16, 1.386e-16, 9.69e-17, 6.747e-17,</div>
<div class="line"><span class="lineno">  809</span>    4.692e-17, 3.236e-17, 2.232e-17, 1.539e-17, 1.061e-17, 7.332e-18,</div>
<div class="line"><span class="lineno">  810</span>    5.076e-18, 3.522e-18, 2.461e-18, 1.726e-18, 1.22e-18, 8.75e-19,</div>
<div class="line"><span class="lineno">  811</span>    6.264e-19, 4.482e-19, 3.207e-19, 2.368e-19, 1.762e-19, 1.312e-19,</div>
<div class="line"><span class="lineno">  812</span>    9.891e-20, 7.595e-20, 5.87e-20, 4.567e-20, 3.612e-20, 2.904e-20,</div>
<div class="line"><span class="lineno">  813</span>    2.343e-20, 1.917e-20, 1.568e-20, 1.308e-20, 1.1e-20, 9.25e-21,</div>
<div class="line"><span class="lineno">  814</span>    7.881e-21</div>
<div class="line"><span class="lineno">  815</span>  };</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> n2o[121] = {</div>
<div class="line"><span class="lineno">  818</span>    3.17e-07, 3.17e-07, 3.17e-07, 3.17e-07, 3.17e-07, 3.17e-07, 3.17e-07,</div>
<div class="line"><span class="lineno">  819</span>    3.17e-07, 3.17e-07, 3.17e-07, 3.124e-07, 3.077e-07, 3.03e-07,</div>
<div class="line"><span class="lineno">  820</span>    2.984e-07, 2.938e-07, 2.892e-07, 2.847e-07, 2.779e-07, 2.705e-07,</div>
<div class="line"><span class="lineno">  821</span>    2.631e-07, 2.557e-07, 2.484e-07, 2.345e-07, 2.201e-07, 2.01e-07,</div>
<div class="line"><span class="lineno">  822</span>    1.754e-07, 1.532e-07, 1.329e-07, 1.154e-07, 1.003e-07, 8.735e-08,</div>
<div class="line"><span class="lineno">  823</span>    7.617e-08, 6.512e-08, 5.547e-08, 4.709e-08, 3.915e-08, 3.259e-08,</div>
<div class="line"><span class="lineno">  824</span>    2.738e-08, 2.327e-08, 1.98e-08, 1.711e-08, 1.493e-08, 1.306e-08,</div>
<div class="line"><span class="lineno">  825</span>    1.165e-08, 1.049e-08, 9.439e-09, 8.375e-09, 7.391e-09, 6.525e-09,</div>
<div class="line"><span class="lineno">  826</span>    5.759e-09, 5.083e-09, 4.485e-09, 3.953e-09, 3.601e-09, 3.27e-09,</div>
<div class="line"><span class="lineno">  827</span>    2.975e-09, 2.757e-09, 2.556e-09, 2.37e-09, 2.195e-09, 2.032e-09,</div>
<div class="line"><span class="lineno">  828</span>    1.912e-09, 1.79e-09, 1.679e-09, 1.572e-09, 1.482e-09, 1.402e-09,</div>
<div class="line"><span class="lineno">  829</span>    1.326e-09, 1.254e-09, 1.187e-09, 1.127e-09, 1.071e-09, 1.02e-09,</div>
<div class="line"><span class="lineno">  830</span>    9.673e-10, 9.193e-10, 8.752e-10, 8.379e-10, 8.017e-10, 7.66e-10,</div>
<div class="line"><span class="lineno">  831</span>    7.319e-10, 7.004e-10, 6.721e-10, 6.459e-10, 6.199e-10, 5.942e-10,</div>
<div class="line"><span class="lineno">  832</span>    5.703e-10, 5.488e-10, 5.283e-10, 5.082e-10, 4.877e-10, 4.696e-10,</div>
<div class="line"><span class="lineno">  833</span>    4.52e-10, 4.355e-10, 4.198e-10, 4.039e-10, 3.888e-10, 3.754e-10,</div>
<div class="line"><span class="lineno">  834</span>    3.624e-10, 3.499e-10, 3.381e-10, 3.267e-10, 3.163e-10, 3.058e-10,</div>
<div class="line"><span class="lineno">  835</span>    2.959e-10, 2.864e-10, 2.77e-10, 2.686e-10, 2.604e-10, 2.534e-10,</div>
<div class="line"><span class="lineno">  836</span>    2.462e-10, 2.386e-10, 2.318e-10, 2.247e-10, 2.189e-10, 2.133e-10,</div>
<div class="line"><span class="lineno">  837</span>    2.071e-10, 2.014e-10, 1.955e-10, 1.908e-10, 1.86e-10, 1.817e-10</div>
<div class="line"><span class="lineno">  838</span>  };</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> n2o5[121] = {</div>
<div class="line"><span class="lineno">  841</span>    1.231e-11, 3.035e-12, 1.702e-12, 9.877e-13, 8.081e-13, 9.039e-13,</div>
<div class="line"><span class="lineno">  842</span>    1.169e-12, 1.474e-12, 1.651e-12, 1.795e-12, 1.998e-12, 2.543e-12,</div>
<div class="line"><span class="lineno">  843</span>    4.398e-12, 7.698e-12, 1.28e-11, 2.131e-11, 3.548e-11, 5.894e-11,</div>
<div class="line"><span class="lineno">  844</span>    7.645e-11, 1.089e-10, 1.391e-10, 1.886e-10, 2.386e-10, 2.986e-10,</div>
<div class="line"><span class="lineno">  845</span>    3.487e-10, 3.994e-10, 4.5e-10, 4.6e-10, 4.591e-10, 4.1e-10, 3.488e-10,</div>
<div class="line"><span class="lineno">  846</span>    2.846e-10, 2.287e-10, 1.696e-10, 1.011e-10, 6.428e-11, 4.324e-11,</div>
<div class="line"><span class="lineno">  847</span>    2.225e-11, 6.214e-12, 3.608e-12, 8.793e-13, 4.491e-13, 1.04e-13,</div>
<div class="line"><span class="lineno">  848</span>    6.1e-14, 3.436e-14, 6.671e-15, 1.171e-15, 5.848e-16, 1.212e-16,</div>
<div class="line"><span class="lineno">  849</span>    1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16,</div>
<div class="line"><span class="lineno">  850</span>    1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16,</div>
<div class="line"><span class="lineno">  851</span>    1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16,</div>
<div class="line"><span class="lineno">  852</span>    1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16,</div>
<div class="line"><span class="lineno">  853</span>    1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16,</div>
<div class="line"><span class="lineno">  854</span>    1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16,</div>
<div class="line"><span class="lineno">  855</span>    1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16, 1e-16,</div>
<div class="line"><span class="lineno">  856</span>    1e-16, 1e-16</div>
<div class="line"><span class="lineno">  857</span>  };</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> nh3[121] = {</div>
<div class="line"><span class="lineno">  860</span>    1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10,</div>
<div class="line"><span class="lineno">  861</span>    1e-10, 1e-10, 1e-10, 1e-10, 9.444e-11, 8.488e-11, 7.241e-11, 5.785e-11,</div>
<div class="line"><span class="lineno">  862</span>    4.178e-11, 3.018e-11, 2.18e-11, 1.574e-11, 1.137e-11, 8.211e-12,</div>
<div class="line"><span class="lineno">  863</span>    5.973e-12, 4.327e-12, 3.118e-12, 2.234e-12, 1.573e-12, 1.04e-12,</div>
<div class="line"><span class="lineno">  864</span>    6.762e-13, 4.202e-13, 2.406e-13, 1.335e-13, 6.938e-14, 3.105e-14,</div>
<div class="line"><span class="lineno">  865</span>    1.609e-14, 1.033e-14, 6.432e-15, 4.031e-15, 2.555e-15, 1.656e-15,</div>
<div class="line"><span class="lineno">  866</span>    1.115e-15, 7.904e-16, 5.63e-16, 4.048e-16, 2.876e-16, 2.004e-16,</div>
<div class="line"><span class="lineno">  867</span>    1.356e-16, 9.237e-17, 6.235e-17, 4.223e-17, 3.009e-17, 2.328e-17,</div>
<div class="line"><span class="lineno">  868</span>    2.002e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  869</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  870</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  871</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  872</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  873</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  874</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  875</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  876</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  877</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  878</span>    1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17, 1.914e-17,</div>
<div class="line"><span class="lineno">  879</span>    1.914e-17</div>
<div class="line"><span class="lineno">  880</span>  };</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> no[121] = {</div>
<div class="line"><span class="lineno">  883</span>    2.586e-10, 4.143e-11, 1.566e-11, 9.591e-12, 8.088e-12, 8.462e-12,</div>
<div class="line"><span class="lineno">  884</span>    1.013e-11, 1.328e-11, 1.855e-11, 2.678e-11, 3.926e-11, 5.464e-11,</div>
<div class="line"><span class="lineno">  885</span>    7.012e-11, 8.912e-11, 1.127e-10, 1.347e-10, 1.498e-10, 1.544e-10,</div>
<div class="line"><span class="lineno">  886</span>    1.602e-10, 1.824e-10, 2.078e-10, 2.366e-10, 2.691e-10, 5.141e-10,</div>
<div class="line"><span class="lineno">  887</span>    8.259e-10, 1.254e-09, 1.849e-09, 2.473e-09, 3.294e-09, 4.16e-09,</div>
<div class="line"><span class="lineno">  888</span>    5.095e-09, 6.11e-09, 6.93e-09, 7.888e-09, 8.903e-09, 9.713e-09,</div>
<div class="line"><span class="lineno">  889</span>    1.052e-08, 1.115e-08, 1.173e-08, 1.21e-08, 1.228e-08, 1.239e-08,</div>
<div class="line"><span class="lineno">  890</span>    1.231e-08, 1.213e-08, 1.192e-08, 1.138e-08, 1.085e-08, 1.008e-08,</div>
<div class="line"><span class="lineno">  891</span>    9.224e-09, 8.389e-09, 7.262e-09, 6.278e-09, 5.335e-09, 4.388e-09,</div>
<div class="line"><span class="lineno">  892</span>    3.589e-09, 2.761e-09, 2.129e-09, 1.633e-09, 1.243e-09, 9.681e-10,</div>
<div class="line"><span class="lineno">  893</span>    8.355e-10, 7.665e-10, 7.442e-10, 8.584e-10, 9.732e-10, 1.063e-09,</div>
<div class="line"><span class="lineno">  894</span>    1.163e-09, 1.286e-09, 1.472e-09, 1.707e-09, 2.032e-09, 2.474e-09,</div>
<div class="line"><span class="lineno">  895</span>    2.977e-09, 3.506e-09, 4.102e-09, 5.013e-09, 6.493e-09, 8.414e-09,</div>
<div class="line"><span class="lineno">  896</span>    1.077e-08, 1.367e-08, 1.777e-08, 2.625e-08, 3.926e-08, 5.545e-08,</div>
<div class="line"><span class="lineno">  897</span>    7.195e-08, 9.464e-08, 1.404e-07, 2.183e-07, 3.329e-07, 4.535e-07,</div>
<div class="line"><span class="lineno">  898</span>    6.158e-07, 8.187e-07, 1.075e-06, 1.422e-06, 1.979e-06, 2.71e-06,</div>
<div class="line"><span class="lineno">  899</span>    3.58e-06, 4.573e-06, 5.951e-06, 7.999e-06, 1.072e-05, 1.372e-05,</div>
<div class="line"><span class="lineno">  900</span>    1.697e-05, 2.112e-05, 2.643e-05, 3.288e-05, 3.994e-05, 4.794e-05,</div>
<div class="line"><span class="lineno">  901</span>    5.606e-05, 6.383e-05, 7.286e-05, 8.156e-05, 8.883e-05, 9.469e-05,</div>
<div class="line"><span class="lineno">  902</span>    9.848e-05, 0.0001023, 0.0001066, 0.0001115, 0.0001145, 0.0001142,</div>
<div class="line"><span class="lineno">  903</span>    0.0001133</div>
<div class="line"><span class="lineno">  904</span>  };</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> no2[121] = {</div>
<div class="line"><span class="lineno">  907</span>    3.036e-09, 2.945e-10, 9.982e-11, 5.069e-11, 3.485e-11, 2.982e-11,</div>
<div class="line"><span class="lineno">  908</span>    2.947e-11, 3.164e-11, 3.714e-11, 4.586e-11, 6.164e-11, 8.041e-11,</div>
<div class="line"><span class="lineno">  909</span>    9.982e-11, 1.283e-10, 1.73e-10, 2.56e-10, 3.909e-10, 5.959e-10,</div>
<div class="line"><span class="lineno">  910</span>    9.081e-10, 1.384e-09, 1.788e-09, 2.189e-09, 2.686e-09, 3.091e-09,</div>
<div class="line"><span class="lineno">  911</span>    3.49e-09, 3.796e-09, 4.2e-09, 5.103e-09, 6.005e-09, 6.3e-09, 6.706e-09,</div>
<div class="line"><span class="lineno">  912</span>    7.07e-09, 7.434e-09, 7.663e-09, 7.788e-09, 7.8e-09, 7.597e-09,</div>
<div class="line"><span class="lineno">  913</span>    7.482e-09, 7.227e-09, 6.403e-09, 5.585e-09, 4.606e-09, 3.703e-09,</div>
<div class="line"><span class="lineno">  914</span>    2.984e-09, 2.183e-09, 1.48e-09, 8.441e-10, 5.994e-10, 3.799e-10,</div>
<div class="line"><span class="lineno">  915</span>    2.751e-10, 1.927e-10, 1.507e-10, 1.102e-10, 6.971e-11, 5.839e-11,</div>
<div class="line"><span class="lineno">  916</span>    3.904e-11, 3.087e-11, 2.176e-11, 1.464e-11, 1.209e-11, 8.497e-12,</div>
<div class="line"><span class="lineno">  917</span>    6.477e-12, 4.371e-12, 2.914e-12, 2.424e-12, 1.753e-12, 1.35e-12,</div>
<div class="line"><span class="lineno">  918</span>    9.417e-13, 6.622e-13, 5.148e-13, 3.841e-13, 3.446e-13, 3.01e-13,</div>
<div class="line"><span class="lineno">  919</span>    2.551e-13, 2.151e-13, 1.829e-13, 1.64e-13, 1.475e-13, 1.352e-13,</div>
<div class="line"><span class="lineno">  920</span>    1.155e-13, 9.963e-14, 9.771e-14, 9.577e-14, 9.384e-14, 9.186e-14,</div>
<div class="line"><span class="lineno">  921</span>    9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14,</div>
<div class="line"><span class="lineno">  922</span>    9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14,</div>
<div class="line"><span class="lineno">  923</span>    9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14,</div>
<div class="line"><span class="lineno">  924</span>    9e-14, 9e-14, 9e-14, 9e-14, 9e-14, 9e-14</div>
<div class="line"><span class="lineno">  925</span>  };</div>
<div class="line"><span class="lineno">  926</span> </div>
<div class="line"><span class="lineno">  927</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> o3[121] = {</div>
<div class="line"><span class="lineno">  928</span>    2.218e-08, 3.394e-08, 3.869e-08, 4.219e-08, 4.501e-08, 4.778e-08,</div>
<div class="line"><span class="lineno">  929</span>    5.067e-08, 5.402e-08, 5.872e-08, 6.521e-08, 7.709e-08, 9.461e-08,</div>
<div class="line"><span class="lineno">  930</span>    1.269e-07, 1.853e-07, 2.723e-07, 3.964e-07, 5.773e-07, 8.2e-07,</div>
<div class="line"><span class="lineno">  931</span>    1.155e-06, 1.59e-06, 2.076e-06, 2.706e-06, 3.249e-06, 3.848e-06,</div>
<div class="line"><span class="lineno">  932</span>    4.459e-06, 4.986e-06, 5.573e-06, 5.958e-06, 6.328e-06, 6.661e-06,</div>
<div class="line"><span class="lineno">  933</span>    6.9e-06, 7.146e-06, 7.276e-06, 7.374e-06, 7.447e-06, 7.383e-06,</div>
<div class="line"><span class="lineno">  934</span>    7.321e-06, 7.161e-06, 6.879e-06, 6.611e-06, 6.216e-06, 5.765e-06,</div>
<div class="line"><span class="lineno">  935</span>    5.355e-06, 4.905e-06, 4.471e-06, 4.075e-06, 3.728e-06, 3.413e-06,</div>
<div class="line"><span class="lineno">  936</span>    3.125e-06, 2.856e-06, 2.607e-06, 2.379e-06, 2.17e-06, 1.978e-06,</div>
<div class="line"><span class="lineno">  937</span>    1.8e-06, 1.646e-06, 1.506e-06, 1.376e-06, 1.233e-06, 1.102e-06,</div>
<div class="line"><span class="lineno">  938</span>    9.839e-07, 8.771e-07, 7.814e-07, 6.947e-07, 6.102e-07, 5.228e-07,</div>
<div class="line"><span class="lineno">  939</span>    4.509e-07, 3.922e-07, 3.501e-07, 3.183e-07, 2.909e-07, 2.686e-07,</div>
<div class="line"><span class="lineno">  940</span>    2.476e-07, 2.284e-07, 2.109e-07, 2.003e-07, 2.013e-07, 2.022e-07,</div>
<div class="line"><span class="lineno">  941</span>    2.032e-07, 2.042e-07, 2.097e-07, 2.361e-07, 2.656e-07, 2.989e-07,</div>
<div class="line"><span class="lineno">  942</span>    3.37e-07, 3.826e-07, 4.489e-07, 5.26e-07, 6.189e-07, 7.312e-07,</div>
<div class="line"><span class="lineno">  943</span>    8.496e-07, 8.444e-07, 8.392e-07, 8.339e-07, 8.286e-07, 8.234e-07,</div>
<div class="line"><span class="lineno">  944</span>    8.181e-07, 8.129e-07, 8.077e-07, 8.026e-07, 6.918e-07, 5.176e-07,</div>
<div class="line"><span class="lineno">  945</span>    3.865e-07, 2.885e-07, 2.156e-07, 1.619e-07, 1.219e-07, 9.161e-08,</div>
<div class="line"><span class="lineno">  946</span>    6.972e-08, 5.399e-08, 3.498e-08, 2.111e-08, 1.322e-08, 8.482e-09,</div>
<div class="line"><span class="lineno">  947</span>    5.527e-09, 3.423e-09, 2.071e-09, 1.314e-09, 8.529e-10, 5.503e-10,</div>
<div class="line"><span class="lineno">  948</span>    3.665e-10</div>
<div class="line"><span class="lineno">  949</span>  };</div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> ocs[121] = {</div>
<div class="line"><span class="lineno">  952</span>    6e-10, 6e-10, 6e-10, 6e-10, 6e-10, 6e-10, 6e-10, 6e-10, 6e-10, 5.997e-10,</div>
<div class="line"><span class="lineno">  953</span>    5.989e-10, 5.881e-10, 5.765e-10, 5.433e-10, 5.074e-10, 4.567e-10,</div>
<div class="line"><span class="lineno">  954</span>    4.067e-10, 3.601e-10, 3.093e-10, 2.619e-10, 2.232e-10, 1.805e-10,</div>
<div class="line"><span class="lineno">  955</span>    1.46e-10, 1.187e-10, 8.03e-11, 5.435e-11, 3.686e-11, 2.217e-11,</div>
<div class="line"><span class="lineno">  956</span>    1.341e-11, 8.756e-12, 4.511e-12, 2.37e-12, 1.264e-12, 8.28e-13,</div>
<div class="line"><span class="lineno">  957</span>    5.263e-13, 3.209e-13, 1.717e-13, 9.068e-14, 4.709e-14, 2.389e-14,</div>
<div class="line"><span class="lineno">  958</span>    1.236e-14, 1.127e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  959</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  960</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  961</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  962</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  963</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  964</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  965</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  966</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  967</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  968</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  969</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  970</span>    1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14, 1.091e-14,</div>
<div class="line"><span class="lineno">  971</span>    1.091e-14, 1.091e-14, 1.091e-14</div>
<div class="line"><span class="lineno">  972</span>  };</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> sf6[121] = {</div>
<div class="line"><span class="lineno">  975</span>    4.103e-12, 4.103e-12, 4.103e-12, 4.103e-12, 4.103e-12, 4.103e-12,</div>
<div class="line"><span class="lineno">  976</span>    4.103e-12, 4.103e-12, 4.103e-12, 4.087e-12, 4.064e-12, 4.023e-12,</div>
<div class="line"><span class="lineno">  977</span>    3.988e-12, 3.941e-12, 3.884e-12, 3.755e-12, 3.622e-12, 3.484e-12,</div>
<div class="line"><span class="lineno">  978</span>    3.32e-12, 3.144e-12, 2.978e-12, 2.811e-12, 2.653e-12, 2.489e-12,</div>
<div class="line"><span class="lineno">  979</span>    2.332e-12, 2.199e-12, 2.089e-12, 2.013e-12, 1.953e-12, 1.898e-12,</div>
<div class="line"><span class="lineno">  980</span>    1.859e-12, 1.826e-12, 1.798e-12, 1.776e-12, 1.757e-12, 1.742e-12,</div>
<div class="line"><span class="lineno">  981</span>    1.728e-12, 1.717e-12, 1.707e-12, 1.698e-12, 1.691e-12, 1.685e-12,</div>
<div class="line"><span class="lineno">  982</span>    1.679e-12, 1.675e-12, 1.671e-12, 1.668e-12, 1.665e-12, 1.663e-12,</div>
<div class="line"><span class="lineno">  983</span>    1.661e-12, 1.659e-12, 1.658e-12, 1.657e-12, 1.656e-12, 1.655e-12,</div>
<div class="line"><span class="lineno">  984</span>    1.654e-12, 1.653e-12, 1.653e-12, 1.652e-12, 1.652e-12, 1.652e-12,</div>
<div class="line"><span class="lineno">  985</span>    1.651e-12, 1.651e-12, 1.651e-12, 1.651e-12, 1.651e-12, 1.651e-12,</div>
<div class="line"><span class="lineno">  986</span>    1.651e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12,</div>
<div class="line"><span class="lineno">  987</span>    1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12,</div>
<div class="line"><span class="lineno">  988</span>    1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12,</div>
<div class="line"><span class="lineno">  989</span>    1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12,</div>
<div class="line"><span class="lineno">  990</span>    1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12,</div>
<div class="line"><span class="lineno">  991</span>    1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12,</div>
<div class="line"><span class="lineno">  992</span>    1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12,</div>
<div class="line"><span class="lineno">  993</span>    1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12, 1.65e-12</div>
<div class="line"><span class="lineno">  994</span>  };</div>
<div class="line"><span class="lineno">  995</span> </div>
<div class="line"><span class="lineno">  996</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> so2[121] = {</div>
<div class="line"><span class="lineno">  997</span>    1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10, 1e-10,</div>
<div class="line"><span class="lineno">  998</span>    1e-10, 1e-10, 9.867e-11, 9.537e-11, 9e-11, 8.404e-11, 7.799e-11,</div>
<div class="line"><span class="lineno">  999</span>    7.205e-11, 6.616e-11, 6.036e-11, 5.475e-11, 5.007e-11, 4.638e-11,</div>
<div class="line"><span class="lineno"> 1000</span>    4.346e-11, 4.055e-11, 3.763e-11, 3.471e-11, 3.186e-11, 2.905e-11,</div>
<div class="line"><span class="lineno"> 1001</span>    2.631e-11, 2.358e-11, 2.415e-11, 2.949e-11, 3.952e-11, 5.155e-11,</div>
<div class="line"><span class="lineno"> 1002</span>    6.76e-11, 8.741e-11, 1.099e-10, 1.278e-10, 1.414e-10, 1.512e-10,</div>
<div class="line"><span class="lineno"> 1003</span>    1.607e-10, 1.699e-10, 1.774e-10, 1.832e-10, 1.871e-10, 1.907e-10,</div>
<div class="line"><span class="lineno"> 1004</span>    1.943e-10, 1.974e-10, 1.993e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10,</div>
<div class="line"><span class="lineno"> 1005</span>    2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10,</div>
<div class="line"><span class="lineno"> 1006</span>    2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10,</div>
<div class="line"><span class="lineno"> 1007</span>    2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10,</div>
<div class="line"><span class="lineno"> 1008</span>    2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10,</div>
<div class="line"><span class="lineno"> 1009</span>    2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10,</div>
<div class="line"><span class="lineno"> 1010</span>    2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10,</div>
<div class="line"><span class="lineno"> 1011</span>    2e-10, 2e-10, 2e-10, 2e-10, 2e-10, 2e-10</div>
<div class="line"><span class="lineno"> 1012</span>  };</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> *q[<a class="code hl_define" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a>] = { NULL };</div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span>  <span class="comment">/* Identify variable... */</span></div>
<div class="line"><span class="lineno"> 1017</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 1018</span>    q[ig] = NULL;</div>
<div class="line"><span class="lineno"> 1019</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;C2H2&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1020</span>      q[ig] = c2h2;</div>
<div class="line"><span class="lineno"> 1021</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;C2H6&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1022</span>      q[ig] = c2h6;</div>
<div class="line"><span class="lineno"> 1023</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;CCl4&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1024</span>      q[ig] = ccl4;</div>
<div class="line"><span class="lineno"> 1025</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;CH3OH&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1026</span>      q[ig] = ch3oh;</div>
<div class="line"><span class="lineno"> 1027</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;CH4&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1028</span>      q[ig] = ch4;</div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;ClO&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1030</span>      q[ig] = clo;</div>
<div class="line"><span class="lineno"> 1031</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;ClONO2&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1032</span>      q[ig] = clono2;</div>
<div class="line"><span class="lineno"> 1033</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;CO&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1034</span>      q[ig] = co;</div>
<div class="line"><span class="lineno"> 1035</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;COF2&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1036</span>      q[ig] = cof2;</div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;F11&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1038</span>      q[ig] = f11;</div>
<div class="line"><span class="lineno"> 1039</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;F113&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1040</span>      q[ig] = f113;</div>
<div class="line"><span class="lineno"> 1041</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;F114&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1042</span>      q[ig] = f114;</div>
<div class="line"><span class="lineno"> 1043</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;F12&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1044</span>      q[ig] = f12;</div>
<div class="line"><span class="lineno"> 1045</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;F14&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1046</span>      q[ig] = f14;</div>
<div class="line"><span class="lineno"> 1047</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;F22&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1048</span>      q[ig] = f22;</div>
<div class="line"><span class="lineno"> 1049</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;H2CO&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1050</span>      q[ig] = h2co;</div>
<div class="line"><span class="lineno"> 1051</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;H2O&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1052</span>      q[ig] = h2o;</div>
<div class="line"><span class="lineno"> 1053</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;H2O2&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1054</span>      q[ig] = h2o2;</div>
<div class="line"><span class="lineno"> 1055</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;HCl&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1056</span>      q[ig] = hcl;</div>
<div class="line"><span class="lineno"> 1057</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;HCN&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1058</span>      q[ig] = hcn;</div>
<div class="line"><span class="lineno"> 1059</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;HF&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1060</span>      q[ig] = hf;</div>
<div class="line"><span class="lineno"> 1061</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;HNO3&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1062</span>      q[ig] = hno3;</div>
<div class="line"><span class="lineno"> 1063</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;HNO4&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1064</span>      q[ig] = hno4;</div>
<div class="line"><span class="lineno"> 1065</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;HOCl&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1066</span>      q[ig] = hocl;</div>
<div class="line"><span class="lineno"> 1067</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;N2O&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1068</span>      q[ig] = n2o;</div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;N2O5&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1070</span>      q[ig] = n2o5;</div>
<div class="line"><span class="lineno"> 1071</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;NH3&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1072</span>      q[ig] = nh3;</div>
<div class="line"><span class="lineno"> 1073</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;NO&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1074</span>      q[ig] = no;</div>
<div class="line"><span class="lineno"> 1075</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;NO2&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1076</span>      q[ig] = no2;</div>
<div class="line"><span class="lineno"> 1077</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;O3&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1078</span>      q[ig] = o3;</div>
<div class="line"><span class="lineno"> 1079</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;OCS&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1080</span>      q[ig] = ocs;</div>
<div class="line"><span class="lineno"> 1081</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;SF6&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1082</span>      q[ig] = sf6;</div>
<div class="line"><span class="lineno"> 1083</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], <span class="stringliteral">&quot;SO2&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 1084</span>      q[ig] = so2;</div>
<div class="line"><span class="lineno"> 1085</span>  }</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>  <span class="comment">/* Loop over atmospheric data points... */</span></div>
<div class="line"><span class="lineno"> 1088</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>    <span class="comment">/* Get altitude index... */</span></div>
<div class="line"><span class="lineno"> 1091</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iz = <a class="code hl_function" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(z, 121, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip]);</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>    <span class="comment">/* Interpolate pressure... */</span></div>
<div class="line"><span class="lineno"> 1094</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = <a class="code hl_define" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca">LOGY</a>(z[iz], pre[iz], z[iz + 1], pre[iz + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip]);</div>
<div class="line"><span class="lineno"> 1095</span> </div>
<div class="line"><span class="lineno"> 1096</span>    <span class="comment">/* Interpolate temperature... */</span></div>
<div class="line"><span class="lineno"> 1097</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip] = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(z[iz], tem[iz], z[iz + 1], tem[iz + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip]);</div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span>    <span class="comment">/* Interpolate trace gases... */</span></div>
<div class="line"><span class="lineno"> 1100</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 1101</span>      <span class="keywordflow">if</span> (q[ig] != NULL)</div>
<div class="line"><span class="lineno"> 1102</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip] =</div>
<div class="line"><span class="lineno"> 1103</span>          <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(z[iz], q[ig][iz], z[iz + 1], q[ig][iz + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip]);</div>
<div class="line"><span class="lineno"> 1104</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1105</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip] = 0;</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span>    <span class="comment">/* Set CO2... */</span></div>
<div class="line"><span class="lineno"> 1108</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a253c2c449b1d7e2f0eeda2ed62c8a4fe">ig_co2</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 1109</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a253c2c449b1d7e2f0eeda2ed62c8a4fe">ig_co2</a>][ip] =</div>
<div class="line"><span class="lineno"> 1110</span>        371.789948e-6 + 2.026214e-6 * (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] - 63158400.) / 31557600.;</div>
<div class="line"><span class="lineno"> 1111</span> </div>
<div class="line"><span class="lineno"> 1112</span>    <span class="comment">/* Set N2... */</span></div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aad56428f3ab41bd9c3b28a84c970d3b9">ig_n2</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 1114</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aad56428f3ab41bd9c3b28a84c970d3b9">ig_n2</a>][ip] = <a class="code hl_define" href="jurassic_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>;</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>    <span class="comment">/* Set O2... */</span></div>
<div class="line"><span class="lineno"> 1117</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8b568f9d63b3d40886e073290532a28d">ig_o2</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 1118</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8b568f9d63b3d40886e073290532a28d">ig_o2</a>][ip] = <a class="code hl_define" href="jurassic_8h.html#a31412dbd7c9b5771f1e7a5ff85d20ab9">O2</a>;</div>
<div class="line"><span class="lineno"> 1119</span> </div>
<div class="line"><span class="lineno"> 1120</span>    <span class="comment">/* Set extinction to zero... */</span></div>
<div class="line"><span class="lineno"> 1121</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 1122</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip] = 0;</div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>    <span class="comment">/* Set cloud layer... */</span></div>
<div class="line"><span class="lineno"> 1125</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a> = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a> = 0;</div>
<div class="line"><span class="lineno"> 1126</span>    for (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 1127</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl] = 0;</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment">/* Set surface layer... */</span></div>
<div class="line"><span class="lineno"> 1130</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a> = 0;</div>
<div class="line"><span class="lineno"> 1131</span>    for (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 1132</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf] = 1;</div>
<div class="line"><span class="lineno"> 1133</span>  }</div>
<div class="line"><span class="lineno"> 1134</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a2a3c8ab98f21179741b274439786726d"><div class="ttname"><a href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a></div><div class="ttdeci">int locate_reg(const double *xx, const int n, const double x)</div><div class="ttdoc">Locate index for interpolation on a regular (uniform) grid.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04458">jurassic.c:4458</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a31412dbd7c9b5771f1e7a5ff85d20ab9"><div class="ttname"><a href="jurassic_8h.html#a31412dbd7c9b5771f1e7a5ff85d20ab9">O2</a></div><div class="ttdeci">#define O2</div><div class="ttdoc">Oxygen concentration.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00178">jurassic.h:178</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a6df174578bf85b1e9f33c597f5f8e5ca"><div class="ttname"><a href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca">LOGY</a></div><div class="ttdeci">#define LOGY(x0, y0, x1, y1, x)</div><div class="ttdoc">Compute logarithmic interpolation in y.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00592">jurassic.h:592</a></div></div>
<div class="ttc" id="ajurassic_8h_html_ac29517e805c6a27f76e87e634eaf2929"><div class="ttname"><a href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a></div><div class="ttdeci">#define NG</div><div class="ttdoc">Maximum number of emitters.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00242">jurassic.h:242</a></div></div>
<div class="ttc" id="ajurassic_8h_html_acd864640121c7df2c19f61f7baa507e4"><div class="ttname"><a href="jurassic_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a></div><div class="ttdeci">#define N2</div><div class="ttdoc">Nitrogen concentration.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00173">jurassic.h:173</a></div></div>
<div class="ttc" id="astructatm__t_html_a05da6b99657d420d7bf4b37a392b048c"><div class="ttname"><a href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">atm_t::time</a></div><div class="ttdeci">double time[NP]</div><div class="ttdoc">Time (seconds since 2000-01-01T00:00Z).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01004">jurassic.h:1004</a></div></div>
<div class="ttc" id="astructctl__t_html_a253c2c449b1d7e2f0eeda2ed62c8a4fe"><div class="ttname"><a href="structctl__t.html#a253c2c449b1d7e2f0eeda2ed62c8a4fe">ctl_t::ig_co2</a></div><div class="ttdeci">int ig_co2</div><div class="ttdoc">Emitter index of CO2.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01060">jurassic.h:1060</a></div></div>
<div class="ttc" id="astructctl__t_html_a8b568f9d63b3d40886e073290532a28d"><div class="ttname"><a href="structctl__t.html#a8b568f9d63b3d40886e073290532a28d">ctl_t::ig_o2</a></div><div class="ttdeci">int ig_o2</div><div class="ttdoc">Emitter index of O2.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01069">jurassic.h:1069</a></div></div>
<div class="ttc" id="astructctl__t_html_aad56428f3ab41bd9c3b28a84c970d3b9"><div class="ttname"><a href="structctl__t.html#aad56428f3ab41bd9c3b28a84c970d3b9">ctl_t::ig_n2</a></div><div class="ttdeci">int ig_n2</div><div class="ttdoc">Emitter index of N2.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01066">jurassic.h:1066</a></div></div>
<div class="ttc" id="astructctl__t_html_ad91bbf51ada1919a24e2c7a5fd666e23"><div class="ttname"><a href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">ctl_t::emitter</a></div><div class="ttdeci">char emitter[NG][LEN]</div><div class="ttdoc">Name of each emitter.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01057">jurassic.h:1057</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_ae324329aa277798b632b25de13faf1b2_cgraph.png" border="0" usemap="#ajurassic_8h_ae324329aa277798b632b25de13faf1b2_cgraph" alt=""/></div>
<map name="ajurassic_8h_ae324329aa277798b632b25de13faf1b2_cgraph" id="ajurassic_8h_ae324329aa277798b632b25de13faf1b2_cgraph">
<area shape="rect" title="Initializes atmospheric climatology profiles." alt="" coords="5,5,92,32"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="140,5,223,32"/>
</map>
</div>

</div>
</div>
<a id="a1c8c72b0bc66d214b4575c13a7a0eb6b" name="a1c8c72b0bc66d214b4575c13a7a0eb6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c8c72b0bc66d214b4575c13a7a0eb6b">&#9670;&nbsp;</a></span>cos_sza()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cos_sza </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the cosine of the solar zenith angle. </p>
<p >This function computes the cosine of the solar zenith angle (SZA), which describes the angle between the local zenith (straight up) and the line connecting the observer to the center of the Sun. The cosine of the SZA is often used directly in radiative transfer and photochemical calculations to avoid unnecessary use of trigonometric inverse functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sec</td><td>Seconds elapsed since 2000-01-01T12:00Z. </td></tr>
    <tr><td class="paramname">lon</td><td>Observer's longitude in degrees. </td></tr>
    <tr><td class="paramname">lat</td><td>Observer's latitude in degrees. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The cosine of the solar zenith angle (dimensionless, range [-1, 1]).</dd></dl>
<p>The cosine of the solar zenith angle is computed based on the observer's position (longitude and latitude) and the specified time in seconds elapsed since 2000-01-01T12:00Z.</p>
<dl class="section note"><dt>Note</dt><dd>The input longitude and latitude must be specified in degrees.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>acos()  can be used to convert the returned value to the solar zenith angle in radians if needed.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l01138">1138</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1141</span>                    {</div>
<div class="line"><span class="lineno"> 1142</span> </div>
<div class="line"><span class="lineno"> 1143</span>  <span class="comment">/* Number of days and fraction with respect to 2000-01-01T12:00Z... */</span></div>
<div class="line"><span class="lineno"> 1144</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> D = sec / 86400 - 0.5;</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>  <span class="comment">/* Geocentric apparent ecliptic longitude [rad]... */</span></div>
<div class="line"><span class="lineno"> 1147</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> g = <a class="code hl_define" href="jurassic_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(357.529 + 0.98560028 * D);</div>
<div class="line"><span class="lineno"> 1148</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> q = 280.459 + 0.98564736 * D;</div>
<div class="line"><span class="lineno"> 1149</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> L = <a class="code hl_define" href="jurassic_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(q + 1.915 * sin(g) + 0.020 * sin(2 * g));</div>
<div class="line"><span class="lineno"> 1150</span> </div>
<div class="line"><span class="lineno"> 1151</span>  <span class="comment">/* Mean obliquity of the ecliptic [rad]... */</span></div>
<div class="line"><span class="lineno"> 1152</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> e = <a class="code hl_define" href="jurassic_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(23.439 - 0.00000036 * D);</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>  <span class="comment">/* Declination [rad]... */</span></div>
<div class="line"><span class="lineno"> 1155</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> sindec = sin(e) * sin(L);</div>
<div class="line"><span class="lineno"> 1156</span> </div>
<div class="line"><span class="lineno"> 1157</span>  <span class="comment">/* Right ascension [rad]... */</span></div>
<div class="line"><span class="lineno"> 1158</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ra = atan2(cos(e) * sin(L), cos(L));</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>  <span class="comment">/* Greenwich Mean Sidereal Time [h]... */</span></div>
<div class="line"><span class="lineno"> 1161</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> GMST = 18.697374558 + 24.06570982441908 * D;</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>  <span class="comment">/* Local Sidereal Time [h]... */</span></div>
<div class="line"><span class="lineno"> 1164</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> LST = GMST + lon / 15;</div>
<div class="line"><span class="lineno"> 1165</span> </div>
<div class="line"><span class="lineno"> 1166</span>  <span class="comment">/* Hour angle [rad]... */</span></div>
<div class="line"><span class="lineno"> 1167</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> h = LST / 12 * M_PI - ra;</div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span>  <span class="comment">/* Convert latitude... */</span></div>
<div class="line"><span class="lineno"> 1170</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> lat_help = <a class="code hl_define" href="jurassic_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat);</div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span>  <span class="comment">/* Return cosine of solar zenith angle... */</span></div>
<div class="line"><span class="lineno"> 1173</span>  <span class="keywordflow">return</span> sin(lat_help) * sindec + cos(lat_help)</div>
<div class="line"><span class="lineno"> 1174</span>    * sqrt(1 - <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(sindec)) * cos(h);</div>
<div class="line"><span class="lineno"> 1175</span>}</div>
<div class="ttc" id="ajurassic_8h_html_a1ac0abc7c913167ecaf81778d57e7a17"><div class="ttname"><a href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a></div><div class="ttdeci">#define POW2(x)</div><div class="ttdoc">Compute the square of a value.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00753">jurassic.h:753</a></div></div>
<div class="ttc" id="ajurassic_8h_html_aa3616a5af1a14b0a5a1b2f542066ae45"><div class="ttname"><a href="jurassic_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(deg)</div><div class="ttdoc">Convert degrees to radians.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00429">jurassic.h:429</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a092636f1592a6e34378a13f3e03e2f87" name="a092636f1592a6e34378a13f3e03e2f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a092636f1592a6e34378a13f3e03e2f87">&#9670;&nbsp;</a></span>cost_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cost_function </td>
          <td>(</td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_matrix *&#160;</td>
          <td class="paramname"><em>s_a_inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>sig_eps_inv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the normalized quadratic cost function for optimal estimation. </p>
<p >Evaluates the cost function </p><p class="formulaDsp">
\[
J = \frac{1}{m} \left[ (\mathbf{y} - \mathbf{y_a})^T
\mathbf{S_\epsilon^{-1}} (\mathbf{y} - \mathbf{y_a})
+ (\mathbf{x} - \mathbf{x_a})^T \mathbf{S_a^{-1}} (\mathbf{x} - \mathbf{x_a}) \right]
\]
</p>
<p> where \(\mathbf{dx} = \mathbf{x} - \mathbf{x_a}\) and \(\mathbf{dy} = \mathbf{y} - \mathbf{y_a}\) represent the deviations from a priori state and measurement vectors, respectively.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dx</td><td>State deviation vector (<code>x - x_a</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dy</td><td>Measurement deviation vector (<code>y - y_a</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s_a_inv</td><td>Inverse of the a priori covariance matrix ( \(\mathbf{S_a^{-1}}\)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sig_eps_inv</td><td>Vector of inverse measurement uncertainties ( \(\mathbf{S_\epsilon^{-1/2}}\) diagonal elements).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Normalized cost function value (dimensionless).</dd></dl>
<ul>
<li>Implements the standard <em>Optimal Estimation Method</em> (Rodgers, 2000) cost function.</li>
<li>The first term ( \(\chi^2_m\)) measures the weighted measurement residuals: \(\chi^2_m = \sum_i (dy_i / \sigma_{\epsilon,i})^2\).</li>
<li>The second term ( \(\chi^2_a\)) measures the deviation from the a priori state: \(\chi^2_a = dx^T \mathbf{S_a^{-1}} dx\).</li>
<li>The result is normalized by the number of measurements \(m\) for scale consistency.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>retrieval, s_a_inv, sig_eps_inv</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Assumes diagonal measurement error covariance (independent measurements).</li>
<li>The covariance matrices must be positive-definite and properly dimensioned.</li>
<li>The function does <b>not</b> modify the input vectors.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l01179">1179</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1183</span>                                 {</div>
<div class="line"><span class="lineno"> 1184</span> </div>
<div class="line"><span class="lineno"> 1185</span>  <span class="keywordtype">double</span> chisq_a, chisq_m = 0;</div>
<div class="line"><span class="lineno"> 1186</span> </div>
<div class="line"><span class="lineno"> 1187</span>  <span class="comment">/* Get sizes... */</span></div>
<div class="line"><span class="lineno"> 1188</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> m = dy-&gt;size;</div>
<div class="line"><span class="lineno"> 1189</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = dx-&gt;size;</div>
<div class="line"><span class="lineno"> 1190</span> </div>
<div class="line"><span class="lineno"> 1191</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 1192</span>  gsl_vector *x_aux = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 1193</span>  gsl_vector *y_aux = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>  <span class="comment">/* Determine normalized cost function...</span></div>
<div class="line"><span class="lineno"> 1196</span><span class="comment">     (chi^2 = 1/m * [dy^T * S_eps^{-1} * dy + dx^T * S_a^{-1} * dx]) */</span></div>
<div class="line"><span class="lineno"> 1197</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; i++)</div>
<div class="line"><span class="lineno"> 1198</span>    chisq_m += <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(gsl_vector_get(dy, i) * gsl_vector_get(sig_eps_inv, i));</div>
<div class="line"><span class="lineno"> 1199</span>  gsl_blas_dgemv(CblasNoTrans, 1.0, s_a_inv, dx, 0.0, x_aux);</div>
<div class="line"><span class="lineno"> 1200</span>  gsl_blas_ddot(dx, x_aux, &amp;chisq_a);</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 1203</span>  gsl_vector_free(x_aux);</div>
<div class="line"><span class="lineno"> 1204</span>  gsl_vector_free(y_aux);</div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>  <span class="comment">/* Return cost function value... */</span></div>
<div class="line"><span class="lineno"> 1207</span>  <span class="keywordflow">return</span> (chisq_m + chisq_a) / (double) m;</div>
<div class="line"><span class="lineno"> 1208</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a962bab37658297e87de9631c67707b" name="a9a962bab37658297e87de9631c67707b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a962bab37658297e87de9631c67707b">&#9670;&nbsp;</a></span>ctmco2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctmco2 </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute carbon dioxide continuum (optical depth). </p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l01212">1212</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1216</span>                  {</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> co2296[2001] =</div>
<div class="line"><span class="lineno"> 1219</span>    { 9.3388e-5, 9.7711e-5, 1.0224e-4, 1.0697e-4,</div>
<div class="line"><span class="lineno"> 1220</span>    1.1193e-4, 1.1712e-4, 1.2255e-4, 1.2824e-4, 1.3419e-4, 1.4043e-4,</div>
<div class="line"><span class="lineno"> 1221</span>    1.4695e-4, 1.5378e-4, 1.6094e-4, 1.6842e-4, 1.7626e-4, 1.8447e-4,</div>
<div class="line"><span class="lineno"> 1222</span>    1.9307e-4, 2.0207e-4, 2.1149e-4, 2.2136e-4, 2.3169e-4, 2.4251e-4,</div>
<div class="line"><span class="lineno"> 1223</span>    2.5384e-4, 2.657e-4, 2.7813e-4, 2.9114e-4, 3.0477e-4, 3.1904e-4,</div>
<div class="line"><span class="lineno"> 1224</span>    3.3399e-4, 3.4965e-4, 3.6604e-4, 3.8322e-4, 4.0121e-4, 4.2006e-4,</div>
<div class="line"><span class="lineno"> 1225</span>    4.398e-4, 4.6047e-4, 4.8214e-4, 5.0483e-4, 5.286e-4, 5.535e-4,</div>
<div class="line"><span class="lineno"> 1226</span>    5.7959e-4, 6.0693e-4, 6.3557e-4, 6.6558e-4, 6.9702e-4, 7.2996e-4,</div>
<div class="line"><span class="lineno"> 1227</span>    7.6449e-4, 8.0066e-4, 8.3856e-4, 8.7829e-4, 9.1991e-4, 9.6354e-4,</div>
<div class="line"><span class="lineno"> 1228</span>    .0010093, .0010572, .0011074, .00116, .0012152, .001273,</div>
<div class="line"><span class="lineno"> 1229</span>    .0013336, .0013972, .0014638, .0015336, .0016068, .0016835,</div>
<div class="line"><span class="lineno"> 1230</span>    .001764, .0018483, .0019367, .0020295, .0021267, .0022286,</div>
<div class="line"><span class="lineno"> 1231</span>    .0023355, .0024476, .0025652, .0026885, .0028178, .0029534,</div>
<div class="line"><span class="lineno"> 1232</span>    .0030956, .0032448, .0034012, .0035654, .0037375, .0039181,</div>
<div class="line"><span class="lineno"> 1233</span>    .0041076, .0043063, .0045148, .0047336, .0049632, .005204,</div>
<div class="line"><span class="lineno"> 1234</span>    .0054567, .0057219, .0060002, .0062923, .0065988, .0069204,</div>
<div class="line"><span class="lineno"> 1235</span>    .007258, .0076123, .0079842, .0083746, .0087844, .0092146,</div>
<div class="line"><span class="lineno"> 1236</span>    .0096663, .01014, .010638, .011161, .01171, .012286, .012891,</div>
<div class="line"><span class="lineno"> 1237</span>    .013527, .014194, .014895, .015631, .016404, .017217, .01807,</div>
<div class="line"><span class="lineno"> 1238</span>    .018966, .019908, .020897, .021936, .023028, .024176, .025382,</div>
<div class="line"><span class="lineno"> 1239</span>    .026649, .027981, .02938, .030851, .032397, .034023, .035732,</div>
<div class="line"><span class="lineno"> 1240</span>    .037528, .039416, .041402, .04349, .045685, .047994, .050422,</div>
<div class="line"><span class="lineno"> 1241</span>    .052975, .055661, .058486, .061458, .064584, .067873, .071334,</div>
<div class="line"><span class="lineno"> 1242</span>    .074975, .078807, .082839, .087082, .091549, .096249, .1012,</div>
<div class="line"><span class="lineno"> 1243</span>    .10641, .11189, .11767, .12375, .13015, .13689, .14399, .15147,</div>
<div class="line"><span class="lineno"> 1244</span>    .15935, .16765, .17639, .18561, .19531, .20554, .21632, .22769,</div>
<div class="line"><span class="lineno"> 1245</span>    .23967, .25229, .2656, .27964, .29443, .31004, .3265, .34386,</div>
<div class="line"><span class="lineno"> 1246</span>    .36218, .3815, .40188, .42339, .44609, .47004, .49533, .52202,</div>
<div class="line"><span class="lineno"> 1247</span>    .5502, .57995, .61137, .64455, .6796, .71663, .75574, .79707,</div>
<div class="line"><span class="lineno"> 1248</span>    .84075, .88691, .9357, .98728, 1.0418, 1.0995, 1.1605, 1.225,</div>
<div class="line"><span class="lineno"> 1249</span>    1.2932, 1.3654, 1.4418, 1.5227, 1.6083, 1.6989, 1.7948, 1.8964,</div>
<div class="line"><span class="lineno"> 1250</span>    2.004, 2.118, 2.2388, 2.3668, 2.5025, 2.6463, 2.7988, 2.9606,</div>
<div class="line"><span class="lineno"> 1251</span>    3.1321, 3.314, 3.5071, 3.712, 3.9296, 4.1605, 4.4058, 4.6663,</div>
<div class="line"><span class="lineno"> 1252</span>    4.9431, 5.2374, 5.5501, 5.8818, 6.2353, 6.6114, 7.0115, 7.4372,</div>
<div class="line"><span class="lineno"> 1253</span>    7.8905, 8.3731, 8.8871, 9.4349, 10.019, 10.641, 11.305, 12.013,</div>
<div class="line"><span class="lineno"> 1254</span>    12.769, 13.576, 14.437, 15.358, 16.342, 17.39, 18.513, 19.716,</div>
<div class="line"><span class="lineno"> 1255</span>    21.003, 22.379, 23.854, 25.436, 27.126, 28.942, 30.89, 32.973,</div>
<div class="line"><span class="lineno"> 1256</span>    35.219, 37.634, 40.224, 43.021, 46.037, 49.29, 52.803, 56.447,</div>
<div class="line"><span class="lineno"> 1257</span>    60.418, 64.792, 69.526, 74.637, 80.182, 86.193, 92.713, 99.786,</div>
<div class="line"><span class="lineno"> 1258</span>    107.47, 115.84, 124.94, 134.86, 145.69, 157.49, 170.3, 184.39,</div>
<div class="line"><span class="lineno"> 1259</span>    199.83, 216.4, 234.55, 254.72, 276.82, 299.85, 326.16, 354.99,</div>
<div class="line"><span class="lineno"> 1260</span>    386.51, 416.68, 449.89, 490.12, 534.35, 578.25, 632.26, 692.61,</div>
<div class="line"><span class="lineno"> 1261</span>    756.43, 834.75, 924.11, 1016.9, 996.96, 1102.7, 1219.2, 1351.9,</div>
<div class="line"><span class="lineno"> 1262</span>    1494.3, 1654.1, 1826.5, 2027.9, 2249., 2453.8, 2714.4, 2999.4,</div>
<div class="line"><span class="lineno"> 1263</span>    3209.5, 3509., 3840.4, 3907.5, 4190.7, 4533.5, 4648.3, 5059.1,</div>
<div class="line"><span class="lineno"> 1264</span>    5561.6, 6191.4, 6820.8, 7905.9, 9362.2, 2431.3, 2211.3, 2046.8,</div>
<div class="line"><span class="lineno"> 1265</span>    2023.8, 1985.9, 1905.9, 1491.1, 1369.8, 1262.2, 1200.7, 887.74,</div>
<div class="line"><span class="lineno"> 1266</span>    820.25, 885.23, 887.21, 816.73, 1126.9, 1216.2, 1272.4, 1579.5,</div>
<div class="line"><span class="lineno"> 1267</span>    1634.2, 1656.3, 1657.9, 1789.5, 1670.8, 1509.5, 8474.6, 7489.2,</div>
<div class="line"><span class="lineno"> 1268</span>    6793.6, 6117., 5574.1, 5141.2, 5084.6, 4745.1, 4413.2, 4102.8,</div>
<div class="line"><span class="lineno"> 1269</span>    4024.7, 3715., 3398.6, 3100.8, 2900.4, 2629.2, 2374., 2144.7,</div>
<div class="line"><span class="lineno"> 1270</span>    1955.8, 1760.8, 1591.2, 1435.2, 1296.2, 1174., 1065.1, 967.76,</div>
<div class="line"><span class="lineno"> 1271</span>    999.48, 897.45, 809.23, 732.77, 670.26, 611.93, 560.11, 518.77,</div>
<div class="line"><span class="lineno"> 1272</span>    476.84, 438.8, 408.48, 380.21, 349.24, 322.71, 296.65, 272.85,</div>
<div class="line"><span class="lineno"> 1273</span>    251.96, 232.04, 213.88, 197.69, 182.41, 168.41, 155.79, 144.05,</div>
<div class="line"><span class="lineno"> 1274</span>    133.31, 123.48, 114.5, 106.21, 98.591, 91.612, 85.156, 79.204,</div>
<div class="line"><span class="lineno"> 1275</span>    73.719, 68.666, 63.975, 59.637, 56.35, 52.545, 49.042, 45.788,</div>
<div class="line"><span class="lineno"> 1276</span>    42.78, 39.992, 37.441, 35.037, 32.8, 30.744, 28.801, 26.986,</div>
<div class="line"><span class="lineno"> 1277</span>    25.297, 23.731, 22.258, 20.883, 19.603, 18.403, 17.295, 16.249,</div>
<div class="line"><span class="lineno"> 1278</span>    15.271, 14.356, 13.501, 12.701, 11.954, 11.254, 10.6, 9.9864,</div>
<div class="line"><span class="lineno"> 1279</span>    9.4118, 8.8745, 8.3714, 7.8997, 7.4578, 7.0446, 6.6573, 6.2949,</div>
<div class="line"><span class="lineno"> 1280</span>    5.9577, 5.6395, 5.3419, 5.063, 4.8037, 4.5608, 4.3452, 4.1364,</div>
<div class="line"><span class="lineno"> 1281</span>    3.9413, 3.7394, 3.562, 3.3932, 3.2325, 3.0789, 2.9318, 2.7898,</div>
<div class="line"><span class="lineno"> 1282</span>    2.6537, 2.5225, 2.3958, 2.2305, 2.1215, 2.0245, 1.9427, 1.8795,</div>
<div class="line"><span class="lineno"> 1283</span>    1.8336, 1.7604, 1.7016, 1.6419, 1.5282, 1.4611, 1.3443, 1.27,</div>
<div class="line"><span class="lineno"> 1284</span>    1.1675, 1.0824, 1.0534, .99833, .95854, .92981, .90887, .89346,</div>
<div class="line"><span class="lineno"> 1285</span>    .88113, .87068, .86102, .85096, .88262, .86151, .83565, .80518,</div>
<div class="line"><span class="lineno"> 1286</span>    .77045, .73736, .74744, .74954, .75773, .82267, .83493, .89402,</div>
<div class="line"><span class="lineno"> 1287</span>    .89725, .93426, .95564, .94045, .94174, .93404, .92035, .90456,</div>
<div class="line"><span class="lineno"> 1288</span>    .88621, .86673, .78117, .7515, .72056, .68822, .65658, .62764,</div>
<div class="line"><span class="lineno"> 1289</span>    .55984, .55598, .57407, .60963, .63763, .66198, .61132, .60972,</div>
<div class="line"><span class="lineno"> 1290</span>    .52496, .50649, .41872, .3964, .32422, .27276, .24048, .23772,</div>
<div class="line"><span class="lineno"> 1291</span>    .2286, .22711, .23999, .32038, .34371, .36621, .38561, .39953,</div>
<div class="line"><span class="lineno"> 1292</span>    .40636, .44913, .42716, .3919, .35477, .33935, .3351, .39746,</div>
<div class="line"><span class="lineno"> 1293</span>    .40993, .49398, .49956, .56157, .54742, .57295, .57386, .55417,</div>
<div class="line"><span class="lineno"> 1294</span>    .50745, .471, .43446, .39102, .34993, .31269, .27888, .24912,</div>
<div class="line"><span class="lineno"> 1295</span>    .22291, .19994, .17972, .16197, .14633, .13252, .12029, .10942,</div>
<div class="line"><span class="lineno"> 1296</span>    .099745, .091118, .083404, .076494, .070292, .064716, .059697,</div>
<div class="line"><span class="lineno"> 1297</span>    .055173, .051093, .047411, .044089, .041092, .038392, .035965,</div>
<div class="line"><span class="lineno"> 1298</span>    .033789, .031846, .030122, .028607, .02729, .026169, .025209,</div>
<div class="line"><span class="lineno"> 1299</span>    .024405, .023766, .023288, .022925, .022716, .022681, .022685,</div>
<div class="line"><span class="lineno"> 1300</span>    .022768, .023133, .023325, .023486, .024004, .024126, .024083,</div>
<div class="line"><span class="lineno"> 1301</span>    .023785, .024023, .023029, .021649, .021108, .019454, .017809,</div>
<div class="line"><span class="lineno"> 1302</span>    .017292, .016635, .017037, .018068, .018977, .018756, .017847,</div>
<div class="line"><span class="lineno"> 1303</span>    .016557, .016142, .014459, .012869, .012381, .010875, .0098701,</div>
<div class="line"><span class="lineno"> 1304</span>    .009285, .0091698, .0091701, .0096145, .010553, .01106, .012613,</div>
<div class="line"><span class="lineno"> 1305</span>    .014362, .015017, .016507, .017741, .01768, .017784, .0171,</div>
<div class="line"><span class="lineno"> 1306</span>    .016357, .016172, .017257, .018978, .020935, .021741, .023567,</div>
<div class="line"><span class="lineno"> 1307</span>    .025183, .025589, .026732, .027648, .028278, .028215, .02856,</div>
<div class="line"><span class="lineno"> 1308</span>    .029015, .029062, .028851, .028497, .027825, .027801, .026523,</div>
<div class="line"><span class="lineno"> 1309</span>    .02487, .022967, .022168, .020194, .018605, .017903, .018439,</div>
<div class="line"><span class="lineno"> 1310</span>    .019697, .020311, .020855, .020057, .018608, .016738, .015963,</div>
<div class="line"><span class="lineno"> 1311</span>    .013844, .011801, .011134, .0097573, .0086007, .0086226,</div>
<div class="line"><span class="lineno"> 1312</span>    .0083721, .0090978, .0097616, .0098426, .011317, .012853, .01447,</div>
<div class="line"><span class="lineno"> 1313</span>    .014657, .015771, .016351, .016079, .014829, .013431, .013185,</div>
<div class="line"><span class="lineno"> 1314</span>    .013207, .01448, .016176, .017971, .018265, .019526, .020455,</div>
<div class="line"><span class="lineno"> 1315</span>    .019797, .019802, .0194, .018176, .017505, .016197, .015339,</div>
<div class="line"><span class="lineno"> 1316</span>    .014401, .013213, .012203, .011186, .010236, .0093288, .0084854,</div>
<div class="line"><span class="lineno"> 1317</span>    .0076837, .0069375, .0062614, .0056628, .0051153, .0046015,</div>
<div class="line"><span class="lineno"> 1318</span>    .0041501, .003752, .0033996, .0030865, .0028077, .0025586,</div>
<div class="line"><span class="lineno"> 1319</span>    .0023355, .0021353, .0019553, .0017931, .0016466, .0015141,</div>
<div class="line"><span class="lineno"> 1320</span>    .0013941, .0012852, .0011862, .0010962, .0010142, 9.3935e-4,</div>
<div class="line"><span class="lineno"> 1321</span>    8.71e-4, 8.0851e-4, 7.5132e-4, 6.9894e-4, 6.5093e-4, 6.0689e-4,</div>
<div class="line"><span class="lineno"> 1322</span>    5.6647e-4, 5.2935e-4, 4.9525e-4, 4.6391e-4, 4.3509e-4, 4.086e-4,</div>
<div class="line"><span class="lineno"> 1323</span>    3.8424e-4, 3.6185e-4, 3.4126e-4, 3.2235e-4, 3.0498e-4, 2.8904e-4,</div>
<div class="line"><span class="lineno"> 1324</span>    2.7444e-4, 2.6106e-4, 2.4883e-4, 2.3766e-4, 2.275e-4, 2.1827e-4,</div>
<div class="line"><span class="lineno"> 1325</span>    2.0992e-4, 2.0239e-4, 1.9563e-4, 1.896e-4, 1.8427e-4, 1.796e-4,</div>
<div class="line"><span class="lineno"> 1326</span>    1.7555e-4, 1.7209e-4, 1.692e-4, 1.6687e-4, 1.6505e-4, 1.6375e-4,</div>
<div class="line"><span class="lineno"> 1327</span>    1.6294e-4, 1.6261e-4, 1.6274e-4, 1.6334e-4, 1.6438e-4, 1.6587e-4,</div>
<div class="line"><span class="lineno"> 1328</span>    1.678e-4, 1.7017e-4, 1.7297e-4, 1.762e-4, 1.7988e-4, 1.8399e-4,</div>
<div class="line"><span class="lineno"> 1329</span>    1.8855e-4, 1.9355e-4, 1.9902e-4, 2.0494e-4, 2.1134e-4, 2.1823e-4,</div>
<div class="line"><span class="lineno"> 1330</span>    2.2561e-4, 2.335e-4, 2.4192e-4, 2.5088e-4, 2.604e-4, 2.705e-4,</div>
<div class="line"><span class="lineno"> 1331</span>    2.8119e-4, 2.9251e-4, 3.0447e-4, 3.171e-4, 3.3042e-4, 3.4447e-4,</div>
<div class="line"><span class="lineno"> 1332</span>    3.5927e-4, 3.7486e-4, 3.9127e-4, 4.0854e-4, 4.267e-4, 4.4579e-4,</div>
<div class="line"><span class="lineno"> 1333</span>    4.6586e-4, 4.8696e-4, 5.0912e-4, 5.324e-4, 5.5685e-4, 5.8253e-4,</div>
<div class="line"><span class="lineno"> 1334</span>    6.0949e-4, 6.378e-4, 6.6753e-4, 6.9873e-4, 7.3149e-4, 7.6588e-4,</div>
<div class="line"><span class="lineno"> 1335</span>    8.0198e-4, 8.3987e-4, 8.7964e-4, 9.2139e-4, 9.6522e-4, .0010112,</div>
<div class="line"><span class="lineno"> 1336</span>    .0010595, .0011102, .0011634, .0012193, .001278, .0013396,</div>
<div class="line"><span class="lineno"> 1337</span>    .0014043, .0014722, .0015436, .0016185, .0016972, .0017799,</div>
<div class="line"><span class="lineno"> 1338</span>    .0018668, .001958, .0020539, .0021547, .0022606, .0023719,</div>
<div class="line"><span class="lineno"> 1339</span>    .002489, .002612, .0027414, .0028775, .0030206, .0031712,</div>
<div class="line"><span class="lineno"> 1340</span>    .0033295, .0034962, .0036716, .0038563, .0040506, .0042553,</div>
<div class="line"><span class="lineno"> 1341</span>    .0044709, .004698, .0049373, .0051894, .0054552, .0057354,</div>
<div class="line"><span class="lineno"> 1342</span>    .006031, .0063427, .0066717, .0070188, .0073854, .0077726,</div>
<div class="line"><span class="lineno"> 1343</span>    .0081816, .0086138, .0090709, .0095543, .010066, .010607,</div>
<div class="line"><span class="lineno"> 1344</span>    .011181, .011789, .012433, .013116, .013842, .014613, .015432,</div>
<div class="line"><span class="lineno"> 1345</span>    .016304, .017233, .018224, .019281, .020394, .021574, .022836,</div>
<div class="line"><span class="lineno"> 1346</span>    .024181, .025594, .027088, .028707, .030401, .032245, .034219,</div>
<div class="line"><span class="lineno"> 1347</span>    .036262, .038539, .040987, .043578, .04641, .04949, .052726,</div>
<div class="line"><span class="lineno"> 1348</span>    .056326, .0602, .064093, .068521, .073278, .077734, .083064,</div>
<div class="line"><span class="lineno"> 1349</span>    .088731, .093885, .1003, .1072, .11365, .12187, .13078, .13989,</div>
<div class="line"><span class="lineno"> 1350</span>    .15095, .16299, .17634, .19116, .20628, .22419, .24386, .26587,</div>
<div class="line"><span class="lineno"> 1351</span>    .28811, .31399, .34321, .36606, .39675, .42742, .44243, .47197,</div>
<div class="line"><span class="lineno"> 1352</span>    .49993, .49027, .51147, .52803, .48931, .49729, .5026, .43854,</div>
<div class="line"><span class="lineno"> 1353</span>    .441, .44766, .43414, .46151, .50029, .55247, .43855, .32115,</div>
<div class="line"><span class="lineno"> 1354</span>    .32607, .3431, .36119, .38029, .41179, .43996, .47144, .51853,</div>
<div class="line"><span class="lineno"> 1355</span>    .55362, .59122, .66338, .69877, .74001, .82923, .86907, .90361,</div>
<div class="line"><span class="lineno"> 1356</span>    1.0025, 1.031, 1.0559, 1.104, 1.1178, 1.1341, 1.1547, 1.351,</div>
<div class="line"><span class="lineno"> 1357</span>    1.4772, 1.4812, 1.4907, 1.512, 1.5442, 1.5853, 1.6358, 1.6963,</div>
<div class="line"><span class="lineno"> 1358</span>    1.7674, 1.8474, 1.9353, 2.0335, 2.143, 2.2592, 2.3853, 2.5217,</div>
<div class="line"><span class="lineno"> 1359</span>    2.6686, 2.8273, 2.9998, 3.183, 3.3868, 3.6109, 3.8564, 4.1159,</div>
<div class="line"><span class="lineno"> 1360</span>    4.4079, 4.7278, 5.0497, 5.3695, 5.758, 6.0834, 6.4976, 6.9312,</div>
<div class="line"><span class="lineno"> 1361</span>    7.38, 7.5746, 7.9833, 8.3791, 8.3956, 8.7501, 9.1067, 9.072,</div>
<div class="line"><span class="lineno"> 1362</span>    9.4649, 9.9112, 10.402, 10.829, 11.605, 12.54, 12.713, 10.443,</div>
<div class="line"><span class="lineno"> 1363</span>    10.825, 11.375, 11.955, 12.623, 13.326, 14.101, 15.041, 15.547,</div>
<div class="line"><span class="lineno"> 1364</span>    16.461, 17.439, 18.716, 19.84, 21.036, 22.642, 23.901, 25.244,</div>
<div class="line"><span class="lineno"> 1365</span>    27.03, 28.411, 29.871, 31.403, 33.147, 34.744, 36.456, 39.239,</div>
<div class="line"><span class="lineno"> 1366</span>    43.605, 45.162, 47.004, 49.093, 51.391, 53.946, 56.673, 59.629,</div>
<div class="line"><span class="lineno"> 1367</span>    63.167, 66.576, 70.254, 74.222, 78.477, 83.034, 87.914, 93.18,</div>
<div class="line"><span class="lineno"> 1368</span>    98.77, 104.74, 111.15, 117.95, 125.23, 133.01, 141.33, 150.21,</div>
<div class="line"><span class="lineno"> 1369</span>    159.71, 169.89, 180.93, 192.54, 204.99, 218.34, 232.65, 248.,</div>
<div class="line"><span class="lineno"> 1370</span>    264.47, 282.14, 301.13, 321.53, 343.48, 367.08, 392.5, 419.88,</div>
<div class="line"><span class="lineno"> 1371</span>    449.4, 481.26, 515.64, 552.79, 592.99, 636.48, 683.61, 734.65,</div>
<div class="line"><span class="lineno"> 1372</span>    789.99, 850.02, 915.14, 985.81, 1062.5, 1147.1, 1237.8, 1336.4,</div>
<div class="line"><span class="lineno"> 1373</span>    1443.2, 1558.9, 1684.2, 1819.2, 1965.2, 2122.6, 2291.7, 2470.8,</div>
<div class="line"><span class="lineno"> 1374</span>    2665.7, 2874.9, 3099.4, 3337.9, 3541., 3813.3, 4111.9, 4439.3,</div>
<div class="line"><span class="lineno"> 1375</span>    4798.9, 5196., 5639.2, 6087.5, 6657.7, 7306.7, 8040.7, 8845.5,</div>
<div class="line"><span class="lineno"> 1376</span>    9702.2, 10670., 11739., 12842., 14141., 15498., 17068., 18729.,</div>
<div class="line"><span class="lineno"> 1377</span>    20557., 22559., 25248., 27664., 30207., 32915., 35611., 38081.,</div>
<div class="line"><span class="lineno"> 1378</span>    40715., 43191., 41651., 42750., 43785., 44353., 44366., 44189.,</div>
<div class="line"><span class="lineno"> 1379</span>    43618., 42862., 41878., 35133., 35215., 36383., 39420., 44055.,</div>
<div class="line"><span class="lineno"> 1380</span>    44155., 45850., 46853., 39197., 38274., 29942., 28553., 21792.,</div>
<div class="line"><span class="lineno"> 1381</span>    21228., 17106., 14955., 18181., 19557., 21427., 23728., 26301.,</div>
<div class="line"><span class="lineno"> 1382</span>    28584., 30775., 32536., 33867., 40089., 39204., 37329., 34452.,</div>
<div class="line"><span class="lineno"> 1383</span>    31373., 33921., 34800., 36043., 44415., 45162., 52181., 50895.,</div>
<div class="line"><span class="lineno"> 1384</span>    54140., 50840., 50468., 48302., 44915., 40910., 36754., 32755.,</div>
<div class="line"><span class="lineno"> 1385</span>    29093., 25860., 22962., 20448., 18247., 16326., 14645., 13165.,</div>
<div class="line"><span class="lineno"> 1386</span>    11861., 10708., 9686.9, 8779.7, 7971.9, 7250.8, 6605.7, 6027.2,</div>
<div class="line"><span class="lineno"> 1387</span>    5507.3, 5039.1, 4616.6, 4234.8, 3889., 3575.4, 3290.5, 3031.3,</div>
<div class="line"><span class="lineno"> 1388</span>    2795.2, 2579.9, 2383.1, 2203.3, 2038.6, 1887.6, 1749.1, 1621.9,</div>
<div class="line"><span class="lineno"> 1389</span>    1505., 1397.4, 1298.3, 1207., 1122.8, 1045., 973.1, 906.64,</div>
<div class="line"><span class="lineno"> 1390</span>    845.16, 788.22, 735.48, 686.57, 641.21, 599.1, 559.99, 523.64,</div>
<div class="line"><span class="lineno"> 1391</span>    489.85, 458.42, 429.16, 401.92, 376.54, 352.88, 330.82, 310.24,</div>
<div class="line"><span class="lineno"> 1392</span>    291.03, 273.09, 256.34, 240.69, 226.05, 212.37, 199.57, 187.59,</div>
<div class="line"><span class="lineno"> 1393</span>    176.37, 165.87, 156.03, 146.82, 138.17, 130.07, 122.47, 115.34,</div>
<div class="line"><span class="lineno"> 1394</span>    108.65, 102.37, 96.473, 90.934, 85.73, 80.84, 76.243, 71.922,</div>
<div class="line"><span class="lineno"> 1395</span>    67.858, 64.034, 60.438, 57.052, 53.866, 50.866, 48.04, 45.379,</div>
<div class="line"><span class="lineno"> 1396</span>    42.872, 40.51, 38.285, 36.188, 34.211, 32.347, 30.588, 28.929,</div>
<div class="line"><span class="lineno"> 1397</span>    27.362, 25.884, 24.489, 23.171, 21.929, 20.755, 19.646, 18.599,</div>
<div class="line"><span class="lineno"> 1398</span>    17.61, 16.677, 15.795, 14.961, 14.174, 13.43, 12.725, 12.06,</div>
<div class="line"><span class="lineno"> 1399</span>    11.431, 10.834, 10.27, 9.7361, 9.2302, 8.7518, 8.2997, 7.8724,</div>
<div class="line"><span class="lineno"> 1400</span>    7.4674, 7.0848, 6.7226, 6.3794, 6.054, 5.745, 5.4525, 5.1752,</div>
<div class="line"><span class="lineno"> 1401</span>    4.9121, 4.6625, 4.4259, 4.2015, 3.9888, 3.7872, 3.5961, 3.4149,</div>
<div class="line"><span class="lineno"> 1402</span>    3.2431, 3.0802, 2.9257, 2.7792, 2.6402, 2.5084, 2.3834, 2.2648,</div>
<div class="line"><span class="lineno"> 1403</span>    2.1522, 2.0455, 1.9441, 1.848, 1.7567, 1.6701, 1.5878, 1.5097,</div>
<div class="line"><span class="lineno"> 1404</span>    1.4356, 1.3651, 1.2981, 1.2345, 1.174, 1.1167, 1.062, 1.0101,</div>
<div class="line"><span class="lineno"> 1405</span>    .96087, .91414, .86986, .82781, .78777, .74971, .71339, .67882,</div>
<div class="line"><span class="lineno"> 1406</span>    .64604, .61473, .58507, .55676, .52987, .5044, .48014, .45715,</div>
<div class="line"><span class="lineno"> 1407</span>    .43527, .41453, .3948, .37609, .35831, .34142, .32524, .30995,</div>
<div class="line"><span class="lineno"> 1408</span>    .29536, .28142, .26807, .25527, .24311, .23166, .22077, .21053,</div>
<div class="line"><span class="lineno"> 1409</span>    .20081, .19143, .18261, .17407, .16603, .15833, .15089, .14385,</div>
<div class="line"><span class="lineno"> 1410</span>    .13707, .13065, .12449, .11865, .11306, .10774, .10266, .097818,</div>
<div class="line"><span class="lineno"> 1411</span>    .093203, .088815, .084641, .080671, .076892, .073296, .069873,</div>
<div class="line"><span class="lineno"> 1412</span>    .066613, .06351, .060555, .05774, .055058, .052504, .050071,</div>
<div class="line"><span class="lineno"> 1413</span>    .047752, .045543, .043438, .041432, .039521, .037699, .035962,</div>
<div class="line"><span class="lineno"> 1414</span>    .034307, .032729, .031225, .029791, .028423, .02712, .025877,</div>
<div class="line"><span class="lineno"> 1415</span>    .024692, .023563, .022485, .021458, .020478, .019543, .018652,</div>
<div class="line"><span class="lineno"> 1416</span>    .017802, .016992, .016219, .015481, .014778, .014107, .013467,</div>
<div class="line"><span class="lineno"> 1417</span>    .012856, .012274, .011718, .011188, .010682, .0102, .0097393,</div>
<div class="line"><span class="lineno"> 1418</span>    .0093001, .008881, .0084812, .0080997, .0077358, .0073885,</div>
<div class="line"><span class="lineno"> 1419</span>    .0070571, .0067409, .0064393, .0061514, .0058768, .0056147,</div>
<div class="line"><span class="lineno"> 1420</span>    .0053647, .0051262, .0048987, .0046816, .0044745, .0042769,</div>
<div class="line"><span class="lineno"> 1421</span>    .0040884, .0039088, .0037373, .0035739, .003418, .0032693,</div>
<div class="line"><span class="lineno"> 1422</span>    .0031277, .0029926, .0028639, .0027413, .0026245, .0025133,</div>
<div class="line"><span class="lineno"> 1423</span>    .0024074, .0023066, .0022108, .0021196, .002033, .0019507,</div>
<div class="line"><span class="lineno"> 1424</span>    .0018726, .0017985, .0017282, .0016617, .0015988, .0015394,</div>
<div class="line"><span class="lineno"> 1425</span>    .0014834, .0014306, .0013811, .0013346, .0012911, .0012506,</div>
<div class="line"><span class="lineno"> 1426</span>    .0012131, .0011784, .0011465, .0011175, .0010912, .0010678,</div>
<div class="line"><span class="lineno"> 1427</span>    .0010472, .0010295, .0010147, .001003, 9.9428e-4, 9.8883e-4,</div>
<div class="line"><span class="lineno"> 1428</span>    9.8673e-4, 9.8821e-4, 9.9343e-4, .0010027, .0010164, .0010348,</div>
<div class="line"><span class="lineno"> 1429</span>    .0010586, .0010882, .0011245, .0011685, .0012145, .0012666,</div>
<div class="line"><span class="lineno"> 1430</span>    .0013095, .0013688, .0014048, .0014663, .0015309, .0015499,</div>
<div class="line"><span class="lineno"> 1431</span>    .0016144, .0016312, .001705, .0017892, .0018499, .0019715,</div>
<div class="line"><span class="lineno"> 1432</span>    .0021102, .0022442, .0024284, .0025893, .0027703, .0029445,</div>
<div class="line"><span class="lineno"> 1433</span>    .0031193, .003346, .0034552, .0036906, .0037584, .0040084,</div>
<div class="line"><span class="lineno"> 1434</span>    .0041934, .0044587, .0047093, .0049759, .0053421, .0055134,</div>
<div class="line"><span class="lineno"> 1435</span>    .0059048, .0058663, .0061036, .0063259, .0059657, .0060653,</div>
<div class="line"><span class="lineno"> 1436</span>    .0060972, .0055539, .0055653, .0055772, .005331, .0054953,</div>
<div class="line"><span class="lineno"> 1437</span>    .0055919, .0058684, .006183, .0066675, .0069808, .0075142,</div>
<div class="line"><span class="lineno"> 1438</span>    .0078536, .0084282, .0089454, .0094625, .0093703, .0095857,</div>
<div class="line"><span class="lineno"> 1439</span>    .0099283, .010063, .010521, .0097778, .0098175, .010379, .010447,</div>
<div class="line"><span class="lineno"> 1440</span>    .0105, .010617, .010706, .01078, .011177, .011212, .011304,</div>
<div class="line"><span class="lineno"> 1441</span>    .011446, .011603, .011816, .012165, .012545, .013069, .013539,</div>
<div class="line"><span class="lineno"> 1442</span>    .01411, .014776, .016103, .017016, .017994, .018978, .01998,</div>
<div class="line"><span class="lineno"> 1443</span>    .021799, .022745, .023681, .024627, .025562, .026992, .027958,</div>
<div class="line"><span class="lineno"> 1444</span>    .029013, .030154, .031402, .03228, .033651, .035272, .037088,</div>
<div class="line"><span class="lineno"> 1445</span>    .039021, .041213, .043597, .045977, .04877, .051809, .054943,</div>
<div class="line"><span class="lineno"> 1446</span>    .058064, .061528, .06537, .069309, .071928, .075752, .079589,</div>
<div class="line"><span class="lineno"> 1447</span>    .083352, .084096, .087497, .090817, .091198, .094966, .099045,</div>
<div class="line"><span class="lineno"> 1448</span>    .10429, .10867, .11518, .12269, .13126, .14087, .15161, .16388,</div>
<div class="line"><span class="lineno"> 1449</span>    .16423, .1759, .18721, .19994, .21275, .22513, .23041, .24231,</div>
<div class="line"><span class="lineno"> 1450</span>    .25299, .25396, .26396, .27696, .27929, .2908, .30595, .31433,</div>
<div class="line"><span class="lineno"> 1451</span>    .3282, .3429, .35944, .37467, .39277, .41245, .43326, .45649,</div>
<div class="line"><span class="lineno"> 1452</span>    .48152, .51897, .54686, .57877, .61263, .64962, .68983, .73945,</div>
<div class="line"><span class="lineno"> 1453</span>    .78619, .83537, .89622, .95002, 1.0067, 1.0742, 1.1355, 1.2007,</div>
<div class="line"><span class="lineno"> 1454</span>    1.2738, 1.347, 1.4254, 1.5094, 1.6009, 1.6976, 1.8019, 1.9148,</div>
<div class="line"><span class="lineno"> 1455</span>    2.0357, 2.166, 2.3066, 2.4579, 2.6208, 2.7966, 2.986, 3.188,</div>
<div class="line"><span class="lineno"> 1456</span>    3.4081, 3.6456, 3.9, 4.1747, 4.4712, 4.7931, 5.1359, 5.5097,</div>
<div class="line"><span class="lineno"> 1457</span>    5.9117, 6.3435, 6.8003, 7.3001, 7.8385, 8.3945, 9.011, 9.6869,</div>
<div class="line"><span class="lineno"> 1458</span>    10.392, 11.18, 12.036, 12.938, 13.944, 14.881, 16.029, 17.255,</div>
<div class="line"><span class="lineno"> 1459</span>    18.574, 19.945, 21.38, 22.9, 24.477, 26.128, 27.87, 29.037,</div>
<div class="line"><span class="lineno"> 1460</span>    30.988, 33.145, 35.506, 37.76, 40.885, 44.487, 48.505, 52.911,</div>
<div class="line"><span class="lineno"> 1461</span>    57.56, 61.964, 67.217, 72.26, 78.343, 85.08, 91.867, 99.435,</div>
<div class="line"><span class="lineno"> 1462</span>    107.68, 116.97, 127.12, 138.32, 150.26, 163.04, 174.81, 189.26,</div>
<div class="line"><span class="lineno"> 1463</span>    205.61, 224.68, 240.98, 261.88, 285.1, 307.58, 334.35, 363.53,</div>
<div class="line"><span class="lineno"> 1464</span>    394.68, 427.85, 458.85, 489.25, 472.87, 486.93, 496.27, 501.52,</div>
<div class="line"><span class="lineno"> 1465</span>    501.57, 497.14, 488.09, 476.32, 393.76, 388.51, 393.42, 414.45,</div>
<div class="line"><span class="lineno"> 1466</span>    455.12, 514.62, 520.38, 547.42, 562.6, 487.47, 480.83, 391.06,</div>
<div class="line"><span class="lineno"> 1467</span>    376.92, 303.7, 295.91, 256.03, 236.73, 280.38, 310.71, 335.53,</div>
<div class="line"><span class="lineno"> 1468</span>    367.88, 401.94, 435.52, 469.13, 497.94, 588.82, 597.94, 597.2,</div>
<div class="line"><span class="lineno"> 1469</span>    588.28, 571.2, 555.75, 603.56, 638.15, 680.75, 801.72, 848.01,</div>
<div class="line"><span class="lineno"> 1470</span>    962.15, 990.06, 1068.1, 1076.2, 1115.3, 1134.2, 1136.6, 1119.1,</div>
<div class="line"><span class="lineno"> 1471</span>    1108.9, 1090.6, 1068.7, 1041.9, 1005.4, 967.98, 927.08, 780.1,</div>
<div class="line"><span class="lineno"> 1472</span>    751.41, 733.12, 742.65, 785.56, 855.16, 852.45, 878.1, 784.59,</div>
<div class="line"><span class="lineno"> 1473</span>    777.81, 765.13, 622.93, 498.09, 474.89, 386.9, 378.48, 336.17,</div>
<div class="line"><span class="lineno"> 1474</span>    322.04, 329.57, 350.5, 383.38, 420.02, 462.39, 499.71, 531.98,</div>
<div class="line"><span class="lineno"> 1475</span>    654.99, 653.43, 639.99, 605.16, 554.16, 504.42, 540.64, 552.33,</div>
<div class="line"><span class="lineno"> 1476</span>    679.46, 699.51, 713.91, 832.17, 919.91, 884.96, 907.57, 846.56,</div>
<div class="line"><span class="lineno"> 1477</span>    818.56, 768.93, 706.71, 642.17, 575.95, 515.38, 459.07, 409.02,</div>
<div class="line"><span class="lineno"> 1478</span>    364.61, 325.46, 291.1, 260.89, 234.39, 211.01, 190.38, 172.11,</div>
<div class="line"><span class="lineno"> 1479</span>    155.91, 141.49, 128.63, 117.13, 106.84, 97.584, 89.262, 81.756,</div>
<div class="line"><span class="lineno"> 1480</span>    74.975, 68.842, 63.28, 58.232, 53.641, 49.46, 45.649, 42.168,</div>
<div class="line"><span class="lineno"> 1481</span>    38.991, 36.078, 33.409, 30.96, 28.71, 26.642, 24.737, 22.985,</div>
<div class="line"><span class="lineno"> 1482</span>    21.37, 19.882, 18.512, 17.242, 16.073, 14.987, 13.984, 13.05,</div>
<div class="line"><span class="lineno"> 1483</span>    12.186, 11.384, 10.637, 9.9436, 9.2988, 8.6991, 8.141, 7.6215,</div>
<div class="line"><span class="lineno"> 1484</span>    7.1378, 6.6872, 6.2671, 5.8754, 5.51, 5.1691, 4.851, 4.5539,</div>
<div class="line"><span class="lineno"> 1485</span>    4.2764, 4.0169, 3.7742, 3.5472, 3.3348, 3.1359, 2.9495, 2.7749,</div>
<div class="line"><span class="lineno"> 1486</span>    2.6113, 2.4578, 2.3139, 2.1789, 2.0523, 1.9334, 1.8219, 1.7171,</div>
<div class="line"><span class="lineno"> 1487</span>    1.6188, 1.5263, 1.4395, 1.3579, 1.2812, 1.209, 1.1411, 1.0773,</div>
<div class="line"><span class="lineno"> 1488</span>    1.0171, .96048, .90713, .85684, .80959, .76495, .72282, .68309,</div>
<div class="line"><span class="lineno"> 1489</span>    .64563, .61035, .57707, .54573, .51622, .48834, .46199, .43709,</div>
<div class="line"><span class="lineno"> 1490</span>    .41359, .39129, .37034, .35064, .33198, .31442, .29784, .28218,</div>
<div class="line"><span class="lineno"> 1491</span>    .26732, .25337, .24017, .22774, .21601, .20479, .19426</div>
<div class="line"><span class="lineno"> 1492</span>  };</div>
<div class="line"><span class="lineno"> 1493</span> </div>
<div class="line"><span class="lineno"> 1494</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> co2260[2001] =</div>
<div class="line"><span class="lineno"> 1495</span>    { 5.7971e-5, 6.0733e-5, 6.3628e-5, 6.6662e-5,</div>
<div class="line"><span class="lineno"> 1496</span>    6.9843e-5, 7.3176e-5, 7.6671e-5, 8.0334e-5, 8.4175e-5, 8.8201e-5,</div>
<div class="line"><span class="lineno"> 1497</span>    9.2421e-5, 9.6846e-5, 1.0149e-4, 1.0635e-4, 1.1145e-4, 1.1679e-4,</div>
<div class="line"><span class="lineno"> 1498</span>    1.224e-4, 1.2828e-4, 1.3444e-4, 1.409e-4, 1.4768e-4, 1.5479e-4,</div>
<div class="line"><span class="lineno"> 1499</span>    1.6224e-4, 1.7006e-4, 1.7826e-4, 1.8685e-4, 1.9587e-4, 2.0532e-4,</div>
<div class="line"><span class="lineno"> 1500</span>    2.1524e-4, 2.2565e-4, 2.3656e-4, 2.48e-4, 2.6001e-4, 2.7261e-4,</div>
<div class="line"><span class="lineno"> 1501</span>    2.8582e-4, 2.9968e-4, 3.1422e-4, 3.2948e-4, 3.4548e-4, 3.6228e-4,</div>
<div class="line"><span class="lineno"> 1502</span>    3.799e-4, 3.9838e-4, 4.1778e-4, 4.3814e-4, 4.595e-4, 4.8191e-4,</div>
<div class="line"><span class="lineno"> 1503</span>    5.0543e-4, 5.3012e-4, 5.5603e-4, 5.8321e-4, 6.1175e-4, 6.417e-4,</div>
<div class="line"><span class="lineno"> 1504</span>    6.7314e-4, 7.0614e-4, 7.4078e-4, 7.7714e-4, 8.1531e-4, 8.5538e-4,</div>
<div class="line"><span class="lineno"> 1505</span>    8.9745e-4, 9.4162e-4, 9.8798e-4, .0010367, .0010878, .0011415,</div>
<div class="line"><span class="lineno"> 1506</span>    .0011978, .001257, .0013191, .0013844, .001453, .0015249,</div>
<div class="line"><span class="lineno"> 1507</span>    .0016006, .00168, .0017634, .001851, .001943, .0020397, .0021412,</div>
<div class="line"><span class="lineno"> 1508</span>    .0022479, .00236, .0024778, .0026015, .0027316, .0028682,</div>
<div class="line"><span class="lineno"> 1509</span>    .0030117, .0031626, .0033211, .0034877, .0036628, .0038469,</div>
<div class="line"><span class="lineno"> 1510</span>    .0040403, .0042436, .0044574, .004682, .0049182, .0051665,</div>
<div class="line"><span class="lineno"> 1511</span>    .0054276, .0057021, .0059907, .0062942, .0066133, .0069489,</div>
<div class="line"><span class="lineno"> 1512</span>    .0073018, .0076729, .0080632, .0084738, .0089056, .0093599,</div>
<div class="line"><span class="lineno"> 1513</span>    .0098377, .01034, .010869, .011426, .012011, .012627, .013276,</div>
<div class="line"><span class="lineno"> 1514</span>    .013958, .014676, .015431, .016226, .017063, .017944, .018872,</div>
<div class="line"><span class="lineno"> 1515</span>    .019848, .020876, .021958, .023098, .024298, .025561, .026892,</div>
<div class="line"><span class="lineno"> 1516</span>    .028293, .029769, .031323, .032961, .034686, .036503, .038418,</div>
<div class="line"><span class="lineno"> 1517</span>    .040435, .042561, .044801, .047161, .049649, .052271, .055035,</div>
<div class="line"><span class="lineno"> 1518</span>    .057948, .061019, .064256, .06767, .07127, .075066, .079069,</div>
<div class="line"><span class="lineno"> 1519</span>    .083291, .087744, .092441, .097396, .10262, .10814, .11396,</div>
<div class="line"><span class="lineno"> 1520</span>    .1201, .12658, .13342, .14064, .14826, .1563, .1648, .17376,</div>
<div class="line"><span class="lineno"> 1521</span>    .18323, .19324, .2038, .21496, .22674, .23919, .25234, .26624,</div>
<div class="line"><span class="lineno"> 1522</span>    .28093, .29646, .31287, .33021, .34855, .36794, .38844, .41012,</div>
<div class="line"><span class="lineno"> 1523</span>    .43305, .45731, .48297, .51011, .53884, .56924, .60141, .63547,</div>
<div class="line"><span class="lineno"> 1524</span>    .67152, .70969, .75012, .79292, .83826, .8863, .93718, .99111,</div>
<div class="line"><span class="lineno"> 1525</span>    1.0482, 1.1088, 1.173, 1.2411, 1.3133, 1.3898, 1.471, 1.5571,</div>
<div class="line"><span class="lineno"> 1526</span>    1.6485, 1.7455, 1.8485, 1.9577, 2.0737, 2.197, 2.3278, 2.4668,</div>
<div class="line"><span class="lineno"> 1527</span>    2.6145, 2.7715, 2.9383, 3.1156, 3.3042, 3.5047, 3.7181, 3.9451,</div>
<div class="line"><span class="lineno"> 1528</span>    4.1866, 4.4437, 4.7174, 5.0089, 5.3192, 5.65, 6.0025, 6.3782,</div>
<div class="line"><span class="lineno"> 1529</span>    6.7787, 7.206, 7.6617, 8.1479, 8.6669, 9.221, 9.8128, 10.445,</div>
<div class="line"><span class="lineno"> 1530</span>    11.12, 11.843, 12.615, 13.441, 14.325, 15.271, 16.283, 17.367,</div>
<div class="line"><span class="lineno"> 1531</span>    18.529, 19.776, 21.111, 22.544, 24.082, 25.731, 27.504, 29.409,</div>
<div class="line"><span class="lineno"> 1532</span>    31.452, 33.654, 36.024, 38.573, 41.323, 44.29, 47.492, 50.951,</div>
<div class="line"><span class="lineno"> 1533</span>    54.608, 58.588, 62.929, 67.629, 72.712, 78.226, 84.207, 90.699,</div>
<div class="line"><span class="lineno"> 1534</span>    97.749, 105.42, 113.77, 122.86, 132.78, 143.61, 155.44, 168.33,</div>
<div class="line"><span class="lineno"> 1535</span>    182.48, 198.01, 214.87, 233.39, 253.86, 276.34, 300.3, 327.28,</div>
<div class="line"><span class="lineno"> 1536</span>    356.89, 389.48, 422.29, 458.99, 501.39, 548.13, 595.62, 652.74,</div>
<div class="line"><span class="lineno"> 1537</span>    716.54, 784.57, 866.78, 960.59, 1062.8, 1072.5, 1189.5, 1319.4,</div>
<div class="line"><span class="lineno"> 1538</span>    1467.6, 1630.2, 1813.7, 2016.9, 2253., 2515.3, 2773.5, 3092.8,</div>
<div class="line"><span class="lineno"> 1539</span>    3444.4, 3720.4, 4104.3, 4527.5, 4645.9, 5021.7, 5462.2, 5597.,</div>
<div class="line"><span class="lineno"> 1540</span>    6110.6, 6732.5, 7513.8, 8270.6, 9640.6, 11487., 2796.1, 2680.1,</div>
<div class="line"><span class="lineno"> 1541</span>    2441.6, 2404.2, 2334.8, 2215.2, 1642.5, 1477.9, 1328.1, 1223.5,</div>
<div class="line"><span class="lineno"> 1542</span>    843.34, 766.96, 831.65, 834.84, 774.85, 1156.3, 1275.6, 1366.1,</div>
<div class="line"><span class="lineno"> 1543</span>    1795.6, 1885., 1936.5, 1953.4, 2154.4, 2002.7, 1789.8, 10381.,</div>
<div class="line"><span class="lineno"> 1544</span>    9040., 8216.5, 7384.7, 6721.9, 6187.7, 6143.8, 5703.9, 5276.6,</div>
<div class="line"><span class="lineno"> 1545</span>    4873.1, 4736., 4325.3, 3927., 3554.1, 3286.1, 2950.1, 2642.4,</div>
<div class="line"><span class="lineno"> 1546</span>    2368.7, 2138.9, 1914., 1719.6, 1543.9, 1388.6, 1252.1, 1132.2,</div>
<div class="line"><span class="lineno"> 1547</span>    1024.1, 1025.4, 920.58, 829.59, 750.54, 685.01, 624.25, 570.14,</div>
<div class="line"><span class="lineno"> 1548</span>    525.81, 481.85, 441.95, 408.71, 377.23, 345.86, 318.51, 292.26,</div>
<div class="line"><span class="lineno"> 1549</span>    268.34, 247.04, 227.14, 209.02, 192.69, 177.59, 163.78, 151.26,</div>
<div class="line"><span class="lineno"> 1550</span>    139.73, 129.19, 119.53, 110.7, 102.57, 95.109, 88.264, 81.948,</div>
<div class="line"><span class="lineno"> 1551</span>    76.13, 70.768, 65.827, 61.251, 57.022, 53.495, 49.824, 46.443,</div>
<div class="line"><span class="lineno"> 1552</span>    43.307, 40.405, 37.716, 35.241, 32.923, 30.77, 28.78, 26.915,</div>
<div class="line"><span class="lineno"> 1553</span>    25.177, 23.56, 22.059, 20.654, 19.345, 18.126, 16.988, 15.93,</div>
<div class="line"><span class="lineno"> 1554</span>    14.939, 14.014, 13.149, 12.343, 11.589, 10.884, 10.225, 9.6093,</div>
<div class="line"><span class="lineno"> 1555</span>    9.0327, 8.4934, 7.9889, 7.5166, 7.0744, 6.6604, 6.2727, 5.9098,</div>
<div class="line"><span class="lineno"> 1556</span>    5.5701, 5.2529, 4.955, 4.676, 4.4148, 4.171, 3.9426, 3.7332,</div>
<div class="line"><span class="lineno"> 1557</span>    3.5347, 3.3493, 3.1677, 3.0025, 2.8466, 2.6994, 2.5601, 2.4277,</div>
<div class="line"><span class="lineno"> 1558</span>    2.3016, 2.1814, 2.0664, 1.9564, 1.8279, 1.7311, 1.6427, 1.5645,</div>
<div class="line"><span class="lineno"> 1559</span>    1.4982, 1.443, 1.374, 1.3146, 1.2562, 1.17, 1.1105, 1.0272,</div>
<div class="line"><span class="lineno"> 1560</span>    .96863, .89718, .83654, .80226, .75908, .72431, .69573, .67174,</div>
<div class="line"><span class="lineno"> 1561</span>    .65126, .63315, .61693, .60182, .58715, .59554, .57649, .55526,</div>
<div class="line"><span class="lineno"> 1562</span>    .53177, .50622, .48176, .4813, .47642, .47492, .50273, .50293,</div>
<div class="line"><span class="lineno"> 1563</span>    .52687, .52239, .53419, .53814, .52626, .52211, .51492, .50622,</div>
<div class="line"><span class="lineno"> 1564</span>    .49746, .48841, .4792, .43534, .41999, .40349, .38586, .36799,</div>
<div class="line"><span class="lineno"> 1565</span>    .35108, .31089, .30803, .3171, .33599, .35041, .36149, .32924,</div>
<div class="line"><span class="lineno"> 1566</span>    .32462, .27309, .25961, .20922, .19504, .15683, .13098, .11588,</div>
<div class="line"><span class="lineno"> 1567</span>    .11478, .11204, .11363, .12135, .16423, .17785, .19094, .20236,</div>
<div class="line"><span class="lineno"> 1568</span>    .21084, .2154, .24108, .22848, .20871, .18797, .17963, .17834,</div>
<div class="line"><span class="lineno"> 1569</span>    .21552, .22284, .26945, .27052, .30108, .28977, .29772, .29224,</div>
<div class="line"><span class="lineno"> 1570</span>    .27658, .24956, .22777, .20654, .18392, .16338, .1452, .12916,</div>
<div class="line"><span class="lineno"> 1571</span>    .1152, .10304, .092437, .083163, .075031, .067878, .061564,</div>
<div class="line"><span class="lineno"> 1572</span>    .055976, .051018, .046609, .042679, .03917, .036032, .033223,</div>
<div class="line"><span class="lineno"> 1573</span>    .030706, .02845, .026428, .024617, .022998, .021554, .02027,</div>
<div class="line"><span class="lineno"> 1574</span>    .019136, .018141, .017278, .016541, .015926, .015432, .015058,</div>
<div class="line"><span class="lineno"> 1575</span>    .014807, .014666, .014635, .014728, .014947, .01527, .015728,</div>
<div class="line"><span class="lineno"> 1576</span>    .016345, .017026, .017798, .018839, .019752, .020636, .021886,</div>
<div class="line"><span class="lineno"> 1577</span>    .022695, .02327, .023478, .024292, .023544, .022222, .021932,</div>
<div class="line"><span class="lineno"> 1578</span>    .020052, .018143, .017722, .017031, .017782, .01938, .020734,</div>
<div class="line"><span class="lineno"> 1579</span>    .020476, .019255, .017477, .016878, .014617, .012489, .011765,</div>
<div class="line"><span class="lineno"> 1580</span>    .0099077, .0086446, .0079446, .0078644, .0079763, .008671,</div>
<div class="line"><span class="lineno"> 1581</span>    .01001, .0108, .012933, .015349, .016341, .018484, .020254,</div>
<div class="line"><span class="lineno"> 1582</span>    .020254, .020478, .019591, .018595, .018385, .019913, .022254,</div>
<div class="line"><span class="lineno"> 1583</span>    .024847, .025809, .028053, .029924, .030212, .031367, .03222,</div>
<div class="line"><span class="lineno"> 1584</span>    .032739, .032537, .03286, .033344, .033507, .033499, .033339,</div>
<div class="line"><span class="lineno"> 1585</span>    .032809, .033041, .031723, .029837, .027511, .026603, .024032,</div>
<div class="line"><span class="lineno"> 1586</span>    .021914, .020948, .021701, .023425, .024259, .024987, .023818,</div>
<div class="line"><span class="lineno"> 1587</span>    .021768, .019223, .018144, .015282, .012604, .01163, .0097907,</div>
<div class="line"><span class="lineno"> 1588</span>    .008336, .0082473, .0079582, .0088077, .009779, .010129, .012145,</div>
<div class="line"><span class="lineno"> 1589</span>    .014378, .016761, .01726, .018997, .019998, .019809, .01819,</div>
<div class="line"><span class="lineno"> 1590</span>    .016358, .016099, .01617, .017939, .020223, .022521, .02277,</div>
<div class="line"><span class="lineno"> 1591</span>    .024279, .025247, .024222, .023989, .023224, .021493, .020362,</div>
<div class="line"><span class="lineno"> 1592</span>    .018596, .017309, .015975, .014466, .013171, .011921, .01078,</div>
<div class="line"><span class="lineno"> 1593</span>    .0097229, .0087612, .0078729, .0070682, .0063494, .0057156,</div>
<div class="line"><span class="lineno"> 1594</span>    .0051459, .0046273, .0041712, .0037686, .0034119, .003095,</div>
<div class="line"><span class="lineno"> 1595</span>    .0028126, .0025603, .0023342, .0021314, .0019489, .0017845,</div>
<div class="line"><span class="lineno"> 1596</span>    .001636, .0015017, .00138, .0012697, .0011694, .0010782,</div>
<div class="line"><span class="lineno"> 1597</span>    9.9507e-4, 9.1931e-4, 8.5013e-4, 7.869e-4, 7.2907e-4, 6.7611e-4,</div>
<div class="line"><span class="lineno"> 1598</span>    6.2758e-4, 5.8308e-4, 5.4223e-4, 5.0473e-4, 4.7027e-4, 4.3859e-4,</div>
<div class="line"><span class="lineno"> 1599</span>    4.0946e-4, 3.8265e-4, 3.5798e-4, 3.3526e-4, 3.1436e-4, 2.9511e-4,</div>
<div class="line"><span class="lineno"> 1600</span>    2.7739e-4, 2.6109e-4, 2.4609e-4, 2.3229e-4, 2.1961e-4, 2.0797e-4,</div>
<div class="line"><span class="lineno"> 1601</span>    1.9729e-4, 1.875e-4, 1.7855e-4, 1.7038e-4, 1.6294e-4, 1.5619e-4,</div>
<div class="line"><span class="lineno"> 1602</span>    1.5007e-4, 1.4456e-4, 1.3961e-4, 1.3521e-4, 1.3131e-4, 1.2789e-4,</div>
<div class="line"><span class="lineno"> 1603</span>    1.2494e-4, 1.2242e-4, 1.2032e-4, 1.1863e-4, 1.1733e-4, 1.1641e-4,</div>
<div class="line"><span class="lineno"> 1604</span>    1.1585e-4, 1.1565e-4, 1.158e-4, 1.1629e-4, 1.1712e-4, 1.1827e-4,</div>
<div class="line"><span class="lineno"> 1605</span>    1.1976e-4, 1.2158e-4, 1.2373e-4, 1.262e-4, 1.2901e-4, 1.3214e-4,</div>
<div class="line"><span class="lineno"> 1606</span>    1.3562e-4, 1.3944e-4, 1.4361e-4, 1.4814e-4, 1.5303e-4, 1.5829e-4,</div>
<div class="line"><span class="lineno"> 1607</span>    1.6394e-4, 1.6999e-4, 1.7644e-4, 1.8332e-4, 1.9063e-4, 1.984e-4,</div>
<div class="line"><span class="lineno"> 1608</span>    2.0663e-4, 2.1536e-4, 2.246e-4, 2.3436e-4, 2.4468e-4, 2.5558e-4,</div>
<div class="line"><span class="lineno"> 1609</span>    2.6708e-4, 2.7921e-4, 2.92e-4, 3.0548e-4, 3.1968e-4, 3.3464e-4,</div>
<div class="line"><span class="lineno"> 1610</span>    3.5039e-4, 3.6698e-4, 3.8443e-4, 4.0281e-4, 4.2214e-4, 4.4248e-4,</div>
<div class="line"><span class="lineno"> 1611</span>    4.6389e-4, 4.864e-4, 5.1009e-4, 5.3501e-4, 5.6123e-4, 5.888e-4,</div>
<div class="line"><span class="lineno"> 1612</span>    6.1781e-4, 6.4833e-4, 6.8043e-4, 7.142e-4, 7.4973e-4, 7.8711e-4,</div>
<div class="line"><span class="lineno"> 1613</span>    8.2644e-4, 8.6783e-4, 9.1137e-4, 9.5721e-4, .0010054, .0010562,</div>
<div class="line"><span class="lineno"> 1614</span>    .0011096, .0011659, .0012251, .0012875, .0013532, .0014224,</div>
<div class="line"><span class="lineno"> 1615</span>    .0014953, .001572, .0016529, .0017381, .0018279, .0019226,</div>
<div class="line"><span class="lineno"> 1616</span>    .0020224, .0021277, .0022386, .0023557, .0024792, .0026095,</div>
<div class="line"><span class="lineno"> 1617</span>    .002747, .0028921, .0030453, .0032071, .003378, .0035586,</div>
<div class="line"><span class="lineno"> 1618</span>    .0037494, .003951, .0041642, .0043897, .0046282, .0048805,</div>
<div class="line"><span class="lineno"> 1619</span>    .0051476, .0054304, .00573, .0060473, .0063837, .0067404,</div>
<div class="line"><span class="lineno"> 1620</span>    .0071188, .0075203, .0079466, .0083994, .0088806, .0093922,</div>
<div class="line"><span class="lineno"> 1621</span>    .0099366, .010516, .011134, .011792, .012494, .013244, .014046,</div>
<div class="line"><span class="lineno"> 1622</span>    .014898, .015808, .016781, .017822, .018929, .020108, .02138,</div>
<div class="line"><span class="lineno"> 1623</span>    .022729, .02419, .02576, .027412, .029233, .031198, .033301,</div>
<div class="line"><span class="lineno"> 1624</span>    .035594, .038092, .040767, .04372, .046918, .050246, .053974,</div>
<div class="line"><span class="lineno"> 1625</span>    .058009, .061976, .066586, .071537, .076209, .081856, .087998,</div>
<div class="line"><span class="lineno"> 1626</span>    .093821, .10113, .10913, .11731, .12724, .13821, .15025, .1639,</div>
<div class="line"><span class="lineno"> 1627</span>    .17807, .19472, .21356, .23496, .25758, .28387, .31389, .34104,</div>
<div class="line"><span class="lineno"> 1628</span>    .37469, .40989, .43309, .46845, .5042, .5023, .52981, .55275,</div>
<div class="line"><span class="lineno"> 1629</span>    .51075, .51976, .52457, .44779, .44721, .4503, .4243, .45244,</div>
<div class="line"><span class="lineno"> 1630</span>    .49491, .55399, .39021, .24802, .2501, .2618, .27475, .28879,</div>
<div class="line"><span class="lineno"> 1631</span>    .31317, .33643, .36257, .4018, .43275, .46525, .53333, .56599,</div>
<div class="line"><span class="lineno"> 1632</span>    .60557, .70142, .74194, .77736, .88567, .91182, .93294, .98407,</div>
<div class="line"><span class="lineno"> 1633</span>    .98772, .99176, .9995, 1.2405, 1.3602, 1.338, 1.3255, 1.3267,</div>
<div class="line"><span class="lineno"> 1634</span>    1.3404, 1.3634, 1.3967, 1.4407, 1.4961, 1.5603, 1.6328, 1.7153,</div>
<div class="line"><span class="lineno"> 1635</span>    1.8094, 1.9091, 2.018, 2.1367, 2.264, 2.4035, 2.5562, 2.7179,</div>
<div class="line"><span class="lineno"> 1636</span>    2.9017, 3.1052, 3.3304, 3.5731, 3.8488, 4.1553, 4.4769, 4.7818,</div>
<div class="line"><span class="lineno"> 1637</span>    5.1711, 5.5204, 5.9516, 6.4097, 6.8899, 7.1118, 7.5469, 7.9735,</div>
<div class="line"><span class="lineno"> 1638</span>    7.9511, 8.3014, 8.6418, 8.4757, 8.8256, 9.2294, 9.6923, 10.033,</div>
<div class="line"><span class="lineno"> 1639</span>    10.842, 11.851, 11.78, 8.8435, 9.1381, 9.5956, 10.076, 10.629,</div>
<div class="line"><span class="lineno"> 1640</span>    11.22, 11.883, 12.69, 13.163, 13.974, 14.846, 16.027, 17.053,</div>
<div class="line"><span class="lineno"> 1641</span>    18.148, 19.715, 20.907, 22.163, 23.956, 25.235, 26.566, 27.94,</div>
<div class="line"><span class="lineno"> 1642</span>    29.576, 30.956, 32.432, 35.337, 39.911, 41.128, 42.625, 44.386,</div>
<div class="line"><span class="lineno"> 1643</span>    46.369, 48.619, 51.031, 53.674, 56.825, 59.921, 63.286, 66.929,</div>
<div class="line"><span class="lineno"> 1644</span>    70.859, 75.081, 79.618, 84.513, 89.739, 95.335, 101.35, 107.76,</div>
<div class="line"><span class="lineno"> 1645</span>    114.63, 121.98, 129.87, 138.3, 147.34, 157.04, 167.56, 178.67,</div>
<div class="line"><span class="lineno"> 1646</span>    190.61, 203.43, 217.19, 231.99, 247.88, 264.98, 283.37, 303.17,</div>
<div class="line"><span class="lineno"> 1647</span>    324.49, 347.47, 372.25, 398.98, 427.85, 459.06, 492.8, 529.31,</div>
<div class="line"><span class="lineno"> 1648</span>    568.89, 611.79, 658.35, 708.91, 763.87, 823.65, 888.72, 959.58,</div>
<div class="line"><span class="lineno"> 1649</span>    1036.8, 1121.8, 1213.9, 1314.3, 1423.8, 1543., 1672.8, 1813.4,</div>
<div class="line"><span class="lineno"> 1650</span>    1966.1, 2131.4, 2309.5, 2499.3, 2705., 2925.7, 3161.6, 3411.3,</div>
<div class="line"><span class="lineno"> 1651</span>    3611.5, 3889.2, 4191.1, 4519.3, 4877.9, 5272.9, 5712.9, 6142.7,</div>
<div class="line"><span class="lineno"> 1652</span>    6719.6, 7385., 8145., 8977.7, 9831.9, 10827., 11934., 13063.,</div>
<div class="line"><span class="lineno"> 1653</span>    14434., 15878., 17591., 19435., 21510., 23835., 26835., 29740.,</div>
<div class="line"><span class="lineno"> 1654</span>    32878., 36305., 39830., 43273., 46931., 50499., 49586., 51598.,</div>
<div class="line"><span class="lineno"> 1655</span>    53429., 54619., 55081., 55102., 54485., 53487., 52042., 42689.,</div>
<div class="line"><span class="lineno"> 1656</span>    42607., 44020., 47994., 54169., 53916., 55808., 56642., 46049.,</div>
<div class="line"><span class="lineno"> 1657</span>    44243., 32929., 30658., 21963., 20835., 15962., 13679., 17652.,</div>
<div class="line"><span class="lineno"> 1658</span>    19680., 22388., 25625., 29184., 32520., 35720., 38414., 40523.,</div>
<div class="line"><span class="lineno"> 1659</span>    49228., 48173., 45678., 41768., 37600., 41313., 42654., 44465.,</div>
<div class="line"><span class="lineno"> 1660</span>    55736., 56630., 65409., 63308., 66572., 61845., 60379., 56777.,</div>
<div class="line"><span class="lineno"> 1661</span>    51920., 46601., 41367., 36529., 32219., 28470., 25192., 22362.,</div>
<div class="line"><span class="lineno"> 1662</span>    19907., 17772., 15907., 14273., 12835., 11567., 10445., 9450.2,</div>
<div class="line"><span class="lineno"> 1663</span>    8565.1, 7776., 7070.8, 6439.2, 5872.3, 5362.4, 4903., 4488.3,</div>
<div class="line"><span class="lineno"> 1664</span>    4113.4, 3773.8, 3465.8, 3186.1, 2931.7, 2700.1, 2488.8, 2296.,</div>
<div class="line"><span class="lineno"> 1665</span>    2119.8, 1958.6, 1810.9, 1675.6, 1551.4, 1437.3, 1332.4, 1236.,</div>
<div class="line"><span class="lineno"> 1666</span>    1147.2, 1065.3, 989.86, 920.22, 855.91, 796.48, 741.53, 690.69,</div>
<div class="line"><span class="lineno"> 1667</span>    643.62, 600.02, 559.6, 522.13, 487.35, 455.06, 425.08, 397.21,</div>
<div class="line"><span class="lineno"> 1668</span>    371.3, 347.2, 324.78, 303.9, 284.46, 266.34, 249.45, 233.7,</div>
<div class="line"><span class="lineno"> 1669</span>    219.01, 205.3, 192.5, 180.55, 169.38, 158.95, 149.2, 140.07,</div>
<div class="line"><span class="lineno"> 1670</span>    131.54, 123.56, 116.09, 109.09, 102.54, 96.405, 90.655, 85.266,</div>
<div class="line"><span class="lineno"> 1671</span>    80.213, 75.475, 71.031, 66.861, 62.948, 59.275, 55.827, 52.587,</div>
<div class="line"><span class="lineno"> 1672</span>    49.544, 46.686, 43.998, 41.473, 39.099, 36.867, 34.768, 32.795,</div>
<div class="line"><span class="lineno"> 1673</span>    30.939, 29.192, 27.546, 25.998, 24.539, 23.164, 21.869, 20.65,</div>
<div class="line"><span class="lineno"> 1674</span>    19.501, 18.419, 17.399, 16.438, 15.532, 14.678, 13.874, 13.115,</div>
<div class="line"><span class="lineno"> 1675</span>    12.4, 11.726, 11.088, 10.488, 9.921, 9.3846, 8.8784, 8.3996,</div>
<div class="line"><span class="lineno"> 1676</span>    7.9469, 7.5197, 7.1174, 6.738, 6.379, 6.0409, 5.7213, 5.419,</div>
<div class="line"><span class="lineno"> 1677</span>    5.1327, 4.8611, 4.6046, 4.3617, 4.1316, 3.9138, 3.7077, 3.5125,</div>
<div class="line"><span class="lineno"> 1678</span>    3.3281, 3.1536, 2.9885, 2.8323, 2.6846, 2.5447, 2.4124, 2.2871,</div>
<div class="line"><span class="lineno"> 1679</span>    2.1686, 2.0564, 1.9501, 1.8495, 1.7543, 1.6641, 1.5787, 1.4978,</div>
<div class="line"><span class="lineno"> 1680</span>    1.4212, 1.3486, 1.2799, 1.2147, 1.1529, 1.0943, 1.0388, .98602,</div>
<div class="line"><span class="lineno"> 1681</span>    .93596, .8886, .84352, .80078, .76029, .722, .68585, .65161,</div>
<div class="line"><span class="lineno"> 1682</span>    .61901, .58808, .55854, .53044, .5039, .47853, .45459, .43173,</div>
<div class="line"><span class="lineno"> 1683</span>    .41008, .38965, .37021, .35186, .33444, .31797, .30234, .28758,</div>
<div class="line"><span class="lineno"> 1684</span>    .2736, .26036, .24764, .2357, .22431, .21342, .20295, .19288,</div>
<div class="line"><span class="lineno"> 1685</span>    .18334, .17444, .166, .15815, .15072, .14348, .13674, .13015,</div>
<div class="line"><span class="lineno"> 1686</span>    .12399, .11807, .11231, .10689, .10164, .096696, .091955,</div>
<div class="line"><span class="lineno"> 1687</span>    .087476, .083183, .079113, .075229, .071536, .068026, .064698,</div>
<div class="line"><span class="lineno"> 1688</span>    .06154, .058544, .055699, .052997, .050431, .047993, .045676,</div>
<div class="line"><span class="lineno"> 1689</span>    .043475, .041382, .039392, .037501, .035702, .033991, .032364,</div>
<div class="line"><span class="lineno"> 1690</span>    .030817, .029345, .027945, .026613, .025345, .024139, .022991,</div>
<div class="line"><span class="lineno"> 1691</span>    .021899, .02086, .019871, .018929, .018033, .01718, .016368,</div>
<div class="line"><span class="lineno"> 1692</span>    .015595, .014859, .014158, .013491, .012856, .012251, .011675,</div>
<div class="line"><span class="lineno"> 1693</span>    .011126, .010604, .010107, .0096331, .009182, .0087523, .0083431,</div>
<div class="line"><span class="lineno"> 1694</span>    .0079533, .0075821, .0072284, .0068915, .0065706, .0062649,</div>
<div class="line"><span class="lineno"> 1695</span>    .0059737, .0056963, .005432, .0051802, .0049404, .0047118,</div>
<div class="line"><span class="lineno"> 1696</span>    .0044941, .0042867, .0040891, .0039009, .0037216, .0035507,</div>
<div class="line"><span class="lineno"> 1697</span>    .003388, .0032329, .0030852, .0029445, .0028105, .0026829,</div>
<div class="line"><span class="lineno"> 1698</span>    .0025613, .0024455, .0023353, .0022303, .0021304, .0020353,</div>
<div class="line"><span class="lineno"> 1699</span>    .0019448, .0018587, .0017767, .0016988, .0016247, .0015543,</div>
<div class="line"><span class="lineno"> 1700</span>    .0014874, .0014238, .0013635, .0013062, .0012519, .0012005,</div>
<div class="line"><span class="lineno"> 1701</span>    .0011517, .0011057, .0010621, .001021, 9.8233e-4, 9.4589e-4,</div>
<div class="line"><span class="lineno"> 1702</span>    9.1167e-4, 8.7961e-4, 8.4964e-4, 8.2173e-4, 7.9582e-4, 7.7189e-4,</div>
<div class="line"><span class="lineno"> 1703</span>    7.499e-4, 7.2983e-4, 7.1167e-4, 6.9542e-4, 6.8108e-4, 6.6866e-4,</div>
<div class="line"><span class="lineno"> 1704</span>    6.5819e-4, 6.4971e-4, 6.4328e-4, 6.3895e-4, 6.3681e-4, 6.3697e-4,</div>
<div class="line"><span class="lineno"> 1705</span>    6.3956e-4, 6.4472e-4, 6.5266e-4, 6.6359e-4, 6.778e-4, 6.9563e-4,</div>
<div class="line"><span class="lineno"> 1706</span>    7.1749e-4, 7.4392e-4, 7.7556e-4, 8.1028e-4, 8.4994e-4, 8.8709e-4,</div>
<div class="line"><span class="lineno"> 1707</span>    9.3413e-4, 9.6953e-4, .0010202, .0010738, .0010976, .0011507,</div>
<div class="line"><span class="lineno"> 1708</span>    .0011686, .0012264, .001291, .0013346, .0014246, .0015293,</div>
<div class="line"><span class="lineno"> 1709</span>    .0016359, .0017824, .0019255, .0020854, .002247, .0024148,</div>
<div class="line"><span class="lineno"> 1710</span>    .0026199, .0027523, .0029704, .0030702, .0033047, .0035013,</div>
<div class="line"><span class="lineno"> 1711</span>    .0037576, .0040275, .0043089, .0046927, .0049307, .0053486,</div>
<div class="line"><span class="lineno"> 1712</span>    .0053809, .0056699, .0059325, .0055488, .005634, .0056392,</div>
<div class="line"><span class="lineno"> 1713</span>    .004946, .0048855, .0048208, .0044386, .0045498, .0046377,</div>
<div class="line"><span class="lineno"> 1714</span>    .0048939, .0052396, .0057324, .0060859, .0066906, .0071148,</div>
<div class="line"><span class="lineno"> 1715</span>    .0077224, .0082687, .008769, .0084471, .008572, .0087729,</div>
<div class="line"><span class="lineno"> 1716</span>    .008775, .0090742, .0080704, .0080288, .0085747, .0086087,</div>
<div class="line"><span class="lineno"> 1717</span>    .0086408, .0088752, .0089381, .0089757, .0093532, .0092824,</div>
<div class="line"><span class="lineno"> 1718</span>    .0092566, .0092645, .0092735, .009342, .0095806, .0097991,</div>
<div class="line"><span class="lineno"> 1719</span>    .010213, .010611, .011129, .011756, .013237, .01412, .015034,</div>
<div class="line"><span class="lineno"> 1720</span>    .015936, .01682, .018597, .019315, .019995, .020658, .021289,</div>
<div class="line"><span class="lineno"> 1721</span>    .022363, .022996, .023716, .024512, .025434, .026067, .027118,</div>
<div class="line"><span class="lineno"> 1722</span>    .028396, .029865, .031442, .033253, .03525, .037296, .039701,</div>
<div class="line"><span class="lineno"> 1723</span>    .042356, .045154, .048059, .051294, .054893, .058636, .061407,</div>
<div class="line"><span class="lineno"> 1724</span>    .065172, .068974, .072676, .073379, .076547, .079556, .079134,</div>
<div class="line"><span class="lineno"> 1725</span>    .082308, .085739, .090192, .09359, .099599, .10669, .11496,</div>
<div class="line"><span class="lineno"> 1726</span>    .1244, .13512, .14752, .14494, .15647, .1668, .17863, .19029,</div>
<div class="line"><span class="lineno"> 1727</span>    .20124, .20254, .21179, .21982, .21625, .22364, .23405, .23382,</div>
<div class="line"><span class="lineno"> 1728</span>    .2434, .25708, .26406, .27621, .28909, .30395, .31717, .33271,</div>
<div class="line"><span class="lineno"> 1729</span>    .3496, .36765, .38774, .40949, .446, .46985, .49846, .5287, .562,</div>
<div class="line"><span class="lineno"> 1730</span>    .59841, .64598, .68834, .7327, .78978, .8373, .88708, .94744,</div>
<div class="line"><span class="lineno"> 1731</span>    1.0006, 1.0574, 1.1215, 1.1856, 1.2546, 1.3292, 1.4107, 1.4974,</div>
<div class="line"><span class="lineno"> 1732</span>    1.5913, 1.6931, 1.8028, 1.9212, 2.0492, 2.1874, 2.3365, 2.4978,</div>
<div class="line"><span class="lineno"> 1733</span>    2.6718, 2.8588, 3.062, 3.2818, 3.5188, 3.7752, 4.0527, 4.3542,</div>
<div class="line"><span class="lineno"> 1734</span>    4.6782, 5.0312, 5.4123, 5.8246, 6.2639, 6.7435, 7.2636, 7.8064,</div>
<div class="line"><span class="lineno"> 1735</span>    8.4091, 9.0696, 9.7677, 10.548, 11.4, 12.309, 13.324, 14.284,</div>
<div class="line"><span class="lineno"> 1736</span>    15.445, 16.687, 18.019, 19.403, 20.847, 22.366, 23.925, 25.537,</div>
<div class="line"><span class="lineno"> 1737</span>    27.213, 28.069, 29.864, 31.829, 33.988, 35.856, 38.829, 42.321,</div>
<div class="line"><span class="lineno"> 1738</span>    46.319, 50.606, 55.126, 59.126, 64.162, 68.708, 74.615, 81.176,</div>
<div class="line"><span class="lineno"> 1739</span>    87.739, 95.494, 103.83, 113.38, 123.99, 135.8, 148.7, 162.58,</div>
<div class="line"><span class="lineno"> 1740</span>    176.32, 192.6, 211.47, 232.7, 252.64, 277.41, 305.38, 333.44,</div>
<div class="line"><span class="lineno"> 1741</span>    366.42, 402.66, 442.14, 484.53, 526.42, 568.15, 558.78, 582.6,</div>
<div class="line"><span class="lineno"> 1742</span>    600.98, 613.94, 619.44, 618.24, 609.84, 595.96, 484.86, 475.59,</div>
<div class="line"><span class="lineno"> 1743</span>    478.49, 501.56, 552.19, 628.44, 630.39, 658.92, 671.96, 562.7,</div>
<div class="line"><span class="lineno"> 1744</span>    545.88, 423.43, 400.14, 306.59, 294.13, 246.8, 226.51, 278.21,</div>
<div class="line"><span class="lineno"> 1745</span>    314.39, 347.22, 389.13, 433.16, 477.48, 521.67, 560.54, 683.6,</div>
<div class="line"><span class="lineno"> 1746</span>    696.37, 695.91, 683.1, 658.24, 634.89, 698.85, 742.87, 796.66,</div>
<div class="line"><span class="lineno"> 1747</span>    954.49, 1009.5, 1150.5, 1179.1, 1267.9, 1272.4, 1312.7, 1330.4,</div>
<div class="line"><span class="lineno"> 1748</span>    1331.6, 1315.8, 1308.3, 1293.3, 1274.6, 1249.5, 1213.2, 1172.1,</div>
<div class="line"><span class="lineno"> 1749</span>    1124.4, 930.33, 893.36, 871.27, 883.54, 940.76, 1036., 1025.6,</div>
<div class="line"><span class="lineno"> 1750</span>    1053.1, 914.51, 894.15, 865.03, 670.63, 508.41, 475.15, 370.85,</div>
<div class="line"><span class="lineno"> 1751</span>    361.06, 319.38, 312.75, 331.87, 367.13, 415., 467.94, 525.49,</div>
<div class="line"><span class="lineno"> 1752</span>    578.41, 624.66, 794.82, 796.97, 780.29, 736.49, 670.18, 603.75,</div>
<div class="line"><span class="lineno"> 1753</span>    659.67, 679.8, 857.12, 884.05, 900.65, 1046.1, 1141.9, 1083.,</div>
<div class="line"><span class="lineno"> 1754</span>    1089.2, 1e3, 947.08, 872.31, 787.91, 704.75, 624.93, 553.68,</div>
<div class="line"><span class="lineno"> 1755</span>    489.91, 434.21, 385.64, 343.3, 306.42, 274.18, 245.94, 221.11,</div>
<div class="line"><span class="lineno"> 1756</span>    199.23, 179.88, 162.73, 147.48, 133.88, 121.73, 110.86, 101.1,</div>
<div class="line"><span class="lineno"> 1757</span>    92.323, 84.417, 77.281, 70.831, 64.991, 59.694, 54.884, 50.509,</div>
<div class="line"><span class="lineno"> 1758</span>    46.526, 42.893, 39.58, 36.549, 33.776, 31.236, 28.907, 26.77,</div>
<div class="line"><span class="lineno"> 1759</span>    24.805, 23., 21.339, 19.81, 18.404, 17.105, 15.909, 14.801,</div>
<div class="line"><span class="lineno"> 1760</span>    13.778, 12.83, 11.954, 11.142, 10.389, 9.691, 9.0434, 8.4423,</div>
<div class="line"><span class="lineno"> 1761</span>    7.8842, 7.3657, 6.8838, 6.4357, 6.0189, 5.6308, 5.2696, 4.9332,</div>
<div class="line"><span class="lineno"> 1762</span>    4.6198, 4.3277, 4.0553, 3.8012, 3.5639, 3.3424, 3.1355, 2.9422,</div>
<div class="line"><span class="lineno"> 1763</span>    2.7614, 2.5924, 2.4343, 2.2864, 2.148, 2.0184, 1.8971, 1.7835,</div>
<div class="line"><span class="lineno"> 1764</span>    1.677, 1.5773, 1.4838, 1.3961, 1.3139, 1.2369, 1.1645, 1.0966,</div>
<div class="line"><span class="lineno"> 1765</span>    1.0329, .97309, .91686, .86406, .81439, .76767, .72381, .68252,</div>
<div class="line"><span class="lineno"> 1766</span>    .64359, .60695, .57247, .54008, .50957, .48092, .45401, .42862,</div>
<div class="line"><span class="lineno"> 1767</span>    .40465, .38202, .36072, .34052, .3216, .30386, .28711, .27135,</div>
<div class="line"><span class="lineno"> 1768</span>    .25651, .24252, .2293, .21689, .20517, .19416, .18381, .17396,</div>
<div class="line"><span class="lineno"> 1769</span>    .16469</div>
<div class="line"><span class="lineno"> 1770</span>  };</div>
<div class="line"><span class="lineno"> 1771</span> </div>
<div class="line"><span class="lineno"> 1772</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> co2230[2001] =</div>
<div class="line"><span class="lineno"> 1773</span>    { 2.743e-5, 2.8815e-5, 3.027e-5, 3.1798e-5,</div>
<div class="line"><span class="lineno"> 1774</span>    3.3405e-5, 3.5094e-5, 3.6869e-5, 3.8734e-5, 4.0694e-5, 4.2754e-5,</div>
<div class="line"><span class="lineno"> 1775</span>    4.492e-5, 4.7196e-5, 4.9588e-5, 5.2103e-5, 5.4747e-5, 5.7525e-5,</div>
<div class="line"><span class="lineno"> 1776</span>    6.0446e-5, 6.3516e-5, 6.6744e-5, 7.0137e-5, 7.3704e-5, 7.7455e-5,</div>
<div class="line"><span class="lineno"> 1777</span>    8.1397e-5, 8.5543e-5, 8.9901e-5, 9.4484e-5, 9.9302e-5, 1.0437e-4,</div>
<div class="line"><span class="lineno"> 1778</span>    1.097e-4, 1.153e-4, 1.2119e-4, 1.2738e-4, 1.3389e-4, 1.4074e-4,</div>
<div class="line"><span class="lineno"> 1779</span>    1.4795e-4, 1.5552e-4, 1.6349e-4, 1.7187e-4, 1.8068e-4, 1.8995e-4,</div>
<div class="line"><span class="lineno"> 1780</span>    1.997e-4, 2.0996e-4, 2.2075e-4, 2.321e-4, 2.4403e-4, 2.5659e-4,</div>
<div class="line"><span class="lineno"> 1781</span>    2.698e-4, 2.837e-4, 2.9832e-4, 3.137e-4, 3.2988e-4, 3.4691e-4,</div>
<div class="line"><span class="lineno"> 1782</span>    3.6483e-4, 3.8368e-4, 4.0351e-4, 4.2439e-4, 4.4635e-4, 4.6947e-4,</div>
<div class="line"><span class="lineno"> 1783</span>    4.9379e-4, 5.1939e-4, 5.4633e-4, 5.7468e-4, 6.0452e-4, 6.3593e-4,</div>
<div class="line"><span class="lineno"> 1784</span>    6.69e-4, 7.038e-4, 7.4043e-4, 7.79e-4, 8.1959e-4, 8.6233e-4,</div>
<div class="line"><span class="lineno"> 1785</span>    9.0732e-4, 9.5469e-4, .0010046, .0010571, .0011124, .0011706,</div>
<div class="line"><span class="lineno"> 1786</span>    .0012319, .0012964, .0013644, .001436, .0015114, .0015908,</div>
<div class="line"><span class="lineno"> 1787</span>    .0016745, .0017625, .0018553, .0019531, .002056, .0021645,</div>
<div class="line"><span class="lineno"> 1788</span>    .0022788, .0023992, .002526, .0026596, .0028004, .0029488,</div>
<div class="line"><span class="lineno"> 1789</span>    .0031052, .0032699, .0034436, .0036265, .0038194, .0040227,</div>
<div class="line"><span class="lineno"> 1790</span>    .0042369, .0044628, .0047008, .0049518, .0052164, .0054953,</div>
<div class="line"><span class="lineno"> 1791</span>    .0057894, .0060995, .0064265, .0067713, .007135, .0075184,</div>
<div class="line"><span class="lineno"> 1792</span>    .0079228, .0083494, .0087993, .0092738, .0097745, .010303,</div>
<div class="line"><span class="lineno"> 1793</span>    .01086, .011448, .012068, .012722, .013413, .014142, .014911,</div>
<div class="line"><span class="lineno"> 1794</span>    .015723, .01658, .017484, .018439, .019447, .020511, .021635,</div>
<div class="line"><span class="lineno"> 1795</span>    .022821, .024074, .025397, .026794, .02827, .029829, .031475,</div>
<div class="line"><span class="lineno"> 1796</span>    .033215, .035052, .036994, .039045, .041213, .043504, .045926,</div>
<div class="line"><span class="lineno"> 1797</span>    .048485, .05119, .05405, .057074, .060271, .063651, .067225,</div>
<div class="line"><span class="lineno"> 1798</span>    .071006, .075004, .079233, .083708, .088441, .093449, .098749,</div>
<div class="line"><span class="lineno"> 1799</span>    .10436, .11029, .11657, .12322, .13026, .13772, .14561, .15397,</div>
<div class="line"><span class="lineno"> 1800</span>    .16282, .1722, .18214, .19266, .20381, .21563, .22816, .24143,</div>
<div class="line"><span class="lineno"> 1801</span>    .2555, .27043, .28625, .30303, .32082, .3397, .35972, .38097,</div>
<div class="line"><span class="lineno"> 1802</span>    .40352, .42746, .45286, .47983, .50847, .53888, .57119, .6055,</div>
<div class="line"><span class="lineno"> 1803</span>    .64196, .6807, .72187, .76564, .81217, .86165, .91427, .97025,</div>
<div class="line"><span class="lineno"> 1804</span>    1.0298, 1.0932, 1.1606, 1.2324, 1.3088, 1.3902, 1.477, 1.5693,</div>
<div class="line"><span class="lineno"> 1805</span>    1.6678, 1.7727, 1.8845, 2.0038, 2.131, 2.2666, 2.4114, 2.5659,</div>
<div class="line"><span class="lineno"> 1806</span>    2.7309, 2.907, 3.0951, 3.2961, 3.5109, 3.7405, 3.986, 4.2485,</div>
<div class="line"><span class="lineno"> 1807</span>    4.5293, 4.8299, 5.1516, 5.4961, 5.8651, 6.2605, 6.6842, 7.1385,</div>
<div class="line"><span class="lineno"> 1808</span>    7.6256, 8.1481, 8.7089, 9.3109, 9.9573, 10.652, 11.398, 12.2,</div>
<div class="line"><span class="lineno"> 1809</span>    13.063, 13.992, 14.99, 16.064, 17.222, 18.469, 19.813, 21.263,</div>
<div class="line"><span class="lineno"> 1810</span>    22.828, 24.516, 26.34, 28.31, 30.437, 32.738, 35.226, 37.914,</div>
<div class="line"><span class="lineno"> 1811</span>    40.824, 43.974, 47.377, 51.061, 55.011, 59.299, 63.961, 69.013,</div>
<div class="line"><span class="lineno"> 1812</span>    74.492, 80.444, 86.919, 93.836, 101.23, 109.25, 117.98, 127.47,</div>
<div class="line"><span class="lineno"> 1813</span>    137.81, 149.07, 161.35, 174.75, 189.42, 205.49, 223.02, 242.26,</div>
<div class="line"><span class="lineno"> 1814</span>    263.45, 286.75, 311.94, 340.01, 370.86, 404.92, 440.44, 480.27,</div>
<div class="line"><span class="lineno"> 1815</span>    525.17, 574.71, 626.22, 686.8, 754.38, 827.07, 913.38, 1011.7,</div>
<div class="line"><span class="lineno"> 1816</span>    1121.5, 1161.6, 1289.5, 1432.2, 1595.4, 1777., 1983.3, 2216.1,</div>
<div class="line"><span class="lineno"> 1817</span>    2485.7, 2788.3, 3101.5, 3481., 3902.1, 4257.1, 4740., 5272.8,</div>
<div class="line"><span class="lineno"> 1818</span>    5457.9, 5946.2, 6505.3, 6668.4, 7302.4, 8061.6, 9015.8, 9908.3,</div>
<div class="line"><span class="lineno"> 1819</span>    11613., 13956., 3249.6, 3243., 2901.5, 2841.3, 2729.6, 2558.2,</div>
<div class="line"><span class="lineno"> 1820</span>    1797.8, 1583.2, 1386., 1233.5, 787.74, 701.46, 761.66, 767.21,</div>
<div class="line"><span class="lineno"> 1821</span>    722.83, 1180.6, 1332.1, 1461.6, 2032.9, 2166., 2255.9, 2294.7,</div>
<div class="line"><span class="lineno"> 1822</span>    2587.2, 2396.5, 2122.4, 12553., 10784., 9832.5, 8827.3, 8029.1,</div>
<div class="line"><span class="lineno"> 1823</span>    7377.9, 7347.1, 6783.8, 6239.1, 5721.1, 5503., 4975.1, 4477.8,</div>
<div class="line"><span class="lineno"> 1824</span>    4021.3, 3676.8, 3275.3, 2914.9, 2597.4, 2328.2, 2075.4, 1857.6,</div>
<div class="line"><span class="lineno"> 1825</span>    1663.6, 1493.3, 1343.8, 1213.3, 1095.6, 1066.5, 958.91, 865.15,</div>
<div class="line"><span class="lineno"> 1826</span>    783.31, 714.35, 650.77, 593.98, 546.2, 499.9, 457.87, 421.75,</div>
<div class="line"><span class="lineno"> 1827</span>    387.61, 355.25, 326.62, 299.7, 275.21, 253.17, 232.83, 214.31,</div>
<div class="line"><span class="lineno"> 1828</span>    197.5, 182.08, 167.98, 155.12, 143.32, 132.5, 122.58, 113.48,</div>
<div class="line"><span class="lineno"> 1829</span>    105.11, 97.415, 90.182, 83.463, 77.281, 71.587, 66.341, 61.493,</div>
<div class="line"><span class="lineno"> 1830</span>    57.014, 53.062, 49.21, 45.663, 42.38, 39.348, 36.547, 33.967,</div>
<div class="line"><span class="lineno"> 1831</span>    31.573, 29.357, 27.314, 25.415, 23.658, 22.03, 20.524, 19.125,</div>
<div class="line"><span class="lineno"> 1832</span>    17.829, 16.627, 15.511, 14.476, 13.514, 12.618, 11.786, 11.013,</div>
<div class="line"><span class="lineno"> 1833</span>    10.294, 9.6246, 9.0018, 8.4218, 7.8816, 7.3783, 6.9092, 6.4719,</div>
<div class="line"><span class="lineno"> 1834</span>    6.0641, 5.6838, 5.3289, 4.998, 4.6893, 4.4014, 4.1325, 3.8813,</div>
<div class="line"><span class="lineno"> 1835</span>    3.6469, 3.4283, 3.2241, 3.035, 2.8576, 2.6922, 2.5348, 2.3896,</div>
<div class="line"><span class="lineno"> 1836</span>    2.2535, 2.1258, 2.0059, 1.8929, 1.7862, 1.6854, 1.5898, 1.4992,</div>
<div class="line"><span class="lineno"> 1837</span>    1.4017, 1.3218, 1.2479, 1.1809, 1.1215, 1.0693, 1.0116, .96016,</div>
<div class="line"><span class="lineno"> 1838</span>    .9105, .84859, .80105, .74381, .69982, .65127, .60899, .57843,</div>
<div class="line"><span class="lineno"> 1839</span>    .54592, .51792, .49336, .47155, .45201, .43426, .41807, .40303,</div>
<div class="line"><span class="lineno"> 1840</span>    .38876, .3863, .37098, .35492, .33801, .32032, .30341, .29874,</div>
<div class="line"><span class="lineno"> 1841</span>    .29193, .28689, .29584, .29155, .29826, .29195, .29287, .2904,</div>
<div class="line"><span class="lineno"> 1842</span>    .28199, .27709, .27162, .26622, .26133, .25676, .25235, .23137,</div>
<div class="line"><span class="lineno"> 1843</span>    .22365, .21519, .20597, .19636, .18699, .16485, .16262, .16643,</div>
<div class="line"><span class="lineno"> 1844</span>    .17542, .18198, .18631, .16759, .16338, .13505, .1267, .10053,</div>
<div class="line"><span class="lineno"> 1845</span>    .092554, .074093, .062159, .055523, .054849, .05401, .05528,</div>
<div class="line"><span class="lineno"> 1846</span>    .058982, .07952, .08647, .093244, .099285, .10393, .10661,</div>
<div class="line"><span class="lineno"> 1847</span>    .12072, .11417, .10396, .093265, .089137, .088909, .10902,</div>
<div class="line"><span class="lineno"> 1848</span>    .11277, .13625, .13565, .14907, .14167, .1428, .13744, .12768,</div>
<div class="line"><span class="lineno"> 1849</span>    .11382, .10244, .091686, .08109, .071739, .063616, .056579,</div>
<div class="line"><span class="lineno"> 1850</span>    .050504, .045251, .040689, .036715, .033237, .030181, .027488,</div>
<div class="line"><span class="lineno"> 1851</span>    .025107, .022998, .021125, .01946, .017979, .016661, .015489,</div>
<div class="line"><span class="lineno"> 1852</span>    .014448, .013526, .012712, .011998, .011375, .010839, .010384,</div>
<div class="line"><span class="lineno"> 1853</span>    .010007, .0097053, .0094783, .0093257, .0092489, .0092504,</div>
<div class="line"><span class="lineno"> 1854</span>    .0093346, .0095077, .0097676, .01012, .01058, .011157, .011844,</div>
<div class="line"><span class="lineno"> 1855</span>    .012672, .013665, .014766, .015999, .017509, .018972, .020444,</div>
<div class="line"><span class="lineno"> 1856</span>    .022311, .023742, .0249, .025599, .026981, .026462, .025143,</div>
<div class="line"><span class="lineno"> 1857</span>    .025066, .022814, .020458, .020026, .019142, .020189, .022371,</div>
<div class="line"><span class="lineno"> 1858</span>    .024163, .023728, .02199, .019506, .018591, .015576, .012784,</div>
<div class="line"><span class="lineno"> 1859</span>    .011744, .0094777, .0079148, .0070652, .006986, .0071758,</div>
<div class="line"><span class="lineno"> 1860</span>    .008086, .0098025, .01087, .013609, .016764, .018137, .021061,</div>
<div class="line"><span class="lineno"> 1861</span>    .023498, .023576, .023965, .022828, .021519, .021283, .023364,</div>
<div class="line"><span class="lineno"> 1862</span>    .026457, .029782, .030856, .033486, .035515, .035543, .036558,</div>
<div class="line"><span class="lineno"> 1863</span>    .037198, .037472, .037045, .037284, .03777, .038085, .038366,</div>
<div class="line"><span class="lineno"> 1864</span>    .038526, .038282, .038915, .037697, .035667, .032941, .031959,</div>
<div class="line"><span class="lineno"> 1865</span>    .028692, .025918, .024596, .025592, .027873, .028935, .02984,</div>
<div class="line"><span class="lineno"> 1866</span>    .028148, .025305, .021912, .020454, .016732, .013357, .01205,</div>
<div class="line"><span class="lineno"> 1867</span>    .009731, .0079881, .0077704, .0074387, .0083895, .0096776,</div>
<div class="line"><span class="lineno"> 1868</span>    .010326, .01293, .015955, .019247, .020145, .02267, .024231,</div>
<div class="line"><span class="lineno"> 1869</span>    .024184, .022131, .019784, .01955, .01971, .022119, .025116,</div>
<div class="line"><span class="lineno"> 1870</span>    .027978, .028107, .029808, .030701, .029164, .028551, .027286,</div>
<div class="line"><span class="lineno"> 1871</span>    .024946, .023259, .020982, .019221, .017471, .015643, .014074,</div>
<div class="line"><span class="lineno"> 1872</span>    .01261, .011301, .010116, .0090582, .0081036, .0072542, .0065034,</div>
<div class="line"><span class="lineno"> 1873</span>    .0058436, .0052571, .0047321, .0042697, .0038607, .0034977,</div>
<div class="line"><span class="lineno"> 1874</span>    .0031747, .0028864, .0026284, .002397, .002189, .0020017,</div>
<div class="line"><span class="lineno"> 1875</span>    .0018326, .0016798, .0015414, .0014159, .0013019, .0011983,</div>
<div class="line"><span class="lineno"> 1876</span>    .0011039, .0010177, 9.391e-4, 8.6717e-4, 8.0131e-4, 7.4093e-4,</div>
<div class="line"><span class="lineno"> 1877</span>    6.8553e-4, 6.3464e-4, 5.8787e-4, 5.4487e-4, 5.0533e-4, 4.69e-4,</div>
<div class="line"><span class="lineno"> 1878</span>    4.3556e-4, 4.0474e-4, 3.7629e-4, 3.5e-4, 3.2569e-4, 3.032e-4,</div>
<div class="line"><span class="lineno"> 1879</span>    2.8239e-4, 2.6314e-4, 2.4535e-4, 2.2891e-4, 2.1374e-4, 1.9975e-4,</div>
<div class="line"><span class="lineno"> 1880</span>    1.8685e-4, 1.7498e-4, 1.6406e-4, 1.5401e-4, 1.4479e-4, 1.3633e-4,</div>
<div class="line"><span class="lineno"> 1881</span>    1.2858e-4, 1.2148e-4, 1.1499e-4, 1.0907e-4, 1.0369e-4, 9.8791e-5,</div>
<div class="line"><span class="lineno"> 1882</span>    9.4359e-5, 9.0359e-5, 8.6766e-5, 8.3555e-5, 8.0703e-5, 7.8192e-5,</div>
<div class="line"><span class="lineno"> 1883</span>    7.6003e-5, 7.4119e-5, 7.2528e-5, 7.1216e-5, 7.0171e-5, 6.9385e-5,</div>
<div class="line"><span class="lineno"> 1884</span>    6.8848e-5, 6.8554e-5, 6.8496e-5, 6.8669e-5, 6.9069e-5, 6.9694e-5,</div>
<div class="line"><span class="lineno"> 1885</span>    7.054e-5, 7.1608e-5, 7.2896e-5, 7.4406e-5, 7.6139e-5, 7.8097e-5,</div>
<div class="line"><span class="lineno"> 1886</span>    8.0283e-5, 8.2702e-5, 8.5357e-5, 8.8255e-5, 9.1402e-5, 9.4806e-5,</div>
<div class="line"><span class="lineno"> 1887</span>    9.8473e-5, 1.0241e-4, 1.0664e-4, 1.1115e-4, 1.1598e-4, 1.2112e-4,</div>
<div class="line"><span class="lineno"> 1888</span>    1.2659e-4, 1.3241e-4, 1.3859e-4, 1.4515e-4, 1.521e-4, 1.5947e-4,</div>
<div class="line"><span class="lineno"> 1889</span>    1.6728e-4, 1.7555e-4, 1.8429e-4, 1.9355e-4, 2.0334e-4, 2.1369e-4,</div>
<div class="line"><span class="lineno"> 1890</span>    2.2463e-4, 2.3619e-4, 2.4841e-4, 2.6132e-4, 2.7497e-4, 2.8938e-4,</div>
<div class="line"><span class="lineno"> 1891</span>    3.0462e-4, 3.2071e-4, 3.3771e-4, 3.5567e-4, 3.7465e-4, 3.947e-4,</div>
<div class="line"><span class="lineno"> 1892</span>    4.1588e-4, 4.3828e-4, 4.6194e-4, 4.8695e-4, 5.1338e-4, 5.4133e-4,</div>
<div class="line"><span class="lineno"> 1893</span>    5.7087e-4, 6.0211e-4, 6.3515e-4, 6.701e-4, 7.0706e-4, 7.4617e-4,</div>
<div class="line"><span class="lineno"> 1894</span>    7.8756e-4, 8.3136e-4, 8.7772e-4, 9.2681e-4, 9.788e-4, .0010339,</div>
<div class="line"><span class="lineno"> 1895</span>    .0010922, .001154, .0012195, .0012889, .0013626, .0014407,</div>
<div class="line"><span class="lineno"> 1896</span>    .0015235, .0016114, .0017048, .0018038, .001909, .0020207,</div>
<div class="line"><span class="lineno"> 1897</span>    .0021395, .0022657, .0023998, .0025426, .0026944, .002856,</div>
<div class="line"><span class="lineno"> 1898</span>    .0030281, .0032114, .0034068, .003615, .0038371, .004074,</div>
<div class="line"><span class="lineno"> 1899</span>    .004327, .0045971, .0048857, .0051942, .0055239, .0058766,</div>
<div class="line"><span class="lineno"> 1900</span>    .0062538, .0066573, .0070891, .007551, .0080455, .0085747,</div>
<div class="line"><span class="lineno"> 1901</span>    .0091412, .0097481, .010397, .011092, .011837, .012638, .013495,</div>
<div class="line"><span class="lineno"> 1902</span>    .014415, .01541, .016475, .017621, .018857, .020175, .02162,</div>
<div class="line"><span class="lineno"> 1903</span>    .023185, .024876, .02672, .028732, .030916, .033319, .035939,</div>
<div class="line"><span class="lineno"> 1904</span>    .038736, .041847, .04524, .048715, .052678, .056977, .061203,</div>
<div class="line"><span class="lineno"> 1905</span>    .066184, .07164, .076952, .083477, .090674, .098049, .10697,</div>
<div class="line"><span class="lineno"> 1906</span>    .1169, .1277, .14011, .15323, .1684, .18601, .20626, .22831,</div>
<div class="line"><span class="lineno"> 1907</span>    .25417, .28407, .31405, .34957, .38823, .41923, .46026, .50409,</div>
<div class="line"><span class="lineno"> 1908</span>    .51227, .54805, .57976, .53818, .55056, .557, .46741, .46403,</div>
<div class="line"><span class="lineno"> 1909</span>    .4636, .42265, .45166, .49852, .56663, .34306, .17779, .17697,</div>
<div class="line"><span class="lineno"> 1910</span>    .18346, .19129, .20014, .21778, .23604, .25649, .28676, .31238,</div>
<div class="line"><span class="lineno"> 1911</span>    .33856, .39998, .4288, .46568, .56654, .60786, .64473, .76466,</div>
<div class="line"><span class="lineno"> 1912</span>    .7897, .80778, .86443, .85736, .84798, .84157, 1.1385, 1.2446,</div>
<div class="line"><span class="lineno"> 1913</span>    1.1923, 1.1552, 1.1338, 1.1266, 1.1292, 1.1431, 1.1683, 1.2059,</div>
<div class="line"><span class="lineno"> 1914</span>    1.2521, 1.3069, 1.3712, 1.4471, 1.5275, 1.6165, 1.7145, 1.8189,</div>
<div class="line"><span class="lineno"> 1915</span>    1.9359, 2.065, 2.2007, 2.3591, 2.5362, 2.7346, 2.9515, 3.2021,</div>
<div class="line"><span class="lineno"> 1916</span>    3.4851, 3.7935, 4.0694, 4.4463, 4.807, 5.2443, 5.7178, 6.2231,</div>
<div class="line"><span class="lineno"> 1917</span>    6.4796, 6.9461, 7.4099, 7.3652, 7.7182, 8.048, 7.7373, 8.0363,</div>
<div class="line"><span class="lineno"> 1918</span>    8.3855, 8.8044, 9.0257, 9.8574, 10.948, 10.563, 6.8979, 7.0744,</div>
<div class="line"><span class="lineno"> 1919</span>    7.4121, 7.7663, 8.1768, 8.6243, 9.1437, 9.7847, 10.182, 10.849,</div>
<div class="line"><span class="lineno"> 1920</span>    11.572, 12.602, 13.482, 14.431, 15.907, 16.983, 18.11, 19.884,</div>
<div class="line"><span class="lineno"> 1921</span>    21.02, 22.18, 23.355, 24.848, 25.954, 27.13, 30.186, 34.893,</div>
<div class="line"><span class="lineno"> 1922</span>    35.682, 36.755, 38.111, 39.703, 41.58, 43.606, 45.868, 48.573,</div>
<div class="line"><span class="lineno"> 1923</span>    51.298, 54.291, 57.559, 61.116, 64.964, 69.124, 73.628, 78.471,</div>
<div class="line"><span class="lineno"> 1924</span>    83.683, 89.307, 95.341, 101.84, 108.83, 116.36, 124.46, 133.18,</div>
<div class="line"><span class="lineno"> 1925</span>    142.57, 152.79, 163.69, 175.43, 188.11, 201.79, 216.55, 232.51,</div>
<div class="line"><span class="lineno"> 1926</span>    249.74, 268.38, 288.54, 310.35, 333.97, 359.55, 387.26, 417.3,</div>
<div class="line"><span class="lineno"> 1927</span>    449.88, 485.2, 523.54, 565.14, 610.28, 659.31, 712.56, 770.43,</div>
<div class="line"><span class="lineno"> 1928</span>    833.36, 901.82, 976.36, 1057.6, 1146.8, 1243.8, 1350., 1466.3,</div>
<div class="line"><span class="lineno"> 1929</span>    1593.6, 1732.7, 1884.1, 2049.1, 2228.2, 2421.9, 2629.4, 2853.7,</div>
<div class="line"><span class="lineno"> 1930</span>    3094.4, 3351.1, 3622.3, 3829.8, 4123.1, 4438.3, 4777.2, 5144.1,</div>
<div class="line"><span class="lineno"> 1931</span>    5545.4, 5990.5, 6404.5, 6996.8, 7687.6, 8482.9, 9349.4, 10203.,</div>
<div class="line"><span class="lineno"> 1932</span>    11223., 12358., 13493., 14916., 16416., 18236., 20222., 22501.,</div>
<div class="line"><span class="lineno"> 1933</span>    25102., 28358., 31707., 35404., 39538., 43911., 48391., 53193.,</div>
<div class="line"><span class="lineno"> 1934</span>    58028., 58082., 61276., 64193., 66294., 67480., 67921., 67423.,</div>
<div class="line"><span class="lineno"> 1935</span>    66254., 64341., 51737., 51420., 53072., 58145., 66195., 65358.,</div>
<div class="line"><span class="lineno"> 1936</span>    67377., 67869., 53509., 50553., 35737., 32425., 21704., 19974.,</div>
<div class="line"><span class="lineno"> 1937</span>    14457., 12142., 16798., 19489., 23049., 27270., 31910., 36457.,</div>
<div class="line"><span class="lineno"> 1938</span>    40877., 44748., 47876., 59793., 58626., 55454., 50337., 44893.,</div>
<div class="line"><span class="lineno"> 1939</span>    50228., 52216., 54747., 69541., 70455., 81014., 77694., 80533.,</div>
<div class="line"><span class="lineno"> 1940</span>    73953., 70927., 65539., 59002., 52281., 45953., 40292., 35360.,</div>
<div class="line"><span class="lineno"> 1941</span>    31124., 27478., 24346., 21647., 19308., 17271., 15491., 13927.,</div>
<div class="line"><span class="lineno"> 1942</span>    12550., 11331., 10250., 9288.8, 8431.4, 7664.9, 6978.3, 6361.8,</div>
<div class="line"><span class="lineno"> 1943</span>    5807.4, 5307.7, 4856.8, 4449., 4079.8, 3744.9, 3440.8, 3164.2,</div>
<div class="line"><span class="lineno"> 1944</span>    2912.3, 2682.7, 2473., 2281.4, 2106., 1945.3, 1797.9, 1662.5,</div>
<div class="line"><span class="lineno"> 1945</span>    1538.1, 1423.6, 1318.1, 1221., 1131.5, 1049., 972.99, 902.87,</div>
<div class="line"><span class="lineno"> 1946</span>    838.01, 777.95, 722.2, 670.44, 622.35, 577.68, 536.21, 497.76,</div>
<div class="line"><span class="lineno"> 1947</span>    462.12, 429.13, 398.61, 370.39, 344.29, 320.16, 297.85, 277.2,</div>
<div class="line"><span class="lineno"> 1948</span>    258.08, 240.38, 223.97, 208.77, 194.66, 181.58, 169.43, 158.15,</div>
<div class="line"><span class="lineno"> 1949</span>    147.67, 137.92, 128.86, 120.44, 112.6, 105.3, 98.499, 92.166,</div>
<div class="line"><span class="lineno"> 1950</span>    86.264, 80.763, 75.632, 70.846, 66.381, 62.213, 58.321, 54.685,</div>
<div class="line"><span class="lineno"> 1951</span>    51.288, 48.114, 45.145, 42.368, 39.772, 37.341, 35.065, 32.937,</div>
<div class="line"><span class="lineno"> 1952</span>    30.943, 29.077, 27.33, 25.693, 24.158, 22.717, 21.367, 20.099,</div>
<div class="line"><span class="lineno"> 1953</span>    18.909, 17.792, 16.744, 15.761, 14.838, 13.971, 13.157, 12.393,</div>
<div class="line"><span class="lineno"> 1954</span>    11.676, 11.003, 10.369, 9.775, 9.2165, 8.6902, 8.1963, 7.7314,</div>
<div class="line"><span class="lineno"> 1955</span>    7.2923, 6.8794, 6.4898, 6.122, 5.7764, 5.4525, 5.1484, 4.8611,</div>
<div class="line"><span class="lineno"> 1956</span>    4.5918, 4.3379, 4.0982, 3.8716, 3.6567, 3.4545, 3.2634, 3.0828,</div>
<div class="line"><span class="lineno"> 1957</span>    2.9122, 2.7512, 2.5993, 2.4561, 2.3211, 2.1938, 2.0737, 1.9603,</div>
<div class="line"><span class="lineno"> 1958</span>    1.8534, 1.7525, 1.6572, 1.5673, 1.4824, 1.4022, 1.3265, 1.2551,</div>
<div class="line"><span class="lineno"> 1959</span>    1.1876, 1.1239, 1.0637, 1.0069, .9532, .90248, .85454, .80921,</div>
<div class="line"><span class="lineno"> 1960</span>    .76631, .72569, .6872, .65072, .61635, .5836, .55261, .52336,</div>
<div class="line"><span class="lineno"> 1961</span>    .49581, .46998, .44559, .42236, .40036, .37929, .35924, .34043,</div>
<div class="line"><span class="lineno"> 1962</span>    .32238, .30547, .28931, .27405, .25975, .24616, .23341, .22133,</div>
<div class="line"><span class="lineno"> 1963</span>    .20997, .19924, .18917, .17967, .17075, .16211, .15411, .14646,</div>
<div class="line"><span class="lineno"> 1964</span>    .13912, .13201, .12509, .11857, .11261, .10698, .10186, .097039,</div>
<div class="line"><span class="lineno"> 1965</span>    .092236, .087844, .083443, .07938, .075452, .071564, .067931,</div>
<div class="line"><span class="lineno"> 1966</span>    .064389, .061078, .057901, .054921, .052061, .049364, .046789,</div>
<div class="line"><span class="lineno"> 1967</span>    .04435, .042044, .039866, .037808, .035863, .034023, .032282,</div>
<div class="line"><span class="lineno"> 1968</span>    .030634, .029073, .027595, .026194, .024866, .023608, .022415,</div>
<div class="line"><span class="lineno"> 1969</span>    .021283, .02021, .019193, .018228, .017312, .016443, .015619,</div>
<div class="line"><span class="lineno"> 1970</span>    .014837, .014094, .01339, .012721, .012086, .011483, .010911,</div>
<div class="line"><span class="lineno"> 1971</span>    .010368, .009852, .0093623, .0088972, .0084556, .0080362,</div>
<div class="line"><span class="lineno"> 1972</span>    .0076379, .0072596, .0069003, .006559, .0062349, .0059269,</div>
<div class="line"><span class="lineno"> 1973</span>    .0056344, .0053565, .0050925, .0048417, .0046034, .004377,</div>
<div class="line"><span class="lineno"> 1974</span>    .0041618, .0039575, .0037633, .0035788, .0034034, .0032368,</div>
<div class="line"><span class="lineno"> 1975</span>    .0030785, .002928, .0027851, .0026492, .0025201, .0023975,</div>
<div class="line"><span class="lineno"> 1976</span>    .0022809, .0021701, .0020649, .0019649, .0018699, .0017796,</div>
<div class="line"><span class="lineno"> 1977</span>    .0016938, .0016122, .0015348, .0014612, .0013913, .001325,</div>
<div class="line"><span class="lineno"> 1978</span>    .0012619, .0012021, .0011452, .0010913, .0010401, 9.9149e-4,</div>
<div class="line"><span class="lineno"> 1979</span>    9.454e-4, 9.0169e-4, 8.6024e-4, 8.2097e-4, 7.8377e-4, 7.4854e-4,</div>
<div class="line"><span class="lineno"> 1980</span>    7.1522e-4, 6.8371e-4, 6.5393e-4, 6.2582e-4, 5.9932e-4, 5.7435e-4,</div>
<div class="line"><span class="lineno"> 1981</span>    5.5087e-4, 5.2882e-4, 5.0814e-4, 4.8881e-4, 4.7076e-4, 4.5398e-4,</div>
<div class="line"><span class="lineno"> 1982</span>    4.3843e-4, 4.2407e-4, 4.109e-4, 3.9888e-4, 3.88e-4, 3.7826e-4,</div>
<div class="line"><span class="lineno"> 1983</span>    3.6963e-4, 3.6213e-4, 3.5575e-4, 3.505e-4, 3.464e-4, 3.4346e-4,</div>
<div class="line"><span class="lineno"> 1984</span>    3.4173e-4, 3.4125e-4, 3.4206e-4, 3.4424e-4, 3.4787e-4, 3.5303e-4,</div>
<div class="line"><span class="lineno"> 1985</span>    3.5986e-4, 3.6847e-4, 3.7903e-4, 3.9174e-4, 4.0681e-4, 4.2455e-4,</div>
<div class="line"><span class="lineno"> 1986</span>    4.4527e-4, 4.6942e-4, 4.9637e-4, 5.2698e-4, 5.5808e-4, 5.9514e-4,</div>
<div class="line"><span class="lineno"> 1987</span>    6.2757e-4, 6.689e-4, 7.1298e-4, 7.3955e-4, 7.8403e-4, 8.0449e-4,</div>
<div class="line"><span class="lineno"> 1988</span>    8.5131e-4, 9.0256e-4, 9.3692e-4, .0010051, .0010846, .0011678,</div>
<div class="line"><span class="lineno"> 1989</span>    .001282, .0014016, .0015355, .0016764, .0018272, .0020055,</div>
<div class="line"><span class="lineno"> 1990</span>    .0021455, .0023421, .0024615, .0026786, .0028787, .0031259,</div>
<div class="line"><span class="lineno"> 1991</span>    .0034046, .0036985, .0040917, .0043902, .0048349, .0049531,</div>
<div class="line"><span class="lineno"> 1992</span>    .0052989, .0056148, .0052452, .0053357, .005333, .0045069,</div>
<div class="line"><span class="lineno"> 1993</span>    .0043851, .004253, .003738, .0038084, .0039013, .0041505,</div>
<div class="line"><span class="lineno"> 1994</span>    .0045372, .0050569, .0054507, .0061267, .0066122, .0072449,</div>
<div class="line"><span class="lineno"> 1995</span>    .0078012, .0082651, .0076538, .0076573, .0076806, .0075227,</div>
<div class="line"><span class="lineno"> 1996</span>    .0076269, .0063758, .006254, .0067749, .0067909, .0068231,</div>
<div class="line"><span class="lineno"> 1997</span>    .0072143, .0072762, .0072954, .007679, .0075107, .0073658,</div>
<div class="line"><span class="lineno"> 1998</span>    .0072441, .0071074, .0070378, .007176, .0072472, .0075844,</div>
<div class="line"><span class="lineno"> 1999</span>    .0079291, .008412, .0090165, .010688, .011535, .012375, .013166,</div>
<div class="line"><span class="lineno"> 2000</span>    .013895, .015567, .016011, .016392, .016737, .017043, .017731,</div>
<div class="line"><span class="lineno"> 2001</span>    .018031, .018419, .018877, .019474, .019868, .020604, .021538,</div>
<div class="line"><span class="lineno"> 2002</span>    .022653, .023869, .025288, .026879, .028547, .030524, .03274,</div>
<div class="line"><span class="lineno"> 2003</span>    .035132, .03769, .040567, .043793, .047188, .049962, .053542,</div>
<div class="line"><span class="lineno"> 2004</span>    .057205, .060776, .061489, .064419, .067124, .065945, .068487,</div>
<div class="line"><span class="lineno"> 2005</span>    .071209, .074783, .077039, .082444, .08902, .09692, .10617,</div>
<div class="line"><span class="lineno"> 2006</span>    .11687, .12952, .12362, .13498, .14412, .15492, .16519, .1744,</div>
<div class="line"><span class="lineno"> 2007</span>    .17096, .17714, .18208, .17363, .17813, .18564, .18295, .19045,</div>
<div class="line"><span class="lineno"> 2008</span>    .20252, .20815, .21844, .22929, .24229, .25321, .26588, .2797,</div>
<div class="line"><span class="lineno"> 2009</span>    .29465, .31136, .32961, .36529, .38486, .41027, .43694, .4667,</div>
<div class="line"><span class="lineno"> 2010</span>    .49943, .54542, .58348, .62303, .67633, .71755, .76054, .81371,</div>
<div class="line"><span class="lineno"> 2011</span>    .85934, .90841, .96438, 1.0207, 1.0821, 1.1491, 1.2226, 1.3018,</div>
<div class="line"><span class="lineno"> 2012</span>    1.388, 1.4818, 1.5835, 1.6939, 1.8137, 1.9435, 2.0843, 2.237,</div>
<div class="line"><span class="lineno"> 2013</span>    2.4026, 2.5818, 2.7767, 2.9885, 3.2182, 3.4679, 3.7391, 4.0349,</div>
<div class="line"><span class="lineno"> 2014</span>    4.3554, 4.7053, 5.0849, 5.4986, 5.9436, 6.4294, 6.9598, 7.5203,</div>
<div class="line"><span class="lineno"> 2015</span>    8.143, 8.8253, 9.5568, 10.371, 11.267, 12.233, 13.31, 14.357,</div>
<div class="line"><span class="lineno"> 2016</span>    15.598, 16.93, 18.358, 19.849, 21.408, 23.04, 24.706, 26.409,</div>
<div class="line"><span class="lineno"> 2017</span>    28.153, 28.795, 30.549, 32.43, 34.49, 36.027, 38.955, 42.465,</div>
<div class="line"><span class="lineno"> 2018</span>    46.565, 50.875, 55.378, 59.002, 63.882, 67.949, 73.693, 80.095,</div>
<div class="line"><span class="lineno"> 2019</span>    86.403, 94.264, 102.65, 112.37, 123.3, 135.54, 149.14, 163.83,</div>
<div class="line"><span class="lineno"> 2020</span>    179.17, 196.89, 217.91, 240.94, 264.13, 292.39, 324.83, 358.21,</div>
<div class="line"><span class="lineno"> 2021</span>    397.16, 440.5, 488.6, 541.04, 595.3, 650.43, 652.03, 688.74,</div>
<div class="line"><span class="lineno"> 2022</span>    719.47, 743.54, 757.68, 762.35, 756.43, 741.42, 595.43, 580.97,</div>
<div class="line"><span class="lineno"> 2023</span>    580.83, 605.68, 667.88, 764.49, 759.93, 789.12, 798.17, 645.66,</div>
<div class="line"><span class="lineno"> 2024</span>    615.65, 455.05, 421.09, 306.45, 289.14, 235.7, 215.52, 274.57,</div>
<div class="line"><span class="lineno"> 2025</span>    316.53, 357.73, 409.89, 465.06, 521.84, 579.02, 630.64, 794.46,</div>
<div class="line"><span class="lineno"> 2026</span>    813., 813.56, 796.25, 761.57, 727.97, 812.14, 866.75, 932.5,</div>
<div class="line"><span class="lineno"> 2027</span>    1132.8, 1194.8, 1362.2, 1387.2, 1482.3, 1479.7, 1517.9, 1533.1,</div>
<div class="line"><span class="lineno"> 2028</span>    1534.2, 1523.3, 1522.5, 1515.5, 1505.2, 1486.5, 1454., 1412.,</div>
<div class="line"><span class="lineno"> 2029</span>    1358.8, 1107.8, 1060.9, 1033.5, 1048.2, 1122.4, 1248.9, 1227.1,</div>
<div class="line"><span class="lineno"> 2030</span>    1255.4, 1058.9, 1020.7, 970.59, 715.24, 512.56, 468.47, 349.3,</div>
<div class="line"><span class="lineno"> 2031</span>    338.26, 299.22, 301.26, 332.38, 382.08, 445.49, 515.87, 590.85,</div>
<div class="line"><span class="lineno"> 2032</span>    662.3, 726.05, 955.59, 964.11, 945.17, 891.48, 807.11, 720.9,</div>
<div class="line"><span class="lineno"> 2033</span>    803.36, 834.46, 1073.9, 1107.1, 1123.6, 1296., 1393.7, 1303.1,</div>
<div class="line"><span class="lineno"> 2034</span>    1284.3, 1161.8, 1078.8, 976.13, 868.72, 767.4, 674.72, 593.73,</div>
<div class="line"><span class="lineno"> 2035</span>    523.12, 462.24, 409.75, 364.34, 325., 290.73, 260.76, 234.46,</div>
<div class="line"><span class="lineno"> 2036</span>    211.28, 190.78, 172.61, 156.44, 142.01, 129.12, 117.57, 107.2,</div>
<div class="line"><span class="lineno"> 2037</span>    97.877, 89.47, 81.882, 75.021, 68.807, 63.171, 58.052, 53.396,</div>
<div class="line"><span class="lineno"> 2038</span>    49.155, 45.288, 41.759, 38.531, 35.576, 32.868, 30.384, 28.102,</div>
<div class="line"><span class="lineno"> 2039</span>    26.003, 24.071, 22.293, 20.655, 19.147, 17.756, 16.476, 15.292,</div>
<div class="line"><span class="lineno"> 2040</span>    14.198, 13.183, 12.241, 11.367, 10.554, 9.7989, 9.0978, 8.4475,</div>
<div class="line"><span class="lineno"> 2041</span>    7.845, 7.2868, 6.7704, 6.2927, 5.8508, 5.4421, 5.064, 4.714,</div>
<div class="line"><span class="lineno"> 2042</span>    4.3902, 4.0902, 3.8121, 3.5543, 3.315, 3.093, 2.8869, 2.6953,</div>
<div class="line"><span class="lineno"> 2043</span>    2.5172, 2.3517, 2.1977, 2.0544, 1.9211, 1.7969, 1.6812, 1.5735,</div>
<div class="line"><span class="lineno"> 2044</span>    1.4731, 1.3794, 1.2921, 1.2107, 1.1346, 1.0637, .99744, .93554,</div>
<div class="line"><span class="lineno"> 2045</span>    .87771, .82368, .77313, .72587, .6816, .64014, .60134, .565,</div>
<div class="line"><span class="lineno"> 2046</span>    .53086, .49883, .46881, .44074, .4144, .38979, .36679, .34513,</div>
<div class="line"><span class="lineno"> 2047</span>    .32474, .30552, .28751, .27045, .25458, .23976, .22584, .21278,</div>
<div class="line"><span class="lineno"> 2048</span>    .20051, .18899, .17815, .16801, .15846, .14954, .14117, .13328,</div>
<div class="line"><span class="lineno"> 2049</span>    .12584</div>
<div class="line"><span class="lineno"> 2050</span>  };</div>
<div class="line"><span class="lineno"> 2051</span> </div>
<div class="line"><span class="lineno"> 2052</span>  <span class="comment">/* Get CO2 continuum absorption... */</span></div>
<div class="line"><span class="lineno"> 2053</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> xw = nu / 2 + 1;</div>
<div class="line"><span class="lineno"> 2054</span>  <span class="keywordflow">if</span> (xw &gt;= 1 &amp;&amp; xw &lt; 2001) {</div>
<div class="line"><span class="lineno"> 2055</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iw = (int) xw;</div>
<div class="line"><span class="lineno"> 2056</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dw = xw - iw;</div>
<div class="line"><span class="lineno"> 2057</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ew = 1 - dw;</div>
<div class="line"><span class="lineno"> 2058</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cw296 = ew * co2296[iw - 1] + dw * co2296[iw];</div>
<div class="line"><span class="lineno"> 2059</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cw260 = ew * co2260[iw - 1] + dw * co2260[iw];</div>
<div class="line"><span class="lineno"> 2060</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cw230 = ew * co2230[iw - 1] + dw * co2230[iw];</div>
<div class="line"><span class="lineno"> 2061</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dt230 = t - 230;</div>
<div class="line"><span class="lineno"> 2062</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dt260 = t - 260;</div>
<div class="line"><span class="lineno"> 2063</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dt296 = t - 296;</div>
<div class="line"><span class="lineno"> 2064</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ctw =</div>
<div class="line"><span class="lineno"> 2065</span>      dt260 * 5.050505e-4 * dt296 * cw230 -</div>
<div class="line"><span class="lineno"> 2066</span>      dt230 * 9.259259e-4 * dt296 * cw260 +</div>
<div class="line"><span class="lineno"> 2067</span>      dt230 * 4.208754e-4 * dt260 * cw296;</div>
<div class="line"><span class="lineno"> 2068</span>    <span class="keywordflow">return</span> u / <a class="code hl_define" href="jurassic_8h.html#a68eddd535923d17ddbc8bb03bab70b3b">NA</a> / 1000 * p / <a class="code hl_define" href="jurassic_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a> * ctw;</div>
<div class="line"><span class="lineno"> 2069</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2070</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2071</span>}</div>
<div class="ttc" id="ajurassic_8h_html_a1583b00a62bc1138f99bbfcd8ef81a6a"><div class="ttname"><a href="jurassic_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a></div><div class="ttdeci">#define P0</div><div class="ttdoc">Standard pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00183">jurassic.h:183</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a68eddd535923d17ddbc8bb03bab70b3b"><div class="ttname"><a href="jurassic_8h.html#a68eddd535923d17ddbc8bb03bab70b3b">NA</a></div><div class="ttdeci">#define NA</div><div class="ttdoc">Avogadro's number.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00168">jurassic.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b99f6f4581181857d4b89b27e8c2f87" name="a5b99f6f4581181857d4b89b27e8c2f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b99f6f4581181857d4b89b27e8c2f87">&#9670;&nbsp;</a></span>ctmh2o()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctmh2o </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute water vapor continuum (optical depth). </p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l02075">2075</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2080</span>                  {</div>
<div class="line"><span class="lineno"> 2081</span> </div>
<div class="line"><span class="lineno"> 2082</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> h2o296[2001] =</div>
<div class="line"><span class="lineno"> 2083</span>    { .17, .1695, .172, .168, .1687, .1624, .1606,</div>
<div class="line"><span class="lineno"> 2084</span>    .1508, .1447, .1344, .1214, .1133, .1009, .09217, .08297, .06989,</div>
<div class="line"><span class="lineno"> 2085</span>    .06513, .05469, .05056, .04417, .03779, .03484, .02994, .0272,</div>
<div class="line"><span class="lineno"> 2086</span>    .02325, .02063, .01818, .01592, .01405, .01251, .0108, .009647,</div>
<div class="line"><span class="lineno"> 2087</span>    .008424, .007519, .006555, .00588, .005136, .004511, .003989,</div>
<div class="line"><span class="lineno"> 2088</span>    .003509, .003114, .00274, .002446, .002144, .001895, .001676,</div>
<div class="line"><span class="lineno"> 2089</span>    .001486, .001312, .001164, .001031, 9.129e-4, 8.106e-4, 7.213e-4,</div>
<div class="line"><span class="lineno"> 2090</span>    6.4e-4, 5.687e-4, 5.063e-4, 4.511e-4, 4.029e-4, 3.596e-4,</div>
<div class="line"><span class="lineno"> 2091</span>    3.22e-4, 2.889e-4, 2.597e-4, 2.337e-4, 2.108e-4, 1.907e-4,</div>
<div class="line"><span class="lineno"> 2092</span>    1.728e-4, 1.57e-4, 1.43e-4, 1.305e-4, 1.195e-4, 1.097e-4,</div>
<div class="line"><span class="lineno"> 2093</span>    1.009e-4, 9.307e-5, 8.604e-5, 7.971e-5, 7.407e-5, 6.896e-5,</div>
<div class="line"><span class="lineno"> 2094</span>    6.433e-5, 6.013e-5, 5.631e-5, 5.283e-5, 4.963e-5, 4.669e-5,</div>
<div class="line"><span class="lineno"> 2095</span>    4.398e-5, 4.148e-5, 3.917e-5, 3.702e-5, 3.502e-5, 3.316e-5,</div>
<div class="line"><span class="lineno"> 2096</span>    3.142e-5, 2.978e-5, 2.825e-5, 2.681e-5, 2.546e-5, 2.419e-5,</div>
<div class="line"><span class="lineno"> 2097</span>    2.299e-5, 2.186e-5, 2.079e-5, 1.979e-5, 1.884e-5, 1.795e-5,</div>
<div class="line"><span class="lineno"> 2098</span>    1.711e-5, 1.633e-5, 1.559e-5, 1.49e-5, 1.426e-5, 1.367e-5,</div>
<div class="line"><span class="lineno"> 2099</span>    1.312e-5, 1.263e-5, 1.218e-5, 1.178e-5, 1.143e-5, 1.112e-5,</div>
<div class="line"><span class="lineno"> 2100</span>    1.088e-5, 1.07e-5, 1.057e-5, 1.05e-5, 1.051e-5, 1.059e-5,</div>
<div class="line"><span class="lineno"> 2101</span>    1.076e-5, 1.1e-5, 1.133e-5, 1.18e-5, 1.237e-5, 1.308e-5,</div>
<div class="line"><span class="lineno"> 2102</span>    1.393e-5, 1.483e-5, 1.614e-5, 1.758e-5, 1.93e-5, 2.123e-5,</div>
<div class="line"><span class="lineno"> 2103</span>    2.346e-5, 2.647e-5, 2.93e-5, 3.279e-5, 3.745e-5, 4.152e-5,</div>
<div class="line"><span class="lineno"> 2104</span>    4.813e-5, 5.477e-5, 6.203e-5, 7.331e-5, 8.056e-5, 9.882e-5,</div>
<div class="line"><span class="lineno"> 2105</span>    1.05e-4, 1.21e-4, 1.341e-4, 1.572e-4, 1.698e-4, 1.968e-4,</div>
<div class="line"><span class="lineno"> 2106</span>    2.175e-4, 2.431e-4, 2.735e-4, 2.867e-4, 3.19e-4, 3.371e-4,</div>
<div class="line"><span class="lineno"> 2107</span>    3.554e-4, 3.726e-4, 3.837e-4, 3.878e-4, 3.864e-4, 3.858e-4,</div>
<div class="line"><span class="lineno"> 2108</span>    3.841e-4, 3.852e-4, 3.815e-4, 3.762e-4, 3.618e-4, 3.579e-4,</div>
<div class="line"><span class="lineno"> 2109</span>    3.45e-4, 3.202e-4, 3.018e-4, 2.785e-4, 2.602e-4, 2.416e-4,</div>
<div class="line"><span class="lineno"> 2110</span>    2.097e-4, 1.939e-4, 1.689e-4, 1.498e-4, 1.308e-4, 1.17e-4,</div>
<div class="line"><span class="lineno"> 2111</span>    1.011e-4, 9.237e-5, 7.909e-5, 7.006e-5, 6.112e-5, 5.401e-5,</div>
<div class="line"><span class="lineno"> 2112</span>    4.914e-5, 4.266e-5, 3.963e-5, 3.316e-5, 3.037e-5, 2.598e-5,</div>
<div class="line"><span class="lineno"> 2113</span>    2.294e-5, 2.066e-5, 1.813e-5, 1.583e-5, 1.423e-5, 1.247e-5,</div>
<div class="line"><span class="lineno"> 2114</span>    1.116e-5, 9.76e-6, 8.596e-6, 7.72e-6, 6.825e-6, 6.108e-6,</div>
<div class="line"><span class="lineno"> 2115</span>    5.366e-6, 4.733e-6, 4.229e-6, 3.731e-6, 3.346e-6, 2.972e-6,</div>
<div class="line"><span class="lineno"> 2116</span>    2.628e-6, 2.356e-6, 2.102e-6, 1.878e-6, 1.678e-6, 1.507e-6,</div>
<div class="line"><span class="lineno"> 2117</span>    1.348e-6, 1.21e-6, 1.089e-6, 9.806e-7, 8.857e-7, 8.004e-7,</div>
<div class="line"><span class="lineno"> 2118</span>    7.261e-7, 6.599e-7, 6.005e-7, 5.479e-7, 5.011e-7, 4.595e-7,</div>
<div class="line"><span class="lineno"> 2119</span>    4.219e-7, 3.885e-7, 3.583e-7, 3.314e-7, 3.071e-7, 2.852e-7,</div>
<div class="line"><span class="lineno"> 2120</span>    2.654e-7, 2.474e-7, 2.311e-7, 2.162e-7, 2.026e-7, 1.902e-7,</div>
<div class="line"><span class="lineno"> 2121</span>    1.788e-7, 1.683e-7, 1.587e-7, 1.497e-7, 1.415e-7, 1.338e-7,</div>
<div class="line"><span class="lineno"> 2122</span>    1.266e-7, 1.2e-7, 1.138e-7, 1.08e-7, 1.027e-7, 9.764e-8,</div>
<div class="line"><span class="lineno"> 2123</span>    9.296e-8, 8.862e-8, 8.458e-8, 8.087e-8, 7.744e-8, 7.429e-8,</div>
<div class="line"><span class="lineno"> 2124</span>    7.145e-8, 6.893e-8, 6.664e-8, 6.468e-8, 6.322e-8, 6.162e-8,</div>
<div class="line"><span class="lineno"> 2125</span>    6.07e-8, 5.992e-8, 5.913e-8, 5.841e-8, 5.796e-8, 5.757e-8,</div>
<div class="line"><span class="lineno"> 2126</span>    5.746e-8, 5.731e-8, 5.679e-8, 5.577e-8, 5.671e-8, 5.656e-8,</div>
<div class="line"><span class="lineno"> 2127</span>    5.594e-8, 5.593e-8, 5.602e-8, 5.62e-8, 5.693e-8, 5.725e-8,</div>
<div class="line"><span class="lineno"> 2128</span>    5.858e-8, 6.037e-8, 6.249e-8, 6.535e-8, 6.899e-8, 7.356e-8,</div>
<div class="line"><span class="lineno"> 2129</span>    7.918e-8, 8.618e-8, 9.385e-8, 1.039e-7, 1.158e-7, 1.29e-7,</div>
<div class="line"><span class="lineno"> 2130</span>    1.437e-7, 1.65e-7, 1.871e-7, 2.121e-7, 2.427e-7, 2.773e-7,</div>
<div class="line"><span class="lineno"> 2131</span>    3.247e-7, 3.677e-7, 4.037e-7, 4.776e-7, 5.101e-7, 6.214e-7,</div>
<div class="line"><span class="lineno"> 2132</span>    6.936e-7, 7.581e-7, 8.486e-7, 9.355e-7, 9.942e-7, 1.063e-6,</div>
<div class="line"><span class="lineno"> 2133</span>    1.123e-6, 1.191e-6, 1.215e-6, 1.247e-6, 1.26e-6, 1.271e-6,</div>
<div class="line"><span class="lineno"> 2134</span>    1.284e-6, 1.317e-6, 1.323e-6, 1.349e-6, 1.353e-6, 1.362e-6,</div>
<div class="line"><span class="lineno"> 2135</span>    1.344e-6, 1.329e-6, 1.336e-6, 1.327e-6, 1.325e-6, 1.359e-6,</div>
<div class="line"><span class="lineno"> 2136</span>    1.374e-6, 1.415e-6, 1.462e-6, 1.526e-6, 1.619e-6, 1.735e-6,</div>
<div class="line"><span class="lineno"> 2137</span>    1.863e-6, 2.034e-6, 2.265e-6, 2.482e-6, 2.756e-6, 3.103e-6,</div>
<div class="line"><span class="lineno"> 2138</span>    3.466e-6, 3.832e-6, 4.378e-6, 4.913e-6, 5.651e-6, 6.311e-6,</div>
<div class="line"><span class="lineno"> 2139</span>    7.169e-6, 8.057e-6, 9.253e-6, 1.047e-5, 1.212e-5, 1.36e-5,</div>
<div class="line"><span class="lineno"> 2140</span>    1.569e-5, 1.776e-5, 2.02e-5, 2.281e-5, 2.683e-5, 2.994e-5,</div>
<div class="line"><span class="lineno"> 2141</span>    3.488e-5, 3.896e-5, 4.499e-5, 5.175e-5, 6.035e-5, 6.34e-5,</div>
<div class="line"><span class="lineno"> 2142</span>    7.281e-5, 7.923e-5, 8.348e-5, 9.631e-5, 1.044e-4, 1.102e-4,</div>
<div class="line"><span class="lineno"> 2143</span>    1.176e-4, 1.244e-4, 1.283e-4, 1.326e-4, 1.4e-4, 1.395e-4,</div>
<div class="line"><span class="lineno"> 2144</span>    1.387e-4, 1.363e-4, 1.314e-4, 1.241e-4, 1.228e-4, 1.148e-4,</div>
<div class="line"><span class="lineno"> 2145</span>    1.086e-4, 1.018e-4, 8.89e-5, 8.316e-5, 7.292e-5, 6.452e-5,</div>
<div class="line"><span class="lineno"> 2146</span>    5.625e-5, 5.045e-5, 4.38e-5, 3.762e-5, 3.29e-5, 2.836e-5,</div>
<div class="line"><span class="lineno"> 2147</span>    2.485e-5, 2.168e-5, 1.895e-5, 1.659e-5, 1.453e-5, 1.282e-5,</div>
<div class="line"><span class="lineno"> 2148</span>    1.132e-5, 1.001e-5, 8.836e-6, 7.804e-6, 6.922e-6, 6.116e-6,</div>
<div class="line"><span class="lineno"> 2149</span>    5.429e-6, 4.824e-6, 4.278e-6, 3.788e-6, 3.371e-6, 2.985e-6,</div>
<div class="line"><span class="lineno"> 2150</span>    2.649e-6, 2.357e-6, 2.09e-6, 1.858e-6, 1.647e-6, 1.462e-6,</div>
<div class="line"><span class="lineno"> 2151</span>    1.299e-6, 1.155e-6, 1.028e-6, 9.142e-7, 8.132e-7, 7.246e-7,</div>
<div class="line"><span class="lineno"> 2152</span>    6.451e-7, 5.764e-7, 5.151e-7, 4.603e-7, 4.121e-7, 3.694e-7,</div>
<div class="line"><span class="lineno"> 2153</span>    3.318e-7, 2.985e-7, 2.69e-7, 2.428e-7, 2.197e-7, 1.992e-7,</div>
<div class="line"><span class="lineno"> 2154</span>    1.81e-7, 1.649e-7, 1.506e-7, 1.378e-7, 1.265e-7, 1.163e-7,</div>
<div class="line"><span class="lineno"> 2155</span>    1.073e-7, 9.918e-8, 9.191e-8, 8.538e-8, 7.949e-8, 7.419e-8,</div>
<div class="line"><span class="lineno"> 2156</span>    6.94e-8, 6.508e-8, 6.114e-8, 5.761e-8, 5.437e-8, 5.146e-8,</div>
<div class="line"><span class="lineno"> 2157</span>    4.89e-8, 4.636e-8, 4.406e-8, 4.201e-8, 4.015e-8, 3.84e-8,</div>
<div class="line"><span class="lineno"> 2158</span>    3.661e-8, 3.51e-8, 3.377e-8, 3.242e-8, 3.13e-8, 3.015e-8,</div>
<div class="line"><span class="lineno"> 2159</span>    2.918e-8, 2.83e-8, 2.758e-8, 2.707e-8, 2.656e-8, 2.619e-8,</div>
<div class="line"><span class="lineno"> 2160</span>    2.609e-8, 2.615e-8, 2.63e-8, 2.675e-8, 2.745e-8, 2.842e-8,</div>
<div class="line"><span class="lineno"> 2161</span>    2.966e-8, 3.125e-8, 3.318e-8, 3.565e-8, 3.85e-8, 4.191e-8,</div>
<div class="line"><span class="lineno"> 2162</span>    4.59e-8, 5.059e-8, 5.607e-8, 6.239e-8, 6.958e-8, 7.796e-8,</div>
<div class="line"><span class="lineno"> 2163</span>    8.773e-8, 9.88e-8, 1.114e-7, 1.258e-7, 1.422e-7, 1.61e-7,</div>
<div class="line"><span class="lineno"> 2164</span>    1.822e-7, 2.06e-7, 2.337e-7, 2.645e-7, 2.996e-7, 3.393e-7,</div>
<div class="line"><span class="lineno"> 2165</span>    3.843e-7, 4.363e-7, 4.935e-7, 5.607e-7, 6.363e-7, 7.242e-7,</div>
<div class="line"><span class="lineno"> 2166</span>    8.23e-7, 9.411e-7, 1.071e-6, 1.232e-6, 1.402e-6, 1.6e-6, 1.82e-6,</div>
<div class="line"><span class="lineno"> 2167</span>    2.128e-6, 2.386e-6, 2.781e-6, 3.242e-6, 3.653e-6, 4.323e-6,</div>
<div class="line"><span class="lineno"> 2168</span>    4.747e-6, 5.321e-6, 5.919e-6, 6.681e-6, 7.101e-6, 7.983e-6,</div>
<div class="line"><span class="lineno"> 2169</span>    8.342e-6, 8.741e-6, 9.431e-6, 9.952e-6, 1.026e-5, 1.055e-5,</div>
<div class="line"><span class="lineno"> 2170</span>    1.095e-5, 1.095e-5, 1.087e-5, 1.056e-5, 1.026e-5, 9.715e-6,</div>
<div class="line"><span class="lineno"> 2171</span>    9.252e-6, 8.452e-6, 7.958e-6, 7.268e-6, 6.295e-6, 6.003e-6, 5e-6,</div>
<div class="line"><span class="lineno"> 2172</span>    4.591e-6, 3.983e-6, 3.479e-6, 3.058e-6, 2.667e-6, 2.293e-6,</div>
<div class="line"><span class="lineno"> 2173</span>    1.995e-6, 1.747e-6, 1.517e-6, 1.335e-6, 1.165e-6, 1.028e-6,</div>
<div class="line"><span class="lineno"> 2174</span>    9.007e-7, 7.956e-7, 7.015e-7, 6.192e-7, 5.491e-7, 4.859e-7,</div>
<div class="line"><span class="lineno"> 2175</span>    4.297e-7, 3.799e-7, 3.38e-7, 3.002e-7, 2.659e-7, 2.366e-7,</div>
<div class="line"><span class="lineno"> 2176</span>    2.103e-7, 1.861e-7, 1.655e-7, 1.469e-7, 1.309e-7, 1.162e-7,</div>
<div class="line"><span class="lineno"> 2177</span>    1.032e-7, 9.198e-8, 8.181e-8, 7.294e-8, 6.516e-8, 5.787e-8,</div>
<div class="line"><span class="lineno"> 2178</span>    5.163e-8, 4.612e-8, 4.119e-8, 3.695e-8, 3.308e-8, 2.976e-8,</div>
<div class="line"><span class="lineno"> 2179</span>    2.67e-8, 2.407e-8, 2.171e-8, 1.965e-8, 1.78e-8, 1.617e-8,</div>
<div class="line"><span class="lineno"> 2180</span>    1.47e-8, 1.341e-8, 1.227e-8, 1.125e-8, 1.033e-8, 9.524e-9,</div>
<div class="line"><span class="lineno"> 2181</span>    8.797e-9, 8.162e-9, 7.565e-9, 7.04e-9, 6.56e-9, 6.129e-9,</div>
<div class="line"><span class="lineno"> 2182</span>    5.733e-9, 5.376e-9, 5.043e-9, 4.75e-9, 4.466e-9, 4.211e-9,</div>
<div class="line"><span class="lineno"> 2183</span>    3.977e-9, 3.759e-9, 3.558e-9, 3.373e-9, 3.201e-9, 3.043e-9,</div>
<div class="line"><span class="lineno"> 2184</span>    2.895e-9, 2.76e-9, 2.635e-9, 2.518e-9, 2.411e-9, 2.314e-9,</div>
<div class="line"><span class="lineno"> 2185</span>    2.23e-9, 2.151e-9, 2.087e-9, 2.035e-9, 1.988e-9, 1.946e-9,</div>
<div class="line"><span class="lineno"> 2186</span>    1.927e-9, 1.916e-9, 1.916e-9, 1.933e-9, 1.966e-9, 2.018e-9,</div>
<div class="line"><span class="lineno"> 2187</span>    2.09e-9, 2.182e-9, 2.299e-9, 2.442e-9, 2.623e-9, 2.832e-9,</div>
<div class="line"><span class="lineno"> 2188</span>    3.079e-9, 3.368e-9, 3.714e-9, 4.104e-9, 4.567e-9, 5.091e-9,</div>
<div class="line"><span class="lineno"> 2189</span>    5.701e-9, 6.398e-9, 7.194e-9, 8.127e-9, 9.141e-9, 1.035e-8,</div>
<div class="line"><span class="lineno"> 2190</span>    1.177e-8, 1.338e-8, 1.508e-8, 1.711e-8, 1.955e-8, 2.216e-8,</div>
<div class="line"><span class="lineno"> 2191</span>    2.534e-8, 2.871e-8, 3.291e-8, 3.711e-8, 4.285e-8, 4.868e-8,</div>
<div class="line"><span class="lineno"> 2192</span>    5.509e-8, 6.276e-8, 7.262e-8, 8.252e-8, 9.4e-8, 1.064e-7,</div>
<div class="line"><span class="lineno"> 2193</span>    1.247e-7, 1.411e-7, 1.626e-7, 1.827e-7, 2.044e-7, 2.284e-7,</div>
<div class="line"><span class="lineno"> 2194</span>    2.452e-7, 2.854e-7, 3.026e-7, 3.278e-7, 3.474e-7, 3.693e-7,</div>
<div class="line"><span class="lineno"> 2195</span>    3.93e-7, 4.104e-7, 4.22e-7, 4.439e-7, 4.545e-7, 4.778e-7,</div>
<div class="line"><span class="lineno"> 2196</span>    4.812e-7, 5.018e-7, 4.899e-7, 5.075e-7, 5.073e-7, 5.171e-7,</div>
<div class="line"><span class="lineno"> 2197</span>    5.131e-7, 5.25e-7, 5.617e-7, 5.846e-7, 6.239e-7, 6.696e-7,</div>
<div class="line"><span class="lineno"> 2198</span>    7.398e-7, 8.073e-7, 9.15e-7, 1.009e-6, 1.116e-6, 1.264e-6,</div>
<div class="line"><span class="lineno"> 2199</span>    1.439e-6, 1.644e-6, 1.856e-6, 2.147e-6, 2.317e-6, 2.713e-6,</div>
<div class="line"><span class="lineno"> 2200</span>    2.882e-6, 2.99e-6, 3.489e-6, 3.581e-6, 4.033e-6, 4.26e-6,</div>
<div class="line"><span class="lineno"> 2201</span>    4.543e-6, 4.84e-6, 4.826e-6, 5.013e-6, 5.252e-6, 5.277e-6,</div>
<div class="line"><span class="lineno"> 2202</span>    5.306e-6, 5.236e-6, 5.123e-6, 5.171e-6, 4.843e-6, 4.615e-6,</div>
<div class="line"><span class="lineno"> 2203</span>    4.385e-6, 3.97e-6, 3.693e-6, 3.231e-6, 2.915e-6, 2.495e-6,</div>
<div class="line"><span class="lineno"> 2204</span>    2.144e-6, 1.91e-6, 1.639e-6, 1.417e-6, 1.226e-6, 1.065e-6,</div>
<div class="line"><span class="lineno"> 2205</span>    9.29e-7, 8.142e-7, 7.161e-7, 6.318e-7, 5.581e-7, 4.943e-7,</div>
<div class="line"><span class="lineno"> 2206</span>    4.376e-7, 3.884e-7, 3.449e-7, 3.06e-7, 2.712e-7, 2.412e-7,</div>
<div class="line"><span class="lineno"> 2207</span>    2.139e-7, 1.903e-7, 1.689e-7, 1.499e-7, 1.331e-7, 1.183e-7,</div>
<div class="line"><span class="lineno"> 2208</span>    1.05e-7, 9.362e-8, 8.306e-8, 7.403e-8, 6.578e-8, 5.853e-8,</div>
<div class="line"><span class="lineno"> 2209</span>    5.216e-8, 4.632e-8, 4.127e-8, 3.678e-8, 3.279e-8, 2.923e-8,</div>
<div class="line"><span class="lineno"> 2210</span>    2.612e-8, 2.339e-8, 2.094e-8, 1.877e-8, 1.686e-8, 1.516e-8,</div>
<div class="line"><span class="lineno"> 2211</span>    1.366e-8, 1.234e-8, 1.114e-8, 1.012e-8, 9.182e-9, 8.362e-9,</div>
<div class="line"><span class="lineno"> 2212</span>    7.634e-9, 6.981e-9, 6.406e-9, 5.888e-9, 5.428e-9, 5.021e-9,</div>
<div class="line"><span class="lineno"> 2213</span>    4.65e-9, 4.326e-9, 4.033e-9, 3.77e-9, 3.536e-9, 3.327e-9,</div>
<div class="line"><span class="lineno"> 2214</span>    3.141e-9, 2.974e-9, 2.825e-9, 2.697e-9, 2.584e-9, 2.488e-9,</div>
<div class="line"><span class="lineno"> 2215</span>    2.406e-9, 2.34e-9, 2.292e-9, 2.259e-9, 2.244e-9, 2.243e-9,</div>
<div class="line"><span class="lineno"> 2216</span>    2.272e-9, 2.31e-9, 2.378e-9, 2.454e-9, 2.618e-9, 2.672e-9,</div>
<div class="line"><span class="lineno"> 2217</span>    2.831e-9, 3.05e-9, 3.225e-9, 3.425e-9, 3.677e-9, 3.968e-9,</div>
<div class="line"><span class="lineno"> 2218</span>    4.221e-9, 4.639e-9, 4.96e-9, 5.359e-9, 5.649e-9, 6.23e-9,</div>
<div class="line"><span class="lineno"> 2219</span>    6.716e-9, 7.218e-9, 7.746e-9, 7.988e-9, 8.627e-9, 8.999e-9,</div>
<div class="line"><span class="lineno"> 2220</span>    9.442e-9, 9.82e-9, 1.015e-8, 1.06e-8, 1.079e-8, 1.109e-8,</div>
<div class="line"><span class="lineno"> 2221</span>    1.137e-8, 1.186e-8, 1.18e-8, 1.187e-8, 1.194e-8, 1.192e-8,</div>
<div class="line"><span class="lineno"> 2222</span>    1.224e-8, 1.245e-8, 1.246e-8, 1.318e-8, 1.377e-8, 1.471e-8,</div>
<div class="line"><span class="lineno"> 2223</span>    1.582e-8, 1.713e-8, 1.853e-8, 2.063e-8, 2.27e-8, 2.567e-8,</div>
<div class="line"><span class="lineno"> 2224</span>    2.891e-8, 3.264e-8, 3.744e-8, 4.286e-8, 4.915e-8, 5.623e-8,</div>
<div class="line"><span class="lineno"> 2225</span>    6.336e-8, 7.293e-8, 8.309e-8, 9.319e-8, 1.091e-7, 1.243e-7,</div>
<div class="line"><span class="lineno"> 2226</span>    1.348e-7, 1.449e-7, 1.62e-7, 1.846e-7, 1.937e-7, 2.04e-7,</div>
<div class="line"><span class="lineno"> 2227</span>    2.179e-7, 2.298e-7, 2.433e-7, 2.439e-7, 2.464e-7, 2.611e-7,</div>
<div class="line"><span class="lineno"> 2228</span>    2.617e-7, 2.582e-7, 2.453e-7, 2.401e-7, 2.349e-7, 2.203e-7,</div>
<div class="line"><span class="lineno"> 2229</span>    2.066e-7, 1.939e-7, 1.78e-7, 1.558e-7, 1.391e-7, 1.203e-7,</div>
<div class="line"><span class="lineno"> 2230</span>    1.048e-7, 9.464e-8, 8.306e-8, 7.239e-8, 6.317e-8, 5.52e-8,</div>
<div class="line"><span class="lineno"> 2231</span>    4.847e-8, 4.282e-8, 3.796e-8, 3.377e-8, 2.996e-8, 2.678e-8,</div>
<div class="line"><span class="lineno"> 2232</span>    2.4e-8, 2.134e-8, 1.904e-8, 1.705e-8, 1.523e-8, 1.35e-8,</div>
<div class="line"><span class="lineno"> 2233</span>    1.204e-8, 1.07e-8, 9.408e-9, 8.476e-9, 7.47e-9, 6.679e-9,</div>
<div class="line"><span class="lineno"> 2234</span>    5.929e-9, 5.267e-9, 4.711e-9, 4.172e-9, 3.761e-9, 3.288e-9,</div>
<div class="line"><span class="lineno"> 2235</span>    2.929e-9, 2.609e-9, 2.315e-9, 2.042e-9, 1.844e-9, 1.64e-9,</div>
<div class="line"><span class="lineno"> 2236</span>    1.47e-9, 1.31e-9, 1.176e-9, 1.049e-9, 9.377e-10, 8.462e-10,</div>
<div class="line"><span class="lineno"> 2237</span>    7.616e-10, 6.854e-10, 6.191e-10, 5.596e-10, 5.078e-10, 4.611e-10,</div>
<div class="line"><span class="lineno"> 2238</span>    4.197e-10, 3.83e-10, 3.505e-10, 3.215e-10, 2.956e-10, 2.726e-10,</div>
<div class="line"><span class="lineno"> 2239</span>    2.521e-10, 2.338e-10, 2.173e-10, 2.026e-10, 1.895e-10, 1.777e-10,</div>
<div class="line"><span class="lineno"> 2240</span>    1.672e-10, 1.579e-10, 1.496e-10, 1.423e-10, 1.358e-10, 1.302e-10,</div>
<div class="line"><span class="lineno"> 2241</span>    1.254e-10, 1.216e-10, 1.187e-10, 1.163e-10, 1.147e-10, 1.145e-10,</div>
<div class="line"><span class="lineno"> 2242</span>    1.15e-10, 1.17e-10, 1.192e-10, 1.25e-10, 1.298e-10, 1.345e-10,</div>
<div class="line"><span class="lineno"> 2243</span>    1.405e-10, 1.538e-10, 1.648e-10, 1.721e-10, 1.872e-10, 1.968e-10,</div>
<div class="line"><span class="lineno"> 2244</span>    2.089e-10, 2.172e-10, 2.317e-10, 2.389e-10, 2.503e-10, 2.585e-10,</div>
<div class="line"><span class="lineno"> 2245</span>    2.686e-10, 2.8e-10, 2.895e-10, 3.019e-10, 3.037e-10, 3.076e-10,</div>
<div class="line"><span class="lineno"> 2246</span>    3.146e-10, 3.198e-10, 3.332e-10, 3.397e-10, 3.54e-10, 3.667e-10,</div>
<div class="line"><span class="lineno"> 2247</span>    3.895e-10, 4.071e-10, 4.565e-10, 4.983e-10, 5.439e-10, 5.968e-10,</div>
<div class="line"><span class="lineno"> 2248</span>    6.676e-10, 7.456e-10, 8.405e-10, 9.478e-10, 1.064e-9, 1.218e-9,</div>
<div class="line"><span class="lineno"> 2249</span>    1.386e-9, 1.581e-9, 1.787e-9, 2.032e-9, 2.347e-9, 2.677e-9,</div>
<div class="line"><span class="lineno"> 2250</span>    3.008e-9, 3.544e-9, 4.056e-9, 4.687e-9, 5.331e-9, 6.227e-9,</div>
<div class="line"><span class="lineno"> 2251</span>    6.854e-9, 8.139e-9, 8.945e-9, 9.865e-9, 1.125e-8, 1.178e-8,</div>
<div class="line"><span class="lineno"> 2252</span>    1.364e-8, 1.436e-8, 1.54e-8, 1.672e-8, 1.793e-8, 1.906e-8,</div>
<div class="line"><span class="lineno"> 2253</span>    2.036e-8, 2.144e-8, 2.292e-8, 2.371e-8, 2.493e-8, 2.606e-8,</div>
<div class="line"><span class="lineno"> 2254</span>    2.706e-8, 2.866e-8, 3.036e-8, 3.136e-8, 3.405e-8, 3.665e-8,</div>
<div class="line"><span class="lineno"> 2255</span>    3.837e-8, 4.229e-8, 4.748e-8, 5.32e-8, 5.763e-8, 6.677e-8,</div>
<div class="line"><span class="lineno"> 2256</span>    7.216e-8, 7.716e-8, 8.958e-8, 9.419e-8, 1.036e-7, 1.108e-7,</div>
<div class="line"><span class="lineno"> 2257</span>    1.189e-7, 1.246e-7, 1.348e-7, 1.31e-7, 1.361e-7, 1.364e-7,</div>
<div class="line"><span class="lineno"> 2258</span>    1.363e-7, 1.343e-7, 1.293e-7, 1.254e-7, 1.235e-7, 1.158e-7,</div>
<div class="line"><span class="lineno"> 2259</span>    1.107e-7, 9.961e-8, 9.011e-8, 7.91e-8, 6.916e-8, 6.338e-8,</div>
<div class="line"><span class="lineno"> 2260</span>    5.564e-8, 4.827e-8, 4.198e-8, 3.695e-8, 3.276e-8, 2.929e-8,</div>
<div class="line"><span class="lineno"> 2261</span>    2.633e-8, 2.391e-8, 2.192e-8, 2.021e-8, 1.89e-8, 1.772e-8,</div>
<div class="line"><span class="lineno"> 2262</span>    1.667e-8, 1.603e-8, 1.547e-8, 1.537e-8, 1.492e-8, 1.515e-8,</div>
<div class="line"><span class="lineno"> 2263</span>    1.479e-8, 1.45e-8, 1.513e-8, 1.495e-8, 1.529e-8, 1.565e-8,</div>
<div class="line"><span class="lineno"> 2264</span>    1.564e-8, 1.553e-8, 1.569e-8, 1.584e-8, 1.57e-8, 1.538e-8,</div>
<div class="line"><span class="lineno"> 2265</span>    1.513e-8, 1.472e-8, 1.425e-8, 1.349e-8, 1.328e-8, 1.249e-8,</div>
<div class="line"><span class="lineno"> 2266</span>    1.17e-8, 1.077e-8, 9.514e-9, 8.614e-9, 7.46e-9, 6.621e-9,</div>
<div class="line"><span class="lineno"> 2267</span>    5.775e-9, 5.006e-9, 4.308e-9, 3.747e-9, 3.24e-9, 2.84e-9,</div>
<div class="line"><span class="lineno"> 2268</span>    2.481e-9, 2.184e-9, 1.923e-9, 1.71e-9, 1.504e-9, 1.334e-9,</div>
<div class="line"><span class="lineno"> 2269</span>    1.187e-9, 1.053e-9, 9.367e-10, 8.306e-10, 7.419e-10, 6.63e-10,</div>
<div class="line"><span class="lineno"> 2270</span>    5.918e-10, 5.277e-10, 4.717e-10, 4.222e-10, 3.783e-10, 3.39e-10,</div>
<div class="line"><span class="lineno"> 2271</span>    3.036e-10, 2.729e-10, 2.455e-10, 2.211e-10, 1.995e-10, 1.804e-10,</div>
<div class="line"><span class="lineno"> 2272</span>    1.635e-10, 1.485e-10, 1.355e-10, 1.24e-10, 1.139e-10, 1.051e-10,</div>
<div class="line"><span class="lineno"> 2273</span>    9.757e-11, 9.114e-11, 8.577e-11, 8.139e-11, 7.792e-11, 7.52e-11,</div>
<div class="line"><span class="lineno"> 2274</span>    7.39e-11, 7.311e-11, 7.277e-11, 7.482e-11, 7.698e-11, 8.162e-11,</div>
<div class="line"><span class="lineno"> 2275</span>    8.517e-11, 8.968e-11, 9.905e-11, 1.075e-10, 1.187e-10, 1.291e-10,</div>
<div class="line"><span class="lineno"> 2276</span>    1.426e-10, 1.573e-10, 1.734e-10, 1.905e-10, 2.097e-10, 2.28e-10,</div>
<div class="line"><span class="lineno"> 2277</span>    2.473e-10, 2.718e-10, 2.922e-10, 3.128e-10, 3.361e-10, 3.641e-10,</div>
<div class="line"><span class="lineno"> 2278</span>    3.91e-10, 4.196e-10, 4.501e-10, 4.932e-10, 5.258e-10, 5.755e-10,</div>
<div class="line"><span class="lineno"> 2279</span>    6.253e-10, 6.664e-10, 7.344e-10, 7.985e-10, 8.877e-10, 1.005e-9,</div>
<div class="line"><span class="lineno"> 2280</span>    1.118e-9, 1.251e-9, 1.428e-9, 1.61e-9, 1.888e-9, 2.077e-9,</div>
<div class="line"><span class="lineno"> 2281</span>    2.331e-9, 2.751e-9, 3.061e-9, 3.522e-9, 3.805e-9, 4.181e-9,</div>
<div class="line"><span class="lineno"> 2282</span>    4.575e-9, 5.167e-9, 5.634e-9, 6.007e-9, 6.501e-9, 6.829e-9,</div>
<div class="line"><span class="lineno"> 2283</span>    7.211e-9, 7.262e-9, 7.696e-9, 7.832e-9, 7.799e-9, 7.651e-9,</div>
<div class="line"><span class="lineno"> 2284</span>    7.304e-9, 7.15e-9, 6.977e-9, 6.603e-9, 6.209e-9, 5.69e-9,</div>
<div class="line"><span class="lineno"> 2285</span>    5.432e-9, 4.764e-9, 4.189e-9, 3.64e-9, 3.203e-9, 2.848e-9,</div>
<div class="line"><span class="lineno"> 2286</span>    2.51e-9, 2.194e-9, 1.946e-9, 1.75e-9, 1.567e-9, 1.426e-9,</div>
<div class="line"><span class="lineno"> 2287</span>    1.302e-9, 1.197e-9, 1.109e-9, 1.035e-9, 9.719e-10, 9.207e-10,</div>
<div class="line"><span class="lineno"> 2288</span>    8.957e-10, 8.578e-10, 8.262e-10, 8.117e-10, 7.987e-10, 7.875e-10,</div>
<div class="line"><span class="lineno"> 2289</span>    7.741e-10, 7.762e-10, 7.537e-10, 7.424e-10, 7.474e-10, 7.294e-10,</div>
<div class="line"><span class="lineno"> 2290</span>    7.216e-10, 7.233e-10, 7.075e-10, 6.892e-10, 6.618e-10, 6.314e-10,</div>
<div class="line"><span class="lineno"> 2291</span>    6.208e-10, 5.689e-10, 5.55e-10, 4.984e-10, 4.6e-10, 4.078e-10,</div>
<div class="line"><span class="lineno"> 2292</span>    3.879e-10, 3.459e-10, 2.982e-10, 2.626e-10, 2.329e-10, 1.988e-10,</div>
<div class="line"><span class="lineno"> 2293</span>    1.735e-10, 1.487e-10, 1.297e-10, 1.133e-10, 9.943e-11, 8.736e-11,</div>
<div class="line"><span class="lineno"> 2294</span>    7.726e-11, 6.836e-11, 6.053e-11, 5.384e-11, 4.789e-11, 4.267e-11,</div>
<div class="line"><span class="lineno"> 2295</span>    3.804e-11, 3.398e-11, 3.034e-11, 2.71e-11, 2.425e-11, 2.173e-11,</div>
<div class="line"><span class="lineno"> 2296</span>    1.95e-11, 1.752e-11, 1.574e-11, 1.418e-11, 1.278e-11, 1.154e-11,</div>
<div class="line"><span class="lineno"> 2297</span>    1.044e-11, 9.463e-12, 8.602e-12, 7.841e-12, 7.171e-12, 6.584e-12,</div>
<div class="line"><span class="lineno"> 2298</span>    6.073e-12, 5.631e-12, 5.254e-12, 4.937e-12, 4.679e-12, 4.476e-12,</div>
<div class="line"><span class="lineno"> 2299</span>    4.328e-12, 4.233e-12, 4.194e-12, 4.211e-12, 4.286e-12, 4.424e-12,</div>
<div class="line"><span class="lineno"> 2300</span>    4.628e-12, 4.906e-12, 5.262e-12, 5.708e-12, 6.254e-12, 6.914e-12,</div>
<div class="line"><span class="lineno"> 2301</span>    7.714e-12, 8.677e-12, 9.747e-12, 1.101e-11, 1.256e-11, 1.409e-11,</div>
<div class="line"><span class="lineno"> 2302</span>    1.597e-11, 1.807e-11, 2.034e-11, 2.316e-11, 2.622e-11, 2.962e-11,</div>
<div class="line"><span class="lineno"> 2303</span>    3.369e-11, 3.819e-11, 4.329e-11, 4.932e-11, 5.589e-11, 6.364e-11,</div>
<div class="line"><span class="lineno"> 2304</span>    7.284e-11, 8.236e-11, 9.447e-11, 1.078e-10, 1.229e-10, 1.417e-10,</div>
<div class="line"><span class="lineno"> 2305</span>    1.614e-10, 1.843e-10, 2.107e-10, 2.406e-10, 2.728e-10, 3.195e-10,</div>
<div class="line"><span class="lineno"> 2306</span>    3.595e-10, 4.153e-10, 4.736e-10, 5.41e-10, 6.088e-10, 6.769e-10,</div>
<div class="line"><span class="lineno"> 2307</span>    7.691e-10, 8.545e-10, 9.621e-10, 1.047e-9, 1.161e-9, 1.296e-9,</div>
<div class="line"><span class="lineno"> 2308</span>    1.424e-9, 1.576e-9, 1.739e-9, 1.893e-9, 2.08e-9, 2.336e-9,</div>
<div class="line"><span class="lineno"> 2309</span>    2.604e-9, 2.76e-9, 3.001e-9, 3.365e-9, 3.55e-9, 3.895e-9,</div>
<div class="line"><span class="lineno"> 2310</span>    4.183e-9, 4.614e-9, 4.846e-9, 5.068e-9, 5.427e-9, 5.541e-9,</div>
<div class="line"><span class="lineno"> 2311</span>    5.864e-9, 5.997e-9, 5.997e-9, 6.061e-9, 5.944e-9, 5.855e-9,</div>
<div class="line"><span class="lineno"> 2312</span>    5.661e-9, 5.523e-9, 5.374e-9, 4.94e-9, 4.688e-9, 4.17e-9,</div>
<div class="line"><span class="lineno"> 2313</span>    3.913e-9, 3.423e-9, 2.997e-9, 2.598e-9, 2.253e-9, 1.946e-9,</div>
<div class="line"><span class="lineno"> 2314</span>    1.71e-9, 1.507e-9, 1.336e-9, 1.19e-9, 1.068e-9, 9.623e-10,</div>
<div class="line"><span class="lineno"> 2315</span>    8.772e-10, 8.007e-10, 7.42e-10, 6.884e-10, 6.483e-10, 6.162e-10,</div>
<div class="line"><span class="lineno"> 2316</span>    5.922e-10, 5.688e-10, 5.654e-10, 5.637e-10, 5.701e-10, 5.781e-10,</div>
<div class="line"><span class="lineno"> 2317</span>    5.874e-10, 6.268e-10, 6.357e-10, 6.525e-10, 7.137e-10, 7.441e-10,</div>
<div class="line"><span class="lineno"> 2318</span>    8.024e-10, 8.485e-10, 9.143e-10, 9.536e-10, 9.717e-10, 1.018e-9,</div>
<div class="line"><span class="lineno"> 2319</span>    1.042e-9, 1.054e-9, 1.092e-9, 1.079e-9, 1.064e-9, 1.043e-9,</div>
<div class="line"><span class="lineno"> 2320</span>    1.02e-9, 9.687e-10, 9.273e-10, 9.208e-10, 9.068e-10, 7.687e-10,</div>
<div class="line"><span class="lineno"> 2321</span>    7.385e-10, 6.595e-10, 5.87e-10, 5.144e-10, 4.417e-10, 3.804e-10,</div>
<div class="line"><span class="lineno"> 2322</span>    3.301e-10, 2.866e-10, 2.509e-10, 2.202e-10, 1.947e-10, 1.719e-10,</div>
<div class="line"><span class="lineno"> 2323</span>    1.525e-10, 1.361e-10, 1.21e-10, 1.084e-10, 9.8e-11, 8.801e-11,</div>
<div class="line"><span class="lineno"> 2324</span>    7.954e-11, 7.124e-11, 6.335e-11, 5.76e-11, 5.132e-11, 4.601e-11,</div>
<div class="line"><span class="lineno"> 2325</span>    4.096e-11, 3.657e-11, 3.25e-11, 2.909e-11, 2.587e-11, 2.297e-11,</div>
<div class="line"><span class="lineno"> 2326</span>    2.05e-11, 1.828e-11, 1.632e-11, 1.462e-11, 1.314e-11, 1.185e-11,</div>
<div class="line"><span class="lineno"> 2327</span>    1.073e-11, 9.76e-12, 8.922e-12, 8.206e-12, 7.602e-12, 7.1e-12,</div>
<div class="line"><span class="lineno"> 2328</span>    6.694e-12, 6.378e-12, 6.149e-12, 6.004e-12, 5.941e-12, 5.962e-12,</div>
<div class="line"><span class="lineno"> 2329</span>    6.069e-12, 6.265e-12, 6.551e-12, 6.935e-12, 7.457e-12, 8.074e-12,</div>
<div class="line"><span class="lineno"> 2330</span>    8.811e-12, 9.852e-12, 1.086e-11, 1.207e-11, 1.361e-11, 1.553e-11,</div>
<div class="line"><span class="lineno"> 2331</span>    1.737e-11, 1.93e-11, 2.175e-11, 2.41e-11, 2.706e-11, 3.023e-11,</div>
<div class="line"><span class="lineno"> 2332</span>    3.313e-11, 3.657e-11, 4.118e-11, 4.569e-11, 5.025e-11, 5.66e-11,</div>
<div class="line"><span class="lineno"> 2333</span>    6.231e-11, 6.881e-11, 7.996e-11, 8.526e-11, 9.694e-11, 1.106e-10,</div>
<div class="line"><span class="lineno"> 2334</span>    1.222e-10, 1.355e-10, 1.525e-10, 1.775e-10, 1.924e-10, 2.181e-10,</div>
<div class="line"><span class="lineno"> 2335</span>    2.379e-10, 2.662e-10, 2.907e-10, 3.154e-10, 3.366e-10, 3.579e-10,</div>
<div class="line"><span class="lineno"> 2336</span>    3.858e-10, 4.046e-10, 4.196e-10, 4.166e-10, 4.457e-10, 4.466e-10,</div>
<div class="line"><span class="lineno"> 2337</span>    4.404e-10, 4.337e-10, 4.15e-10, 4.083e-10, 3.91e-10, 3.723e-10,</div>
<div class="line"><span class="lineno"> 2338</span>    3.514e-10, 3.303e-10, 2.847e-10, 2.546e-10, 2.23e-10, 1.994e-10,</div>
<div class="line"><span class="lineno"> 2339</span>    1.733e-10, 1.488e-10, 1.297e-10, 1.144e-10, 1.004e-10, 8.741e-11,</div>
<div class="line"><span class="lineno"> 2340</span>    7.928e-11, 7.034e-11, 6.323e-11, 5.754e-11, 5.25e-11, 4.85e-11,</div>
<div class="line"><span class="lineno"> 2341</span>    4.502e-11, 4.286e-11, 4.028e-11, 3.899e-11, 3.824e-11, 3.761e-11,</div>
<div class="line"><span class="lineno"> 2342</span>    3.804e-11, 3.839e-11, 3.845e-11, 4.244e-11, 4.382e-11, 4.582e-11,</div>
<div class="line"><span class="lineno"> 2343</span>    4.847e-11, 5.209e-11, 5.384e-11, 5.887e-11, 6.371e-11, 6.737e-11,</div>
<div class="line"><span class="lineno"> 2344</span>    7.168e-11, 7.415e-11, 7.827e-11, 8.037e-11, 8.12e-11, 8.071e-11,</div>
<div class="line"><span class="lineno"> 2345</span>    8.008e-11, 7.851e-11, 7.544e-11, 7.377e-11, 7.173e-11, 6.801e-11,</div>
<div class="line"><span class="lineno"> 2346</span>    6.267e-11, 5.727e-11, 5.288e-11, 4.853e-11, 4.082e-11, 3.645e-11,</div>
<div class="line"><span class="lineno"> 2347</span>    3.136e-11, 2.672e-11, 2.304e-11, 1.986e-11, 1.725e-11, 1.503e-11,</div>
<div class="line"><span class="lineno"> 2348</span>    1.315e-11, 1.153e-11, 1.014e-11, 8.942e-12, 7.901e-12, 6.993e-12,</div>
<div class="line"><span class="lineno"> 2349</span>    6.199e-12, 5.502e-12, 4.89e-12, 4.351e-12, 3.878e-12, 3.461e-12,</div>
<div class="line"><span class="lineno"> 2350</span>    3.094e-12, 2.771e-12, 2.488e-12, 2.241e-12, 2.025e-12, 1.838e-12,</div>
<div class="line"><span class="lineno"> 2351</span>    1.677e-12, 1.541e-12, 1.427e-12, 1.335e-12, 1.262e-12, 1.209e-12,</div>
<div class="line"><span class="lineno"> 2352</span>    1.176e-12, 1.161e-12, 1.165e-12, 1.189e-12, 1.234e-12, 1.3e-12,</div>
<div class="line"><span class="lineno"> 2353</span>    1.389e-12, 1.503e-12, 1.644e-12, 1.814e-12, 2.017e-12, 2.255e-12,</div>
<div class="line"><span class="lineno"> 2354</span>    2.534e-12, 2.858e-12, 3.231e-12, 3.661e-12, 4.153e-12, 4.717e-12,</div>
<div class="line"><span class="lineno"> 2355</span>    5.36e-12, 6.094e-12, 6.93e-12, 7.882e-12, 8.966e-12, 1.02e-11,</div>
<div class="line"><span class="lineno"> 2356</span>    1.162e-11, 1.324e-11, 1.51e-11, 1.72e-11, 1.965e-11, 2.237e-11,</div>
<div class="line"><span class="lineno"> 2357</span>    2.56e-11, 2.927e-11, 3.371e-11, 3.842e-11, 4.429e-11, 5.139e-11,</div>
<div class="line"><span class="lineno"> 2358</span>    5.798e-11, 6.697e-11, 7.626e-11, 8.647e-11, 1.022e-10, 1.136e-10,</div>
<div class="line"><span class="lineno"> 2359</span>    1.3e-10, 1.481e-10, 1.672e-10, 1.871e-10, 2.126e-10, 2.357e-10,</div>
<div class="line"><span class="lineno"> 2360</span>    2.583e-10, 2.997e-10, 3.289e-10, 3.702e-10, 4.012e-10, 4.319e-10,</div>
<div class="line"><span class="lineno"> 2361</span>    4.527e-10, 5.001e-10, 5.448e-10, 5.611e-10, 5.76e-10, 5.965e-10,</div>
<div class="line"><span class="lineno"> 2362</span>    6.079e-10, 6.207e-10, 6.276e-10, 6.222e-10, 6.137e-10, 6e-10,</div>
<div class="line"><span class="lineno"> 2363</span>    5.814e-10, 5.393e-10, 5.35e-10, 4.947e-10, 4.629e-10, 4.117e-10,</div>
<div class="line"><span class="lineno"> 2364</span>    3.712e-10, 3.372e-10, 2.923e-10, 2.55e-10, 2.232e-10, 1.929e-10,</div>
<div class="line"><span class="lineno"> 2365</span>    1.679e-10, 1.46e-10, 1.289e-10, 1.13e-10, 9.953e-11, 8.763e-11,</div>
<div class="line"><span class="lineno"> 2366</span>    7.76e-11, 6.9e-11, 6.16e-11, 5.525e-11, 4.958e-11, 4.489e-11,</div>
<div class="line"><span class="lineno"> 2367</span>    4.072e-11, 3.728e-11, 3.438e-11, 3.205e-11, 3.006e-11, 2.848e-11,</div>
<div class="line"><span class="lineno"> 2368</span>    2.766e-11, 2.688e-11, 2.664e-11, 2.67e-11, 2.696e-11, 2.786e-11,</div>
<div class="line"><span class="lineno"> 2369</span>    2.861e-11, 3.009e-11, 3.178e-11, 3.389e-11, 3.587e-11, 3.819e-11,</div>
<div class="line"><span class="lineno"> 2370</span>    4.054e-11, 4.417e-11, 4.703e-11, 5.137e-11, 5.46e-11, 6.055e-11,</div>
<div class="line"><span class="lineno"> 2371</span>    6.333e-11, 6.773e-11, 7.219e-11, 7.717e-11, 8.131e-11, 8.491e-11,</div>
<div class="line"><span class="lineno"> 2372</span>    8.574e-11, 9.01e-11, 9.017e-11, 8.999e-11, 8.959e-11, 8.838e-11,</div>
<div class="line"><span class="lineno"> 2373</span>    8.579e-11, 8.162e-11, 8.098e-11, 7.472e-11, 7.108e-11, 6.559e-11,</div>
<div class="line"><span class="lineno"> 2374</span>    5.994e-11, 5.172e-11, 4.424e-11, 3.951e-11, 3.34e-11, 2.902e-11,</div>
<div class="line"><span class="lineno"> 2375</span>    2.541e-11, 2.215e-11, 1.945e-11, 1.716e-11, 1.503e-11, 1.339e-11,</div>
<div class="line"><span class="lineno"> 2376</span>    1.185e-11, 1.05e-11, 9.336e-12, 8.307e-12, 7.312e-12, 6.55e-12,</div>
<div class="line"><span class="lineno"> 2377</span>    5.836e-12, 5.178e-12, 4.6e-12, 4.086e-12, 3.639e-12, 3.247e-12,</div>
<div class="line"><span class="lineno"> 2378</span>    2.904e-12, 2.604e-12, 2.341e-12, 2.112e-12, 1.914e-12, 1.744e-12,</div>
<div class="line"><span class="lineno"> 2379</span>    1.598e-12, 1.476e-12, 1.374e-12, 1.293e-12, 1.23e-12, 1.185e-12,</div>
<div class="line"><span class="lineno"> 2380</span>    1.158e-12, 1.147e-12, 1.154e-12, 1.177e-12, 1.219e-12, 1.28e-12,</div>
<div class="line"><span class="lineno"> 2381</span>    1.36e-12, 1.463e-12, 1.591e-12, 1.75e-12, 1.94e-12, 2.156e-12,</div>
<div class="line"><span class="lineno"> 2382</span>    2.43e-12, 2.748e-12, 3.052e-12, 3.533e-12, 3.967e-12, 4.471e-12,</div>
<div class="line"><span class="lineno"> 2383</span>    5.041e-12, 5.86e-12, 6.664e-12, 7.522e-12, 8.342e-12, 9.412e-12,</div>
<div class="line"><span class="lineno"> 2384</span>    1.072e-11, 1.213e-11, 1.343e-11, 1.496e-11, 1.664e-11, 1.822e-11,</div>
<div class="line"><span class="lineno"> 2385</span>    2.029e-11, 2.233e-11, 2.457e-11, 2.709e-11, 2.928e-11, 3.115e-11,</div>
<div class="line"><span class="lineno"> 2386</span>    3.356e-11, 3.592e-11, 3.818e-11, 3.936e-11, 4.061e-11, 4.149e-11,</div>
<div class="line"><span class="lineno"> 2387</span>    4.299e-11, 4.223e-11, 4.251e-11, 4.287e-11, 4.177e-11, 4.094e-11,</div>
<div class="line"><span class="lineno"> 2388</span>    3.942e-11, 3.772e-11, 3.614e-11, 3.394e-11, 3.222e-11, 2.791e-11,</div>
<div class="line"><span class="lineno"> 2389</span>    2.665e-11, 2.309e-11, 2.032e-11, 1.74e-11, 1.535e-11, 1.323e-11,</div>
<div class="line"><span class="lineno"> 2390</span>    1.151e-11, 9.803e-12, 8.65e-12, 7.54e-12, 6.619e-12, 5.832e-12,</div>
<div class="line"><span class="lineno"> 2391</span>    5.113e-12, 4.503e-12, 3.975e-12, 3.52e-12, 3.112e-12, 2.797e-12,</div>
<div class="line"><span class="lineno"> 2392</span>    2.5e-12, 2.24e-12, 2.013e-12, 1.819e-12, 1.653e-12, 1.513e-12,</div>
<div class="line"><span class="lineno"> 2393</span>    1.395e-12, 1.299e-12, 1.225e-12, 1.168e-12, 1.124e-12, 1.148e-12,</div>
<div class="line"><span class="lineno"> 2394</span>    1.107e-12, 1.128e-12, 1.169e-12, 1.233e-12, 1.307e-12, 1.359e-12,</div>
<div class="line"><span class="lineno"> 2395</span>    1.543e-12, 1.686e-12, 1.794e-12, 2.028e-12, 2.21e-12, 2.441e-12,</div>
<div class="line"><span class="lineno"> 2396</span>    2.653e-12, 2.828e-12, 3.093e-12, 3.28e-12, 3.551e-12, 3.677e-12,</div>
<div class="line"><span class="lineno"> 2397</span>    3.803e-12, 3.844e-12, 4.068e-12, 4.093e-12, 4.002e-12, 3.904e-12,</div>
<div class="line"><span class="lineno"> 2398</span>    3.624e-12, 3.633e-12, 3.622e-12, 3.443e-12, 3.184e-12, 2.934e-12,</div>
<div class="line"><span class="lineno"> 2399</span>    2.476e-12, 2.212e-12, 1.867e-12, 1.594e-12, 1.37e-12, 1.192e-12,</div>
<div class="line"><span class="lineno"> 2400</span>    1.045e-12, 9.211e-13, 8.17e-13, 7.29e-13, 6.55e-13, 5.929e-13,</div>
<div class="line"><span class="lineno"> 2401</span>    5.415e-13, 4.995e-13, 4.661e-13, 4.406e-13, 4.225e-13, 4.116e-13,</div>
<div class="line"><span class="lineno"> 2402</span>    4.075e-13, 4.102e-13, 4.198e-13, 4.365e-13, 4.606e-13, 4.925e-13,</div>
<div class="line"><span class="lineno"> 2403</span>    5.326e-13, 5.818e-13, 6.407e-13, 7.104e-13, 7.92e-13, 8.868e-13,</div>
<div class="line"><span class="lineno"> 2404</span>    9.964e-13, 1.123e-12, 1.268e-12, 1.434e-12, 1.626e-12, 1.848e-12,</div>
<div class="line"><span class="lineno"> 2405</span>    2.107e-12, 2.422e-12, 2.772e-12, 3.145e-12, 3.704e-12, 4.27e-12,</div>
<div class="line"><span class="lineno"> 2406</span>    4.721e-12, 5.361e-12, 6.083e-12, 7.095e-12, 7.968e-12, 9.228e-12,</div>
<div class="line"><span class="lineno"> 2407</span>    1.048e-11, 1.187e-11, 1.336e-11, 1.577e-11, 1.772e-11, 2.017e-11,</div>
<div class="line"><span class="lineno"> 2408</span>    2.25e-11, 2.63e-11, 2.911e-11, 3.356e-11, 3.82e-11, 4.173e-11,</div>
<div class="line"><span class="lineno"> 2409</span>    4.811e-11, 5.254e-11, 5.839e-11, 6.187e-11, 6.805e-11, 7.118e-11,</div>
<div class="line"><span class="lineno"> 2410</span>    7.369e-11, 7.664e-11, 7.794e-11, 7.947e-11, 8.036e-11, 7.954e-11,</div>
<div class="line"><span class="lineno"> 2411</span>    7.849e-11, 7.518e-11, 7.462e-11, 6.926e-11, 6.531e-11, 6.197e-11,</div>
<div class="line"><span class="lineno"> 2412</span>    5.421e-11, 4.777e-11, 4.111e-11, 3.679e-11, 3.166e-11, 2.786e-11,</div>
<div class="line"><span class="lineno"> 2413</span>    2.436e-11, 2.144e-11, 1.859e-11, 1.628e-11, 1.414e-11, 1.237e-11,</div>
<div class="line"><span class="lineno"> 2414</span>    1.093e-11, 9.558e-12</div>
<div class="line"><span class="lineno"> 2415</span>  };</div>
<div class="line"><span class="lineno"> 2416</span> </div>
<div class="line"><span class="lineno"> 2417</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> h2o260[2001] =</div>
<div class="line"><span class="lineno"> 2418</span>    { .2752, .2732, .2749, .2676, .2667, .2545,</div>
<div class="line"><span class="lineno"> 2419</span>    .2497, .2327, .2218, .2036, .1825, .1694, .1497, .1353, .121,</div>
<div class="line"><span class="lineno"> 2420</span>    .1014, .09405, .07848, .07195, .06246, .05306, .04853, .04138,</div>
<div class="line"><span class="lineno"> 2421</span>    .03735, .03171, .02785, .02431, .02111, .01845, .0164, .01405,</div>
<div class="line"><span class="lineno"> 2422</span>    .01255, .01098, .009797, .008646, .007779, .006898, .006099,</div>
<div class="line"><span class="lineno"> 2423</span>    .005453, .004909, .004413, .003959, .003581, .003199, .002871,</div>
<div class="line"><span class="lineno"> 2424</span>    .002583, .00233, .002086, .001874, .001684, .001512, .001361,</div>
<div class="line"><span class="lineno"> 2425</span>    .001225, .0011, 9.89e-4, 8.916e-4, 8.039e-4, 7.256e-4, 6.545e-4,</div>
<div class="line"><span class="lineno"> 2426</span>    5.918e-4, 5.359e-4, 4.867e-4, 4.426e-4, 4.033e-4, 3.682e-4,</div>
<div class="line"><span class="lineno"> 2427</span>    3.366e-4, 3.085e-4, 2.833e-4, 2.605e-4, 2.403e-4, 2.221e-4,</div>
<div class="line"><span class="lineno"> 2428</span>    2.055e-4, 1.908e-4, 1.774e-4, 1.653e-4, 1.544e-4, 1.443e-4,</div>
<div class="line"><span class="lineno"> 2429</span>    1.351e-4, 1.267e-4, 1.19e-4, 1.119e-4, 1.053e-4, 9.922e-5,</div>
<div class="line"><span class="lineno"> 2430</span>    9.355e-5, 8.831e-5, 8.339e-5, 7.878e-5, 7.449e-5, 7.043e-5,</div>
<div class="line"><span class="lineno"> 2431</span>    6.664e-5, 6.307e-5, 5.969e-5, 5.654e-5, 5.357e-5, 5.075e-5,</div>
<div class="line"><span class="lineno"> 2432</span>    4.81e-5, 4.56e-5, 4.322e-5, 4.102e-5, 3.892e-5, 3.696e-5,</div>
<div class="line"><span class="lineno"> 2433</span>    3.511e-5, 3.339e-5, 3.177e-5, 3.026e-5, 2.886e-5, 2.756e-5,</div>
<div class="line"><span class="lineno"> 2434</span>    2.636e-5, 2.527e-5, 2.427e-5, 2.337e-5, 2.257e-5, 2.185e-5,</div>
<div class="line"><span class="lineno"> 2435</span>    2.127e-5, 2.08e-5, 2.041e-5, 2.013e-5, 2e-5, 1.997e-5, 2.009e-5,</div>
<div class="line"><span class="lineno"> 2436</span>    2.031e-5, 2.068e-5, 2.124e-5, 2.189e-5, 2.267e-5, 2.364e-5,</div>
<div class="line"><span class="lineno"> 2437</span>    2.463e-5, 2.618e-5, 2.774e-5, 2.937e-5, 3.144e-5, 3.359e-5,</div>
<div class="line"><span class="lineno"> 2438</span>    3.695e-5, 4.002e-5, 4.374e-5, 4.947e-5, 5.431e-5, 6.281e-5,</div>
<div class="line"><span class="lineno"> 2439</span>    7.169e-5, 8.157e-5, 9.728e-5, 1.079e-4, 1.337e-4, 1.442e-4,</div>
<div class="line"><span class="lineno"> 2440</span>    1.683e-4, 1.879e-4, 2.223e-4, 2.425e-4, 2.838e-4, 3.143e-4,</div>
<div class="line"><span class="lineno"> 2441</span>    3.527e-4, 4.012e-4, 4.237e-4, 4.747e-4, 5.057e-4, 5.409e-4,</div>
<div class="line"><span class="lineno"> 2442</span>    5.734e-4, 5.944e-4, 6.077e-4, 6.175e-4, 6.238e-4, 6.226e-4,</div>
<div class="line"><span class="lineno"> 2443</span>    6.248e-4, 6.192e-4, 6.098e-4, 5.818e-4, 5.709e-4, 5.465e-4,</div>
<div class="line"><span class="lineno"> 2444</span>    5.043e-4, 4.699e-4, 4.294e-4, 3.984e-4, 3.672e-4, 3.152e-4,</div>
<div class="line"><span class="lineno"> 2445</span>    2.883e-4, 2.503e-4, 2.211e-4, 1.92e-4, 1.714e-4, 1.485e-4,</div>
<div class="line"><span class="lineno"> 2446</span>    1.358e-4, 1.156e-4, 1.021e-4, 8.887e-5, 7.842e-5, 7.12e-5,</div>
<div class="line"><span class="lineno"> 2447</span>    6.186e-5, 5.73e-5, 4.792e-5, 4.364e-5, 3.72e-5, 3.28e-5,</div>
<div class="line"><span class="lineno"> 2448</span>    2.946e-5, 2.591e-5, 2.261e-5, 2.048e-5, 1.813e-5, 1.63e-5,</div>
<div class="line"><span class="lineno"> 2449</span>    1.447e-5, 1.282e-5, 1.167e-5, 1.041e-5, 9.449e-6, 8.51e-6,</div>
<div class="line"><span class="lineno"> 2450</span>    7.596e-6, 6.961e-6, 6.272e-6, 5.728e-6, 5.198e-6, 4.667e-6,</div>
<div class="line"><span class="lineno"> 2451</span>    4.288e-6, 3.897e-6, 3.551e-6, 3.235e-6, 2.952e-6, 2.688e-6,</div>
<div class="line"><span class="lineno"> 2452</span>    2.449e-6, 2.241e-6, 2.05e-6, 1.879e-6, 1.722e-6, 1.582e-6,</div>
<div class="line"><span class="lineno"> 2453</span>    1.456e-6, 1.339e-6, 1.236e-6, 1.144e-6, 1.06e-6, 9.83e-7,</div>
<div class="line"><span class="lineno"> 2454</span>    9.149e-7, 8.535e-7, 7.973e-7, 7.466e-7, 6.999e-7, 6.574e-7,</div>
<div class="line"><span class="lineno"> 2455</span>    6.18e-7, 5.821e-7, 5.487e-7, 5.18e-7, 4.896e-7, 4.631e-7,</div>
<div class="line"><span class="lineno"> 2456</span>    4.386e-7, 4.16e-7, 3.945e-7, 3.748e-7, 3.562e-7, 3.385e-7,</div>
<div class="line"><span class="lineno"> 2457</span>    3.222e-7, 3.068e-7, 2.922e-7, 2.788e-7, 2.659e-7, 2.539e-7,</div>
<div class="line"><span class="lineno"> 2458</span>    2.425e-7, 2.318e-7, 2.219e-7, 2.127e-7, 2.039e-7, 1.958e-7,</div>
<div class="line"><span class="lineno"> 2459</span>    1.885e-7, 1.818e-7, 1.758e-7, 1.711e-7, 1.662e-7, 1.63e-7,</div>
<div class="line"><span class="lineno"> 2460</span>    1.605e-7, 1.58e-7, 1.559e-7, 1.545e-7, 1.532e-7, 1.522e-7,</div>
<div class="line"><span class="lineno"> 2461</span>    1.51e-7, 1.495e-7, 1.465e-7, 1.483e-7, 1.469e-7, 1.448e-7,</div>
<div class="line"><span class="lineno"> 2462</span>    1.444e-7, 1.436e-7, 1.426e-7, 1.431e-7, 1.425e-7, 1.445e-7,</div>
<div class="line"><span class="lineno"> 2463</span>    1.477e-7, 1.515e-7, 1.567e-7, 1.634e-7, 1.712e-7, 1.802e-7,</div>
<div class="line"><span class="lineno"> 2464</span>    1.914e-7, 2.024e-7, 2.159e-7, 2.295e-7, 2.461e-7, 2.621e-7,</div>
<div class="line"><span class="lineno"> 2465</span>    2.868e-7, 3.102e-7, 3.394e-7, 3.784e-7, 4.223e-7, 4.864e-7,</div>
<div class="line"><span class="lineno"> 2466</span>    5.501e-7, 6.039e-7, 7.193e-7, 7.728e-7, 9.514e-7, 1.073e-6,</div>
<div class="line"><span class="lineno"> 2467</span>    1.18e-6, 1.333e-6, 1.472e-6, 1.566e-6, 1.677e-6, 1.784e-6,</div>
<div class="line"><span class="lineno"> 2468</span>    1.904e-6, 1.953e-6, 2.02e-6, 2.074e-6, 2.128e-6, 2.162e-6,</div>
<div class="line"><span class="lineno"> 2469</span>    2.219e-6, 2.221e-6, 2.249e-6, 2.239e-6, 2.235e-6, 2.185e-6,</div>
<div class="line"><span class="lineno"> 2470</span>    2.141e-6, 2.124e-6, 2.09e-6, 2.068e-6, 2.1e-6, 2.104e-6,</div>
<div class="line"><span class="lineno"> 2471</span>    2.142e-6, 2.181e-6, 2.257e-6, 2.362e-6, 2.5e-6, 2.664e-6,</div>
<div class="line"><span class="lineno"> 2472</span>    2.884e-6, 3.189e-6, 3.48e-6, 3.847e-6, 4.313e-6, 4.79e-6,</div>
<div class="line"><span class="lineno"> 2473</span>    5.25e-6, 5.989e-6, 6.692e-6, 7.668e-6, 8.52e-6, 9.606e-6,</div>
<div class="line"><span class="lineno"> 2474</span>    1.073e-5, 1.225e-5, 1.377e-5, 1.582e-5, 1.761e-5, 2.029e-5,</div>
<div class="line"><span class="lineno"> 2475</span>    2.284e-5, 2.602e-5, 2.94e-5, 3.483e-5, 3.928e-5, 4.618e-5,</div>
<div class="line"><span class="lineno"> 2476</span>    5.24e-5, 6.132e-5, 7.183e-5, 8.521e-5, 9.111e-5, 1.07e-4,</div>
<div class="line"><span class="lineno"> 2477</span>    1.184e-4, 1.264e-4, 1.475e-4, 1.612e-4, 1.704e-4, 1.818e-4,</div>
<div class="line"><span class="lineno"> 2478</span>    1.924e-4, 1.994e-4, 2.061e-4, 2.18e-4, 2.187e-4, 2.2e-4,</div>
<div class="line"><span class="lineno"> 2479</span>    2.196e-4, 2.131e-4, 2.015e-4, 1.988e-4, 1.847e-4, 1.729e-4,</div>
<div class="line"><span class="lineno"> 2480</span>    1.597e-4, 1.373e-4, 1.262e-4, 1.087e-4, 9.439e-5, 8.061e-5,</div>
<div class="line"><span class="lineno"> 2481</span>    7.093e-5, 6.049e-5, 5.12e-5, 4.435e-5, 3.817e-5, 3.34e-5,</div>
<div class="line"><span class="lineno"> 2482</span>    2.927e-5, 2.573e-5, 2.291e-5, 2.04e-5, 1.827e-5, 1.636e-5,</div>
<div class="line"><span class="lineno"> 2483</span>    1.463e-5, 1.309e-5, 1.17e-5, 1.047e-5, 9.315e-6, 8.328e-6,</div>
<div class="line"><span class="lineno"> 2484</span>    7.458e-6, 6.665e-6, 5.94e-6, 5.316e-6, 4.752e-6, 4.252e-6,</div>
<div class="line"><span class="lineno"> 2485</span>    3.825e-6, 3.421e-6, 3.064e-6, 2.746e-6, 2.465e-6, 2.216e-6,</div>
<div class="line"><span class="lineno"> 2486</span>    1.99e-6, 1.79e-6, 1.609e-6, 1.449e-6, 1.306e-6, 1.177e-6,</div>
<div class="line"><span class="lineno"> 2487</span>    1.063e-6, 9.607e-7, 8.672e-7, 7.855e-7, 7.118e-7, 6.46e-7,</div>
<div class="line"><span class="lineno"> 2488</span>    5.871e-7, 5.34e-7, 4.868e-7, 4.447e-7, 4.068e-7, 3.729e-7,</div>
<div class="line"><span class="lineno"> 2489</span>    3.423e-7, 3.151e-7, 2.905e-7, 2.686e-7, 2.484e-7, 2.306e-7,</div>
<div class="line"><span class="lineno"> 2490</span>    2.142e-7, 1.995e-7, 1.86e-7, 1.738e-7, 1.626e-7, 1.522e-7,</div>
<div class="line"><span class="lineno"> 2491</span>    1.427e-7, 1.338e-7, 1.258e-7, 1.183e-7, 1.116e-7, 1.056e-7,</div>
<div class="line"><span class="lineno"> 2492</span>    9.972e-8, 9.46e-8, 9.007e-8, 8.592e-8, 8.195e-8, 7.816e-8,</div>
<div class="line"><span class="lineno"> 2493</span>    7.483e-8, 7.193e-8, 6.892e-8, 6.642e-8, 6.386e-8, 6.154e-8,</div>
<div class="line"><span class="lineno"> 2494</span>    5.949e-8, 5.764e-8, 5.622e-8, 5.479e-8, 5.364e-8, 5.301e-8,</div>
<div class="line"><span class="lineno"> 2495</span>    5.267e-8, 5.263e-8, 5.313e-8, 5.41e-8, 5.55e-8, 5.745e-8,</div>
<div class="line"><span class="lineno"> 2496</span>    6.003e-8, 6.311e-8, 6.713e-8, 7.173e-8, 7.724e-8, 8.368e-8,</div>
<div class="line"><span class="lineno"> 2497</span>    9.121e-8, 9.986e-8, 1.097e-7, 1.209e-7, 1.338e-7, 1.486e-7,</div>
<div class="line"><span class="lineno"> 2498</span>    1.651e-7, 1.837e-7, 2.048e-7, 2.289e-7, 2.557e-7, 2.857e-7,</div>
<div class="line"><span class="lineno"> 2499</span>    3.195e-7, 3.587e-7, 4.015e-7, 4.497e-7, 5.049e-7, 5.665e-7,</div>
<div class="line"><span class="lineno"> 2500</span>    6.366e-7, 7.121e-7, 7.996e-7, 8.946e-7, 1.002e-6, 1.117e-6,</div>
<div class="line"><span class="lineno"> 2501</span>    1.262e-6, 1.416e-6, 1.611e-6, 1.807e-6, 2.056e-6, 2.351e-6,</div>
<div class="line"><span class="lineno"> 2502</span>    2.769e-6, 3.138e-6, 3.699e-6, 4.386e-6, 5.041e-6, 6.074e-6,</div>
<div class="line"><span class="lineno"> 2503</span>    6.812e-6, 7.79e-6, 8.855e-6, 1.014e-5, 1.095e-5, 1.245e-5,</div>
<div class="line"><span class="lineno"> 2504</span>    1.316e-5, 1.39e-5, 1.504e-5, 1.583e-5, 1.617e-5, 1.652e-5,</div>
<div class="line"><span class="lineno"> 2505</span>    1.713e-5, 1.724e-5, 1.715e-5, 1.668e-5, 1.629e-5, 1.552e-5,</div>
<div class="line"><span class="lineno"> 2506</span>    1.478e-5, 1.34e-5, 1.245e-5, 1.121e-5, 9.575e-6, 8.956e-6,</div>
<div class="line"><span class="lineno"> 2507</span>    7.345e-6, 6.597e-6, 5.612e-6, 4.818e-6, 4.165e-6, 3.579e-6,</div>
<div class="line"><span class="lineno"> 2508</span>    3.041e-6, 2.623e-6, 2.29e-6, 1.984e-6, 1.748e-6, 1.534e-6,</div>
<div class="line"><span class="lineno"> 2509</span>    1.369e-6, 1.219e-6, 1.092e-6, 9.8e-7, 8.762e-7, 7.896e-7,</div>
<div class="line"><span class="lineno"> 2510</span>    7.104e-7, 6.364e-7, 5.691e-7, 5.107e-7, 4.575e-7, 4.09e-7,</div>
<div class="line"><span class="lineno"> 2511</span>    3.667e-7, 3.287e-7, 2.931e-7, 2.633e-7, 2.356e-7, 2.111e-7,</div>
<div class="line"><span class="lineno"> 2512</span>    1.895e-7, 1.697e-7, 1.525e-7, 1.369e-7, 1.233e-7, 1.114e-7,</div>
<div class="line"><span class="lineno"> 2513</span>    9.988e-8, 9.004e-8, 8.149e-8, 7.352e-8, 6.662e-8, 6.03e-8,</div>
<div class="line"><span class="lineno"> 2514</span>    5.479e-8, 4.974e-8, 4.532e-8, 4.129e-8, 3.781e-8, 3.462e-8,</div>
<div class="line"><span class="lineno"> 2515</span>    3.176e-8, 2.919e-8, 2.687e-8, 2.481e-8, 2.292e-8, 2.119e-8,</div>
<div class="line"><span class="lineno"> 2516</span>    1.967e-8, 1.828e-8, 1.706e-8, 1.589e-8, 1.487e-8, 1.393e-8,</div>
<div class="line"><span class="lineno"> 2517</span>    1.307e-8, 1.228e-8, 1.156e-8, 1.089e-8, 1.028e-8, 9.696e-9,</div>
<div class="line"><span class="lineno"> 2518</span>    9.159e-9, 8.658e-9, 8.187e-9, 7.746e-9, 7.34e-9, 6.953e-9,</div>
<div class="line"><span class="lineno"> 2519</span>    6.594e-9, 6.259e-9, 5.948e-9, 5.66e-9, 5.386e-9, 5.135e-9,</div>
<div class="line"><span class="lineno"> 2520</span>    4.903e-9, 4.703e-9, 4.515e-9, 4.362e-9, 4.233e-9, 4.117e-9,</div>
<div class="line"><span class="lineno"> 2521</span>    4.017e-9, 3.962e-9, 3.924e-9, 3.905e-9, 3.922e-9, 3.967e-9,</div>
<div class="line"><span class="lineno"> 2522</span>    4.046e-9, 4.165e-9, 4.32e-9, 4.522e-9, 4.769e-9, 5.083e-9,</div>
<div class="line"><span class="lineno"> 2523</span>    5.443e-9, 5.872e-9, 6.366e-9, 6.949e-9, 7.601e-9, 8.371e-9,</div>
<div class="line"><span class="lineno"> 2524</span>    9.22e-9, 1.02e-8, 1.129e-8, 1.251e-8, 1.393e-8, 1.542e-8,</div>
<div class="line"><span class="lineno"> 2525</span>    1.72e-8, 1.926e-8, 2.152e-8, 2.392e-8, 2.678e-8, 3.028e-8,</div>
<div class="line"><span class="lineno"> 2526</span>    3.39e-8, 3.836e-8, 4.309e-8, 4.9e-8, 5.481e-8, 6.252e-8,</div>
<div class="line"><span class="lineno"> 2527</span>    7.039e-8, 7.883e-8, 8.849e-8, 1.012e-7, 1.142e-7, 1.3e-7,</div>
<div class="line"><span class="lineno"> 2528</span>    1.475e-7, 1.732e-7, 1.978e-7, 2.304e-7, 2.631e-7, 2.988e-7,</div>
<div class="line"><span class="lineno"> 2529</span>    3.392e-7, 3.69e-7, 4.355e-7, 4.672e-7, 5.11e-7, 5.461e-7,</div>
<div class="line"><span class="lineno"> 2530</span>    5.828e-7, 6.233e-7, 6.509e-7, 6.672e-7, 6.969e-7, 7.104e-7,</div>
<div class="line"><span class="lineno"> 2531</span>    7.439e-7, 7.463e-7, 7.708e-7, 7.466e-7, 7.668e-7, 7.549e-7,</div>
<div class="line"><span class="lineno"> 2532</span>    7.586e-7, 7.384e-7, 7.439e-7, 7.785e-7, 7.915e-7, 8.31e-7,</div>
<div class="line"><span class="lineno"> 2533</span>    8.745e-7, 9.558e-7, 1.038e-6, 1.173e-6, 1.304e-6, 1.452e-6,</div>
<div class="line"><span class="lineno"> 2534</span>    1.671e-6, 1.931e-6, 2.239e-6, 2.578e-6, 3.032e-6, 3.334e-6,</div>
<div class="line"><span class="lineno"> 2535</span>    3.98e-6, 4.3e-6, 4.518e-6, 5.321e-6, 5.508e-6, 6.211e-6, 6.59e-6,</div>
<div class="line"><span class="lineno"> 2536</span>    7.046e-6, 7.555e-6, 7.558e-6, 7.875e-6, 8.319e-6, 8.433e-6,</div>
<div class="line"><span class="lineno"> 2537</span>    8.59e-6, 8.503e-6, 8.304e-6, 8.336e-6, 7.739e-6, 7.301e-6,</div>
<div class="line"><span class="lineno"> 2538</span>    6.827e-6, 6.078e-6, 5.551e-6, 4.762e-6, 4.224e-6, 3.538e-6,</div>
<div class="line"><span class="lineno"> 2539</span>    2.984e-6, 2.619e-6, 2.227e-6, 1.923e-6, 1.669e-6, 1.462e-6,</div>
<div class="line"><span class="lineno"> 2540</span>    1.294e-6, 1.155e-6, 1.033e-6, 9.231e-7, 8.238e-7, 7.36e-7,</div>
<div class="line"><span class="lineno"> 2541</span>    6.564e-7, 5.869e-7, 5.236e-7, 4.673e-7, 4.174e-7, 3.736e-7,</div>
<div class="line"><span class="lineno"> 2542</span>    3.33e-7, 2.976e-7, 2.657e-7, 2.367e-7, 2.106e-7, 1.877e-7,</div>
<div class="line"><span class="lineno"> 2543</span>    1.671e-7, 1.494e-7, 1.332e-7, 1.192e-7, 1.065e-7, 9.558e-8,</div>
<div class="line"><span class="lineno"> 2544</span>    8.586e-8, 7.717e-8, 6.958e-8, 6.278e-8, 5.666e-8, 5.121e-8,</div>
<div class="line"><span class="lineno"> 2545</span>    4.647e-8, 4.213e-8, 3.815e-8, 3.459e-8, 3.146e-8, 2.862e-8,</div>
<div class="line"><span class="lineno"> 2546</span>    2.604e-8, 2.375e-8, 2.162e-8, 1.981e-8, 1.817e-8, 1.67e-8,</div>
<div class="line"><span class="lineno"> 2547</span>    1.537e-8, 1.417e-8, 1.31e-8, 1.215e-8, 1.128e-8, 1.05e-8,</div>
<div class="line"><span class="lineno"> 2548</span>    9.793e-9, 9.158e-9, 8.586e-9, 8.068e-9, 7.595e-9, 7.166e-9,</div>
<div class="line"><span class="lineno"> 2549</span>    6.778e-9, 6.427e-9, 6.108e-9, 5.826e-9, 5.571e-9, 5.347e-9,</div>
<div class="line"><span class="lineno"> 2550</span>    5.144e-9, 4.968e-9, 4.822e-9, 4.692e-9, 4.589e-9, 4.506e-9,</div>
<div class="line"><span class="lineno"> 2551</span>    4.467e-9, 4.44e-9, 4.466e-9, 4.515e-9, 4.718e-9, 4.729e-9,</div>
<div class="line"><span class="lineno"> 2552</span>    4.937e-9, 5.249e-9, 5.466e-9, 5.713e-9, 6.03e-9, 6.436e-9,</div>
<div class="line"><span class="lineno"> 2553</span>    6.741e-9, 7.33e-9, 7.787e-9, 8.414e-9, 8.908e-9, 9.868e-9,</div>
<div class="line"><span class="lineno"> 2554</span>    1.069e-8, 1.158e-8, 1.253e-8, 1.3e-8, 1.409e-8, 1.47e-8,</div>
<div class="line"><span class="lineno"> 2555</span>    1.548e-8, 1.612e-8, 1.666e-8, 1.736e-8, 1.763e-8, 1.812e-8,</div>
<div class="line"><span class="lineno"> 2556</span>    1.852e-8, 1.923e-8, 1.897e-8, 1.893e-8, 1.888e-8, 1.868e-8,</div>
<div class="line"><span class="lineno"> 2557</span>    1.895e-8, 1.899e-8, 1.876e-8, 1.96e-8, 2.02e-8, 2.121e-8,</div>
<div class="line"><span class="lineno"> 2558</span>    2.239e-8, 2.379e-8, 2.526e-8, 2.766e-8, 2.994e-8, 3.332e-8,</div>
<div class="line"><span class="lineno"> 2559</span>    3.703e-8, 4.158e-8, 4.774e-8, 5.499e-8, 6.355e-8, 7.349e-8,</div>
<div class="line"><span class="lineno"> 2560</span>    8.414e-8, 9.846e-8, 1.143e-7, 1.307e-7, 1.562e-7, 1.817e-7,</div>
<div class="line"><span class="lineno"> 2561</span>    2.011e-7, 2.192e-7, 2.485e-7, 2.867e-7, 3.035e-7, 3.223e-7,</div>
<div class="line"><span class="lineno"> 2562</span>    3.443e-7, 3.617e-7, 3.793e-7, 3.793e-7, 3.839e-7, 4.081e-7,</div>
<div class="line"><span class="lineno"> 2563</span>    4.117e-7, 4.085e-7, 3.92e-7, 3.851e-7, 3.754e-7, 3.49e-7,</div>
<div class="line"><span class="lineno"> 2564</span>    3.229e-7, 2.978e-7, 2.691e-7, 2.312e-7, 2.029e-7, 1.721e-7,</div>
<div class="line"><span class="lineno"> 2565</span>    1.472e-7, 1.308e-7, 1.132e-7, 9.736e-8, 8.458e-8, 7.402e-8,</div>
<div class="line"><span class="lineno"> 2566</span>    6.534e-8, 5.811e-8, 5.235e-8, 4.762e-8, 4.293e-8, 3.896e-8,</div>
<div class="line"><span class="lineno"> 2567</span>    3.526e-8, 3.165e-8, 2.833e-8, 2.551e-8, 2.288e-8, 2.036e-8,</div>
<div class="line"><span class="lineno"> 2568</span>    1.82e-8, 1.626e-8, 1.438e-8, 1.299e-8, 1.149e-8, 1.03e-8,</div>
<div class="line"><span class="lineno"> 2569</span>    9.148e-9, 8.122e-9, 7.264e-9, 6.425e-9, 5.777e-9, 5.06e-9,</div>
<div class="line"><span class="lineno"> 2570</span>    4.502e-9, 4.013e-9, 3.567e-9, 3.145e-9, 2.864e-9, 2.553e-9,</div>
<div class="line"><span class="lineno"> 2571</span>    2.311e-9, 2.087e-9, 1.886e-9, 1.716e-9, 1.556e-9, 1.432e-9,</div>
<div class="line"><span class="lineno"> 2572</span>    1.311e-9, 1.202e-9, 1.104e-9, 1.013e-9, 9.293e-10, 8.493e-10,</div>
<div class="line"><span class="lineno"> 2573</span>    7.79e-10, 7.185e-10, 6.642e-10, 6.141e-10, 5.684e-10, 5.346e-10,</div>
<div class="line"><span class="lineno"> 2574</span>    5.032e-10, 4.725e-10, 4.439e-10, 4.176e-10, 3.93e-10, 3.714e-10,</div>
<div class="line"><span class="lineno"> 2575</span>    3.515e-10, 3.332e-10, 3.167e-10, 3.02e-10, 2.887e-10, 2.769e-10,</div>
<div class="line"><span class="lineno"> 2576</span>    2.665e-10, 2.578e-10, 2.503e-10, 2.436e-10, 2.377e-10, 2.342e-10,</div>
<div class="line"><span class="lineno"> 2577</span>    2.305e-10, 2.296e-10, 2.278e-10, 2.321e-10, 2.355e-10, 2.402e-10,</div>
<div class="line"><span class="lineno"> 2578</span>    2.478e-10, 2.67e-10, 2.848e-10, 2.982e-10, 3.263e-10, 3.438e-10,</div>
<div class="line"><span class="lineno"> 2579</span>    3.649e-10, 3.829e-10, 4.115e-10, 4.264e-10, 4.473e-10, 4.63e-10,</div>
<div class="line"><span class="lineno"> 2580</span>    4.808e-10, 4.995e-10, 5.142e-10, 5.313e-10, 5.318e-10, 5.358e-10,</div>
<div class="line"><span class="lineno"> 2581</span>    5.452e-10, 5.507e-10, 5.698e-10, 5.782e-10, 5.983e-10, 6.164e-10,</div>
<div class="line"><span class="lineno"> 2582</span>    6.532e-10, 6.811e-10, 7.624e-10, 8.302e-10, 9.067e-10, 9.937e-10,</div>
<div class="line"><span class="lineno"> 2583</span>    1.104e-9, 1.221e-9, 1.361e-9, 1.516e-9, 1.675e-9, 1.883e-9,</div>
<div class="line"><span class="lineno"> 2584</span>    2.101e-9, 2.349e-9, 2.614e-9, 2.92e-9, 3.305e-9, 3.724e-9,</div>
<div class="line"><span class="lineno"> 2585</span>    4.142e-9, 4.887e-9, 5.614e-9, 6.506e-9, 7.463e-9, 8.817e-9,</div>
<div class="line"><span class="lineno"> 2586</span>    9.849e-9, 1.187e-8, 1.321e-8, 1.474e-8, 1.698e-8, 1.794e-8,</div>
<div class="line"><span class="lineno"> 2587</span>    2.09e-8, 2.211e-8, 2.362e-8, 2.556e-8, 2.729e-8, 2.88e-8,</div>
<div class="line"><span class="lineno"> 2588</span>    3.046e-8, 3.167e-8, 3.367e-8, 3.457e-8, 3.59e-8, 3.711e-8,</div>
<div class="line"><span class="lineno"> 2589</span>    3.826e-8, 4.001e-8, 4.211e-8, 4.315e-8, 4.661e-8, 5.01e-8,</div>
<div class="line"><span class="lineno"> 2590</span>    5.249e-8, 5.84e-8, 6.628e-8, 7.512e-8, 8.253e-8, 9.722e-8,</div>
<div class="line"><span class="lineno"> 2591</span>    1.067e-7, 1.153e-7, 1.347e-7, 1.428e-7, 1.577e-7, 1.694e-7,</div>
<div class="line"><span class="lineno"> 2592</span>    1.833e-7, 1.938e-7, 2.108e-7, 2.059e-7, 2.157e-7, 2.185e-7,</div>
<div class="line"><span class="lineno"> 2593</span>    2.208e-7, 2.182e-7, 2.093e-7, 2.014e-7, 1.962e-7, 1.819e-7,</div>
<div class="line"><span class="lineno"> 2594</span>    1.713e-7, 1.51e-7, 1.34e-7, 1.154e-7, 9.89e-8, 8.88e-8, 7.673e-8,</div>
<div class="line"><span class="lineno"> 2595</span>    6.599e-8, 5.73e-8, 5.081e-8, 4.567e-8, 4.147e-8, 3.773e-8,</div>
<div class="line"><span class="lineno"> 2596</span>    3.46e-8, 3.194e-8, 2.953e-8, 2.759e-8, 2.594e-8, 2.442e-8,</div>
<div class="line"><span class="lineno"> 2597</span>    2.355e-8, 2.283e-8, 2.279e-8, 2.231e-8, 2.279e-8, 2.239e-8,</div>
<div class="line"><span class="lineno"> 2598</span>    2.21e-8, 2.309e-8, 2.293e-8, 2.352e-8, 2.415e-8, 2.43e-8,</div>
<div class="line"><span class="lineno"> 2599</span>    2.426e-8, 2.465e-8, 2.5e-8, 2.496e-8, 2.465e-8, 2.445e-8,</div>
<div class="line"><span class="lineno"> 2600</span>    2.383e-8, 2.299e-8, 2.165e-8, 2.113e-8, 1.968e-8, 1.819e-8,</div>
<div class="line"><span class="lineno"> 2601</span>    1.644e-8, 1.427e-8, 1.27e-8, 1.082e-8, 9.428e-9, 8.091e-9,</div>
<div class="line"><span class="lineno"> 2602</span>    6.958e-9, 5.988e-9, 5.246e-9, 4.601e-9, 4.098e-9, 3.664e-9,</div>
<div class="line"><span class="lineno"> 2603</span>    3.287e-9, 2.942e-9, 2.656e-9, 2.364e-9, 2.118e-9, 1.903e-9,</div>
<div class="line"><span class="lineno"> 2604</span>    1.703e-9, 1.525e-9, 1.365e-9, 1.229e-9, 1.107e-9, 9.96e-10,</div>
<div class="line"><span class="lineno"> 2605</span>    8.945e-10, 8.08e-10, 7.308e-10, 6.616e-10, 5.994e-10, 5.422e-10,</div>
<div class="line"><span class="lineno"> 2606</span>    4.929e-10, 4.478e-10, 4.07e-10, 3.707e-10, 3.379e-10, 3.087e-10,</div>
<div class="line"><span class="lineno"> 2607</span>    2.823e-10, 2.592e-10, 2.385e-10, 2.201e-10, 2.038e-10, 1.897e-10,</div>
<div class="line"><span class="lineno"> 2608</span>    1.774e-10, 1.667e-10, 1.577e-10, 1.502e-10, 1.437e-10, 1.394e-10,</div>
<div class="line"><span class="lineno"> 2609</span>    1.358e-10, 1.324e-10, 1.329e-10, 1.324e-10, 1.36e-10, 1.39e-10,</div>
<div class="line"><span class="lineno"> 2610</span>    1.424e-10, 1.544e-10, 1.651e-10, 1.817e-10, 1.984e-10, 2.195e-10,</div>
<div class="line"><span class="lineno"> 2611</span>    2.438e-10, 2.7e-10, 2.991e-10, 3.322e-10, 3.632e-10, 3.957e-10,</div>
<div class="line"><span class="lineno"> 2612</span>    4.36e-10, 4.701e-10, 5.03e-10, 5.381e-10, 5.793e-10, 6.19e-10,</div>
<div class="line"><span class="lineno"> 2613</span>    6.596e-10, 7.004e-10, 7.561e-10, 7.934e-10, 8.552e-10, 9.142e-10,</div>
<div class="line"><span class="lineno"> 2614</span>    9.57e-10, 1.027e-9, 1.097e-9, 1.193e-9, 1.334e-9, 1.47e-9,</div>
<div class="line"><span class="lineno"> 2615</span>    1.636e-9, 1.871e-9, 2.122e-9, 2.519e-9, 2.806e-9, 3.203e-9,</div>
<div class="line"><span class="lineno"> 2616</span>    3.846e-9, 4.362e-9, 5.114e-9, 5.643e-9, 6.305e-9, 6.981e-9,</div>
<div class="line"><span class="lineno"> 2617</span>    7.983e-9, 8.783e-9, 9.419e-9, 1.017e-8, 1.063e-8, 1.121e-8,</div>
<div class="line"><span class="lineno"> 2618</span>    1.13e-8, 1.201e-8, 1.225e-8, 1.232e-8, 1.223e-8, 1.177e-8,</div>
<div class="line"><span class="lineno"> 2619</span>    1.151e-8, 1.116e-8, 1.047e-8, 9.698e-9, 8.734e-9, 8.202e-9,</div>
<div class="line"><span class="lineno"> 2620</span>    7.041e-9, 6.074e-9, 5.172e-9, 4.468e-9, 3.913e-9, 3.414e-9,</div>
<div class="line"><span class="lineno"> 2621</span>    2.975e-9, 2.65e-9, 2.406e-9, 2.173e-9, 2.009e-9, 1.861e-9,</div>
<div class="line"><span class="lineno"> 2622</span>    1.727e-9, 1.612e-9, 1.514e-9, 1.43e-9, 1.362e-9, 1.333e-9,</div>
<div class="line"><span class="lineno"> 2623</span>    1.288e-9, 1.249e-9, 1.238e-9, 1.228e-9, 1.217e-9, 1.202e-9,</div>
<div class="line"><span class="lineno"> 2624</span>    1.209e-9, 1.177e-9, 1.157e-9, 1.165e-9, 1.142e-9, 1.131e-9,</div>
<div class="line"><span class="lineno"> 2625</span>    1.138e-9, 1.117e-9, 1.1e-9, 1.069e-9, 1.023e-9, 1.005e-9,</div>
<div class="line"><span class="lineno"> 2626</span>    9.159e-10, 8.863e-10, 7.865e-10, 7.153e-10, 6.247e-10, 5.846e-10,</div>
<div class="line"><span class="lineno"> 2627</span>    5.133e-10, 4.36e-10, 3.789e-10, 3.335e-10, 2.833e-10, 2.483e-10,</div>
<div class="line"><span class="lineno"> 2628</span>    2.155e-10, 1.918e-10, 1.709e-10, 1.529e-10, 1.374e-10, 1.235e-10,</div>
<div class="line"><span class="lineno"> 2629</span>    1.108e-10, 9.933e-11, 8.932e-11, 8.022e-11, 7.224e-11, 6.52e-11,</div>
<div class="line"><span class="lineno"> 2630</span>    5.896e-11, 5.328e-11, 4.813e-11, 4.365e-11, 3.961e-11, 3.594e-11,</div>
<div class="line"><span class="lineno"> 2631</span>    3.266e-11, 2.967e-11, 2.701e-11, 2.464e-11, 2.248e-11, 2.054e-11,</div>
<div class="line"><span class="lineno"> 2632</span>    1.878e-11, 1.721e-11, 1.579e-11, 1.453e-11, 1.341e-11, 1.241e-11,</div>
<div class="line"><span class="lineno"> 2633</span>    1.154e-11, 1.078e-11, 1.014e-11, 9.601e-12, 9.167e-12, 8.838e-12,</div>
<div class="line"><span class="lineno"> 2634</span>    8.614e-12, 8.493e-12, 8.481e-12, 8.581e-12, 8.795e-12, 9.131e-12,</div>
<div class="line"><span class="lineno"> 2635</span>    9.601e-12, 1.021e-11, 1.097e-11, 1.191e-11, 1.303e-11, 1.439e-11,</div>
<div class="line"><span class="lineno"> 2636</span>    1.601e-11, 1.778e-11, 1.984e-11, 2.234e-11, 2.474e-11, 2.766e-11,</div>
<div class="line"><span class="lineno"> 2637</span>    3.085e-11, 3.415e-11, 3.821e-11, 4.261e-11, 4.748e-11, 5.323e-11,</div>
<div class="line"><span class="lineno"> 2638</span>    5.935e-11, 6.619e-11, 7.418e-11, 8.294e-11, 9.26e-11, 1.039e-10,</div>
<div class="line"><span class="lineno"> 2639</span>    1.156e-10, 1.297e-10, 1.46e-10, 1.641e-10, 1.858e-10, 2.1e-10,</div>
<div class="line"><span class="lineno"> 2640</span>    2.383e-10, 2.724e-10, 3.116e-10, 3.538e-10, 4.173e-10, 4.727e-10,</div>
<div class="line"><span class="lineno"> 2641</span>    5.503e-10, 6.337e-10, 7.32e-10, 8.298e-10, 9.328e-10, 1.059e-9,</div>
<div class="line"><span class="lineno"> 2642</span>    1.176e-9, 1.328e-9, 1.445e-9, 1.593e-9, 1.77e-9, 1.954e-9,</div>
<div class="line"><span class="lineno"> 2643</span>    2.175e-9, 2.405e-9, 2.622e-9, 2.906e-9, 3.294e-9, 3.713e-9,</div>
<div class="line"><span class="lineno"> 2644</span>    3.98e-9, 4.384e-9, 4.987e-9, 5.311e-9, 5.874e-9, 6.337e-9,</div>
<div class="line"><span class="lineno"> 2645</span>    7.027e-9, 7.39e-9, 7.769e-9, 8.374e-9, 8.605e-9, 9.165e-9,</div>
<div class="line"><span class="lineno"> 2646</span>    9.415e-9, 9.511e-9, 9.704e-9, 9.588e-9, 9.45e-9, 9.086e-9,</div>
<div class="line"><span class="lineno"> 2647</span>    8.798e-9, 8.469e-9, 7.697e-9, 7.168e-9, 6.255e-9, 5.772e-9,</div>
<div class="line"><span class="lineno"> 2648</span>    4.97e-9, 4.271e-9, 3.653e-9, 3.154e-9, 2.742e-9, 2.435e-9,</div>
<div class="line"><span class="lineno"> 2649</span>    2.166e-9, 1.936e-9, 1.731e-9, 1.556e-9, 1.399e-9, 1.272e-9,</div>
<div class="line"><span class="lineno"> 2650</span>    1.157e-9, 1.066e-9, 9.844e-10, 9.258e-10, 8.787e-10, 8.421e-10,</div>
<div class="line"><span class="lineno"> 2651</span>    8.083e-10, 8.046e-10, 8.067e-10, 8.181e-10, 8.325e-10, 8.517e-10,</div>
<div class="line"><span class="lineno"> 2652</span>    9.151e-10, 9.351e-10, 9.677e-10, 1.071e-9, 1.126e-9, 1.219e-9,</div>
<div class="line"><span class="lineno"> 2653</span>    1.297e-9, 1.408e-9, 1.476e-9, 1.517e-9, 1.6e-9, 1.649e-9,</div>
<div class="line"><span class="lineno"> 2654</span>    1.678e-9, 1.746e-9, 1.742e-9, 1.728e-9, 1.699e-9, 1.655e-9,</div>
<div class="line"><span class="lineno"> 2655</span>    1.561e-9, 1.48e-9, 1.451e-9, 1.411e-9, 1.171e-9, 1.106e-9,</div>
<div class="line"><span class="lineno"> 2656</span>    9.714e-10, 8.523e-10, 7.346e-10, 6.241e-10, 5.371e-10, 4.704e-10,</div>
<div class="line"><span class="lineno"> 2657</span>    4.144e-10, 3.683e-10, 3.292e-10, 2.942e-10, 2.62e-10, 2.341e-10,</div>
<div class="line"><span class="lineno"> 2658</span>    2.104e-10, 1.884e-10, 1.7e-10, 1.546e-10, 1.394e-10, 1.265e-10,</div>
<div class="line"><span class="lineno"> 2659</span>    1.14e-10, 1.019e-10, 9.279e-11, 8.283e-11, 7.458e-11, 6.668e-11,</div>
<div class="line"><span class="lineno"> 2660</span>    5.976e-11, 5.33e-11, 4.794e-11, 4.289e-11, 3.841e-11, 3.467e-11,</div>
<div class="line"><span class="lineno"> 2661</span>    3.13e-11, 2.832e-11, 2.582e-11, 2.356e-11, 2.152e-11, 1.97e-11,</div>
<div class="line"><span class="lineno"> 2662</span>    1.808e-11, 1.664e-11, 1.539e-11, 1.434e-11, 1.344e-11, 1.269e-11,</div>
<div class="line"><span class="lineno"> 2663</span>    1.209e-11, 1.162e-11, 1.129e-11, 1.108e-11, 1.099e-11, 1.103e-11,</div>
<div class="line"><span class="lineno"> 2664</span>    1.119e-11, 1.148e-11, 1.193e-11, 1.252e-11, 1.329e-11, 1.421e-11,</div>
<div class="line"><span class="lineno"> 2665</span>    1.555e-11, 1.685e-11, 1.839e-11, 2.054e-11, 2.317e-11, 2.571e-11,</div>
<div class="line"><span class="lineno"> 2666</span>    2.839e-11, 3.171e-11, 3.49e-11, 3.886e-11, 4.287e-11, 4.645e-11,</div>
<div class="line"><span class="lineno"> 2667</span>    5.047e-11, 5.592e-11, 6.109e-11, 6.628e-11, 7.381e-11, 8.088e-11,</div>
<div class="line"><span class="lineno"> 2668</span>    8.966e-11, 1.045e-10, 1.12e-10, 1.287e-10, 1.486e-10, 1.662e-10,</div>
<div class="line"><span class="lineno"> 2669</span>    1.866e-10, 2.133e-10, 2.524e-10, 2.776e-10, 3.204e-10, 3.559e-10,</div>
<div class="line"><span class="lineno"> 2670</span>    4.028e-10, 4.448e-10, 4.882e-10, 5.244e-10, 5.605e-10, 6.018e-10,</div>
<div class="line"><span class="lineno"> 2671</span>    6.328e-10, 6.579e-10, 6.541e-10, 7.024e-10, 7.074e-10, 7.068e-10,</div>
<div class="line"><span class="lineno"> 2672</span>    7.009e-10, 6.698e-10, 6.545e-10, 6.209e-10, 5.834e-10, 5.412e-10,</div>
<div class="line"><span class="lineno"> 2673</span>    5.001e-10, 4.231e-10, 3.727e-10, 3.211e-10, 2.833e-10, 2.447e-10,</div>
<div class="line"><span class="lineno"> 2674</span>    2.097e-10, 1.843e-10, 1.639e-10, 1.449e-10, 1.27e-10, 1.161e-10,</div>
<div class="line"><span class="lineno"> 2675</span>    1.033e-10, 9.282e-11, 8.407e-11, 7.639e-11, 7.023e-11, 6.474e-11,</div>
<div class="line"><span class="lineno"> 2676</span>    6.142e-11, 5.76e-11, 5.568e-11, 5.472e-11, 5.39e-11, 5.455e-11,</div>
<div class="line"><span class="lineno"> 2677</span>    5.54e-11, 5.587e-11, 6.23e-11, 6.49e-11, 6.868e-11, 7.382e-11,</div>
<div class="line"><span class="lineno"> 2678</span>    8.022e-11, 8.372e-11, 9.243e-11, 1.004e-10, 1.062e-10, 1.13e-10,</div>
<div class="line"><span class="lineno"> 2679</span>    1.176e-10, 1.244e-10, 1.279e-10, 1.298e-10, 1.302e-10, 1.312e-10,</div>
<div class="line"><span class="lineno"> 2680</span>    1.295e-10, 1.244e-10, 1.211e-10, 1.167e-10, 1.098e-10, 9.927e-11,</div>
<div class="line"><span class="lineno"> 2681</span>    8.854e-11, 8.011e-11, 7.182e-11, 5.923e-11, 5.212e-11, 4.453e-11,</div>
<div class="line"><span class="lineno"> 2682</span>    3.832e-11, 3.371e-11, 2.987e-11, 2.651e-11, 2.354e-11, 2.093e-11,</div>
<div class="line"><span class="lineno"> 2683</span>    1.863e-11, 1.662e-11, 1.486e-11, 1.331e-11, 1.193e-11, 1.071e-11,</div>
<div class="line"><span class="lineno"> 2684</span>    9.628e-12, 8.66e-12, 7.801e-12, 7.031e-12, 6.347e-12, 5.733e-12,</div>
<div class="line"><span class="lineno"> 2685</span>    5.182e-12, 4.695e-12, 4.26e-12, 3.874e-12, 3.533e-12, 3.235e-12,</div>
<div class="line"><span class="lineno"> 2686</span>    2.979e-12, 2.76e-12, 2.579e-12, 2.432e-12, 2.321e-12, 2.246e-12,</div>
<div class="line"><span class="lineno"> 2687</span>    2.205e-12, 2.196e-12, 2.223e-12, 2.288e-12, 2.387e-12, 2.525e-12,</div>
<div class="line"><span class="lineno"> 2688</span>    2.704e-12, 2.925e-12, 3.191e-12, 3.508e-12, 3.876e-12, 4.303e-12,</div>
<div class="line"><span class="lineno"> 2689</span>    4.793e-12, 5.347e-12, 5.978e-12, 6.682e-12, 7.467e-12, 8.34e-12,</div>
<div class="line"><span class="lineno"> 2690</span>    9.293e-12, 1.035e-11, 1.152e-11, 1.285e-11, 1.428e-11, 1.586e-11,</div>
<div class="line"><span class="lineno"> 2691</span>    1.764e-11, 1.972e-11, 2.214e-11, 2.478e-11, 2.776e-11, 3.151e-11,</div>
<div class="line"><span class="lineno"> 2692</span>    3.591e-11, 4.103e-11, 4.66e-11, 5.395e-11, 6.306e-11, 7.172e-11,</div>
<div class="line"><span class="lineno"> 2693</span>    8.358e-11, 9.67e-11, 1.11e-10, 1.325e-10, 1.494e-10, 1.736e-10,</div>
<div class="line"><span class="lineno"> 2694</span>    2.007e-10, 2.296e-10, 2.608e-10, 3.004e-10, 3.361e-10, 3.727e-10,</div>
<div class="line"><span class="lineno"> 2695</span>    4.373e-10, 4.838e-10, 5.483e-10, 6.006e-10, 6.535e-10, 6.899e-10,</div>
<div class="line"><span class="lineno"> 2696</span>    7.687e-10, 8.444e-10, 8.798e-10, 9.135e-10, 9.532e-10, 9.757e-10,</div>
<div class="line"><span class="lineno"> 2697</span>    9.968e-10, 1.006e-9, 9.949e-10, 9.789e-10, 9.564e-10, 9.215e-10,</div>
<div class="line"><span class="lineno"> 2698</span>    8.51e-10, 8.394e-10, 7.707e-10, 7.152e-10, 6.274e-10, 5.598e-10,</div>
<div class="line"><span class="lineno"> 2699</span>    5.028e-10, 4.3e-10, 3.71e-10, 3.245e-10, 2.809e-10, 2.461e-10,</div>
<div class="line"><span class="lineno"> 2700</span>    2.154e-10, 1.91e-10, 1.685e-10, 1.487e-10, 1.313e-10, 1.163e-10,</div>
<div class="line"><span class="lineno"> 2701</span>    1.031e-10, 9.172e-11, 8.221e-11, 7.382e-11, 6.693e-11, 6.079e-11,</div>
<div class="line"><span class="lineno"> 2702</span>    5.581e-11, 5.167e-11, 4.811e-11, 4.506e-11, 4.255e-11, 4.083e-11,</div>
<div class="line"><span class="lineno"> 2703</span>    3.949e-11, 3.881e-11, 3.861e-11, 3.858e-11, 3.951e-11, 4.045e-11,</div>
<div class="line"><span class="lineno"> 2704</span>    4.24e-11, 4.487e-11, 4.806e-11, 5.133e-11, 5.518e-11, 5.919e-11,</div>
<div class="line"><span class="lineno"> 2705</span>    6.533e-11, 7.031e-11, 7.762e-11, 8.305e-11, 9.252e-11, 9.727e-11,</div>
<div class="line"><span class="lineno"> 2706</span>    1.045e-10, 1.117e-10, 1.2e-10, 1.275e-10, 1.341e-10, 1.362e-10,</div>
<div class="line"><span class="lineno"> 2707</span>    1.438e-10, 1.45e-10, 1.455e-10, 1.455e-10, 1.434e-10, 1.381e-10,</div>
<div class="line"><span class="lineno"> 2708</span>    1.301e-10, 1.276e-10, 1.163e-10, 1.089e-10, 9.911e-11, 8.943e-11,</div>
<div class="line"><span class="lineno"> 2709</span>    7.618e-11, 6.424e-11, 5.717e-11, 4.866e-11, 4.257e-11, 3.773e-11,</div>
<div class="line"><span class="lineno"> 2710</span>    3.331e-11, 2.958e-11, 2.629e-11, 2.316e-11, 2.073e-11, 1.841e-11,</div>
<div class="line"><span class="lineno"> 2711</span>    1.635e-11, 1.464e-11, 1.31e-11, 1.16e-11, 1.047e-11, 9.408e-12,</div>
<div class="line"><span class="lineno"> 2712</span>    8.414e-12, 7.521e-12, 6.705e-12, 5.993e-12, 5.371e-12, 4.815e-12,</div>
<div class="line"><span class="lineno"> 2713</span>    4.338e-12, 3.921e-12, 3.567e-12, 3.265e-12, 3.01e-12, 2.795e-12,</div>
<div class="line"><span class="lineno"> 2714</span>    2.613e-12, 2.464e-12, 2.346e-12, 2.256e-12, 2.195e-12, 2.165e-12,</div>
<div class="line"><span class="lineno"> 2715</span>    2.166e-12, 2.198e-12, 2.262e-12, 2.364e-12, 2.502e-12, 2.682e-12,</div>
<div class="line"><span class="lineno"> 2716</span>    2.908e-12, 3.187e-12, 3.533e-12, 3.946e-12, 4.418e-12, 5.013e-12,</div>
<div class="line"><span class="lineno"> 2717</span>    5.708e-12, 6.379e-12, 7.43e-12, 8.39e-12, 9.51e-12, 1.078e-11,</div>
<div class="line"><span class="lineno"> 2718</span>    1.259e-11, 1.438e-11, 1.63e-11, 1.814e-11, 2.055e-11, 2.348e-11,</div>
<div class="line"><span class="lineno"> 2719</span>    2.664e-11, 2.956e-11, 3.3e-11, 3.677e-11, 4.032e-11, 4.494e-11,</div>
<div class="line"><span class="lineno"> 2720</span>    4.951e-11, 5.452e-11, 6.014e-11, 6.5e-11, 6.915e-11, 7.45e-11,</div>
<div class="line"><span class="lineno"> 2721</span>    7.971e-11, 8.468e-11, 8.726e-11, 8.995e-11, 9.182e-11, 9.509e-11,</div>
<div class="line"><span class="lineno"> 2722</span>    9.333e-11, 9.386e-11, 9.457e-11, 9.21e-11, 9.019e-11, 8.68e-11,</div>
<div class="line"><span class="lineno"> 2723</span>    8.298e-11, 7.947e-11, 7.46e-11, 7.082e-11, 6.132e-11, 5.855e-11,</div>
<div class="line"><span class="lineno"> 2724</span>    5.073e-11, 4.464e-11, 3.825e-11, 3.375e-11, 2.911e-11, 2.535e-11,</div>
<div class="line"><span class="lineno"> 2725</span>    2.16e-11, 1.907e-11, 1.665e-11, 1.463e-11, 1.291e-11, 1.133e-11,</div>
<div class="line"><span class="lineno"> 2726</span>    9.997e-12, 8.836e-12, 7.839e-12, 6.943e-12, 6.254e-12, 5.6e-12,</div>
<div class="line"><span class="lineno"> 2727</span>    5.029e-12, 4.529e-12, 4.102e-12, 3.737e-12, 3.428e-12, 3.169e-12,</div>
<div class="line"><span class="lineno"> 2728</span>    2.959e-12, 2.798e-12, 2.675e-12, 2.582e-12, 2.644e-12, 2.557e-12,</div>
<div class="line"><span class="lineno"> 2729</span>    2.614e-12, 2.717e-12, 2.874e-12, 3.056e-12, 3.187e-12, 3.631e-12,</div>
<div class="line"><span class="lineno"> 2730</span>    3.979e-12, 4.248e-12, 4.817e-12, 5.266e-12, 5.836e-12, 6.365e-12,</div>
<div class="line"><span class="lineno"> 2731</span>    6.807e-12, 7.47e-12, 7.951e-12, 8.636e-12, 8.972e-12, 9.314e-12,</div>
<div class="line"><span class="lineno"> 2732</span>    9.445e-12, 1.003e-11, 1.013e-11, 9.937e-12, 9.729e-12, 9.064e-12,</div>
<div class="line"><span class="lineno"> 2733</span>    9.119e-12, 9.124e-12, 8.704e-12, 8.078e-12, 7.47e-12, 6.329e-12,</div>
<div class="line"><span class="lineno"> 2734</span>    5.674e-12, 4.808e-12, 4.119e-12, 3.554e-12, 3.103e-12, 2.731e-12,</div>
<div class="line"><span class="lineno"> 2735</span>    2.415e-12, 2.15e-12, 1.926e-12, 1.737e-12, 1.578e-12, 1.447e-12,</div>
<div class="line"><span class="lineno"> 2736</span>    1.34e-12, 1.255e-12, 1.191e-12, 1.146e-12, 1.121e-12, 1.114e-12,</div>
<div class="line"><span class="lineno"> 2737</span>    1.126e-12, 1.156e-12, 1.207e-12, 1.278e-12, 1.372e-12, 1.49e-12,</div>
<div class="line"><span class="lineno"> 2738</span>    1.633e-12, 1.805e-12, 2.01e-12, 2.249e-12, 2.528e-12, 2.852e-12,</div>
<div class="line"><span class="lineno"> 2739</span>    3.228e-12, 3.658e-12, 4.153e-12, 4.728e-12, 5.394e-12, 6.176e-12,</div>
<div class="line"><span class="lineno"> 2740</span>    7.126e-12, 8.188e-12, 9.328e-12, 1.103e-11, 1.276e-11, 1.417e-11,</div>
<div class="line"><span class="lineno"> 2741</span>    1.615e-11, 1.84e-11, 2.155e-11, 2.429e-11, 2.826e-11, 3.222e-11,</div>
<div class="line"><span class="lineno"> 2742</span>    3.664e-11, 4.14e-11, 4.906e-11, 5.536e-11, 6.327e-11, 7.088e-11,</div>
<div class="line"><span class="lineno"> 2743</span>    8.316e-11, 9.242e-11, 1.07e-10, 1.223e-10, 1.341e-10, 1.553e-10,</div>
<div class="line"><span class="lineno"> 2744</span>    1.703e-10, 1.9e-10, 2.022e-10, 2.233e-10, 2.345e-10, 2.438e-10,</div>
<div class="line"><span class="lineno"> 2745</span>    2.546e-10, 2.599e-10, 2.661e-10, 2.703e-10, 2.686e-10, 2.662e-10,</div>
<div class="line"><span class="lineno"> 2746</span>    2.56e-10, 2.552e-10, 2.378e-10, 2.252e-10, 2.146e-10, 1.885e-10,</div>
<div class="line"><span class="lineno"> 2747</span>    1.668e-10, 1.441e-10, 1.295e-10, 1.119e-10, 9.893e-11, 8.687e-11,</div>
<div class="line"><span class="lineno"> 2748</span>    7.678e-11, 6.685e-11, 5.879e-11, 5.127e-11, 4.505e-11, 3.997e-11,</div>
<div class="line"><span class="lineno"> 2749</span>    3.511e-11</div>
<div class="line"><span class="lineno"> 2750</span>  };</div>
<div class="line"><span class="lineno"> 2751</span> </div>
<div class="line"><span class="lineno"> 2752</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> h2ofrn[2001] = { .01095, .01126, .01205, .01322, .0143,</div>
<div class="line"><span class="lineno"> 2753</span>    .01506, .01548, .01534, .01486, .01373, .01262, .01134, .01001,</div>
<div class="line"><span class="lineno"> 2754</span>    .008702, .007475, .006481, .00548, .0046, .003833, .00311,</div>
<div class="line"><span class="lineno"> 2755</span>    .002543, .002049, .00168, .001374, .001046, 8.193e-4, 6.267e-4,</div>
<div class="line"><span class="lineno"> 2756</span>    4.968e-4, 3.924e-4, 2.983e-4, 2.477e-4, 1.997e-4, 1.596e-4,</div>
<div class="line"><span class="lineno"> 2757</span>    1.331e-4, 1.061e-4, 8.942e-5, 7.168e-5, 5.887e-5, 4.848e-5,</div>
<div class="line"><span class="lineno"> 2758</span>    3.817e-5, 3.17e-5, 2.579e-5, 2.162e-5, 1.768e-5, 1.49e-5,</div>
<div class="line"><span class="lineno"> 2759</span>    1.231e-5, 1.013e-5, 8.555e-6, 7.328e-6, 6.148e-6, 5.207e-6,</div>
<div class="line"><span class="lineno"> 2760</span>    4.387e-6, 3.741e-6, 3.22e-6, 2.753e-6, 2.346e-6, 1.985e-6,</div>
<div class="line"><span class="lineno"> 2761</span>    1.716e-6, 1.475e-6, 1.286e-6, 1.122e-6, 9.661e-7, 8.284e-7,</div>
<div class="line"><span class="lineno"> 2762</span>    7.057e-7, 6.119e-7, 5.29e-7, 4.571e-7, 3.948e-7, 3.432e-7,</div>
<div class="line"><span class="lineno"> 2763</span>    2.983e-7, 2.589e-7, 2.265e-7, 1.976e-7, 1.704e-7, 1.456e-7,</div>
<div class="line"><span class="lineno"> 2764</span>    1.26e-7, 1.101e-7, 9.648e-8, 8.415e-8, 7.34e-8, 6.441e-8,</div>
<div class="line"><span class="lineno"> 2765</span>    5.643e-8, 4.94e-8, 4.276e-8, 3.703e-8, 3.227e-8, 2.825e-8,</div>
<div class="line"><span class="lineno"> 2766</span>    2.478e-8, 2.174e-8, 1.898e-8, 1.664e-8, 1.458e-8, 1.278e-8,</div>
<div class="line"><span class="lineno"> 2767</span>    1.126e-8, 9.891e-9, 8.709e-9, 7.652e-9, 6.759e-9, 5.975e-9,</div>
<div class="line"><span class="lineno"> 2768</span>    5.31e-9, 4.728e-9, 4.214e-9, 3.792e-9, 3.463e-9, 3.226e-9,</div>
<div class="line"><span class="lineno"> 2769</span>    2.992e-9, 2.813e-9, 2.749e-9, 2.809e-9, 2.913e-9, 3.037e-9,</div>
<div class="line"><span class="lineno"> 2770</span>    3.413e-9, 3.738e-9, 4.189e-9, 4.808e-9, 5.978e-9, 7.088e-9,</div>
<div class="line"><span class="lineno"> 2771</span>    8.071e-9, 9.61e-9, 1.21e-8, 1.5e-8, 1.764e-8, 2.221e-8, 2.898e-8,</div>
<div class="line"><span class="lineno"> 2772</span>    3.948e-8, 5.068e-8, 6.227e-8, 7.898e-8, 1.033e-7, 1.437e-7,</div>
<div class="line"><span class="lineno"> 2773</span>    1.889e-7, 2.589e-7, 3.59e-7, 4.971e-7, 7.156e-7, 9.983e-7,</div>
<div class="line"><span class="lineno"> 2774</span>    1.381e-6, 1.929e-6, 2.591e-6, 3.453e-6, 4.57e-6, 5.93e-6,</div>
<div class="line"><span class="lineno"> 2775</span>    7.552e-6, 9.556e-6, 1.183e-5, 1.425e-5, 1.681e-5, 1.978e-5,</div>
<div class="line"><span class="lineno"> 2776</span>    2.335e-5, 2.668e-5, 3.022e-5, 3.371e-5, 3.715e-5, 3.967e-5,</div>
<div class="line"><span class="lineno"> 2777</span>    4.06e-5, 4.01e-5, 3.809e-5, 3.491e-5, 3.155e-5, 2.848e-5,</div>
<div class="line"><span class="lineno"> 2778</span>    2.678e-5, 2.66e-5, 2.811e-5, 3.071e-5, 3.294e-5, 3.459e-5,</div>
<div class="line"><span class="lineno"> 2779</span>    3.569e-5, 3.56e-5, 3.434e-5, 3.186e-5, 2.916e-5, 2.622e-5,</div>
<div class="line"><span class="lineno"> 2780</span>    2.275e-5, 1.918e-5, 1.62e-5, 1.373e-5, 1.182e-5, 1.006e-5,</div>
<div class="line"><span class="lineno"> 2781</span>    8.556e-6, 7.26e-6, 6.107e-6, 5.034e-6, 4.211e-6, 3.426e-6,</div>
<div class="line"><span class="lineno"> 2782</span>    2.865e-6, 2.446e-6, 1.998e-6, 1.628e-6, 1.242e-6, 1.005e-6,</div>
<div class="line"><span class="lineno"> 2783</span>    7.853e-7, 6.21e-7, 5.071e-7, 4.156e-7, 3.548e-7, 2.825e-7,</div>
<div class="line"><span class="lineno"> 2784</span>    2.261e-7, 1.916e-7, 1.51e-7, 1.279e-7, 1.059e-7, 9.14e-8,</div>
<div class="line"><span class="lineno"> 2785</span>    7.707e-8, 6.17e-8, 5.311e-8, 4.263e-8, 3.518e-8, 2.961e-8,</div>
<div class="line"><span class="lineno"> 2786</span>    2.457e-8, 2.119e-8, 1.712e-8, 1.439e-8, 1.201e-8, 1.003e-8,</div>
<div class="line"><span class="lineno"> 2787</span>    8.564e-9, 7.199e-9, 6.184e-9, 5.206e-9, 4.376e-9, 3.708e-9,</div>
<div class="line"><span class="lineno"> 2788</span>    3.157e-9, 2.725e-9, 2.361e-9, 2.074e-9, 1.797e-9, 1.562e-9,</div>
<div class="line"><span class="lineno"> 2789</span>    1.364e-9, 1.196e-9, 1.042e-9, 8.862e-10, 7.648e-10, 6.544e-10,</div>
<div class="line"><span class="lineno"> 2790</span>    5.609e-10, 4.791e-10, 4.108e-10, 3.531e-10, 3.038e-10, 2.618e-10,</div>
<div class="line"><span class="lineno"> 2791</span>    2.268e-10, 1.969e-10, 1.715e-10, 1.496e-10, 1.308e-10, 1.147e-10,</div>
<div class="line"><span class="lineno"> 2792</span>    1.008e-10, 8.894e-11, 7.885e-11, 7.031e-11, 6.355e-11, 5.854e-11,</div>
<div class="line"><span class="lineno"> 2793</span>    5.534e-11, 5.466e-11, 5.725e-11, 6.447e-11, 7.943e-11, 1.038e-10,</div>
<div class="line"><span class="lineno"> 2794</span>    1.437e-10, 2.04e-10, 2.901e-10, 4.051e-10, 5.556e-10, 7.314e-10,</div>
<div class="line"><span class="lineno"> 2795</span>    9.291e-10, 1.134e-9, 1.321e-9, 1.482e-9, 1.596e-9, 1.669e-9,</div>
<div class="line"><span class="lineno"> 2796</span>    1.715e-9, 1.762e-9, 1.817e-9, 1.828e-9, 1.848e-9, 1.873e-9,</div>
<div class="line"><span class="lineno"> 2797</span>    1.902e-9, 1.894e-9, 1.864e-9, 1.841e-9, 1.797e-9, 1.704e-9,</div>
<div class="line"><span class="lineno"> 2798</span>    1.559e-9, 1.382e-9, 1.187e-9, 1.001e-9, 8.468e-10, 7.265e-10,</div>
<div class="line"><span class="lineno"> 2799</span>    6.521e-10, 6.381e-10, 6.66e-10, 7.637e-10, 9.705e-10, 1.368e-9,</div>
<div class="line"><span class="lineno"> 2800</span>    1.856e-9, 2.656e-9, 3.954e-9, 5.96e-9, 8.72e-9, 1.247e-8,</div>
<div class="line"><span class="lineno"> 2801</span>    1.781e-8, 2.491e-8, 3.311e-8, 4.272e-8, 5.205e-8, 6.268e-8,</div>
<div class="line"><span class="lineno"> 2802</span>    7.337e-8, 8.277e-8, 9.185e-8, 1.004e-7, 1.091e-7, 1.159e-7,</div>
<div class="line"><span class="lineno"> 2803</span>    1.188e-7, 1.175e-7, 1.124e-7, 1.033e-7, 9.381e-8, 8.501e-8,</div>
<div class="line"><span class="lineno"> 2804</span>    7.956e-8, 7.894e-8, 8.331e-8, 9.102e-8, 9.836e-8, 1.035e-7,</div>
<div class="line"><span class="lineno"> 2805</span>    1.064e-7, 1.06e-7, 1.032e-7, 9.808e-8, 9.139e-8, 8.442e-8,</div>
<div class="line"><span class="lineno"> 2806</span>    7.641e-8, 6.881e-8, 6.161e-8, 5.404e-8, 4.804e-8, 4.446e-8,</div>
<div class="line"><span class="lineno"> 2807</span>    4.328e-8, 4.259e-8, 4.421e-8, 4.673e-8, 4.985e-8, 5.335e-8,</div>
<div class="line"><span class="lineno"> 2808</span>    5.796e-8, 6.542e-8, 7.714e-8, 8.827e-8, 1.04e-7, 1.238e-7,</div>
<div class="line"><span class="lineno"> 2809</span>    1.499e-7, 1.829e-7, 2.222e-7, 2.689e-7, 3.303e-7, 3.981e-7,</div>
<div class="line"><span class="lineno"> 2810</span>    4.84e-7, 5.91e-7, 7.363e-7, 9.087e-7, 1.139e-6, 1.455e-6,</div>
<div class="line"><span class="lineno"> 2811</span>    1.866e-6, 2.44e-6, 3.115e-6, 3.941e-6, 4.891e-6, 5.992e-6,</div>
<div class="line"><span class="lineno"> 2812</span>    7.111e-6, 8.296e-6, 9.21e-6, 9.987e-6, 1.044e-5, 1.073e-5,</div>
<div class="line"><span class="lineno"> 2813</span>    1.092e-5, 1.106e-5, 1.138e-5, 1.171e-5, 1.186e-5, 1.186e-5,</div>
<div class="line"><span class="lineno"> 2814</span>    1.179e-5, 1.166e-5, 1.151e-5, 1.16e-5, 1.197e-5, 1.241e-5,</div>
<div class="line"><span class="lineno"> 2815</span>    1.268e-5, 1.26e-5, 1.184e-5, 1.063e-5, 9.204e-6, 7.584e-6,</div>
<div class="line"><span class="lineno"> 2816</span>    6.053e-6, 4.482e-6, 3.252e-6, 2.337e-6, 1.662e-6, 1.18e-6,</div>
<div class="line"><span class="lineno"> 2817</span>    8.15e-7, 5.95e-7, 4.354e-7, 3.302e-7, 2.494e-7, 1.93e-7,</div>
<div class="line"><span class="lineno"> 2818</span>    1.545e-7, 1.25e-7, 1.039e-7, 8.602e-8, 7.127e-8, 5.897e-8,</div>
<div class="line"><span class="lineno"> 2819</span>    4.838e-8, 4.018e-8, 3.28e-8, 2.72e-8, 2.307e-8, 1.972e-8,</div>
<div class="line"><span class="lineno"> 2820</span>    1.654e-8, 1.421e-8, 1.174e-8, 1.004e-8, 8.739e-9, 7.358e-9,</div>
<div class="line"><span class="lineno"> 2821</span>    6.242e-9, 5.303e-9, 4.567e-9, 3.94e-9, 3.375e-9, 2.864e-9,</div>
<div class="line"><span class="lineno"> 2822</span>    2.422e-9, 2.057e-9, 1.75e-9, 1.505e-9, 1.294e-9, 1.101e-9,</div>
<div class="line"><span class="lineno"> 2823</span>    9.401e-10, 8.018e-10, 6.903e-10, 5.965e-10, 5.087e-10, 4.364e-10,</div>
<div class="line"><span class="lineno"> 2824</span>    3.759e-10, 3.247e-10, 2.809e-10, 2.438e-10, 2.123e-10, 1.853e-10,</div>
<div class="line"><span class="lineno"> 2825</span>    1.622e-10, 1.426e-10, 1.26e-10, 1.125e-10, 1.022e-10, 9.582e-11,</div>
<div class="line"><span class="lineno"> 2826</span>    9.388e-11, 9.801e-11, 1.08e-10, 1.276e-10, 1.551e-10, 1.903e-10,</div>
<div class="line"><span class="lineno"> 2827</span>    2.291e-10, 2.724e-10, 3.117e-10, 3.4e-10, 3.562e-10, 3.625e-10,</div>
<div class="line"><span class="lineno"> 2828</span>    3.619e-10, 3.429e-10, 3.221e-10, 2.943e-10, 2.645e-10, 2.338e-10,</div>
<div class="line"><span class="lineno"> 2829</span>    2.062e-10, 1.901e-10, 1.814e-10, 1.827e-10, 1.906e-10, 1.984e-10,</div>
<div class="line"><span class="lineno"> 2830</span>    2.04e-10, 2.068e-10, 2.075e-10, 2.018e-10, 1.959e-10, 1.897e-10,</div>
<div class="line"><span class="lineno"> 2831</span>    1.852e-10, 1.791e-10, 1.696e-10, 1.634e-10, 1.598e-10, 1.561e-10,</div>
<div class="line"><span class="lineno"> 2832</span>    1.518e-10, 1.443e-10, 1.377e-10, 1.346e-10, 1.342e-10, 1.375e-10,</div>
<div class="line"><span class="lineno"> 2833</span>    1.525e-10, 1.767e-10, 2.108e-10, 2.524e-10, 2.981e-10, 3.477e-10,</div>
<div class="line"><span class="lineno"> 2834</span>    4.262e-10, 5.326e-10, 6.646e-10, 8.321e-10, 1.069e-9, 1.386e-9,</div>
<div class="line"><span class="lineno"> 2835</span>    1.743e-9, 2.216e-9, 2.808e-9, 3.585e-9, 4.552e-9, 5.907e-9,</div>
<div class="line"><span class="lineno"> 2836</span>    7.611e-9, 9.774e-9, 1.255e-8, 1.666e-8, 2.279e-8, 3.221e-8,</div>
<div class="line"><span class="lineno"> 2837</span>    4.531e-8, 6.4e-8, 9.187e-8, 1.295e-7, 1.825e-7, 2.431e-7,</div>
<div class="line"><span class="lineno"> 2838</span>    3.181e-7, 4.009e-7, 4.941e-7, 5.88e-7, 6.623e-7, 7.155e-7,</div>
<div class="line"><span class="lineno"> 2839</span>    7.451e-7, 7.594e-7, 7.541e-7, 7.467e-7, 7.527e-7, 7.935e-7,</div>
<div class="line"><span class="lineno"> 2840</span>    8.461e-7, 8.954e-7, 9.364e-7, 9.843e-7, 1.024e-6, 1.05e-6,</div>
<div class="line"><span class="lineno"> 2841</span>    1.059e-6, 1.074e-6, 1.072e-6, 1.043e-6, 9.789e-7, 8.803e-7,</div>
<div class="line"><span class="lineno"> 2842</span>    7.662e-7, 6.378e-7, 5.133e-7, 3.958e-7, 2.914e-7, 2.144e-7,</div>
<div class="line"><span class="lineno"> 2843</span>    1.57e-7, 1.14e-7, 8.47e-8, 6.2e-8, 4.657e-8, 3.559e-8, 2.813e-8,</div>
<div class="line"><span class="lineno"> 2844</span>    2.222e-8, 1.769e-8, 1.391e-8, 1.125e-8, 9.186e-9, 7.704e-9,</div>
<div class="line"><span class="lineno"> 2845</span>    6.447e-9, 5.381e-9, 4.442e-9, 3.669e-9, 3.057e-9, 2.564e-9,</div>
<div class="line"><span class="lineno"> 2846</span>    2.153e-9, 1.784e-9, 1.499e-9, 1.281e-9, 1.082e-9, 9.304e-10,</div>
<div class="line"><span class="lineno"> 2847</span>    8.169e-10, 6.856e-10, 5.866e-10, 5.043e-10, 4.336e-10, 3.731e-10,</div>
<div class="line"><span class="lineno"> 2848</span>    3.175e-10, 2.745e-10, 2.374e-10, 2.007e-10, 1.737e-10, 1.508e-10,</div>
<div class="line"><span class="lineno"> 2849</span>    1.302e-10, 1.13e-10, 9.672e-11, 8.375e-11, 7.265e-11, 6.244e-11,</div>
<div class="line"><span class="lineno"> 2850</span>    5.343e-11, 4.654e-11, 3.975e-11, 3.488e-11, 3.097e-11, 2.834e-11,</div>
<div class="line"><span class="lineno"> 2851</span>    2.649e-11, 2.519e-11, 2.462e-11, 2.443e-11, 2.44e-11, 2.398e-11,</div>
<div class="line"><span class="lineno"> 2852</span>    2.306e-11, 2.183e-11, 2.021e-11, 1.821e-11, 1.599e-11, 1.403e-11,</div>
<div class="line"><span class="lineno"> 2853</span>    1.196e-11, 1.023e-11, 8.728e-12, 7.606e-12, 6.941e-12, 6.545e-12,</div>
<div class="line"><span class="lineno"> 2854</span>    6.484e-12, 6.6e-12, 6.718e-12, 6.785e-12, 6.746e-12, 6.724e-12,</div>
<div class="line"><span class="lineno"> 2855</span>    6.764e-12, 6.995e-12, 7.144e-12, 7.32e-12, 7.33e-12, 7.208e-12,</div>
<div class="line"><span class="lineno"> 2856</span>    6.789e-12, 6.09e-12, 5.337e-12, 4.62e-12, 4.037e-12, 3.574e-12,</div>
<div class="line"><span class="lineno"> 2857</span>    3.311e-12, 3.346e-12, 3.566e-12, 3.836e-12, 4.076e-12, 4.351e-12,</div>
<div class="line"><span class="lineno"> 2858</span>    4.691e-12, 5.114e-12, 5.427e-12, 6.167e-12, 7.436e-12, 8.842e-12,</div>
<div class="line"><span class="lineno"> 2859</span>    1.038e-11, 1.249e-11, 1.54e-11, 1.915e-11, 2.48e-11, 3.256e-11,</div>
<div class="line"><span class="lineno"> 2860</span>    4.339e-11, 5.611e-11, 7.519e-11, 1.037e-10, 1.409e-10, 1.883e-10,</div>
<div class="line"><span class="lineno"> 2861</span>    2.503e-10, 3.38e-10, 4.468e-10, 5.801e-10, 7.335e-10, 8.98e-10,</div>
<div class="line"><span class="lineno"> 2862</span>    1.11e-9, 1.363e-9, 1.677e-9, 2.104e-9, 2.681e-9, 3.531e-9,</div>
<div class="line"><span class="lineno"> 2863</span>    4.621e-9, 6.106e-9, 8.154e-9, 1.046e-8, 1.312e-8, 1.607e-8,</div>
<div class="line"><span class="lineno"> 2864</span>    1.948e-8, 2.266e-8, 2.495e-8, 2.655e-8, 2.739e-8, 2.739e-8,</div>
<div class="line"><span class="lineno"> 2865</span>    2.662e-8, 2.589e-8, 2.59e-8, 2.664e-8, 2.833e-8, 3.023e-8,</div>
<div class="line"><span class="lineno"> 2866</span>    3.305e-8, 3.558e-8, 3.793e-8, 3.961e-8, 4.056e-8, 4.102e-8,</div>
<div class="line"><span class="lineno"> 2867</span>    4.025e-8, 3.917e-8, 3.706e-8, 3.493e-8, 3.249e-8, 3.096e-8,</div>
<div class="line"><span class="lineno"> 2868</span>    3.011e-8, 3.111e-8, 3.395e-8, 3.958e-8, 4.875e-8, 6.066e-8,</div>
<div class="line"><span class="lineno"> 2869</span>    7.915e-8, 1.011e-7, 1.3e-7, 1.622e-7, 2.003e-7, 2.448e-7,</div>
<div class="line"><span class="lineno"> 2870</span>    2.863e-7, 3.317e-7, 3.655e-7, 3.96e-7, 4.098e-7, 4.168e-7,</div>
<div class="line"><span class="lineno"> 2871</span>    4.198e-7, 4.207e-7, 4.289e-7, 4.384e-7, 4.471e-7, 4.524e-7,</div>
<div class="line"><span class="lineno"> 2872</span>    4.574e-7, 4.633e-7, 4.785e-7, 5.028e-7, 5.371e-7, 5.727e-7,</div>
<div class="line"><span class="lineno"> 2873</span>    5.955e-7, 5.998e-7, 5.669e-7, 5.082e-7, 4.397e-7, 3.596e-7,</div>
<div class="line"><span class="lineno"> 2874</span>    2.814e-7, 2.074e-7, 1.486e-7, 1.057e-7, 7.25e-8, 4.946e-8,</div>
<div class="line"><span class="lineno"> 2875</span>    3.43e-8, 2.447e-8, 1.793e-8, 1.375e-8, 1.096e-8, 9.091e-9,</div>
<div class="line"><span class="lineno"> 2876</span>    7.709e-9, 6.631e-9, 5.714e-9, 4.886e-9, 4.205e-9, 3.575e-9,</div>
<div class="line"><span class="lineno"> 2877</span>    3.07e-9, 2.631e-9, 2.284e-9, 2.002e-9, 1.745e-9, 1.509e-9,</div>
<div class="line"><span class="lineno"> 2878</span>    1.284e-9, 1.084e-9, 9.163e-10, 7.663e-10, 6.346e-10, 5.283e-10,</div>
<div class="line"><span class="lineno"> 2879</span>    4.354e-10, 3.59e-10, 2.982e-10, 2.455e-10, 2.033e-10, 1.696e-10,</div>
<div class="line"><span class="lineno"> 2880</span>    1.432e-10, 1.211e-10, 1.02e-10, 8.702e-11, 7.38e-11, 6.293e-11,</div>
<div class="line"><span class="lineno"> 2881</span>    5.343e-11, 4.532e-11, 3.907e-11, 3.365e-11, 2.945e-11, 2.558e-11,</div>
<div class="line"><span class="lineno"> 2882</span>    2.192e-11, 1.895e-11, 1.636e-11, 1.42e-11, 1.228e-11, 1.063e-11,</div>
<div class="line"><span class="lineno"> 2883</span>    9.348e-12, 8.2e-12, 7.231e-12, 6.43e-12, 5.702e-12, 5.052e-12,</div>
<div class="line"><span class="lineno"> 2884</span>    4.469e-12, 4e-12, 3.679e-12, 3.387e-12, 3.197e-12, 3.158e-12,</div>
<div class="line"><span class="lineno"> 2885</span>    3.327e-12, 3.675e-12, 4.292e-12, 5.437e-12, 7.197e-12, 1.008e-11,</div>
<div class="line"><span class="lineno"> 2886</span>    1.437e-11, 2.035e-11, 2.905e-11, 4.062e-11, 5.528e-11, 7.177e-11,</div>
<div class="line"><span class="lineno"> 2887</span>    9.064e-11, 1.109e-10, 1.297e-10, 1.473e-10, 1.652e-10, 1.851e-10,</div>
<div class="line"><span class="lineno"> 2888</span>    2.079e-10, 2.313e-10, 2.619e-10, 2.958e-10, 3.352e-10, 3.796e-10,</div>
<div class="line"><span class="lineno"> 2889</span>    4.295e-10, 4.923e-10, 5.49e-10, 5.998e-10, 6.388e-10, 6.645e-10,</div>
<div class="line"><span class="lineno"> 2890</span>    6.712e-10, 6.549e-10, 6.38e-10, 6.255e-10, 6.253e-10, 6.459e-10,</div>
<div class="line"><span class="lineno"> 2891</span>    6.977e-10, 7.59e-10, 8.242e-10, 8.92e-10, 9.403e-10, 9.701e-10,</div>
<div class="line"><span class="lineno"> 2892</span>    9.483e-10, 9.135e-10, 8.617e-10, 7.921e-10, 7.168e-10, 6.382e-10,</div>
<div class="line"><span class="lineno"> 2893</span>    5.677e-10, 5.045e-10, 4.572e-10, 4.312e-10, 4.145e-10, 4.192e-10,</div>
<div class="line"><span class="lineno"> 2894</span>    4.541e-10, 5.368e-10, 6.771e-10, 8.962e-10, 1.21e-9, 1.659e-9,</div>
<div class="line"><span class="lineno"> 2895</span>    2.33e-9, 3.249e-9, 4.495e-9, 5.923e-9, 7.642e-9, 9.607e-9,</div>
<div class="line"><span class="lineno"> 2896</span>    1.178e-8, 1.399e-8, 1.584e-8, 1.73e-8, 1.816e-8, 1.87e-8,</div>
<div class="line"><span class="lineno"> 2897</span>    1.868e-8, 1.87e-8, 1.884e-8, 1.99e-8, 2.15e-8, 2.258e-8,</div>
<div class="line"><span class="lineno"> 2898</span>    2.364e-8, 2.473e-8, 2.602e-8, 2.689e-8, 2.731e-8, 2.816e-8,</div>
<div class="line"><span class="lineno"> 2899</span>    2.859e-8, 2.839e-8, 2.703e-8, 2.451e-8, 2.149e-8, 1.787e-8,</div>
<div class="line"><span class="lineno"> 2900</span>    1.449e-8, 1.111e-8, 8.282e-9, 6.121e-9, 4.494e-9, 3.367e-9,</div>
<div class="line"><span class="lineno"> 2901</span>    2.487e-9, 1.885e-9, 1.503e-9, 1.249e-9, 1.074e-9, 9.427e-10,</div>
<div class="line"><span class="lineno"> 2902</span>    8.439e-10, 7.563e-10, 6.772e-10, 6.002e-10, 5.254e-10, 4.588e-10,</div>
<div class="line"><span class="lineno"> 2903</span>    3.977e-10, 3.449e-10, 3.003e-10, 2.624e-10, 2.335e-10, 2.04e-10,</div>
<div class="line"><span class="lineno"> 2904</span>    1.771e-10, 1.534e-10, 1.296e-10, 1.097e-10, 9.173e-11, 7.73e-11,</div>
<div class="line"><span class="lineno"> 2905</span>    6.547e-11, 5.191e-11, 4.198e-11, 3.361e-11, 2.732e-11, 2.244e-11,</div>
<div class="line"><span class="lineno"> 2906</span>    1.791e-11, 1.509e-11, 1.243e-11, 1.035e-11, 8.969e-12, 7.394e-12,</div>
<div class="line"><span class="lineno"> 2907</span>    6.323e-12, 5.282e-12, 4.543e-12, 3.752e-12, 3.14e-12, 2.6e-12,</div>
<div class="line"><span class="lineno"> 2908</span>    2.194e-12, 1.825e-12, 1.511e-12, 1.245e-12, 1.024e-12, 8.539e-13,</div>
<div class="line"><span class="lineno"> 2909</span>    7.227e-13, 6.102e-13, 5.189e-13, 4.43e-13, 3.774e-13, 3.236e-13,</div>
<div class="line"><span class="lineno"> 2910</span>    2.8e-13, 2.444e-13, 2.156e-13, 1.932e-13, 1.775e-13, 1.695e-13,</div>
<div class="line"><span class="lineno"> 2911</span>    1.672e-13, 1.704e-13, 1.825e-13, 2.087e-13, 2.614e-13, 3.377e-13,</div>
<div class="line"><span class="lineno"> 2912</span>    4.817e-13, 6.989e-13, 1.062e-12, 1.562e-12, 2.288e-12, 3.295e-12,</div>
<div class="line"><span class="lineno"> 2913</span>    4.55e-12, 5.965e-12, 7.546e-12, 9.395e-12, 1.103e-11, 1.228e-11,</div>
<div class="line"><span class="lineno"> 2914</span>    1.318e-11, 1.38e-11, 1.421e-11, 1.39e-11, 1.358e-11, 1.336e-11,</div>
<div class="line"><span class="lineno"> 2915</span>    1.342e-11, 1.356e-11, 1.424e-11, 1.552e-11, 1.73e-11, 1.951e-11,</div>
<div class="line"><span class="lineno"> 2916</span>    2.128e-11, 2.249e-11, 2.277e-11, 2.226e-11, 2.111e-11, 1.922e-11,</div>
<div class="line"><span class="lineno"> 2917</span>    1.775e-11, 1.661e-11, 1.547e-11, 1.446e-11, 1.323e-11, 1.21e-11,</div>
<div class="line"><span class="lineno"> 2918</span>    1.054e-11, 9.283e-12, 8.671e-12, 8.67e-12, 9.429e-12, 1.062e-11,</div>
<div class="line"><span class="lineno"> 2919</span>    1.255e-11, 1.506e-11, 1.818e-11, 2.26e-11, 2.831e-11, 3.723e-11,</div>
<div class="line"><span class="lineno"> 2920</span>    5.092e-11, 6.968e-11, 9.826e-11, 1.349e-10, 1.87e-10, 2.58e-10,</div>
<div class="line"><span class="lineno"> 2921</span>    3.43e-10, 4.424e-10, 5.521e-10, 6.812e-10, 8.064e-10, 9.109e-10,</div>
<div class="line"><span class="lineno"> 2922</span>    9.839e-10, 1.028e-9, 1.044e-9, 1.029e-9, 1.005e-9, 1.002e-9,</div>
<div class="line"><span class="lineno"> 2923</span>    1.038e-9, 1.122e-9, 1.233e-9, 1.372e-9, 1.524e-9, 1.665e-9,</div>
<div class="line"><span class="lineno"> 2924</span>    1.804e-9, 1.908e-9, 2.015e-9, 2.117e-9, 2.219e-9, 2.336e-9,</div>
<div class="line"><span class="lineno"> 2925</span>    2.531e-9, 2.805e-9, 3.189e-9, 3.617e-9, 4.208e-9, 4.911e-9,</div>
<div class="line"><span class="lineno"> 2926</span>    5.619e-9, 6.469e-9, 7.188e-9, 7.957e-9, 8.503e-9, 9.028e-9,</div>
<div class="line"><span class="lineno"> 2927</span>    9.571e-9, 9.99e-9, 1.055e-8, 1.102e-8, 1.132e-8, 1.141e-8,</div>
<div class="line"><span class="lineno"> 2928</span>    1.145e-8, 1.145e-8, 1.176e-8, 1.224e-8, 1.304e-8, 1.388e-8,</div>
<div class="line"><span class="lineno"> 2929</span>    1.445e-8, 1.453e-8, 1.368e-8, 1.22e-8, 1.042e-8, 8.404e-9,</div>
<div class="line"><span class="lineno"> 2930</span>    6.403e-9, 4.643e-9, 3.325e-9, 2.335e-9, 1.638e-9, 1.19e-9,</div>
<div class="line"><span class="lineno"> 2931</span>    9.161e-10, 7.412e-10, 6.226e-10, 5.516e-10, 5.068e-10, 4.831e-10,</div>
<div class="line"><span class="lineno"> 2932</span>    4.856e-10, 5.162e-10, 5.785e-10, 6.539e-10, 7.485e-10, 8.565e-10,</div>
<div class="line"><span class="lineno"> 2933</span>    9.534e-10, 1.052e-9, 1.115e-9, 1.173e-9, 1.203e-9, 1.224e-9,</div>
<div class="line"><span class="lineno"> 2934</span>    1.243e-9, 1.248e-9, 1.261e-9, 1.265e-9, 1.25e-9, 1.217e-9,</div>
<div class="line"><span class="lineno"> 2935</span>    1.176e-9, 1.145e-9, 1.153e-9, 1.199e-9, 1.278e-9, 1.366e-9,</div>
<div class="line"><span class="lineno"> 2936</span>    1.426e-9, 1.444e-9, 1.365e-9, 1.224e-9, 1.051e-9, 8.539e-10,</div>
<div class="line"><span class="lineno"> 2937</span>    6.564e-10, 4.751e-10, 3.404e-10, 2.377e-10, 1.631e-10, 1.114e-10,</div>
<div class="line"><span class="lineno"> 2938</span>    7.87e-11, 5.793e-11, 4.284e-11, 3.3e-11, 2.62e-11, 2.152e-11,</div>
<div class="line"><span class="lineno"> 2939</span>    1.777e-11, 1.496e-11, 1.242e-11, 1.037e-11, 8.725e-12, 7.004e-12,</div>
<div class="line"><span class="lineno"> 2940</span>    5.718e-12, 4.769e-12, 3.952e-12, 3.336e-12, 2.712e-12, 2.213e-12,</div>
<div class="line"><span class="lineno"> 2941</span>    1.803e-12, 1.492e-12, 1.236e-12, 1.006e-12, 8.384e-13, 7.063e-13,</div>
<div class="line"><span class="lineno"> 2942</span>    5.879e-13, 4.93e-13, 4.171e-13, 3.569e-13, 3.083e-13, 2.688e-13,</div>
<div class="line"><span class="lineno"> 2943</span>    2.333e-13, 2.035e-13, 1.82e-13, 1.682e-13, 1.635e-13, 1.674e-13,</div>
<div class="line"><span class="lineno"> 2944</span>    1.769e-13, 2.022e-13, 2.485e-13, 3.127e-13, 4.25e-13, 5.928e-13,</div>
<div class="line"><span class="lineno"> 2945</span>    8.514e-13, 1.236e-12, 1.701e-12, 2.392e-12, 3.231e-12, 4.35e-12,</div>
<div class="line"><span class="lineno"> 2946</span>    5.559e-12, 6.915e-12, 8.519e-12, 1.013e-11, 1.146e-11, 1.24e-11,</div>
<div class="line"><span class="lineno"> 2947</span>    1.305e-11, 1.333e-11, 1.318e-11, 1.263e-11, 1.238e-11, 1.244e-11,</div>
<div class="line"><span class="lineno"> 2948</span>    1.305e-11, 1.432e-11, 1.623e-11, 1.846e-11, 2.09e-11, 2.328e-11,</div>
<div class="line"><span class="lineno"> 2949</span>    2.526e-11, 2.637e-11, 2.702e-11, 2.794e-11, 2.889e-11, 2.989e-11,</div>
<div class="line"><span class="lineno"> 2950</span>    3.231e-11, 3.68e-11, 4.375e-11, 5.504e-11, 7.159e-11, 9.502e-11,</div>
<div class="line"><span class="lineno"> 2951</span>    1.279e-10, 1.645e-10, 2.098e-10, 2.618e-10, 3.189e-10, 3.79e-10,</div>
<div class="line"><span class="lineno"> 2952</span>    4.303e-10, 4.753e-10, 5.027e-10, 5.221e-10, 5.293e-10, 5.346e-10,</div>
<div class="line"><span class="lineno"> 2953</span>    5.467e-10, 5.796e-10, 6.2e-10, 6.454e-10, 6.705e-10, 6.925e-10,</div>
<div class="line"><span class="lineno"> 2954</span>    7.233e-10, 7.35e-10, 7.538e-10, 7.861e-10, 8.077e-10, 8.132e-10,</div>
<div class="line"><span class="lineno"> 2955</span>    7.749e-10, 7.036e-10, 6.143e-10, 5.093e-10, 4.089e-10, 3.092e-10,</div>
<div class="line"><span class="lineno"> 2956</span>    2.299e-10, 1.705e-10, 1.277e-10, 9.723e-11, 7.533e-11, 6.126e-11,</div>
<div class="line"><span class="lineno"> 2957</span>    5.154e-11, 4.428e-11, 3.913e-11, 3.521e-11, 3.297e-11, 3.275e-11,</div>
<div class="line"><span class="lineno"> 2958</span>    3.46e-11, 3.798e-11, 4.251e-11, 4.745e-11, 5.232e-11, 5.606e-11,</div>
<div class="line"><span class="lineno"> 2959</span>    5.82e-11, 5.88e-11, 5.79e-11, 5.661e-11, 5.491e-11, 5.366e-11,</div>
<div class="line"><span class="lineno"> 2960</span>    5.341e-11, 5.353e-11, 5.336e-11, 5.293e-11, 5.248e-11, 5.235e-11,</div>
<div class="line"><span class="lineno"> 2961</span>    5.208e-11, 5.322e-11, 5.521e-11, 5.725e-11, 5.827e-11, 5.685e-11,</div>
<div class="line"><span class="lineno"> 2962</span>    5.245e-11, 4.612e-11, 3.884e-11, 3.129e-11, 2.404e-11, 1.732e-11,</div>
<div class="line"><span class="lineno"> 2963</span>    1.223e-11, 8.574e-12, 5.888e-12, 3.986e-12, 2.732e-12, 1.948e-12,</div>
<div class="line"><span class="lineno"> 2964</span>    1.414e-12, 1.061e-12, 8.298e-13, 6.612e-13, 5.413e-13, 4.472e-13,</div>
<div class="line"><span class="lineno"> 2965</span>    3.772e-13, 3.181e-13, 2.645e-13, 2.171e-13, 1.778e-13, 1.464e-13,</div>
<div class="line"><span class="lineno"> 2966</span>    1.183e-13, 9.637e-14, 7.991e-14, 6.668e-14, 5.57e-14, 4.663e-14,</div>
<div class="line"><span class="lineno"> 2967</span>    3.848e-14, 3.233e-14, 2.706e-14, 2.284e-14, 1.944e-14, 1.664e-14,</div>
<div class="line"><span class="lineno"> 2968</span>    1.43e-14, 1.233e-14, 1.066e-14, 9.234e-15, 8.023e-15, 6.993e-15,</div>
<div class="line"><span class="lineno"> 2969</span>    6.119e-15, 5.384e-15, 4.774e-15, 4.283e-15, 3.916e-15, 3.695e-15,</div>
<div class="line"><span class="lineno"> 2970</span>    3.682e-15, 4.004e-15, 4.912e-15, 6.853e-15, 1.056e-14, 1.712e-14,</div>
<div class="line"><span class="lineno"> 2971</span>    2.804e-14, 4.516e-14, 7.113e-14, 1.084e-13, 1.426e-13, 1.734e-13,</div>
<div class="line"><span class="lineno"> 2972</span>    1.978e-13, 2.194e-13, 2.388e-13, 2.489e-13, 2.626e-13, 2.865e-13,</div>
<div class="line"><span class="lineno"> 2973</span>    3.105e-13, 3.387e-13, 3.652e-13, 3.984e-13, 4.398e-13, 4.906e-13,</div>
<div class="line"><span class="lineno"> 2974</span>    5.55e-13, 6.517e-13, 7.813e-13, 9.272e-13, 1.164e-12, 1.434e-12,</div>
<div class="line"><span class="lineno"> 2975</span>    1.849e-12, 2.524e-12, 3.328e-12, 4.523e-12, 6.108e-12, 8.207e-12,</div>
<div class="line"><span class="lineno"> 2976</span>    1.122e-11, 1.477e-11, 1.9e-11, 2.412e-11, 2.984e-11, 3.68e-11,</div>
<div class="line"><span class="lineno"> 2977</span>    4.353e-11, 4.963e-11, 5.478e-11, 5.903e-11, 6.233e-11, 6.483e-11,</div>
<div class="line"><span class="lineno"> 2978</span>    6.904e-11, 7.569e-11, 8.719e-11, 1.048e-10, 1.278e-10, 1.557e-10,</div>
<div class="line"><span class="lineno"> 2979</span>    1.869e-10, 2.218e-10, 2.61e-10, 2.975e-10, 3.371e-10, 3.746e-10,</div>
<div class="line"><span class="lineno"> 2980</span>    4.065e-10, 4.336e-10, 4.503e-10, 4.701e-10, 4.8e-10, 4.917e-10,</div>
<div class="line"><span class="lineno"> 2981</span>    5.038e-10, 5.128e-10, 5.143e-10, 5.071e-10, 5.019e-10, 5.025e-10,</div>
<div class="line"><span class="lineno"> 2982</span>    5.183e-10, 5.496e-10, 5.877e-10, 6.235e-10, 6.42e-10, 6.234e-10,</div>
<div class="line"><span class="lineno"> 2983</span>    5.698e-10, 4.916e-10, 4.022e-10, 3.126e-10, 2.282e-10, 1.639e-10,</div>
<div class="line"><span class="lineno"> 2984</span>    1.142e-10, 7.919e-11, 5.69e-11, 4.313e-11, 3.413e-11, 2.807e-11,</div>
<div class="line"><span class="lineno"> 2985</span>    2.41e-11, 2.166e-11, 2.024e-11, 1.946e-11, 1.929e-11, 1.963e-11,</div>
<div class="line"><span class="lineno"> 2986</span>    2.035e-11, 2.162e-11, 2.305e-11, 2.493e-11, 2.748e-11, 3.048e-11,</div>
<div class="line"><span class="lineno"> 2987</span>    3.413e-11, 3.754e-11, 4.155e-11, 4.635e-11, 5.11e-11, 5.734e-11,</div>
<div class="line"><span class="lineno"> 2988</span>    6.338e-11, 6.99e-11, 7.611e-11, 8.125e-11, 8.654e-11, 8.951e-11,</div>
<div class="line"><span class="lineno"> 2989</span>    9.182e-11, 9.31e-11, 9.273e-11, 9.094e-11, 8.849e-11, 8.662e-11,</div>
<div class="line"><span class="lineno"> 2990</span>    8.67e-11, 8.972e-11, 9.566e-11, 1.025e-10, 1.083e-10, 1.111e-10,</div>
<div class="line"><span class="lineno"> 2991</span>    1.074e-10, 9.771e-11, 8.468e-11, 6.958e-11, 5.47e-11, 4.04e-11,</div>
<div class="line"><span class="lineno"> 2992</span>    2.94e-11, 2.075e-11, 1.442e-11, 1.01e-11, 7.281e-12, 5.409e-12,</div>
<div class="line"><span class="lineno"> 2993</span>    4.138e-12, 3.304e-12, 2.784e-12, 2.473e-12, 2.273e-12, 2.186e-12,</div>
<div class="line"><span class="lineno"> 2994</span>    2.118e-12, 2.066e-12, 1.958e-12, 1.818e-12, 1.675e-12, 1.509e-12,</div>
<div class="line"><span class="lineno"> 2995</span>    1.349e-12, 1.171e-12, 9.838e-13, 8.213e-13, 6.765e-13, 5.378e-13,</div>
<div class="line"><span class="lineno"> 2996</span>    4.161e-13, 3.119e-13, 2.279e-13, 1.637e-13, 1.152e-13, 8.112e-14,</div>
<div class="line"><span class="lineno"> 2997</span>    5.919e-14, 4.47e-14, 3.492e-14, 2.811e-14, 2.319e-14, 1.948e-14,</div>
<div class="line"><span class="lineno"> 2998</span>    1.66e-14, 1.432e-14, 1.251e-14, 1.109e-14, 1.006e-14, 9.45e-15,</div>
<div class="line"><span class="lineno"> 2999</span>    9.384e-15, 1.012e-14, 1.216e-14, 1.636e-14, 2.305e-14, 3.488e-14,</div>
<div class="line"><span class="lineno"> 3000</span>    5.572e-14, 8.479e-14, 1.265e-13, 1.905e-13, 2.73e-13, 3.809e-13,</div>
<div class="line"><span class="lineno"> 3001</span>    4.955e-13, 6.303e-13, 7.861e-13, 9.427e-13, 1.097e-12, 1.212e-12,</div>
<div class="line"><span class="lineno"> 3002</span>    1.328e-12, 1.415e-12, 1.463e-12, 1.495e-12, 1.571e-12, 1.731e-12,</div>
<div class="line"><span class="lineno"> 3003</span>    1.981e-12, 2.387e-12, 2.93e-12, 3.642e-12, 4.584e-12, 5.822e-12,</div>
<div class="line"><span class="lineno"> 3004</span>    7.278e-12, 9.193e-12, 1.135e-11, 1.382e-11, 1.662e-11, 1.958e-11,</div>
<div class="line"><span class="lineno"> 3005</span>    2.286e-11, 2.559e-11, 2.805e-11, 2.988e-11, 3.106e-11, 3.182e-11,</div>
<div class="line"><span class="lineno"> 3006</span>    3.2e-11, 3.258e-11, 3.362e-11, 3.558e-11, 3.688e-11, 3.8e-11,</div>
<div class="line"><span class="lineno"> 3007</span>    3.929e-11, 4.062e-11, 4.186e-11, 4.293e-11, 4.48e-11, 4.643e-11,</div>
<div class="line"><span class="lineno"> 3008</span>    4.704e-11, 4.571e-11, 4.206e-11, 3.715e-11, 3.131e-11, 2.541e-11,</div>
<div class="line"><span class="lineno"> 3009</span>    1.978e-11, 1.508e-11, 1.146e-11, 8.7e-12, 6.603e-12, 5.162e-12,</div>
<div class="line"><span class="lineno"> 3010</span>    4.157e-12, 3.408e-12, 2.829e-12, 2.405e-12, 2.071e-12, 1.826e-12,</div>
<div class="line"><span class="lineno"> 3011</span>    1.648e-12, 1.542e-12, 1.489e-12, 1.485e-12, 1.493e-12, 1.545e-12,</div>
<div class="line"><span class="lineno"> 3012</span>    1.637e-12, 1.814e-12, 2.061e-12, 2.312e-12, 2.651e-12, 3.03e-12,</div>
<div class="line"><span class="lineno"> 3013</span>    3.46e-12, 3.901e-12, 4.306e-12, 4.721e-12, 5.008e-12, 5.281e-12,</div>
<div class="line"><span class="lineno"> 3014</span>    5.541e-12, 5.791e-12, 6.115e-12, 6.442e-12, 6.68e-12, 6.791e-12,</div>
<div class="line"><span class="lineno"> 3015</span>    6.831e-12, 6.839e-12, 6.946e-12, 7.128e-12, 7.537e-12, 8.036e-12,</div>
<div class="line"><span class="lineno"> 3016</span>    8.392e-12, 8.526e-12, 8.11e-12, 7.325e-12, 6.329e-12, 5.183e-12,</div>
<div class="line"><span class="lineno"> 3017</span>    4.081e-12, 2.985e-12, 2.141e-12, 1.492e-12, 1.015e-12, 6.684e-13,</div>
<div class="line"><span class="lineno"> 3018</span>    4.414e-13, 2.987e-13, 2.038e-13, 1.391e-13, 9.86e-14, 7.24e-14,</div>
<div class="line"><span class="lineno"> 3019</span>    5.493e-14, 4.288e-14, 3.427e-14, 2.787e-14, 2.296e-14, 1.909e-14,</div>
<div class="line"><span class="lineno"> 3020</span>    1.598e-14, 1.344e-14, 1.135e-14, 9.616e-15, 8.169e-15, 6.957e-15,</div>
<div class="line"><span class="lineno"> 3021</span>    5.938e-15, 5.08e-15, 4.353e-15, 3.738e-15, 3.217e-15, 2.773e-15,</div>
<div class="line"><span class="lineno"> 3022</span>    2.397e-15, 2.077e-15, 1.805e-15, 1.575e-15, 1.382e-15, 1.221e-15,</div>
<div class="line"><span class="lineno"> 3023</span>    1.09e-15, 9.855e-16, 9.068e-16, 8.537e-16, 8.27e-16, 8.29e-16,</div>
<div class="line"><span class="lineno"> 3024</span>    8.634e-16, 9.359e-16, 1.055e-15, 1.233e-15, 1.486e-15, 1.839e-15,</div>
<div class="line"><span class="lineno"> 3025</span>    2.326e-15, 2.998e-15, 3.934e-15, 5.256e-15, 7.164e-15, 9.984e-15,</div>
<div class="line"><span class="lineno"> 3026</span>    1.427e-14, 2.099e-14, 3.196e-14, 5.121e-14, 7.908e-14, 1.131e-13,</div>
<div class="line"><span class="lineno"> 3027</span>    1.602e-13, 2.239e-13, 3.075e-13, 4.134e-13, 5.749e-13, 7.886e-13,</div>
<div class="line"><span class="lineno"> 3028</span>    1.071e-12, 1.464e-12, 2.032e-12, 2.8e-12, 3.732e-12, 4.996e-12,</div>
<div class="line"><span class="lineno"> 3029</span>    6.483e-12, 8.143e-12, 1.006e-11, 1.238e-11, 1.484e-11, 1.744e-11,</div>
<div class="line"><span class="lineno"> 3030</span>    2.02e-11, 2.274e-11, 2.562e-11, 2.848e-11, 3.191e-11, 3.617e-11,</div>
<div class="line"><span class="lineno"> 3031</span>    4.081e-11, 4.577e-11, 4.937e-11, 5.204e-11, 5.401e-11, 5.462e-11,</div>
<div class="line"><span class="lineno"> 3032</span>    5.507e-11, 5.51e-11, 5.605e-11, 5.686e-11, 5.739e-11, 5.766e-11,</div>
<div class="line"><span class="lineno"> 3033</span>    5.74e-11, 5.754e-11, 5.761e-11, 5.777e-11, 5.712e-11, 5.51e-11,</div>
<div class="line"><span class="lineno"> 3034</span>    5.088e-11, 4.438e-11, 3.728e-11, 2.994e-11, 2.305e-11, 1.715e-11,</div>
<div class="line"><span class="lineno"> 3035</span>    1.256e-11, 9.208e-12, 6.745e-12, 5.014e-12, 3.785e-12, 2.9e-12,</div>
<div class="line"><span class="lineno"> 3036</span>    2.239e-12, 1.757e-12, 1.414e-12, 1.142e-12, 9.482e-13, 8.01e-13,</div>
<div class="line"><span class="lineno"> 3037</span>    6.961e-13, 6.253e-13, 5.735e-13, 5.433e-13, 5.352e-13, 5.493e-13,</div>
<div class="line"><span class="lineno"> 3038</span>    5.706e-13, 6.068e-13, 6.531e-13, 7.109e-13, 7.767e-13, 8.59e-13,</div>
<div class="line"><span class="lineno"> 3039</span>    9.792e-13, 1.142e-12, 1.371e-12, 1.65e-12, 1.957e-12, 2.302e-12,</div>
<div class="line"><span class="lineno"> 3040</span>    2.705e-12, 3.145e-12, 3.608e-12, 4.071e-12, 4.602e-12, 5.133e-12,</div>
<div class="line"><span class="lineno"> 3041</span>    5.572e-12, 5.987e-12, 6.248e-12, 6.533e-12, 6.757e-12, 6.935e-12,</div>
<div class="line"><span class="lineno"> 3042</span>    7.224e-12, 7.422e-12, 7.538e-12, 7.547e-12, 7.495e-12, 7.543e-12,</div>
<div class="line"><span class="lineno"> 3043</span>    7.725e-12, 8.139e-12, 8.627e-12, 9.146e-12, 9.443e-12, 9.318e-12,</div>
<div class="line"><span class="lineno"> 3044</span>    8.649e-12, 7.512e-12, 6.261e-12, 4.915e-12, 3.647e-12, 2.597e-12,</div>
<div class="line"><span class="lineno"> 3045</span>    1.785e-12, 1.242e-12, 8.66e-13, 6.207e-13, 4.61e-13, 3.444e-13,</div>
<div class="line"><span class="lineno"> 3046</span>    2.634e-13, 2.1e-13, 1.725e-13, 1.455e-13, 1.237e-13, 1.085e-13,</div>
<div class="line"><span class="lineno"> 3047</span>    9.513e-14, 7.978e-14, 6.603e-14, 5.288e-14, 4.084e-14, 2.952e-14,</div>
<div class="line"><span class="lineno"> 3048</span>    2.157e-14, 1.593e-14, 1.199e-14, 9.267e-15, 7.365e-15, 6.004e-15,</div>
<div class="line"><span class="lineno"> 3049</span>    4.995e-15, 4.218e-15, 3.601e-15, 3.101e-15, 2.692e-15, 2.36e-15,</div>
<div class="line"><span class="lineno"> 3050</span>    2.094e-15, 1.891e-15, 1.755e-15, 1.699e-15, 1.755e-15, 1.987e-15,</div>
<div class="line"><span class="lineno"> 3051</span>    2.506e-15, 3.506e-15, 5.289e-15, 8.311e-15, 1.325e-14, 2.129e-14,</div>
<div class="line"><span class="lineno"> 3052</span>    3.237e-14, 4.595e-14, 6.441e-14, 8.433e-14, 1.074e-13, 1.383e-13,</div>
<div class="line"><span class="lineno"> 3053</span>    1.762e-13, 2.281e-13, 2.831e-13, 3.523e-13, 4.38e-13, 5.304e-13,</div>
<div class="line"><span class="lineno"> 3054</span>    6.29e-13, 7.142e-13, 8.032e-13, 8.934e-13, 9.888e-13, 1.109e-12,</div>
<div class="line"><span class="lineno"> 3055</span>    1.261e-12, 1.462e-12, 1.74e-12, 2.099e-12, 2.535e-12, 3.008e-12,</div>
<div class="line"><span class="lineno"> 3056</span>    3.462e-12, 3.856e-12, 4.098e-12, 4.239e-12, 4.234e-12, 4.132e-12,</div>
<div class="line"><span class="lineno"> 3057</span>    3.986e-12, 3.866e-12, 3.829e-12, 3.742e-12, 3.705e-12, 3.694e-12,</div>
<div class="line"><span class="lineno"> 3058</span>    3.765e-12, 3.849e-12, 3.929e-12, 4.056e-12, 4.092e-12, 4.047e-12,</div>
<div class="line"><span class="lineno"> 3059</span>    3.792e-12, 3.407e-12, 2.953e-12, 2.429e-12, 1.931e-12, 1.46e-12,</div>
<div class="line"><span class="lineno"> 3060</span>    1.099e-12, 8.199e-13, 6.077e-13, 4.449e-13, 3.359e-13, 2.524e-13,</div>
<div class="line"><span class="lineno"> 3061</span>    1.881e-13, 1.391e-13, 1.02e-13, 7.544e-14, 5.555e-14, 4.22e-14,</div>
<div class="line"><span class="lineno"> 3062</span>    3.321e-14, 2.686e-14, 2.212e-14, 1.78e-14, 1.369e-14, 1.094e-14,</div>
<div class="line"><span class="lineno"> 3063</span>    9.13e-15, 8.101e-15, 7.828e-15, 8.393e-15, 1.012e-14, 1.259e-14,</div>
<div class="line"><span class="lineno"> 3064</span>    1.538e-14, 1.961e-14, 2.619e-14, 3.679e-14, 5.049e-14, 6.917e-14,</div>
<div class="line"><span class="lineno"> 3065</span>    8.88e-14, 1.115e-13, 1.373e-13, 1.619e-13, 1.878e-13, 2.111e-13,</div>
<div class="line"><span class="lineno"> 3066</span>    2.33e-13, 2.503e-13, 2.613e-13, 2.743e-13, 2.826e-13, 2.976e-13,</div>
<div class="line"><span class="lineno"> 3067</span>    3.162e-13, 3.36e-13, 3.491e-13, 3.541e-13, 3.595e-13, 3.608e-13,</div>
<div class="line"><span class="lineno"> 3068</span>    3.709e-13, 3.869e-13, 4.12e-13, 4.366e-13, 4.504e-13, 4.379e-13,</div>
<div class="line"><span class="lineno"> 3069</span>    3.955e-13, 3.385e-13, 2.741e-13, 2.089e-13, 1.427e-13, 9.294e-14,</div>
<div class="line"><span class="lineno"> 3070</span>    5.775e-14, 3.565e-14, 2.21e-14, 1.398e-14, 9.194e-15, 6.363e-15,</div>
<div class="line"><span class="lineno"> 3071</span>    4.644e-15, 3.55e-15, 2.808e-15, 2.274e-15, 1.871e-15, 1.557e-15,</div>
<div class="line"><span class="lineno"> 3072</span>    1.308e-15, 1.108e-15, 9.488e-16, 8.222e-16, 7.238e-16, 6.506e-16,</div>
<div class="line"><span class="lineno"> 3073</span>    6.008e-16, 5.742e-16, 5.724e-16, 5.991e-16, 6.625e-16, 7.775e-16,</div>
<div class="line"><span class="lineno"> 3074</span>    9.734e-16, 1.306e-15, 1.88e-15, 2.879e-15, 4.616e-15, 7.579e-15,</div>
<div class="line"><span class="lineno"> 3075</span>    1.248e-14, 2.03e-14, 3.244e-14, 5.171e-14, 7.394e-14, 9.676e-14,</div>
<div class="line"><span class="lineno"> 3076</span>    1.199e-13, 1.467e-13, 1.737e-13, 2.02e-13, 2.425e-13, 3.016e-13,</div>
<div class="line"><span class="lineno"> 3077</span>    3.7e-13, 4.617e-13, 5.949e-13, 7.473e-13, 9.378e-13, 1.191e-12,</div>
<div class="line"><span class="lineno"> 3078</span>    1.481e-12, 1.813e-12, 2.232e-12, 2.722e-12, 3.254e-12, 3.845e-12,</div>
<div class="line"><span class="lineno"> 3079</span>    4.458e-12, 5.048e-12, 5.511e-12, 5.898e-12, 6.204e-12, 6.293e-12,</div>
<div class="line"><span class="lineno"> 3080</span>    6.386e-12, 6.467e-12, 6.507e-12, 6.466e-12, 6.443e-12, 6.598e-12,</div>
<div class="line"><span class="lineno"> 3081</span>    6.873e-12, 7.3e-12, 7.816e-12, 8.368e-12, 8.643e-12, 8.466e-12,</div>
<div class="line"><span class="lineno"> 3082</span>    7.871e-12, 6.853e-12, 5.714e-12, 4.482e-12, 3.392e-12, 2.613e-12,</div>
<div class="line"><span class="lineno"> 3083</span>    2.008e-12, 1.562e-12, 1.228e-12, 9.888e-13, 7.646e-13, 5.769e-13,</div>
<div class="line"><span class="lineno"> 3084</span>    4.368e-13, 3.324e-13, 2.508e-13, 1.916e-13</div>
<div class="line"><span class="lineno"> 3085</span>  };</div>
<div class="line"><span class="lineno"> 3086</span> </div>
<div class="line"><span class="lineno"> 3087</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> xfcrev[15] =</div>
<div class="line"><span class="lineno"> 3088</span>    { 1.003, 1.009, 1.015, 1.023, 1.029, 1.033, 1.037,</div>
<div class="line"><span class="lineno"> 3089</span>    1.039, 1.04, 1.046, 1.036, 1.027, 1.01, 1.002, 1.</div>
<div class="line"><span class="lineno"> 3090</span>  };</div>
<div class="line"><span class="lineno"> 3091</span> </div>
<div class="line"><span class="lineno"> 3092</span>  <span class="keywordtype">double</span> sfac;</div>
<div class="line"><span class="lineno"> 3093</span> </div>
<div class="line"><span class="lineno"> 3094</span>  <span class="comment">/* Get H2O continuum absorption... */</span></div>
<div class="line"><span class="lineno"> 3095</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> xw = nu / 10 + 1;</div>
<div class="line"><span class="lineno"> 3096</span>  <span class="keywordflow">if</span> (xw &gt;= 1 &amp;&amp; xw &lt; 2001) {</div>
<div class="line"><span class="lineno"> 3097</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iw = (int) xw;</div>
<div class="line"><span class="lineno"> 3098</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dw = xw - iw;</div>
<div class="line"><span class="lineno"> 3099</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ew = 1 - dw;</div>
<div class="line"><span class="lineno"> 3100</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cw296 = ew * h2o296[iw - 1] + dw * h2o296[iw];</div>
<div class="line"><span class="lineno"> 3101</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cw260 = ew * h2o260[iw - 1] + dw * h2o260[iw];</div>
<div class="line"><span class="lineno"> 3102</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cwfrn = ew * h2ofrn[iw - 1] + dw * h2ofrn[iw];</div>
<div class="line"><span class="lineno"> 3103</span>    <span class="keywordflow">if</span> (nu &lt;= 820 || nu &gt;= 960) {</div>
<div class="line"><span class="lineno"> 3104</span>      sfac = 1;</div>
<div class="line"><span class="lineno"> 3105</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3106</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> xx = (nu - 820) / 10;</div>
<div class="line"><span class="lineno"> 3107</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> ix = (int) xx;</div>
<div class="line"><span class="lineno"> 3108</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> dx = xx - ix;</div>
<div class="line"><span class="lineno"> 3109</span>      sfac = (1 - dx) * xfcrev[ix] + dx * xfcrev[ix + 1];</div>
<div class="line"><span class="lineno"> 3110</span>    }</div>
<div class="line"><span class="lineno"> 3111</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ctwslf =</div>
<div class="line"><span class="lineno"> 3112</span>      sfac * cw296 * pow(cw260 / cw296, (296 - t) / (296 - 260));</div>
<div class="line"><span class="lineno"> 3113</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> vf2 = <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(nu - 370);</div>
<div class="line"><span class="lineno"> 3114</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> vf6 = <a class="code hl_define" href="jurassic_8h.html#ab051a5ece45339feb3f4b19a4dddbcb2">POW3</a>(vf2);</div>
<div class="line"><span class="lineno"> 3115</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> fscal = 36100 / (vf2 + vf6 * 1e-8 + 36100) * -.25 + 1;</div>
<div class="line"><span class="lineno"> 3116</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ctwfrn = cwfrn * fscal;</div>
<div class="line"><span class="lineno"> 3117</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> a1 = nu * u * tanh(.7193876 / t * nu);</div>
<div class="line"><span class="lineno"> 3118</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> a2 = 296 / t;</div>
<div class="line"><span class="lineno"> 3119</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> a3 = p / <a class="code hl_define" href="jurassic_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a> * (q * ctwslf + (1 - q) * ctwfrn) * 1e-20;</div>
<div class="line"><span class="lineno"> 3120</span>    <span class="keywordflow">return</span> a1 * a2 * a3;</div>
<div class="line"><span class="lineno"> 3121</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3122</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3123</span>}</div>
<div class="ttc" id="ajurassic_8h_html_ab051a5ece45339feb3f4b19a4dddbcb2"><div class="ttname"><a href="jurassic_8h.html#ab051a5ece45339feb3f4b19a4dddbcb2">POW3</a></div><div class="ttdeci">#define POW3(x)</div><div class="ttdoc">Compute the cube of a value.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00766">jurassic.h:766</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad788eb8a3a6df141d82f28adbd610668" name="ad788eb8a3a6df141d82f28adbd610668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad788eb8a3a6df141d82f28adbd610668">&#9670;&nbsp;</a></span>ctmn2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctmn2 </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute N collision-induced absorption coefficient. </p>
<p >Calculates the nitrogen (N) absorption coefficient due to collision-induced absorption (CIA) near the 4.3 m CO band using tabulated laboratory data for the absorption strength (B) and temperature exponent ().</p>
<p >The function linearly interpolates B and  as a function of wavenumber, then applies a temperature- and pressure-dependent scaling relation to compute the absorption coefficient.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Wavenumber [cm]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Pressure [hPa]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Temperature [K].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>N absorption coefficient [km].</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Valid for approximately 21202600 cm (4.04.7 m) where NN and NO CIA dominates. Returns zero outside the tabulated range.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid.">locate_reg</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a" title="Standard pressure [hPa].">P0</a>, <a class="el" href="jurassic_8h.html#acd864640121c7df2c19f61f7baa507e4" title="Nitrogen concentration.">N2</a></dd></dl>
<dl class="section user"><dt>Reference</dt><dd>Lafferty et al., J. Quant. Spectrosc. Radiat. Transf., 68, 473479 (2001)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03127">3127</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3130</span>                  {</div>
<div class="line"><span class="lineno"> 3131</span> </div>
<div class="line"><span class="lineno"> 3132</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> ba[98] =</div>
<div class="line"><span class="lineno"> 3133</span>    { 0., 4.45e-8, 5.22e-8, 6.46e-8, 7.75e-8, 9.03e-8,</div>
<div class="line"><span class="lineno"> 3134</span>    1.06e-7, 1.21e-7, 1.37e-7, 1.57e-7, 1.75e-7, 2.01e-7, 2.3e-7,</div>
<div class="line"><span class="lineno"> 3135</span>    2.59e-7, 2.95e-7, 3.26e-7, 3.66e-7, 4.05e-7, 4.47e-7, 4.92e-7,</div>
<div class="line"><span class="lineno"> 3136</span>    5.34e-7, 5.84e-7, 6.24e-7, 6.67e-7, 7.14e-7, 7.26e-7, 7.54e-7,</div>
<div class="line"><span class="lineno"> 3137</span>    7.84e-7, 8.09e-7, 8.42e-7, 8.62e-7, 8.87e-7, 9.11e-7, 9.36e-7,</div>
<div class="line"><span class="lineno"> 3138</span>    9.76e-7, 1.03e-6, 1.11e-6, 1.23e-6, 1.39e-6, 1.61e-6, 1.76e-6,</div>
<div class="line"><span class="lineno"> 3139</span>    1.94e-6, 1.97e-6, 1.87e-6, 1.75e-6, 1.56e-6, 1.42e-6, 1.35e-6,</div>
<div class="line"><span class="lineno"> 3140</span>    1.32e-6, 1.29e-6, 1.29e-6, 1.29e-6, 1.3e-6, 1.32e-6, 1.33e-6,</div>
<div class="line"><span class="lineno"> 3141</span>    1.34e-6, 1.35e-6, 1.33e-6, 1.31e-6, 1.29e-6, 1.24e-6, 1.2e-6,</div>
<div class="line"><span class="lineno"> 3142</span>    1.16e-6, 1.1e-6, 1.04e-6, 9.96e-7, 9.38e-7, 8.63e-7, 7.98e-7,</div>
<div class="line"><span class="lineno"> 3143</span>    7.26e-7, 6.55e-7, 5.94e-7, 5.35e-7, 4.74e-7, 4.24e-7, 3.77e-7,</div>
<div class="line"><span class="lineno"> 3144</span>    3.33e-7, 2.96e-7, 2.63e-7, 2.34e-7, 2.08e-7, 1.85e-7, 1.67e-7,</div>
<div class="line"><span class="lineno"> 3145</span>    1.47e-7, 1.32e-7, 1.2e-7, 1.09e-7, 9.85e-8, 9.08e-8, 8.18e-8,</div>
<div class="line"><span class="lineno"> 3146</span>    7.56e-8, 6.85e-8, 6.14e-8, 5.83e-8, 5.77e-8, 5e-8, 4.32e-8, 0.</div>
<div class="line"><span class="lineno"> 3147</span>  };</div>
<div class="line"><span class="lineno"> 3148</span> </div>
<div class="line"><span class="lineno"> 3149</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> betaa[98] =</div>
<div class="line"><span class="lineno"> 3150</span>    { 802., 802., 761., 722., 679., 646., 609., 562.,</div>
<div class="line"><span class="lineno"> 3151</span>    511., 472., 436., 406., 377., 355., 338., 319., 299., 278., 255.,</div>
<div class="line"><span class="lineno"> 3152</span>    233., 208., 184., 149., 107., 66., 25., -13., -49., -82., -104.,</div>
<div class="line"><span class="lineno"> 3153</span>    -119., -130., -139., -144., -146., -146., -147., -148., -150.,</div>
<div class="line"><span class="lineno"> 3154</span>    -153., -160., -169., -181., -189., -195., -200., -205., -209.,</div>
<div class="line"><span class="lineno"> 3155</span>    -211., -210., -210., -209., -205., -199., -190., -180., -168.,</div>
<div class="line"><span class="lineno"> 3156</span>    -157., -143., -126., -108., -89., -63., -32., 1., 35., 65., 95.,</div>
<div class="line"><span class="lineno"> 3157</span>    121., 141., 152., 161., 164., 164., 161., 155., 148., 143., 137.,</div>
<div class="line"><span class="lineno"> 3158</span>    133., 131., 133., 139., 150., 165., 187., 213., 248., 284., 321.,</div>
<div class="line"><span class="lineno"> 3159</span>    372., 449., 514., 569., 609., 642., 673., 673.</div>
<div class="line"><span class="lineno"> 3160</span>  };</div>
<div class="line"><span class="lineno"> 3161</span> </div>
<div class="line"><span class="lineno"> 3162</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> nua[98] =</div>
<div class="line"><span class="lineno"> 3163</span>    { 2120., 2125., 2130., 2135., 2140., 2145., 2150.,</div>
<div class="line"><span class="lineno"> 3164</span>    2155., 2160., 2165., 2170., 2175., 2180., 2185., 2190., 2195.,</div>
<div class="line"><span class="lineno"> 3165</span>    2200., 2205., 2210., 2215., 2220., 2225., 2230., 2235., 2240.,</div>
<div class="line"><span class="lineno"> 3166</span>    2245., 2250., 2255., 2260., 2265., 2270., 2275., 2280., 2285.,</div>
<div class="line"><span class="lineno"> 3167</span>    2290., 2295., 2300., 2305., 2310., 2315., 2320., 2325., 2330.,</div>
<div class="line"><span class="lineno"> 3168</span>    2335., 2340., 2345., 2350., 2355., 2360., 2365., 2370., 2375.,</div>
<div class="line"><span class="lineno"> 3169</span>    2380., 2385., 2390., 2395., 2400., 2405., 2410., 2415., 2420.,</div>
<div class="line"><span class="lineno"> 3170</span>    2425., 2430., 2435., 2440., 2445., 2450., 2455., 2460., 2465.,</div>
<div class="line"><span class="lineno"> 3171</span>    2470., 2475., 2480., 2485., 2490., 2495., 2500., 2505., 2510.,</div>
<div class="line"><span class="lineno"> 3172</span>    2515., 2520., 2525., 2530., 2535., 2540., 2545., 2550., 2555.,</div>
<div class="line"><span class="lineno"> 3173</span>    2560., 2565., 2570., 2575., 2580., 2585., 2590., 2595., 2600., 2605.</div>
<div class="line"><span class="lineno"> 3174</span>  };</div>
<div class="line"><span class="lineno"> 3175</span> </div>
<div class="line"><span class="lineno"> 3176</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = 273.0, tr = 296.0;</div>
<div class="line"><span class="lineno"> 3177</span> </div>
<div class="line"><span class="lineno"> 3178</span>  <span class="comment">/* Check wavenumber range... */</span></div>
<div class="line"><span class="lineno"> 3179</span>  <span class="keywordflow">if</span> (nu &lt; nua[0] || nu &gt; nua[97])</div>
<div class="line"><span class="lineno"> 3180</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3181</span> </div>
<div class="line"><span class="lineno"> 3182</span>  <span class="comment">/* Interpolate B and beta... */</span></div>
<div class="line"><span class="lineno"> 3183</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_function" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(nua, 98, nu);</div>
<div class="line"><span class="lineno"> 3184</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> b =</div>
<div class="line"><span class="lineno"> 3185</span>    1e6 * <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(nua[idx], ba[idx], nua[idx + 1], ba[idx + 1], nu);</div>
<div class="line"><span class="lineno"> 3186</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> beta =</div>
<div class="line"><span class="lineno"> 3187</span>    <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(nua[idx], betaa[idx], nua[idx + 1], betaa[idx + 1], nu);</div>
<div class="line"><span class="lineno"> 3188</span> </div>
<div class="line"><span class="lineno"> 3189</span>  <span class="comment">/* Compute absorption coefficient... */</span></div>
<div class="line"><span class="lineno"> 3190</span>  <span class="keywordflow">return</span> 0.1 * <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(p / <a class="code hl_define" href="jurassic_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a> * t0 / t) * exp(beta * (1 / tr - 1 / t))</div>
<div class="line"><span class="lineno"> 3191</span>    * <a class="code hl_define" href="jurassic_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a> * b * (<a class="code hl_define" href="jurassic_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a> + (1 - <a class="code hl_define" href="jurassic_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>) * (1.294 - 0.4545 * t / tr));</div>
<div class="line"><span class="lineno"> 3192</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_ad788eb8a3a6df141d82f28adbd610668_cgraph.png" border="0" usemap="#ajurassic_8h_ad788eb8a3a6df141d82f28adbd610668_cgraph" alt=""/></div>
<map name="ajurassic_8h_ad788eb8a3a6df141d82f28adbd610668_cgraph" id="ajurassic_8h_ad788eb8a3a6df141d82f28adbd610668_cgraph">
<area shape="rect" title="Compute N collision&#45;induced absorption coefficient." alt="" coords="5,5,64,32"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="112,5,195,32"/>
</map>
</div>

</div>
</div>
<a id="a2d55d073ef8855381487a486970152f5" name="a2d55d073ef8855381487a486970152f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d55d073ef8855381487a486970152f5">&#9670;&nbsp;</a></span>ctmo2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctmo2 </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute O collision-induced absorption coefficient. </p>
<p >Calculates the molecular oxygen (O) absorption coefficient due to collision-induced absorption (CIA) using tabulated laboratory data for the absorption strength (B) and temperature exponent ().</p>
<p >The function linearly interpolates B and  as a function of wavenumber and applies a pressure- and temperature-dependent scaling relation to compute the absorption coefficient.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Wavenumber [cm]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Pressure [hPa]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Temperature [K].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>O absorption coefficient [km].</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Valid for approximately 13601800 cm ( 7.45.5 m), corresponding to the O CIA band. Returns zero outside the tabulated range.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid.">locate_reg</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a" title="Standard pressure [hPa].">P0</a>, <a class="el" href="jurassic_8h.html#a31412dbd7c9b5771f1e7a5ff85d20ab9" title="Oxygen concentration.">O2</a></dd></dl>
<dl class="section user"><dt>References</dt><dd>Greenblatt et al., J. Quant. Spectrosc. Radiat. Transf., 33, 127140 (1985) Smith and Newnham, Appl. Opt., 39, 318326 (2000)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03196">3196</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3199</span>                  {</div>
<div class="line"><span class="lineno"> 3200</span> </div>
<div class="line"><span class="lineno"> 3201</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> ba[90] =</div>
<div class="line"><span class="lineno"> 3202</span>    { 0., .061, .074, .084, .096, .12, .162, .208, .246,</div>
<div class="line"><span class="lineno"> 3203</span>    .285, .314, .38, .444, .5, .571, .673, .768, .853, .966, 1.097,</div>
<div class="line"><span class="lineno"> 3204</span>    1.214, 1.333, 1.466, 1.591, 1.693, 1.796, 1.922, 2.037, 2.154,</div>
<div class="line"><span class="lineno"> 3205</span>    2.264, 2.375, 2.508, 2.671, 2.847, 3.066, 3.417, 3.828, 4.204,</div>
<div class="line"><span class="lineno"> 3206</span>    4.453, 4.599, 4.528, 4.284, 3.955, 3.678, 3.477, 3.346, 3.29,</div>
<div class="line"><span class="lineno"> 3207</span>    3.251, 3.231, 3.226, 3.212, 3.192, 3.108, 3.033, 2.911, 2.798,</div>
<div class="line"><span class="lineno"> 3208</span>    2.646, 2.508, 2.322, 2.13, 1.928, 1.757, 1.588, 1.417, 1.253,</div>
<div class="line"><span class="lineno"> 3209</span>    1.109, .99, .888, .791, .678, .587, .524, .464, .403, .357, .32,</div>
<div class="line"><span class="lineno"> 3210</span>    .29, .267, .242, .215, .182, .16, .146, .128, .103, .087, .081,</div>
<div class="line"><span class="lineno"> 3211</span>    .071, .064, 0.</div>
<div class="line"><span class="lineno"> 3212</span>  };</div>
<div class="line"><span class="lineno"> 3213</span> </div>
<div class="line"><span class="lineno"> 3214</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> betaa[90] =</div>
<div class="line"><span class="lineno"> 3215</span>    { 467., 467., 400., 315., 379., 368., 475., 521.,</div>
<div class="line"><span class="lineno"> 3216</span>    531., 512., 442., 444., 430., 381., 335., 324., 296., 248., 215.,</div>
<div class="line"><span class="lineno"> 3217</span>    193., 158., 127., 101., 71., 31., -6., -26., -47., -63., -79.,</div>
<div class="line"><span class="lineno"> 3218</span>    -88., -88., -87., -90., -98., -99., -109., -134., -160., -167.,</div>
<div class="line"><span class="lineno"> 3219</span>    -164., -158., -153., -151., -156., -166., -168., -173., -170.,</div>
<div class="line"><span class="lineno"> 3220</span>    -161., -145., -126., -108., -84., -59., -29., 4., 41., 73., 97.,</div>
<div class="line"><span class="lineno"> 3221</span>    123., 159., 198., 220., 242., 256., 281., 311., 334., 319., 313.,</div>
<div class="line"><span class="lineno"> 3222</span>    321., 323., 310., 315., 320., 335., 361., 378., 373., 338., 319.,</div>
<div class="line"><span class="lineno"> 3223</span>    346., 322., 291., 290., 350., 371., 504., 504.</div>
<div class="line"><span class="lineno"> 3224</span>  };</div>
<div class="line"><span class="lineno"> 3225</span> </div>
<div class="line"><span class="lineno"> 3226</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> nua[90] =</div>
<div class="line"><span class="lineno"> 3227</span>    { 1360., 1365., 1370., 1375., 1380., 1385., 1390.,</div>
<div class="line"><span class="lineno"> 3228</span>    1395., 1400., 1405., 1410., 1415., 1420., 1425., 1430., 1435.,</div>
<div class="line"><span class="lineno"> 3229</span>    1440., 1445., 1450., 1455., 1460., 1465., 1470., 1475., 1480.,</div>
<div class="line"><span class="lineno"> 3230</span>    1485., 1490., 1495., 1500., 1505., 1510., 1515., 1520., 1525.,</div>
<div class="line"><span class="lineno"> 3231</span>    1530., 1535., 1540., 1545., 1550., 1555., 1560., 1565., 1570.,</div>
<div class="line"><span class="lineno"> 3232</span>    1575., 1580., 1585., 1590., 1595., 1600., 1605., 1610., 1615.,</div>
<div class="line"><span class="lineno"> 3233</span>    1620., 1625., 1630., 1635., 1640., 1645., 1650., 1655., 1660.,</div>
<div class="line"><span class="lineno"> 3234</span>    1665., 1670., 1675., 1680., 1685., 1690., 1695., 1700., 1705.,</div>
<div class="line"><span class="lineno"> 3235</span>    1710., 1715., 1720., 1725., 1730., 1735., 1740., 1745., 1750.,</div>
<div class="line"><span class="lineno"> 3236</span>    1755., 1760., 1765., 1770., 1775., 1780., 1785., 1790., 1795.,</div>
<div class="line"><span class="lineno"> 3237</span>    1800., 1805.</div>
<div class="line"><span class="lineno"> 3238</span>  };</div>
<div class="line"><span class="lineno"> 3239</span> </div>
<div class="line"><span class="lineno"> 3240</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = 273, tr = 296;</div>
<div class="line"><span class="lineno"> 3241</span> </div>
<div class="line"><span class="lineno"> 3242</span>  <span class="comment">/* Check wavenumber range... */</span></div>
<div class="line"><span class="lineno"> 3243</span>  <span class="keywordflow">if</span> (nu &lt; nua[0] || nu &gt; nua[89])</div>
<div class="line"><span class="lineno"> 3244</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3245</span> </div>
<div class="line"><span class="lineno"> 3246</span>  <span class="comment">/* Interpolate B and beta... */</span></div>
<div class="line"><span class="lineno"> 3247</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_function" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(nua, 90, nu);</div>
<div class="line"><span class="lineno"> 3248</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> b = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(nua[idx], ba[idx], nua[idx + 1], ba[idx + 1], nu);</div>
<div class="line"><span class="lineno"> 3249</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> beta =</div>
<div class="line"><span class="lineno"> 3250</span>    <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(nua[idx], betaa[idx], nua[idx + 1], betaa[idx + 1], nu);</div>
<div class="line"><span class="lineno"> 3251</span> </div>
<div class="line"><span class="lineno"> 3252</span>  <span class="comment">/* Compute absorption coefficient... */</span></div>
<div class="line"><span class="lineno"> 3253</span>  <span class="keywordflow">return</span> 0.1 * <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(p / <a class="code hl_define" href="jurassic_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a> * t0 / t) * exp(beta * (1 / tr - 1 / t)) * <a class="code hl_define" href="jurassic_8h.html#a31412dbd7c9b5771f1e7a5ff85d20ab9">O2</a> * b;</div>
<div class="line"><span class="lineno"> 3254</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a2d55d073ef8855381487a486970152f5_cgraph.png" border="0" usemap="#ajurassic_8h_a2d55d073ef8855381487a486970152f5_cgraph" alt=""/></div>
<map name="ajurassic_8h_a2d55d073ef8855381487a486970152f5_cgraph" id="ajurassic_8h_a2d55d073ef8855381487a486970152f5_cgraph">
<area shape="rect" title="Compute O collision&#45;induced absorption coefficient." alt="" coords="5,5,64,32"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="112,5,195,32"/>
</map>
</div>

</div>
</div>
<a id="ad4d49729d85da58030daa13689c5edd1" name="ad4d49729d85da58030daa13689c5edd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4d49729d85da58030daa13689c5edd1">&#9670;&nbsp;</a></span>copy_atm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copy_atm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm_dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy or initialize atmospheric profile data. </p>
<p >Copies all fields from one atmospheric structure (<code>atm_src</code>) to another (<code>atm_dest</code>), including geolocation, thermodynamic, gas, extinction, cloud, and surface parameters. If <code>init</code> is nonzero, the destination fields are instead initialized to default values (zeros for most fields, unity for surface emissivity).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining array dimensions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">atm_dest</td><td>Destination atmospheric structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm_src</td><td>Source atmospheric structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">init</td><td>Initialization flag:<ul>
<li>0  copy data from <code>atm_src</code> </li>
<li>1  initialize <code>atm_dest</code> to default values</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The number of vertical levels (<code>atm_src-&gt;np</code>) determines the amount of data copied. The function performs shallow copies using <code>memcpy</code> for efficiency.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03258">3258</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3262</span>                  {</div>
<div class="line"><span class="lineno"> 3263</span> </div>
<div class="line"><span class="lineno"> 3264</span>  <span class="comment">/* Data size... */</span></div>
<div class="line"><span class="lineno"> 3265</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> s = (size_t) atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div>
<div class="line"><span class="lineno"> 3266</span> </div>
<div class="line"><span class="lineno"> 3267</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno"> 3268</span>  atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> = atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>;</div>
<div class="line"><span class="lineno"> 3269</span>  memcpy(atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, s);</div>
<div class="line"><span class="lineno"> 3270</span>  memcpy(atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, s);</div>
<div class="line"><span class="lineno"> 3271</span>  memcpy(atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, s);</div>
<div class="line"><span class="lineno"> 3272</span>  memcpy(atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, s);</div>
<div class="line"><span class="lineno"> 3273</span>  memcpy(atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, s);</div>
<div class="line"><span class="lineno"> 3274</span>  memcpy(atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>, atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>, s);</div>
<div class="line"><span class="lineno"> 3275</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 3276</span>    memcpy(atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig], atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig], s);</div>
<div class="line"><span class="lineno"> 3277</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 3278</span>    memcpy(atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw], atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw], s);</div>
<div class="line"><span class="lineno"> 3279</span>  atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a> = atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>;</div>
<div class="line"><span class="lineno"> 3280</span>  atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a> = atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>;</div>
<div class="line"><span class="lineno"> 3281</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 3282</span>    atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl] = atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl];</div>
<div class="line"><span class="lineno"> 3283</span>  atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a> = atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>;</div>
<div class="line"><span class="lineno"> 3284</span>  for (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 3285</span>    atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf] = atm_src-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf];</div>
<div class="line"><span class="lineno"> 3286</span> </div>
<div class="line"><span class="lineno"> 3287</span>  <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 3288</span>  if (init)</div>
<div class="line"><span class="lineno"> 3289</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 3290</span>      atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = 0;</div>
<div class="line"><span class="lineno"> 3291</span>      atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip] = 0;</div>
<div class="line"><span class="lineno"> 3292</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 3293</span>        atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip] = 0;</div>
<div class="line"><span class="lineno"> 3294</span>      for (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 3295</span>        atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip] = 0;</div>
<div class="line"><span class="lineno"> 3296</span>      atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a> = 0;</div>
<div class="line"><span class="lineno"> 3297</span>      atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a> = 0;</div>
<div class="line"><span class="lineno"> 3298</span>      for (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 3299</span>        atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl] = 0;</div>
<div class="line"><span class="lineno"> 3300</span>      atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a> = 0;</div>
<div class="line"><span class="lineno"> 3301</span>      for (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 3302</span>        atm_dest-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf] = 1;</div>
<div class="line"><span class="lineno"> 3303</span>    }</div>
<div class="line"><span class="lineno"> 3304</span>}</div>
<div class="ttc" id="astructatm__t_html_a25ef7d304d5cfa54c5af30192620373b"><div class="ttname"><a href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">atm_t::lat</a></div><div class="ttdeci">double lat[NP]</div><div class="ttdoc">Latitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01013">jurassic.h:1013</a></div></div>
<div class="ttc" id="astructatm__t_html_a2c8ffb598109120ed6d1f8e79aeb3ff8"><div class="ttname"><a href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">atm_t::lon</a></div><div class="ttdeci">double lon[NP]</div><div class="ttdoc">Longitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01010">jurassic.h:1010</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa855e52716bd4b479bb0d2446b300a4e" name="aa855e52716bd4b479bb0d2446b300a4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa855e52716bd4b479bb0d2446b300a4e">&#9670;&nbsp;</a></span>copy_obs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copy_obs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs_dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy or initialize observation geometry and radiance data. </p>
<p >Copies all observation fields from a source structure (<code>obs_src</code>) to a destination structure (<code>obs_dest</code>), including observer, view, and tangent point geometry, as well as radiance and transmittance data. If <code>init</code> is nonzero, radiance and transmittance values are reset to zero wherever finite values are found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining the number of channels (<a class="el" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">ctl_t::nd</a>) and other dimensions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">obs_dest</td><td>Destination observation structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs_src</td><td>Source observation structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">init</td><td>Initialization flag:<ul>
<li>0  copy data from <code>obs_src</code> <br  />
</li>
<li>1  initialize <code>obs_dest</code> (set <code>rad</code> and <code>tau</code> to zero)</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The number of ray paths (<code>obs_src-&gt;nr</code>) defines the copied data size. Shallow copies are performed via <code>memcpy</code> for efficiency.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03308">3308</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3312</span>                  {</div>
<div class="line"><span class="lineno"> 3313</span> </div>
<div class="line"><span class="lineno"> 3314</span>  <span class="comment">/* Data size... */</span></div>
<div class="line"><span class="lineno"> 3315</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> s = (size_t) obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div>
<div class="line"><span class="lineno"> 3316</span> </div>
<div class="line"><span class="lineno"> 3317</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno"> 3318</span>  obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a> = obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>;</div>
<div class="line"><span class="lineno"> 3319</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>, s);</div>
<div class="line"><span class="lineno"> 3320</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>, s);</div>
<div class="line"><span class="lineno"> 3321</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>, s);</div>
<div class="line"><span class="lineno"> 3322</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>, s);</div>
<div class="line"><span class="lineno"> 3323</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>, s);</div>
<div class="line"><span class="lineno"> 3324</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>, s);</div>
<div class="line"><span class="lineno"> 3325</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>, s);</div>
<div class="line"><span class="lineno"> 3326</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>, s);</div>
<div class="line"><span class="lineno"> 3327</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>, s);</div>
<div class="line"><span class="lineno"> 3328</span>  memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>, obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>, s);</div>
<div class="line"><span class="lineno"> 3329</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3330</span>    memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>], obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>], s);</div>
<div class="line"><span class="lineno"> 3331</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3332</span>    memcpy(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[<span class="keywordtype">id</span>], obs_src-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[<span class="keywordtype">id</span>], s);</div>
<div class="line"><span class="lineno"> 3333</span> </div>
<div class="line"><span class="lineno"> 3334</span>  <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 3335</span>  <span class="keywordflow">if</span> (init)</div>
<div class="line"><span class="lineno"> 3336</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3337</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 3338</span>        <span class="keywordflow">if</span> (isfinite(obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir])) {</div>
<div class="line"><span class="lineno"> 3339</span>          obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[id][ir] = 0;</div>
<div class="line"><span class="lineno"> 3340</span>          obs_dest-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[id][ir] = 0;</div>
<div class="line"><span class="lineno"> 3341</span>        }</div>
<div class="line"><span class="lineno"> 3342</span>}</div>
<div class="ttc" id="astructctl__t_html_a8f5acb554ff044a1c3212c40fff9eec1"><div class="ttname"><a href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">ctl_t::nd</a></div><div class="ttdeci">int nd</div><div class="ttdoc">Number of radiance channels.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01072">jurassic.h:1072</a></div></div>
<div class="ttc" id="astructobs__t_html_a0f8aac57859ceccb50b258d487e74670"><div class="ttname"><a href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">obs_t::tau</a></div><div class="ttdeci">double tau[ND][NR]</div><div class="ttdoc">Transmittance of ray path.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01313">jurassic.h:1313</a></div></div>
<div class="ttc" id="astructobs__t_html_a3703f37920744c9d01cbc5c65b1dc7c3"><div class="ttname"><a href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">obs_t::rad</a></div><div class="ttdeci">double rad[ND][NR]</div><div class="ttdoc">Radiance [W/(m^2 sr cm^-1)].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01316">jurassic.h:1316</a></div></div>
<div class="ttc" id="astructobs__t_html_a4edcf8144a1c2babeae0f0c60b3ccb9e"><div class="ttname"><a href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">obs_t::tplon</a></div><div class="ttdeci">double tplon[NR]</div><div class="ttdoc">Tangent point longitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01307">jurassic.h:1307</a></div></div>
<div class="ttc" id="astructobs__t_html_a5ad297ef892545d93168c57ed26f74b5"><div class="ttname"><a href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">obs_t::vpz</a></div><div class="ttdeci">double vpz[NR]</div><div class="ttdoc">View point altitude [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01295">jurassic.h:1295</a></div></div>
<div class="ttc" id="astructobs__t_html_a62d326c0aa12f2f9208c6a5576e599da"><div class="ttname"><a href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">obs_t::vplat</a></div><div class="ttdeci">double vplat[NR]</div><div class="ttdoc">View point latitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01301">jurassic.h:1301</a></div></div>
<div class="ttc" id="astructobs__t_html_a6623d4c4c139db8c86195751653ea716"><div class="ttname"><a href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obs_t::obslon</a></div><div class="ttdeci">double obslon[NR]</div><div class="ttdoc">Observer longitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01289">jurassic.h:1289</a></div></div>
<div class="ttc" id="astructobs__t_html_a8b9f2ae531c4d8693c7ce86f0387d290"><div class="ttname"><a href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obs_t::obslat</a></div><div class="ttdeci">double obslat[NR]</div><div class="ttdoc">Observer latitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01292">jurassic.h:1292</a></div></div>
<div class="ttc" id="astructobs__t_html_a992d21aae832400874f3f6bc3e7d1981"><div class="ttname"><a href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obs_t::obsz</a></div><div class="ttdeci">double obsz[NR]</div><div class="ttdoc">Observer altitude [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01286">jurassic.h:1286</a></div></div>
<div class="ttc" id="astructobs__t_html_ab6667e8396fbfe507ebc81545d390c66"><div class="ttname"><a href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">obs_t::tplat</a></div><div class="ttdeci">double tplat[NR]</div><div class="ttdoc">Tangent point latitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01310">jurassic.h:1310</a></div></div>
<div class="ttc" id="astructobs__t_html_aba164760718f1c258c150ebbc93a39a9"><div class="ttname"><a href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">obs_t::vplon</a></div><div class="ttdeci">double vplon[NR]</div><div class="ttdoc">View point longitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01298">jurassic.h:1298</a></div></div>
<div class="ttc" id="astructobs__t_html_ad86987afb2b3307399b50383f4dbdc40"><div class="ttname"><a href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">obs_t::time</a></div><div class="ttdeci">double time[NR]</div><div class="ttdoc">Time (seconds since 2000-01-01T00:00Z).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01283">jurassic.h:1283</a></div></div>
<div class="ttc" id="astructobs__t_html_ae058b1684cd96b157b1796a5b9be6c38"><div class="ttname"><a href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">obs_t::tpz</a></div><div class="ttdeci">double tpz[NR]</div><div class="ttdoc">Tangent point altitude [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01304">jurassic.h:1304</a></div></div>
<div class="ttc" id="astructobs__t_html_aebd5d0d6c2d1dba7a769c4d506570fa0"><div class="ttname"><a href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">obs_t::nr</a></div><div class="ttdeci">int nr</div><div class="ttdoc">Number of ray paths.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01280">jurassic.h:1280</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a556279802ef57635f9e81a062d8b6ce1" name="a556279802ef57635f9e81a062d8b6ce1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a556279802ef57635f9e81a062d8b6ce1">&#9670;&nbsp;</a></span>day2doy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void day2doy </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>doy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a calendar date to day-of-year. </p>
<p >This function computes the day-of-year (1365 or 1366 for leap years) corresponding to a given Gregorian date specified by year, month, and day.</p>
<p >Leap years are determined using the standard Gregorian rules:</p><ul>
<li>Every year divisible by 4 is a leap year,</li>
<li>except years divisible by 100, unless also divisible by 400.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">year</td><td>The full year (e.g., 2025). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mon</td><td>The month of the year (112). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">day</td><td>The day of the month (131). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">doy</td><td>Pointer to an integer where the resulting day-of-year will be stored (1365 or 1366).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The caller must ensure that the input date is valid.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03346">3346</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3350</span>            {</div>
<div class="line"><span class="lineno"> 3351</span> </div>
<div class="line"><span class="lineno"> 3352</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> d0[12] =</div>
<div class="line"><span class="lineno"> 3353</span>    { 1, 32, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335 };</div>
<div class="line"><span class="lineno"> 3354</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> d0l[12] =</div>
<div class="line"><span class="lineno"> 3355</span>    { 1, 32, 61, 92, 122, 153, 183, 214, 245, 275, 306, 336 };</div>
<div class="line"><span class="lineno"> 3356</span> </div>
<div class="line"><span class="lineno"> 3357</span>  <span class="comment">/* Get day of year... */</span></div>
<div class="line"><span class="lineno"> 3358</span>  <span class="keywordflow">if</span> (year % 400 == 0 || (year % 100 != 0 &amp;&amp; year % 4 == 0))</div>
<div class="line"><span class="lineno"> 3359</span>    *doy = d0l[mon - 1] + day - 1;</div>
<div class="line"><span class="lineno"> 3360</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3361</span>    *doy = d0[mon - 1] + day - 1;</div>
<div class="line"><span class="lineno"> 3362</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2b4738ae5b57d80da7a4c779c493f1a" name="ab2b4738ae5b57d80da7a4c779c493f1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2b4738ae5b57d80da7a4c779c493f1a">&#9670;&nbsp;</a></span>doy2day()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void doy2day </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>doy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>mon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>day</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a day-of-year value to a calendar date. </p>
<p >This function computes the month and day corresponding to a given day-of-year (1365 or 1366 for leap years) in the Gregorian calendar.</p>
<p >Leap years are determined using the standard Gregorian rules:</p><ul>
<li>Every year divisible by 4 is a leap year,</li>
<li>except years divisible by 100, unless also divisible by 400.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">year</td><td>The full year (e.g., 2025). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">doy</td><td>The day-of-year (1365 or 1366). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mon</td><td>Pointer to an integer where the calculated month (112) will be stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">day</td><td>Pointer to an integer where the calculated day-of-month will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The caller must ensure that <code>doy</code> is within the valid range for the specified year.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03366">3366</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3370</span>            {</div>
<div class="line"><span class="lineno"> 3371</span> </div>
<div class="line"><span class="lineno"> 3372</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> d0[12] =</div>
<div class="line"><span class="lineno"> 3373</span>    { 1, 32, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335 };</div>
<div class="line"><span class="lineno"> 3374</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> d0l[12] =</div>
<div class="line"><span class="lineno"> 3375</span>    { 1, 32, 61, 92, 122, 153, 183, 214, 245, 275, 306, 336 };</div>
<div class="line"><span class="lineno"> 3376</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 3377</span> </div>
<div class="line"><span class="lineno"> 3378</span>  <span class="comment">/* Get month and day... */</span></div>
<div class="line"><span class="lineno"> 3379</span>  <span class="keywordflow">if</span> (year % 400 == 0 || (year % 100 != 0 &amp;&amp; year % 4 == 0)) {</div>
<div class="line"><span class="lineno"> 3380</span>    <span class="keywordflow">for</span> (i = 11; i &gt;= 0; i--)</div>
<div class="line"><span class="lineno"> 3381</span>      <span class="keywordflow">if</span> (d0l[i] &lt;= doy)</div>
<div class="line"><span class="lineno"> 3382</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3383</span>    *mon = i + 1;</div>
<div class="line"><span class="lineno"> 3384</span>    *day = doy - d0l[i] + 1;</div>
<div class="line"><span class="lineno"> 3385</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3386</span>    <span class="keywordflow">for</span> (i = 11; i &gt;= 0; i--)</div>
<div class="line"><span class="lineno"> 3387</span>      <span class="keywordflow">if</span> (d0[i] &lt;= doy)</div>
<div class="line"><span class="lineno"> 3388</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3389</span>    *mon = i + 1;</div>
<div class="line"><span class="lineno"> 3390</span>    *day = doy - d0[i] + 1;</div>
<div class="line"><span class="lineno"> 3391</span>  }</div>
<div class="line"><span class="lineno"> 3392</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a832e63c37527025311d1886a60dff605" name="a832e63c37527025311d1886a60dff605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a832e63c37527025311d1886a60dff605">&#9670;&nbsp;</a></span>find_emitter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int find_emitter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>emitter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find gas species index by name. </p>
<p >Searches the list of emitter (gas) names defined in the control structure for a case-insensitive match to the given string. Returns the corresponding gas index if found, or -1 otherwise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure containing the list of gas emitters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">emitter</td><td>Name of the gas species to search for (e.g. "H2O", "CO2").</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index of the matching emitter (0  index &lt; ctl-&gt;ng), or -1 if no match is found.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Comparison is case-insensitive using <code>strcasecmp()</code>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03396">3396</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3398</span>                       {</div>
<div class="line"><span class="lineno"> 3399</span> </div>
<div class="line"><span class="lineno"> 3400</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 3401</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], emitter) == 0)</div>
<div class="line"><span class="lineno"> 3402</span>      <span class="keywordflow">return</span> ig;</div>
<div class="line"><span class="lineno"> 3403</span> </div>
<div class="line"><span class="lineno"> 3404</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 3405</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abe93da56294b380e322c18ca2838fd51" name="abe93da56294b380e322c18ca2838fd51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe93da56294b380e322c18ca2838fd51">&#9670;&nbsp;</a></span>formod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void formod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the selected forward model. </p>
<p >Computes synthetic radiances or brightness temperatures for the given atmospheric state and observation geometry using the selected forward-model method (CGA, EGA, or RFM). The function also applies hydrostatic adjustment, field-of-view convolution, and optional brightness-temperature conversion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining model settings and options. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbl</td><td>Emissivity and source-function lookup tables. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atm</td><td>Atmospheric profile; may be adjusted for hydrostatic balance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obs</td><td>Observation geometry and radiance data; populated with model output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The model type is selected via ctl_t::formod:<ul>
<li>0 or 1  pencil-beam models (<a class="el" href="jurassic_8h.html#a9727c4e0e5bc85384762b6ad81a8c3be">formod_pencil</a>) <br  />
</li>
<li>2  RFM line-by-line model (<a class="el" href="jurassic_8h.html#a2caf20484e8e2f52ff3650321b7c704c">formod_rfm</a>)</li>
</ul>
</dd>
<dd>
The function preserves <code>obs-&gt;rad</code> elements marked as invalid (NaN) by applying an internal observation mask.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a>, <a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a>, <a class="el" href="jurassic_8h.html#a9727c4e0e5bc85384762b6ad81a8c3be" title="Compute line-of-sight radiances using the pencil-beam forward model.">formod_pencil</a>, <a class="el" href="jurassic_8h.html#a2caf20484e8e2f52ff3650321b7c704c" title="Interface routine for the Reference Forward Model (RFM).">formod_rfm</a>, <a class="el" href="jurassic_8h.html#ab0c3109373d1d5edcf57840c288f6f53" title="Apply field-of-view (FOV) convolution to modeled radiances.">formod_fov</a>, <a class="el" href="jurassic_8h.html#ad69ab6edb8f722212fb01e12d8809643" title="Adjust pressure profile using the hydrostatic equation.">hydrostatic</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03409">3409</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3413</span>              {</div>
<div class="line"><span class="lineno"> 3414</span> </div>
<div class="line"><span class="lineno"> 3415</span>  <span class="keywordtype">int</span> *mask;</div>
<div class="line"><span class="lineno"> 3416</span> </div>
<div class="line"><span class="lineno"> 3417</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 3418</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(mask, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 3419</span>        <a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a> * <a class="code hl_define" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>);</div>
<div class="line"><span class="lineno"> 3420</span> </div>
<div class="line"><span class="lineno"> 3421</span>  <span class="comment">/* Save observation mask... */</span></div>
<div class="line"><span class="lineno"> 3422</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3423</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 3424</span>      mask[<span class="keywordtype">id</span> * <a class="code hl_define" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a> + ir] = !isfinite(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir]);</div>
<div class="line"><span class="lineno"> 3425</span> </div>
<div class="line"><span class="lineno"> 3426</span>  <span class="comment">/* Hydrostatic equilibrium... */</span></div>
<div class="line"><span class="lineno"> 3427</span>  <a class="code hl_function" href="jurassic_8c.html#ad69ab6edb8f722212fb01e12d8809643">hydrostatic</a>(ctl, atm);</div>
<div class="line"><span class="lineno"> 3428</span> </div>
<div class="line"><span class="lineno"> 3429</span>  <span class="comment">/* CGA or EGA forward model... */</span></div>
<div class="line"><span class="lineno"> 3430</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a76702f4f08a76f29e138d97c7d2b1833">formod</a> == 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a76702f4f08a76f29e138d97c7d2b1833">formod</a> == 1)</div>
<div class="line"><span class="lineno"> 3431</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 3432</span>      <a class="code hl_function" href="jurassic_8c.html#a9727c4e0e5bc85384762b6ad81a8c3be">formod_pencil</a>(ctl, tbl, atm, obs, ir);</div>
<div class="line"><span class="lineno"> 3433</span> </div>
<div class="line"><span class="lineno"> 3434</span>  <span class="comment">/* Call RFM... */</span></div>
<div class="line"><span class="lineno"> 3435</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a76702f4f08a76f29e138d97c7d2b1833">formod</a> == 2)</div>
<div class="line"><span class="lineno"> 3436</span>    <a class="code hl_function" href="jurassic_8c.html#a2caf20484e8e2f52ff3650321b7c704c">formod_rfm</a>(ctl, atm, obs);</div>
<div class="line"><span class="lineno"> 3437</span> </div>
<div class="line"><span class="lineno"> 3438</span>  <span class="comment">/* Apply field-of-view convolution... */</span></div>
<div class="line"><span class="lineno"> 3439</span>  <a class="code hl_function" href="jurassic_8c.html#ab0c3109373d1d5edcf57840c288f6f53">formod_fov</a>(ctl, obs);</div>
<div class="line"><span class="lineno"> 3440</span> </div>
<div class="line"><span class="lineno"> 3441</span>  <span class="comment">/* Convert radiance to brightness temperature... */</span></div>
<div class="line"><span class="lineno"> 3442</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af700a5fe670e013c550494cee733b60c">write_bbt</a>)</div>
<div class="line"><span class="lineno"> 3443</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3444</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 3445</span>        obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir] = <a class="code hl_define" href="jurassic_8h.html#a064f8ccf1a30f33e2fd095884558364d">BRIGHT</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 3446</span> </div>
<div class="line"><span class="lineno"> 3447</span>  <span class="comment">/* Apply observation mask... */</span></div>
<div class="line"><span class="lineno"> 3448</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3449</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 3450</span>      <span class="keywordflow">if</span> (mask[<span class="keywordtype">id</span> * <a class="code hl_define" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a> + ir])</div>
<div class="line"><span class="lineno"> 3451</span>        obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[id][ir] = NAN;</div>
<div class="line"><span class="lineno"> 3452</span> </div>
<div class="line"><span class="lineno"> 3453</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 3454</span>  free(mask);</div>
<div class="line"><span class="lineno"> 3455</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a2caf20484e8e2f52ff3650321b7c704c"><div class="ttname"><a href="jurassic_8c.html#a2caf20484e8e2f52ff3650321b7c704c">formod_rfm</a></div><div class="ttdeci">void formod_rfm(const ctl_t *ctl, const atm_t *atm, obs_t *obs)</div><div class="ttdoc">Interface routine for the Reference Forward Model (RFM).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03695">jurassic.c:3695</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a9727c4e0e5bc85384762b6ad81a8c3be"><div class="ttname"><a href="jurassic_8c.html#a9727c4e0e5bc85384762b6ad81a8c3be">formod_pencil</a></div><div class="ttdeci">void formod_pencil(const ctl_t *ctl, const tbl_t *tbl, const atm_t *atm, obs_t *obs, const int ir)</div><div class="ttdoc">Compute line-of-sight radiances using the pencil-beam forward model.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03560">jurassic.c:3560</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ab0c3109373d1d5edcf57840c288f6f53"><div class="ttname"><a href="jurassic_8c.html#ab0c3109373d1d5edcf57840c288f6f53">formod_fov</a></div><div class="ttdeci">void formod_fov(const ctl_t *ctl, obs_t *obs)</div><div class="ttdoc">Apply field-of-view (FOV) convolution to modeled radiances.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03495">jurassic.c:3495</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ad69ab6edb8f722212fb01e12d8809643"><div class="ttname"><a href="jurassic_8c.html#ad69ab6edb8f722212fb01e12d8809643">hydrostatic</a></div><div class="ttdeci">void hydrostatic(const ctl_t *ctl, atm_t *atm)</div><div class="ttdoc">Adjust pressure profile using the hydrostatic equation.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03873">jurassic.c:3873</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a064f8ccf1a30f33e2fd095884558364d"><div class="ttname"><a href="jurassic_8h.html#a064f8ccf1a30f33e2fd095884558364d">BRIGHT</a></div><div class="ttdeci">#define BRIGHT(rad, nu)</div><div class="ttdoc">Compute brightness temperature from radiance.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00412">jurassic.h:412</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a68d169e5b90cf721678bc7ab0f964a99"><div class="ttname"><a href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a></div><div class="ttdeci">#define ND</div><div class="ttdoc">Maximum number of radiance channels.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00237">jurassic.h:237</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a9aee3e5daf3b1051597d21ab093adbd0"><div class="ttname"><a href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a></div><div class="ttdeci">#define ALLOC(ptr, type, n)</div><div class="ttdoc">Allocate memory for an array.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00382">jurassic.h:382</a></div></div>
<div class="ttc" id="ajurassic_8h_html_af146485306ae74a2edf18636300fd107"><div class="ttname"><a href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a></div><div class="ttdeci">#define NR</div><div class="ttdoc">Maximum number of ray paths.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00252">jurassic.h:252</a></div></div>
<div class="ttc" id="astructctl__t_html_a16a7e8119bff09ce8de3ee89d6ca0044"><div class="ttname"><a href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">ctl_t::nu</a></div><div class="ttdeci">double nu[ND]</div><div class="ttdoc">Centroid wavenumber of each channel [cm^-1].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01075">jurassic.h:1075</a></div></div>
<div class="ttc" id="astructctl__t_html_a76702f4f08a76f29e138d97c7d2b1833"><div class="ttname"><a href="structctl__t.html#a76702f4f08a76f29e138d97c7d2b1833">ctl_t::formod</a></div><div class="ttdeci">int formod</div><div class="ttdoc">Forward model (0=CGA, 1=EGA, 2=RFM).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01195">jurassic.h:1195</a></div></div>
<div class="ttc" id="astructctl__t_html_af700a5fe670e013c550494cee733b60c"><div class="ttname"><a href="structctl__t.html#af700a5fe670e013c550494cee733b60c">ctl_t::write_bbt</a></div><div class="ttdeci">int write_bbt</div><div class="ttdoc">Use brightness temperature instead of radiance (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01189">jurassic.h:1189</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_abe93da56294b380e322c18ca2838fd51_cgraph.png" border="0" usemap="#ajurassic_8h_abe93da56294b380e322c18ca2838fd51_cgraph" alt=""/></div>
<map name="ajurassic_8h_abe93da56294b380e322c18ca2838fd51_cgraph" id="ajurassic_8h_abe93da56294b380e322c18ca2838fd51_cgraph">
<area shape="rect" title="Execute the selected forward model." alt="" coords="5,514,68,540"/>
<area shape="rect" href="jurassic_8c.html#ab0c3109373d1d5edcf57840c288f6f53" title="Apply field&#45;of&#45;view (FOV) convolution to modeled radiances." alt="" coords="124,336,211,363"/>
<area shape="rect" href="jurassic_8c.html#a9727c4e0e5bc85384762b6ad81a8c3be" title="Compute line&#45;of&#45;sight radiances using the pencil&#45;beam forward model." alt="" coords="116,387,219,414"/>
<area shape="rect" href="jurassic_8c.html#a2caf20484e8e2f52ff3650321b7c704c" title="Interface routine for the Reference Forward Model (RFM)." alt="" coords="123,640,211,667"/>
<area shape="rect" href="jurassic_8c.html#ad69ab6edb8f722212fb01e12d8809643" title="Adjust pressure profile using the hydrostatic equation." alt="" coords="125,691,210,718"/>
<area shape="rect" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e" title="Copy or initialize observation geometry and radiance data." alt="" coords="287,58,365,84"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="603,362,678,388"/>
<area shape="rect" href="jurassic_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="291,387,361,414"/>
<area shape="rect" href="jurassic_8c.html#a363f5205cd58d7a22133f704f1137181" title="Compute total extinction including gaseous continua." alt="" coords="267,159,385,186"/>
<area shape="rect" href="jurassic_8c.html#ac7826de16feb2eb6730b661bf8deba90" title="Interpolate the source function (Planck radiance) at a given temperature." alt="" coords="270,108,382,135"/>
<area shape="rect" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="605,666,677,692"/>
<area shape="rect" href="jurassic_8c.html#a5e22cd63c35ef6e2c9b9023e2c3945d8" title="Interpolate emissivities and transmittances using the CurtisGodson approximation (CGA)." alt="" coords="436,235,539,262"/>
<area shape="rect" href="jurassic_8c.html#a2b67aa3affea0dd3c6da502dab26d22d" title="Interpolate emissivities and transmittances using the Emissivity Growth Approximation (EGA)." alt="" coords="436,286,539,312"/>
<area shape="rect" href="jurassic_8c.html#a44e1e4b6ab44e79d049f99a04e79df9f" title="Perform line&#45;of&#45;sight (LOS) ray tracing through the atmosphere." alt="" coords="292,488,360,515"/>
<area shape="rect" href="jurassic_8c.html#a9a962bab37658297e87de9631c67707b" title="Compute carbon dioxide continuum (optical depth)." alt="" coords="455,134,520,160"/>
<area shape="rect" href="jurassic_8c.html#a5b99f6f4581181857d4b89b27e8c2f87" title="Compute water vapor continuum (optical depth)." alt="" coords="455,184,520,211"/>
<area shape="rect" href="jurassic_8c.html#ad788eb8a3a6df141d82f28adbd610668" title="Compute N collision&#45;induced absorption coefficient." alt="" coords="458,83,517,110"/>
<area shape="rect" href="jurassic_8c.html#a2d55d073ef8855381487a486970152f5" title="Compute O collision&#45;induced absorption coefficient." alt="" coords="458,32,517,59"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="599,83,682,110"/>
<area shape="rect" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a" title="Interpolate emissivity from lookup tables as a function of column density." alt="" coords="589,235,692,262"/>
<area shape="rect" href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids." alt="" coords="740,260,819,287"/>
<area shape="rect" href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138" title="Interpolate column density from lookup tables as a function of emissivity." alt="" coords="597,286,685,312"/>
<area shape="rect" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="Converts Cartesian coordinates to geographic coordinates." alt="" coords="605,539,677,566"/>
<area shape="rect" href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612" title="Interpolate atmospheric state variables at a given altitude." alt="" coords="446,387,529,414"/>
<area shape="rect" href="jurassic_8c.html#a9020f32787ea7be08486d537a4f5c0fc" title="Determine the tangent point along a line of sight (LOS)." alt="" coords="437,590,537,616"/>
<area shape="rect" href="jurassic_8c.html#a134dbd60b73c18eda7032e58284dbade" title="Read and spectrally convolve an RFM output spectrum." alt="" coords="275,640,377,667"/>
<area shape="rect" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two&#45;column shape function from an ASCII file." alt="" coords="281,742,371,768"/>
<area shape="rect" href="jurassic_8c.html#a675d14cbd1ae26f72e86f828d8367240" title="Write atmospheric profile in RFM&#45;compatible format." alt="" coords="273,691,379,718"/>
<area shape="rect" href="jurassic_8c.html#a19d63e07e3eb8166cbf65ce079e4d156" title="Read a Reference Forward Model (RFM) ASCII spectrum." alt="" coords="433,742,541,768"/>
</map>
</div>

</div>
</div>
<a id="a363f5205cd58d7a22133f704f1137181" name="a363f5205cd58d7a22133f704f1137181"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a363f5205cd58d7a22133f704f1137181">&#9670;&nbsp;</a></span>formod_continua()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void formod_continua </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structlos__t.html">los_t</a> *&#160;</td>
          <td class="paramname"><em>los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute total extinction including gaseous continua. </p>
<p >Calculates the total extinction coefficient for a given line-of-sight point by summing spectrally dependent extinction and optional gaseous continuum contributions (CO, HO, N, O).</p>
<p >The function updates the extinction array <code>beta</code> for each spectral channel based on line-by-line extinction and enabled continua flags specified in <code>ctl</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining model setup and continuum options. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">los</td><td>Line-of-sight data containing pressure, temperature, gas concentrations, and extinction coefficients. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Index of the line-of-sight point to process. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">beta</td><td>Array of total extinction coefficients [km] per channel.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Each continuum component is added only if its corresponding control flag (e.g., <a class="el" href="structctl__t.html#a417bdd14462698d3ced23bc954fa48a0">ctl_t::ctm_co2</a>, <a class="el" href="structctl__t.html#a73f4f8e915d10ba9048b798580f7dddb">ctl_t::ctm_h2o</a>) is enabled and the gas index is valid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structlos__t.html" title="Line-of-sight data.">los_t</a>, <a class="el" href="jurassic_8h.html#a9a962bab37658297e87de9631c67707b" title="Compute carbon dioxide continuum (optical depth).">ctmco2</a>, <a class="el" href="jurassic_8h.html#a5b99f6f4581181857d4b89b27e8c2f87" title="Compute water vapor continuum (optical depth).">ctmh2o</a>, <a class="el" href="jurassic_8h.html#ad788eb8a3a6df141d82f28adbd610668" title="Compute N collision-induced absorption coefficient.">ctmn2</a>, <a class="el" href="jurassic_8h.html#a2d55d073ef8855381487a486970152f5" title="Compute O collision-induced absorption coefficient.">ctmo2</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03459">3459</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3463</span>                {</div>
<div class="line"><span class="lineno"> 3464</span> </div>
<div class="line"><span class="lineno"> 3465</span>  <span class="comment">/* Extinction... */</span></div>
<div class="line"><span class="lineno"> 3466</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3467</span>    beta[<span class="keywordtype">id</span>] = los-&gt;<a class="code hl_variable" href="structlos__t.html#acba1f4bef3b96b5412b5fb9b8dea6cba">k</a>[ip][<span class="keywordtype">id</span>];</div>
<div class="line"><span class="lineno"> 3468</span> </div>
<div class="line"><span class="lineno"> 3469</span>  <span class="comment">/* CO2 continuum... */</span></div>
<div class="line"><span class="lineno"> 3470</span>  if (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a417bdd14462698d3ced23bc954fa48a0">ctm_co2</a> &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a253c2c449b1d7e2f0eeda2ed62c8a4fe">ig_co2</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3471</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3472</span>      beta[<span class="keywordtype">id</span>] += <a class="code hl_function" href="jurassic_8c.html#a9a962bab37658297e87de9631c67707b">ctmco2</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[ip], los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip],</div>
<div class="line"><span class="lineno"> 3473</span>                         los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a253c2c449b1d7e2f0eeda2ed62c8a4fe">ig_co2</a>]) / los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[ip];</div>
<div class="line"><span class="lineno"> 3474</span> </div>
<div class="line"><span class="lineno"> 3475</span>  <span class="comment">/* H2O continuum... */</span></div>
<div class="line"><span class="lineno"> 3476</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a73f4f8e915d10ba9048b798580f7dddb">ctm_h2o</a> &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3477</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3478</span>      beta[<span class="keywordtype">id</span>] += <a class="code hl_function" href="jurassic_8c.html#a5b99f6f4581181857d4b89b27e8c2f87">ctmh2o</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[ip], los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip],</div>
<div class="line"><span class="lineno"> 3479</span>                         los-&gt;<a class="code hl_variable" href="structlos__t.html#a1a0f916b58e4aa17b792002b7385bcff">q</a>[ip][ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a>], los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a>])</div>
<div class="line"><span class="lineno"> 3480</span>        / los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[ip];</div>
<div class="line"><span class="lineno"> 3481</span> </div>
<div class="line"><span class="lineno"> 3482</span>  <span class="comment">/* N2 continuum... */</span></div>
<div class="line"><span class="lineno"> 3483</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5b53512f37127a12ef73a85dc8ccee4c">ctm_n2</a>)</div>
<div class="line"><span class="lineno"> 3484</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3485</span>      beta[<span class="keywordtype">id</span>] += <a class="code hl_function" href="jurassic_8c.html#ad788eb8a3a6df141d82f28adbd610668">ctmn2</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[ip], los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip]);</div>
<div class="line"><span class="lineno"> 3486</span> </div>
<div class="line"><span class="lineno"> 3487</span>  <span class="comment">/* O2 continuum... */</span></div>
<div class="line"><span class="lineno"> 3488</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad66545f9845ba89aa91fd173b50600ce">ctm_o2</a>)</div>
<div class="line"><span class="lineno"> 3489</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3490</span>      beta[<span class="keywordtype">id</span>] += <a class="code hl_function" href="jurassic_8c.html#a2d55d073ef8855381487a486970152f5">ctmo2</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[ip], los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip]);</div>
<div class="line"><span class="lineno"> 3491</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a2d55d073ef8855381487a486970152f5"><div class="ttname"><a href="jurassic_8c.html#a2d55d073ef8855381487a486970152f5">ctmo2</a></div><div class="ttdeci">double ctmo2(const double nu, const double p, const double t)</div><div class="ttdoc">Compute O collision-induced absorption coefficient.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03196">jurassic.c:3196</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a5b99f6f4581181857d4b89b27e8c2f87"><div class="ttname"><a href="jurassic_8c.html#a5b99f6f4581181857d4b89b27e8c2f87">ctmh2o</a></div><div class="ttdeci">double ctmh2o(const double nu, const double p, const double t, const double q, const double u)</div><div class="ttdoc">Compute water vapor continuum (optical depth).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l02075">jurassic.c:2075</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a9a962bab37658297e87de9631c67707b"><div class="ttname"><a href="jurassic_8c.html#a9a962bab37658297e87de9631c67707b">ctmco2</a></div><div class="ttdeci">double ctmco2(const double nu, const double p, const double t, const double u)</div><div class="ttdoc">Compute carbon dioxide continuum (optical depth).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l01212">jurassic.c:1212</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ad788eb8a3a6df141d82f28adbd610668"><div class="ttname"><a href="jurassic_8c.html#ad788eb8a3a6df141d82f28adbd610668">ctmn2</a></div><div class="ttdeci">double ctmn2(const double nu, const double p, const double t)</div><div class="ttdoc">Compute N collision-induced absorption coefficient.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03127">jurassic.c:3127</a></div></div>
<div class="ttc" id="astructctl__t_html_a417bdd14462698d3ced23bc954fa48a0"><div class="ttname"><a href="structctl__t.html#a417bdd14462698d3ced23bc954fa48a0">ctl_t::ctm_co2</a></div><div class="ttdeci">int ctm_co2</div><div class="ttdoc">Compute CO2 continuum (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01117">jurassic.h:1117</a></div></div>
<div class="ttc" id="astructctl__t_html_a5b53512f37127a12ef73a85dc8ccee4c"><div class="ttname"><a href="structctl__t.html#a5b53512f37127a12ef73a85dc8ccee4c">ctl_t::ctm_n2</a></div><div class="ttdeci">int ctm_n2</div><div class="ttdoc">Compute N2 continuum (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01123">jurassic.h:1123</a></div></div>
<div class="ttc" id="astructctl__t_html_a73f4f8e915d10ba9048b798580f7dddb"><div class="ttname"><a href="structctl__t.html#a73f4f8e915d10ba9048b798580f7dddb">ctl_t::ctm_h2o</a></div><div class="ttdeci">int ctm_h2o</div><div class="ttdoc">Compute H2O continuum (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01120">jurassic.h:1120</a></div></div>
<div class="ttc" id="astructctl__t_html_ad66545f9845ba89aa91fd173b50600ce"><div class="ttname"><a href="structctl__t.html#ad66545f9845ba89aa91fd173b50600ce">ctl_t::ctm_o2</a></div><div class="ttdeci">int ctm_o2</div><div class="ttdoc">Compute O2 continuum (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01126">jurassic.h:1126</a></div></div>
<div class="ttc" id="astructctl__t_html_ae2af3d94af749a1d5ca2ca2d2b92067c"><div class="ttname"><a href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ctl_t::ig_h2o</a></div><div class="ttdeci">int ig_h2o</div><div class="ttdoc">Emitter index of H2O.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01063">jurassic.h:1063</a></div></div>
<div class="ttc" id="astructlos__t_html_a1a0f916b58e4aa17b792002b7385bcff"><div class="ttname"><a href="structlos__t.html#a1a0f916b58e4aa17b792002b7385bcff">los_t::q</a></div><div class="ttdeci">double q[NLOS][NG]</div><div class="ttdoc">Volume mixing ratio [ppv].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01236">jurassic.h:1236</a></div></div>
<div class="ttc" id="astructlos__t_html_a6ba42c3d2673b0b2805c674b38680c16"><div class="ttname"><a href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">los_t::ds</a></div><div class="ttdeci">double ds[NLOS]</div><div class="ttdoc">Segment length [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01248">jurassic.h:1248</a></div></div>
<div class="ttc" id="astructlos__t_html_aa53eeaf4d2b6033c0f455a70efad410c"><div class="ttname"><a href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">los_t::u</a></div><div class="ttdeci">double u[NLOS][NG]</div><div class="ttdoc">Column density [molecules/cm^2].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01251">jurassic.h:1251</a></div></div>
<div class="ttc" id="astructlos__t_html_acba1f4bef3b96b5412b5fb9b8dea6cba"><div class="ttname"><a href="structlos__t.html#acba1f4bef3b96b5412b5fb9b8dea6cba">los_t::k</a></div><div class="ttdeci">double k[NLOS][ND]</div><div class="ttdoc">Extinction [km^-1].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01239">jurassic.h:1239</a></div></div>
<div class="ttc" id="astructlos__t_html_ae9885d0d23e84e6d0443d0d8e04c8867"><div class="ttname"><a href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">los_t::t</a></div><div class="ttdeci">double t[NLOS]</div><div class="ttdoc">Temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01233">jurassic.h:1233</a></div></div>
<div class="ttc" id="astructlos__t_html_aec5a63bda3ad49f3dd865fe5887108c9"><div class="ttname"><a href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">los_t::p</a></div><div class="ttdeci">double p[NLOS]</div><div class="ttdoc">Pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01230">jurassic.h:1230</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a363f5205cd58d7a22133f704f1137181_cgraph.png" border="0" usemap="#ajurassic_8h_a363f5205cd58d7a22133f704f1137181_cgraph" alt=""/></div>
<map name="ajurassic_8h_a363f5205cd58d7a22133f704f1137181_cgraph" id="ajurassic_8h_a363f5205cd58d7a22133f704f1137181_cgraph">
<area shape="rect" title="Compute total extinction including gaseous continua." alt="" coords="5,81,124,108"/>
<area shape="rect" href="jurassic_8c.html#a9a962bab37658297e87de9631c67707b" title="Compute carbon dioxide continuum (optical depth)." alt="" coords="172,5,237,32"/>
<area shape="rect" href="jurassic_8c.html#a5b99f6f4581181857d4b89b27e8c2f87" title="Compute water vapor continuum (optical depth)." alt="" coords="172,56,237,83"/>
<area shape="rect" href="jurassic_8c.html#ad788eb8a3a6df141d82f28adbd610668" title="Compute N collision&#45;induced absorption coefficient." alt="" coords="175,107,234,133"/>
<area shape="rect" href="jurassic_8c.html#a2d55d073ef8855381487a486970152f5" title="Compute O collision&#45;induced absorption coefficient." alt="" coords="175,157,234,184"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="285,132,368,159"/>
</map>
</div>

</div>
</div>
<a id="ab0c3109373d1d5edcf57840c288f6f53" name="ab0c3109373d1d5edcf57840c288f6f53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0c3109373d1d5edcf57840c288f6f53">&#9670;&nbsp;</a></span>formod_fov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void formod_fov </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply field-of-view (FOV) convolution to modeled radiances. </p>
<p >Convolves pencil-beam radiances and transmittances along each ray path with the instrument field-of-view weighting function defined in the control structure. This simulates finite FOV effects on measured radiances and transmittances.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure containing FOV parameters (offsets <a class="el" href="structctl__t.html#ac995bb7e49db8132059101867cc00e38">ctl_t::fov_dz</a> and weights <a class="el" href="structctl__t.html#af728c5c4b398624439a3a7d881476dd2">ctl_t::fov_w</a>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obs</td><td>Observation structure; input pencil-beam data are replaced with FOV-convolved radiances and transmittances.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The convolution is skipped if <a class="el" href="structctl__t.html#a6dd6b751109cac0ebf94f3bcae7a01e8">ctl_t::fov</a> starts with '-' (indicating no FOV correction). Requires at least two valid altitude samples per time step.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">ERRMSG</td><td>if insufficient data are available for convolution.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03495">3495</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3497</span>              {</div>
<div class="line"><span class="lineno"> 3498</span> </div>
<div class="line"><span class="lineno"> 3499</span>  <a class="code hl_struct" href="structobs__t.html">obs_t</a> *obs2;</div>
<div class="line"><span class="lineno"> 3500</span> </div>
<div class="line"><span class="lineno"> 3501</span>  <span class="keywordtype">double</span> rad[<a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>][<a class="code hl_define" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>], tau[<a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>][<a class="code hl_define" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>], z[<a class="code hl_define" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>];</div>
<div class="line"><span class="lineno"> 3502</span> </div>
<div class="line"><span class="lineno"> 3503</span>  <span class="comment">/* Do not take into account FOV... */</span></div>
<div class="line"><span class="lineno"> 3504</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6dd6b751109cac0ebf94f3bcae7a01e8">fov</a>[0] == <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 3505</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3506</span> </div>
<div class="line"><span class="lineno"> 3507</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 3508</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(obs2, <a class="code hl_struct" href="structobs__t.html">obs_t</a>, 1);</div>
<div class="line"><span class="lineno"> 3509</span> </div>
<div class="line"><span class="lineno"> 3510</span>  <span class="comment">/* Copy observation data... */</span></div>
<div class="line"><span class="lineno"> 3511</span>  <a class="code hl_function" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e">copy_obs</a>(ctl, obs2, obs, 0);</div>
<div class="line"><span class="lineno"> 3512</span> </div>
<div class="line"><span class="lineno"> 3513</span>  <span class="comment">/* Loop over ray paths... */</span></div>
<div class="line"><span class="lineno"> 3514</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++) {</div>
<div class="line"><span class="lineno"> 3515</span> </div>
<div class="line"><span class="lineno"> 3516</span>    <span class="comment">/* Get radiance and transmittance profiles... */</span></div>
<div class="line"><span class="lineno"> 3517</span>    <span class="keywordtype">int</span> nz = 0;</div>
<div class="line"><span class="lineno"> 3518</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir2 = <a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(ir - <a class="code hl_define" href="jurassic_8h.html#a1b12a17c57a92107c191e44599a2e315">NFOV</a>, 0);</div>
<div class="line"><span class="lineno"> 3519</span>         ir2 &lt; <a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(ir + 1 + <a class="code hl_define" href="jurassic_8h.html#a1b12a17c57a92107c191e44599a2e315">NFOV</a>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>); ir2++)</div>
<div class="line"><span class="lineno"> 3520</span>      <span class="keywordflow">if</span> (obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>[ir2] == obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>[ir]) {</div>
<div class="line"><span class="lineno"> 3521</span>        z[nz] = obs2-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[ir2];</div>
<div class="line"><span class="lineno"> 3522</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 3523</span>          rad[id][nz] = obs2-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[id][ir2];</div>
<div class="line"><span class="lineno"> 3524</span>          tau[id][nz] = obs2-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[id][ir2];</div>
<div class="line"><span class="lineno"> 3525</span>        }</div>
<div class="line"><span class="lineno"> 3526</span>        nz++;</div>
<div class="line"><span class="lineno"> 3527</span>      }</div>
<div class="line"><span class="lineno"> 3528</span>    <span class="keywordflow">if</span> (nz &lt; 2)</div>
<div class="line"><span class="lineno"> 3529</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot apply FOV convolution!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3530</span> </div>
<div class="line"><span class="lineno"> 3531</span>    <span class="comment">/* Convolute profiles with FOV... */</span></div>
<div class="line"><span class="lineno"> 3532</span>    <span class="keywordtype">double</span> wsum = 0;</div>
<div class="line"><span class="lineno"> 3533</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 3534</span>      obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[id][ir] = 0;</div>
<div class="line"><span class="lineno"> 3535</span>      obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[id][ir] = 0;</div>
<div class="line"><span class="lineno"> 3536</span>    }</div>
<div class="line"><span class="lineno"> 3537</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8feb52a8c01e8348012c0f2f714f2f92">fov_n</a>; i++) {</div>
<div class="line"><span class="lineno"> 3538</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zfov = obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[ir] + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac995bb7e49db8132059101867cc00e38">fov_dz</a>[i];</div>
<div class="line"><span class="lineno"> 3539</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_function" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(z, nz, zfov);</div>
<div class="line"><span class="lineno"> 3540</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 3541</span>        obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[id][ir] += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af728c5c4b398624439a3a7d881476dd2">fov_w</a>[i]</div>
<div class="line"><span class="lineno"> 3542</span>          * <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(z[idx], rad[<span class="keywordtype">id</span>][idx], z[idx + 1], rad[<span class="keywordtype">id</span>][idx + 1], zfov);</div>
<div class="line"><span class="lineno"> 3543</span>        obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[id][ir] += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af728c5c4b398624439a3a7d881476dd2">fov_w</a>[i]</div>
<div class="line"><span class="lineno"> 3544</span>          * <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(z[idx], tau[<span class="keywordtype">id</span>][idx], z[idx + 1], tau[<span class="keywordtype">id</span>][idx + 1], zfov);</div>
<div class="line"><span class="lineno"> 3545</span>      }</div>
<div class="line"><span class="lineno"> 3546</span>      wsum += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af728c5c4b398624439a3a7d881476dd2">fov_w</a>[i];</div>
<div class="line"><span class="lineno"> 3547</span>    }</div>
<div class="line"><span class="lineno"> 3548</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 3549</span>      obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[id][ir] /= wsum;</div>
<div class="line"><span class="lineno"> 3550</span>      obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[id][ir] /= wsum;</div>
<div class="line"><span class="lineno"> 3551</span>    }</div>
<div class="line"><span class="lineno"> 3552</span>  }</div>
<div class="line"><span class="lineno"> 3553</span> </div>
<div class="line"><span class="lineno"> 3554</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 3555</span>  free(obs2);</div>
<div class="line"><span class="lineno"> 3556</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a4e1b87dc3c93a23c89f739adf10b60dc"><div class="ttname"><a href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a></div><div class="ttdeci">int locate_irr(const double *xx, const int n, const double x)</div><div class="ttdoc">Locate index for interpolation on an irregular grid.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04428">jurassic.c:4428</a></div></div>
<div class="ttc" id="ajurassic_8c_html_aa855e52716bd4b479bb0d2446b300a4e"><div class="ttname"><a href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e">copy_obs</a></div><div class="ttdeci">void copy_obs(const ctl_t *ctl, obs_t *obs_dest, const obs_t *obs_src, const int init)</div><div class="ttdoc">Copy or initialize observation geometry and radiance data.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03308">jurassic.c:3308</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a1b12a17c57a92107c191e44599a2e315"><div class="ttname"><a href="jurassic_8h.html#a1b12a17c57a92107c191e44599a2e315">NFOV</a></div><div class="ttdeci">#define NFOV</div><div class="ttdoc">Number of ray paths used for FOV calculations.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00297">jurassic.h:297</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdoc">Determine the minimum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00631">jurassic.h:631</a></div></div>
<div class="ttc" id="ajurassic_8h_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdoc">Determine the maximum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00613">jurassic.h:613</a></div></div>
<div class="ttc" id="astructctl__t_html_a6dd6b751109cac0ebf94f3bcae7a01e8"><div class="ttname"><a href="structctl__t.html#a6dd6b751109cac0ebf94f3bcae7a01e8">ctl_t::fov</a></div><div class="ttdeci">char fov[LEN]</div><div class="ttdoc">Field-of-view data file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01138">jurassic.h:1138</a></div></div>
<div class="ttc" id="astructctl__t_html_a8feb52a8c01e8348012c0f2f714f2f92"><div class="ttname"><a href="structctl__t.html#a8feb52a8c01e8348012c0f2f714f2f92">ctl_t::fov_n</a></div><div class="ttdeci">int fov_n</div><div class="ttdoc">Field-of-view number of data points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01147">jurassic.h:1147</a></div></div>
<div class="ttc" id="astructctl__t_html_ac995bb7e49db8132059101867cc00e38"><div class="ttname"><a href="structctl__t.html#ac995bb7e49db8132059101867cc00e38">ctl_t::fov_dz</a></div><div class="ttdeci">double fov_dz[NSHAPE]</div><div class="ttdoc">Field-of-view vertical distance [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01141">jurassic.h:1141</a></div></div>
<div class="ttc" id="astructctl__t_html_af728c5c4b398624439a3a7d881476dd2"><div class="ttname"><a href="structctl__t.html#af728c5c4b398624439a3a7d881476dd2">ctl_t::fov_w</a></div><div class="ttdeci">double fov_w[NSHAPE]</div><div class="ttdoc">Field-of-view weighting factor.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01144">jurassic.h:1144</a></div></div>
<div class="ttc" id="astructobs__t_html"><div class="ttname"><a href="structobs__t.html">obs_t</a></div><div class="ttdoc">Observation geometry and radiance data.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01277">jurassic.h:1277</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_ab0c3109373d1d5edcf57840c288f6f53_cgraph.png" border="0" usemap="#ajurassic_8h_ab0c3109373d1d5edcf57840c288f6f53_cgraph" alt=""/></div>
<map name="ajurassic_8h_ab0c3109373d1d5edcf57840c288f6f53_cgraph" id="ajurassic_8h_ab0c3109373d1d5edcf57840c288f6f53_cgraph">
<area shape="rect" title="Apply field&#45;of&#45;view (FOV) convolution to modeled radiances." alt="" coords="5,31,92,57"/>
<area shape="rect" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e" title="Copy or initialize observation geometry and radiance data." alt="" coords="140,5,217,32"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="141,56,216,83"/>
</map>
</div>

</div>
</div>
<a id="a9727c4e0e5bc85384762b6ad81a8c3be" name="a9727c4e0e5bc85384762b6ad81a8c3be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9727c4e0e5bc85384762b6ad81a8c3be">&#9670;&nbsp;</a></span>formod_pencil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void formod_pencil </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute line-of-sight radiances using the pencil-beam forward model. </p>
<p >Simulates monochromatic radiances and transmittances along a single line of sight using a layer-by-layer pencil-beam approximation. The model includes gaseous absorption, continuum extinction, surface emission, reflection, and optional solar illumination.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining model configuration, gas setup, surface type, and spectral parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbl</td><td>Emissivity and source-function lookup tables. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Atmospheric state containing pressure, temperature, and gas profiles. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obs</td><td>Observation data; updated with modeled radiances and transmittances for the specified ray path. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ir</td><td>Index of the current ray path in <code>obs</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Depending on <a class="el" href="structctl__t.html#a76702f4f08a76f29e138d97c7d2b1833">ctl_t::formod</a>, this function calls either <a class="el" href="jurassic_8c.html#a5e22cd63c35ef6e2c9b9023e2c3945d8">intpol_tbl_cga()</a> (CGA) or <a class="el" href="jurassic_8c.html#a2b67aa3affea0dd3c6da502dab26d22d">intpol_tbl_ega()</a> (EGA) for gas absorption interpolation. <br  />
 Surface effects include emission, reflection, andif enabled solar illumination based on the solar zenith angle.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a>, <a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a>, <a class="el" href="structlos__t.html" title="Line-of-sight data.">los_t</a>, <a class="el" href="jurassic_8h.html#a44e1e4b6ab44e79d049f99a04e79df9f" title="Perform line-of-sight (LOS) ray tracing through the atmosphere.">raytrace</a>, <a class="el" href="jurassic_8h.html#a363f5205cd58d7a22133f704f1137181" title="Compute total extinction including gaseous continua.">formod_continua</a>, <a class="el" href="jurassic_8h.html#ac7826de16feb2eb6730b661bf8deba90" title="Interpolate the source function (Planck radiance) at a given temperature.">formod_srcfunc</a>, <a class="el" href="jurassic_8h.html#a5e22cd63c35ef6e2c9b9023e2c3945d8" title="Interpolate emissivities and transmittances using the CurtisGodson approximation (CGA).">intpol_tbl_cga</a>, <a class="el" href="jurassic_8h.html#a2b67aa3affea0dd3c6da502dab26d22d" title="Interpolate emissivities and transmittances using the Emissivity Growth Approximation (EGA).">intpol_tbl_ega</a>, <a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee" title="Compute spectral radiance using Plancks law.">PLANCK</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03560">3560</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3565</span>                {</div>
<div class="line"><span class="lineno"> 3566</span> </div>
<div class="line"><span class="lineno"> 3567</span>  <a class="code hl_struct" href="structlos__t.html">los_t</a> *los;</div>
<div class="line"><span class="lineno"> 3568</span> </div>
<div class="line"><span class="lineno"> 3569</span>  <span class="keywordtype">double</span> beta_ctm[<a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>], rad[<a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>], tau[<a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>], tau_refl[<a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>],</div>
<div class="line"><span class="lineno"> 3570</span>    tau_path[<a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>][<a class="code hl_define" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a>], tau_gas[<a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>], x0[3], x1[3];</div>
<div class="line"><span class="lineno"> 3571</span> </div>
<div class="line"><span class="lineno"> 3572</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 3573</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(los, <a class="code hl_struct" href="structlos__t.html">los_t</a>, 1);</div>
<div class="line"><span class="lineno"> 3574</span> </div>
<div class="line"><span class="lineno"> 3575</span>  <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 3576</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 3577</span>    rad[id] = 0;</div>
<div class="line"><span class="lineno"> 3578</span>    tau[id] = 1;</div>
<div class="line"><span class="lineno"> 3579</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 3580</span>      tau_path[<span class="keywordtype">id</span>][ig] = 1;</div>
<div class="line"><span class="lineno"> 3581</span>  }</div>
<div class="line"><span class="lineno"> 3582</span> </div>
<div class="line"><span class="lineno"> 3583</span>  <span class="comment">/* Raytracing... */</span></div>
<div class="line"><span class="lineno"> 3584</span>  <a class="code hl_function" href="jurassic_8c.html#a44e1e4b6ab44e79d049f99a04e79df9f">raytrace</a>(ctl, atm, obs, los, ir);</div>
<div class="line"><span class="lineno"> 3585</span> </div>
<div class="line"><span class="lineno"> 3586</span>  <span class="comment">/* Loop over LOS points... */</span></div>
<div class="line"><span class="lineno"> 3587</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 3588</span> </div>
<div class="line"><span class="lineno"> 3589</span>    <span class="comment">/* Get trace gas transmittance... */</span></div>
<div class="line"><span class="lineno"> 3590</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a76702f4f08a76f29e138d97c7d2b1833">formod</a> == 0)</div>
<div class="line"><span class="lineno"> 3591</span>      <a class="code hl_function" href="jurassic_8c.html#a5e22cd63c35ef6e2c9b9023e2c3945d8">intpol_tbl_cga</a>(ctl, tbl, los, ip, tau_path, tau_gas);</div>
<div class="line"><span class="lineno"> 3592</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3593</span>      <a class="code hl_function" href="jurassic_8c.html#a2b67aa3affea0dd3c6da502dab26d22d">intpol_tbl_ega</a>(ctl, tbl, los, ip, tau_path, tau_gas);</div>
<div class="line"><span class="lineno"> 3594</span> </div>
<div class="line"><span class="lineno"> 3595</span>    <span class="comment">/* Get continuum absorption... */</span></div>
<div class="line"><span class="lineno"> 3596</span>    <a class="code hl_function" href="jurassic_8c.html#a363f5205cd58d7a22133f704f1137181">formod_continua</a>(ctl, los, ip, beta_ctm);</div>
<div class="line"><span class="lineno"> 3597</span> </div>
<div class="line"><span class="lineno"> 3598</span>    <span class="comment">/* Compute Planck function... */</span></div>
<div class="line"><span class="lineno"> 3599</span>    <a class="code hl_function" href="jurassic_8c.html#ac7826de16feb2eb6730b661bf8deba90">formod_srcfunc</a>(ctl, tbl, los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip], los-&gt;<a class="code hl_variable" href="structlos__t.html#ab882cd1e0293656de28123cd377d5d7b">src</a>[ip]);</div>
<div class="line"><span class="lineno"> 3600</span> </div>
<div class="line"><span class="lineno"> 3601</span>    <span class="comment">/* Loop over channels... */</span></div>
<div class="line"><span class="lineno"> 3602</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3603</span>      <span class="keywordflow">if</span> (tau_gas[<span class="keywordtype">id</span>] &gt; 0) {</div>
<div class="line"><span class="lineno"> 3604</span> </div>
<div class="line"><span class="lineno"> 3605</span>        <span class="comment">/* Get segment emissivity... */</span></div>
<div class="line"><span class="lineno"> 3606</span>        los-&gt;<a class="code hl_variable" href="structlos__t.html#a0724cfbbe1f1b3efc88c42dba17767b7">eps</a>[ip][id] = 1 - tau_gas[id] * exp(-beta_ctm[<span class="keywordtype">id</span>] * los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[ip]);</div>
<div class="line"><span class="lineno"> 3607</span> </div>
<div class="line"><span class="lineno"> 3608</span>        <span class="comment">/* Compute radiance... */</span></div>
<div class="line"><span class="lineno"> 3609</span>        rad[id] += los-&gt;<a class="code hl_variable" href="structlos__t.html#ab882cd1e0293656de28123cd377d5d7b">src</a>[ip][id] * los-&gt;<a class="code hl_variable" href="structlos__t.html#a0724cfbbe1f1b3efc88c42dba17767b7">eps</a>[ip][id] * tau[id];</div>
<div class="line"><span class="lineno"> 3610</span> </div>
<div class="line"><span class="lineno"> 3611</span>        <span class="comment">/* Compute path transmittance... */</span></div>
<div class="line"><span class="lineno"> 3612</span>        tau[id] *= (1 - los-&gt;<a class="code hl_variable" href="structlos__t.html#a0724cfbbe1f1b3efc88c42dba17767b7">eps</a>[ip][id]);</div>
<div class="line"><span class="lineno"> 3613</span>      }</div>
<div class="line"><span class="lineno"> 3614</span>  }</div>
<div class="line"><span class="lineno"> 3615</span> </div>
<div class="line"><span class="lineno"> 3616</span>  <span class="comment">/* Check whether LOS hit the ground... */</span></div>
<div class="line"><span class="lineno"> 3617</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8ff7b3f429eb1f23d768fd189d963169">sftype</a> &gt;= 1 &amp;&amp; los-&gt;<a class="code hl_variable" href="structlos__t.html#a203d2c0dc9cc278bbd6b51714c759191">sft</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 3618</span> </div>
<div class="line"><span class="lineno"> 3619</span>    <span class="comment">/* Add surface emissions... */</span></div>
<div class="line"><span class="lineno"> 3620</span>    <span class="keywordtype">double</span> src_sf[<a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>];</div>
<div class="line"><span class="lineno"> 3621</span>    <a class="code hl_function" href="jurassic_8c.html#ac7826de16feb2eb6730b661bf8deba90">formod_srcfunc</a>(ctl, tbl, los-&gt;<a class="code hl_variable" href="structlos__t.html#a203d2c0dc9cc278bbd6b51714c759191">sft</a>, src_sf);</div>
<div class="line"><span class="lineno"> 3622</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3623</span>      rad[<span class="keywordtype">id</span>] += los-&gt;<a class="code hl_variable" href="structlos__t.html#addaf4b2df1ce35bb8e4e43bd6d61e2b2">sfeps</a>[<span class="keywordtype">id</span>] * src_sf[<span class="keywordtype">id</span>] * tau[<span class="keywordtype">id</span>];</div>
<div class="line"><span class="lineno"> 3624</span> </div>
<div class="line"><span class="lineno"> 3625</span>    <span class="comment">/* Check reflectivity... */</span></div>
<div class="line"><span class="lineno"> 3626</span>    <span class="keywordtype">int</span> refl = 0;</div>
<div class="line"><span class="lineno"> 3627</span>    if (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8ff7b3f429eb1f23d768fd189d963169">sftype</a> &gt;= 2)</div>
<div class="line"><span class="lineno"> 3628</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3629</span>        <span class="keywordflow">if</span> (los-&gt;<a class="code hl_variable" href="structlos__t.html#addaf4b2df1ce35bb8e4e43bd6d61e2b2">sfeps</a>[<span class="keywordtype">id</span>] &lt; 1) {</div>
<div class="line"><span class="lineno"> 3630</span>          refl = 1;</div>
<div class="line"><span class="lineno"> 3631</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3632</span>        }</div>
<div class="line"><span class="lineno"> 3633</span> </div>
<div class="line"><span class="lineno"> 3634</span>    <span class="comment">/* Calculate reflection... */</span></div>
<div class="line"><span class="lineno"> 3635</span>    <span class="keywordflow">if</span> (refl) {</div>
<div class="line"><span class="lineno"> 3636</span> </div>
<div class="line"><span class="lineno"> 3637</span>      <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 3638</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3639</span>        tau_refl[<span class="keywordtype">id</span>] = 1;</div>
<div class="line"><span class="lineno"> 3640</span> </div>
<div class="line"><span class="lineno"> 3641</span>      <span class="comment">/* Add down-welling radiance... */</span></div>
<div class="line"><span class="lineno"> 3642</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1; ip &gt;= 0; ip--)</div>
<div class="line"><span class="lineno"> 3643</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 3644</span>          rad[id] += los-&gt;<a class="code hl_variable" href="structlos__t.html#ab882cd1e0293656de28123cd377d5d7b">src</a>[ip][id] * los-&gt;<a class="code hl_variable" href="structlos__t.html#a0724cfbbe1f1b3efc88c42dba17767b7">eps</a>[ip][id] * tau_refl[id]</div>
<div class="line"><span class="lineno"> 3645</span>            * tau[id] * (1 - los-&gt;<a class="code hl_variable" href="structlos__t.html#addaf4b2df1ce35bb8e4e43bd6d61e2b2">sfeps</a>[id]);</div>
<div class="line"><span class="lineno"> 3646</span>          tau_refl[id] *= (1 - los-&gt;<a class="code hl_variable" href="structlos__t.html#a0724cfbbe1f1b3efc88c42dba17767b7">eps</a>[ip][id]);</div>
<div class="line"><span class="lineno"> 3647</span>        }</div>
<div class="line"><span class="lineno"> 3648</span> </div>
<div class="line"><span class="lineno"> 3649</span>      <span class="comment">/* Add solar term... */</span></div>
<div class="line"><span class="lineno"> 3650</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8ff7b3f429eb1f23d768fd189d963169">sftype</a> &gt;= 3) {</div>
<div class="line"><span class="lineno"> 3651</span> </div>
<div class="line"><span class="lineno"> 3652</span>        <span class="comment">/* Get cosine of solar zenith angle... */</span></div>
<div class="line"><span class="lineno"> 3653</span>        <span class="keywordtype">double</span> cos_sza_val;</div>
<div class="line"><span class="lineno"> 3654</span>        <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8e7cd04d65ba7ae0efb60e09678a566c">sfsza</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 3655</span>          cos_sza_val = <a class="code hl_function" href="jurassic_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">cos_sza</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>[ir],</div>
<div class="line"><span class="lineno"> 3656</span>                                los-&gt;<a class="code hl_variable" href="structlos__t.html#a5f4f0f880e8649bd90459fe7c14811dc">lon</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1], los-&gt;<a class="code hl_variable" href="structlos__t.html#ab1339541546c449911407fdabf0beea3">lat</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1]);</div>
<div class="line"><span class="lineno"> 3657</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3658</span>          cos_sza_val = cos(<a class="code hl_define" href="jurassic_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8e7cd04d65ba7ae0efb60e09678a566c">sfsza</a>));</div>
<div class="line"><span class="lineno"> 3659</span> </div>
<div class="line"><span class="lineno"> 3660</span>        <span class="comment">/* Check validity (avoid division by zero)... */</span></div>
<div class="line"><span class="lineno"> 3661</span>        <span class="keywordflow">if</span> (cos_sza_val &gt; 1e-6) {</div>
<div class="line"><span class="lineno"> 3662</span> </div>
<div class="line"><span class="lineno"> 3663</span>          <span class="comment">/* Compute incidence direction cosine... */</span></div>
<div class="line"><span class="lineno"> 3664</span>          <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1], los-&gt;<a class="code hl_variable" href="structlos__t.html#a5f4f0f880e8649bd90459fe7c14811dc">lon</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1],</div>
<div class="line"><span class="lineno"> 3665</span>                   los-&gt;<a class="code hl_variable" href="structlos__t.html#ab1339541546c449911407fdabf0beea3">lat</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1], x0);</div>
<div class="line"><span class="lineno"> 3666</span>          <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[0], los-&gt;<a class="code hl_variable" href="structlos__t.html#a5f4f0f880e8649bd90459fe7c14811dc">lon</a>[0], los-&gt;<a class="code hl_variable" href="structlos__t.html#ab1339541546c449911407fdabf0beea3">lat</a>[0], x1);</div>
<div class="line"><span class="lineno"> 3667</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 3668</span>            x1[i] -= x0[i];</div>
<div class="line"><span class="lineno"> 3669</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> cosa = <a class="code hl_define" href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a>(x0, x1) / <a class="code hl_define" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a>(x0) / <a class="code hl_define" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a>(x1);</div>
<div class="line"><span class="lineno"> 3670</span> </div>
<div class="line"><span class="lineno"> 3671</span>          <span class="comment">/* Ratio of incident direction to solar zenith direction... */</span></div>
<div class="line"><span class="lineno"> 3672</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> rcos = cosa / cos_sza_val;</div>
<div class="line"><span class="lineno"> 3673</span> </div>
<div class="line"><span class="lineno"> 3674</span>          <span class="comment">/* Add solar radiance contribution... */</span></div>
<div class="line"><span class="lineno"> 3675</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3676</span>            rad[<span class="keywordtype">id</span>] += 6.764e-5 / (2. * M_PI) * <a class="code hl_define" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a>(<a class="code hl_define" href="jurassic_8h.html#aa5244027c00b642d69d62392f5a60f8b">TSUN</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>])</div>
<div class="line"><span class="lineno"> 3677</span>              * tau_refl[id] * (1 - los-&gt;<a class="code hl_variable" href="structlos__t.html#addaf4b2df1ce35bb8e4e43bd6d61e2b2">sfeps</a>[id]) * tau[<span class="keywordtype">id</span>] * rcos;</div>
<div class="line"><span class="lineno"> 3678</span>        }</div>
<div class="line"><span class="lineno"> 3679</span>      }</div>
<div class="line"><span class="lineno"> 3680</span>    }</div>
<div class="line"><span class="lineno"> 3681</span>  }</div>
<div class="line"><span class="lineno"> 3682</span> </div>
<div class="line"><span class="lineno"> 3683</span>  <span class="comment">/* Copy results... */</span></div>
<div class="line"><span class="lineno"> 3684</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 3685</span>    obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[id][ir] = rad[id];</div>
<div class="line"><span class="lineno"> 3686</span>    obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[id][ir] = tau[id];</div>
<div class="line"><span class="lineno"> 3687</span>  }</div>
<div class="line"><span class="lineno"> 3688</span> </div>
<div class="line"><span class="lineno"> 3689</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 3690</span>  free(los);</div>
<div class="line"><span class="lineno"> 3691</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a1c8c72b0bc66d214b4575c13a7a0eb6b"><div class="ttname"><a href="jurassic_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">cos_sza</a></div><div class="ttdeci">double cos_sza(const double sec, const double lon, const double lat)</div><div class="ttdoc">Calculates the cosine of the solar zenith angle.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l01138">jurassic.c:1138</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a2b67aa3affea0dd3c6da502dab26d22d"><div class="ttname"><a href="jurassic_8c.html#a2b67aa3affea0dd3c6da502dab26d22d">intpol_tbl_ega</a></div><div class="ttdeci">void intpol_tbl_ega(const ctl_t *ctl, const tbl_t *tbl, const los_t *los, const int ip, double tau_path[ND][NG], double tau_seg[ND])</div><div class="ttdoc">Interpolate emissivities and transmittances using the Emissivity Growth Approximation (EGA).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04140">jurassic.c:4140</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a363f5205cd58d7a22133f704f1137181"><div class="ttname"><a href="jurassic_8c.html#a363f5205cd58d7a22133f704f1137181">formod_continua</a></div><div class="ttdeci">void formod_continua(const ctl_t *ctl, const los_t *los, const int ip, double *beta)</div><div class="ttdoc">Compute total extinction including gaseous continua.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03459">jurassic.c:3459</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a44e1e4b6ab44e79d049f99a04e79df9f"><div class="ttname"><a href="jurassic_8c.html#a44e1e4b6ab44e79d049f99a04e79df9f">raytrace</a></div><div class="ttdeci">void raytrace(const ctl_t *ctl, const atm_t *atm, obs_t *obs, los_t *los, const int ir)</div><div class="ttdoc">Perform line-of-sight (LOS) ray tracing through the atmosphere.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04873">jurassic.c:4873</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a5e22cd63c35ef6e2c9b9023e2c3945d8"><div class="ttname"><a href="jurassic_8c.html#a5e22cd63c35ef6e2c9b9023e2c3945d8">intpol_tbl_cga</a></div><div class="ttdeci">void intpol_tbl_cga(const ctl_t *ctl, const tbl_t *tbl, const los_t *los, const int ip, double tau_path[ND][NG], double tau_seg[ND])</div><div class="ttdoc">Interpolate emissivities and transmittances using the CurtisGodson approximation (CGA).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04051">jurassic.c:4051</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ac7826de16feb2eb6730b661bf8deba90"><div class="ttname"><a href="jurassic_8c.html#ac7826de16feb2eb6730b661bf8deba90">formod_srcfunc</a></div><div class="ttdeci">void formod_srcfunc(const ctl_t *ctl, const tbl_t *tbl, const double t, double *src)</div><div class="ttdoc">Interpolate the source function (Planck radiance) at a given temperature.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03836">jurassic.c:3836</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ae3aea782dfca9019f3f2d169f8cc0f6d"><div class="ttname"><a href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a></div><div class="ttdeci">void geo2cart(const double z, const double lon, const double lat, double *x)</div><div class="ttdoc">Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03853">jurassic.c:3853</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a2f872a4cdfaa577c03b9dea8201028e8"><div class="ttname"><a href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a></div><div class="ttdeci">#define DOTP(a, b)</div><div class="ttdoc">Compute dot product of two 3D vectors.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00482">jurassic.h:482</a></div></div>
<div class="ttc" id="ajurassic_8h_html_aa5244027c00b642d69d62392f5a60f8b"><div class="ttname"><a href="jurassic_8h.html#aa5244027c00b642d69d62392f5a60f8b">TSUN</a></div><div class="ttdeci">#define TSUN</div><div class="ttdoc">Effective temperature of the sun [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00213">jurassic.h:213</a></div></div>
<div class="ttc" id="ajurassic_8h_html_ab737f801dafc49850e131f6a42cd45ee"><div class="ttname"><a href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a></div><div class="ttdeci">#define PLANCK(T, nu)</div><div class="ttdoc">Compute spectral radiance using Plancks law.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00739">jurassic.h:739</a></div></div>
<div class="ttc" id="astructctl__t_html_a8e7cd04d65ba7ae0efb60e09678a566c"><div class="ttname"><a href="structctl__t.html#a8e7cd04d65ba7ae0efb60e09678a566c">ctl_t::sfsza</a></div><div class="ttdeci">double sfsza</div><div class="ttdoc">Solar zenith angle at the surface [deg] (-999=auto).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01099">jurassic.h:1099</a></div></div>
<div class="ttc" id="astructctl__t_html_a8ff7b3f429eb1f23d768fd189d963169"><div class="ttname"><a href="structctl__t.html#a8ff7b3f429eb1f23d768fd189d963169">ctl_t::sftype</a></div><div class="ttdeci">int sftype</div><div class="ttdoc">Surface treatment (0=none, 1=emissions, 2=downward, 3=solar).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01096">jurassic.h:1096</a></div></div>
<div class="ttc" id="astructlos__t_html"><div class="ttname"><a href="structlos__t.html">los_t</a></div><div class="ttdoc">Line-of-sight data.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01215">jurassic.h:1215</a></div></div>
<div class="ttc" id="astructlos__t_html_a0699ee03023f12b348926fc8d6046c8e"><div class="ttname"><a href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">los_t::z</a></div><div class="ttdeci">double z[NLOS]</div><div class="ttdoc">Altitude [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01221">jurassic.h:1221</a></div></div>
<div class="ttc" id="astructlos__t_html_a0724cfbbe1f1b3efc88c42dba17767b7"><div class="ttname"><a href="structlos__t.html#a0724cfbbe1f1b3efc88c42dba17767b7">los_t::eps</a></div><div class="ttdeci">double eps[NLOS][ND]</div><div class="ttdoc">Segment emissivity.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01263">jurassic.h:1263</a></div></div>
<div class="ttc" id="astructlos__t_html_a203d2c0dc9cc278bbd6b51714c759191"><div class="ttname"><a href="structlos__t.html#a203d2c0dc9cc278bbd6b51714c759191">los_t::sft</a></div><div class="ttdeci">double sft</div><div class="ttdoc">Surface temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01242">jurassic.h:1242</a></div></div>
<div class="ttc" id="astructlos__t_html_a5f4f0f880e8649bd90459fe7c14811dc"><div class="ttname"><a href="structlos__t.html#a5f4f0f880e8649bd90459fe7c14811dc">los_t::lon</a></div><div class="ttdeci">double lon[NLOS]</div><div class="ttdoc">Longitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01224">jurassic.h:1224</a></div></div>
<div class="ttc" id="astructlos__t_html_a8a1dd4eed9a219b4dba98db4e22e6355"><div class="ttname"><a href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">los_t::np</a></div><div class="ttdeci">int np</div><div class="ttdoc">Number of LOS points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01218">jurassic.h:1218</a></div></div>
<div class="ttc" id="astructlos__t_html_ab1339541546c449911407fdabf0beea3"><div class="ttname"><a href="structlos__t.html#ab1339541546c449911407fdabf0beea3">los_t::lat</a></div><div class="ttdeci">double lat[NLOS]</div><div class="ttdoc">Latitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01227">jurassic.h:1227</a></div></div>
<div class="ttc" id="astructlos__t_html_ab882cd1e0293656de28123cd377d5d7b"><div class="ttname"><a href="structlos__t.html#ab882cd1e0293656de28123cd377d5d7b">los_t::src</a></div><div class="ttdeci">double src[NLOS][ND]</div><div class="ttdoc">Segment source function [W/(m^2 sr cm^-1)].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01266">jurassic.h:1266</a></div></div>
<div class="ttc" id="astructlos__t_html_addaf4b2df1ce35bb8e4e43bd6d61e2b2"><div class="ttname"><a href="structlos__t.html#addaf4b2df1ce35bb8e4e43bd6d61e2b2">los_t::sfeps</a></div><div class="ttdeci">double sfeps[ND]</div><div class="ttdoc">Surface emissivity.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01245">jurassic.h:1245</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a9727c4e0e5bc85384762b6ad81a8c3be_cgraph.png" border="0" usemap="#ajurassic_8h_a9727c4e0e5bc85384762b6ad81a8c3be_cgraph" alt=""/></div>
<map name="ajurassic_8h_a9727c4e0e5bc85384762b6ad81a8c3be_cgraph" id="ajurassic_8h_a9727c4e0e5bc85384762b6ad81a8c3be_cgraph">
<area shape="rect" title="Compute line&#45;of&#45;sight radiances using the pencil&#45;beam forward model." alt="" coords="5,234,108,261"/>
<area shape="rect" href="jurassic_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="180,57,251,84"/>
<area shape="rect" href="jurassic_8c.html#a363f5205cd58d7a22133f704f1137181" title="Compute total extinction including gaseous continua." alt="" coords="156,158,275,185"/>
<area shape="rect" href="jurassic_8c.html#ac7826de16feb2eb6730b661bf8deba90" title="Interpolate the source function (Planck radiance) at a given temperature." alt="" coords="159,108,271,134"/>
<area shape="rect" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="489,488,561,514"/>
<area shape="rect" href="jurassic_8c.html#a5e22cd63c35ef6e2c9b9023e2c3945d8" title="Interpolate emissivities and transmittances using the CurtisGodson approximation (CGA)." alt="" coords="323,234,425,261"/>
<area shape="rect" href="jurassic_8c.html#a2b67aa3affea0dd3c6da502dab26d22d" title="Interpolate emissivities and transmittances using the Emissivity Growth Approximation (EGA)." alt="" coords="323,285,425,312"/>
<area shape="rect" href="jurassic_8c.html#a44e1e4b6ab44e79d049f99a04e79df9f" title="Perform line&#45;of&#45;sight (LOS) ray tracing through the atmosphere." alt="" coords="181,462,249,489"/>
<area shape="rect" href="jurassic_8c.html#a9a962bab37658297e87de9631c67707b" title="Compute carbon dioxide continuum (optical depth)." alt="" coords="341,133,407,160"/>
<area shape="rect" href="jurassic_8c.html#a5b99f6f4581181857d4b89b27e8c2f87" title="Compute water vapor continuum (optical depth)." alt="" coords="341,184,407,210"/>
<area shape="rect" href="jurassic_8c.html#ad788eb8a3a6df141d82f28adbd610668" title="Compute N collision&#45;induced absorption coefficient." alt="" coords="345,82,403,109"/>
<area shape="rect" href="jurassic_8c.html#a2d55d073ef8855381487a486970152f5" title="Compute O collision&#45;induced absorption coefficient." alt="" coords="345,32,403,58"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="483,82,566,109"/>
<area shape="rect" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a" title="Interpolate emissivity from lookup tables as a function of column density." alt="" coords="473,234,576,261"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="487,361,562,388"/>
<area shape="rect" href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids." alt="" coords="624,260,703,286"/>
<area shape="rect" href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138" title="Interpolate column density from lookup tables as a function of emissivity." alt="" coords="481,285,569,312"/>
<area shape="rect" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="Converts Cartesian coordinates to geographic coordinates." alt="" coords="489,564,561,590"/>
<area shape="rect" href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612" title="Interpolate atmospheric state variables at a given altitude." alt="" coords="333,386,415,413"/>
<area shape="rect" href="jurassic_8c.html#a9020f32787ea7be08486d537a4f5c0fc" title="Determine the tangent point along a line of sight (LOS)." alt="" coords="324,538,424,565"/>
</map>
</div>

</div>
</div>
<a id="a2caf20484e8e2f52ff3650321b7c704c" name="a2caf20484e8e2f52ff3650321b7c704c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2caf20484e8e2f52ff3650321b7c704c">&#9670;&nbsp;</a></span>formod_rfm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void formod_rfm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interface routine for the Reference Forward Model (RFM). </p>
<p >Prepares input data, executes the RFM executable, and imports simulated radiances and transmittances into the observation structure. The routine converts the atmospheric and geometric configuration from internal JURASSIC data structures into RFM-compatible driver and atmosphere files, then reads the RFM output spectra.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining model configuration, RFM executable path, HITRAN database, and spectral setup. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Atmospheric state structure containing pressure, temperature, and gas profiles. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obs</td><td>Observation geometry and radiance data to be populated with RFM-computed radiances and transmittances.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function assumes identical observer positions across all ray paths and no extinction data in <code>atm</code>. It automatically determines whether the geometry is limb, nadir, or observer-based.</dd>
<dd>
Adds appropriate RFM flags (e.g., <code>RAD</code>, <code>TRA</code>, <code>MIX</code>, <code>CTM</code>) based on the control settings. Temporary files such as <code>rfm.drv</code>, <code>rfm.atm</code>, and <code>rad_*</code>.asc are created and removed automatically.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a>, <a class="el" href="jurassic_8h.html#a44e1e4b6ab44e79d049f99a04e79df9f" title="Perform line-of-sight (LOS) ray tracing through the atmosphere.">raytrace</a>, <a class="el" href="jurassic_8h.html#a675d14cbd1ae26f72e86f828d8367240" title="Write atmospheric profile in RFM-compatible format.">write_atm_rfm</a>, <a class="el" href="jurassic_8h.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two-column shape function from an ASCII file.">read_shape</a>, <a class="el" href="jurassic_8h.html#a134dbd60b73c18eda7032e58284dbade" title="Read and spectrally convolve an RFM output spectrum.">read_obs_rfm</a>, <a class="el" href="jurassic_8h.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates.">geo2cart</a>, <a class="el" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943" title="Compute the norm (magnitude) of a 3D vector.">NORM</a>, <a class="el" href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8" title="Compute dot product of two 3D vectors.">DOTP</a></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">ERRMSG</td><td>on inconsistent geometry, failed I/O, or system call errors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Requires external RFM binary; ensure <a class="el" href="structctl__t.html#a342dfe238de9dfcb389b07477f8ef527">ctl_t::rfmbin</a> is set.</dd></dl>
<dl class="section user"><dt>Reference</dt><dd>Dudhia, A., "The Reference Forward Model (RFM)", JQSRT 186, 243253 (2017)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03695">3695</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3698</span>              {</div>
<div class="line"><span class="lineno"> 3699</span> </div>
<div class="line"><span class="lineno"> 3700</span>  <a class="code hl_struct" href="structlos__t.html">los_t</a> *los;</div>
<div class="line"><span class="lineno"> 3701</span> </div>
<div class="line"><span class="lineno"> 3702</span>  FILE *out;</div>
<div class="line"><span class="lineno"> 3703</span> </div>
<div class="line"><span class="lineno"> 3704</span>  <span class="keywordtype">char</span> cmd[2 * <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], filename[2 * <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>],</div>
<div class="line"><span class="lineno"> 3705</span>    rfmflg[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>] = { <span class="stringliteral">&quot;RAD TRA MIX LIN SFC&quot;</span> };</div>
<div class="line"><span class="lineno"> 3706</span> </div>
<div class="line"><span class="lineno"> 3707</span>  <span class="keywordtype">double</span> f[<a class="code hl_define" href="jurassic_8h.html#a7705bd290b81177c733651a18441be93">NSHAPE</a>], nu[<a class="code hl_define" href="jurassic_8h.html#a7705bd290b81177c733651a18441be93">NSHAPE</a>], nu0, nu1, obsz = -999, tsurf,</div>
<div class="line"><span class="lineno"> 3708</span>    xd[3], xo[3], xv[3], z[<a class="code hl_define" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>], zmin, zmax;</div>
<div class="line"><span class="lineno"> 3709</span> </div>
<div class="line"><span class="lineno"> 3710</span>  <span class="keywordtype">int</span> n, nadir = 0;</div>
<div class="line"><span class="lineno"> 3711</span> </div>
<div class="line"><span class="lineno"> 3712</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 3713</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(los, <a class="code hl_struct" href="structlos__t.html">los_t</a>, 1);</div>
<div class="line"><span class="lineno"> 3714</span> </div>
<div class="line"><span class="lineno"> 3715</span>  <span class="comment">/* Check observer positions... */</span></div>
<div class="line"><span class="lineno"> 3716</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 1; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 3717</span>    <span class="keywordflow">if</span> (obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[ir] != obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[0]</div>
<div class="line"><span class="lineno"> 3718</span>        || obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>[ir] != obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>[0]</div>
<div class="line"><span class="lineno"> 3719</span>        || obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>[ir] != obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>[0])</div>
<div class="line"><span class="lineno"> 3720</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;RFM interface requires identical observer positions!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3721</span> </div>
<div class="line"><span class="lineno"> 3722</span>  <span class="comment">/* Check extinction data... */</span></div>
<div class="line"><span class="lineno"> 3723</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 3724</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 3725</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip] != 0)</div>
<div class="line"><span class="lineno"> 3726</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;RFM interface cannot handle extinction data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3727</span> </div>
<div class="line"><span class="lineno"> 3728</span>  <span class="comment">/* Get altitude range of atmospheric data... */</span></div>
<div class="line"><span class="lineno"> 3729</span>  gsl_stats_minmax(&amp;zmin, &amp;zmax, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 3730</span> </div>
<div class="line"><span class="lineno"> 3731</span>  <span class="comment">/* Observer within atmosphere? */</span></div>
<div class="line"><span class="lineno"> 3732</span>  <span class="keywordflow">if</span> (obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[0] &gt;= zmin &amp;&amp; obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[0] &lt;= zmax) {</div>
<div class="line"><span class="lineno"> 3733</span>    obsz = obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[0];</div>
<div class="line"><span class="lineno"> 3734</span>    strcat(rfmflg, <span class="stringliteral">&quot; OBS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3735</span>  }</div>
<div class="line"><span class="lineno"> 3736</span> </div>
<div class="line"><span class="lineno"> 3737</span>  <span class="comment">/* Determine tangent altitude or air mass factor... */</span></div>
<div class="line"><span class="lineno"> 3738</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++) {</div>
<div class="line"><span class="lineno"> 3739</span> </div>
<div class="line"><span class="lineno"> 3740</span>    <span class="comment">/* Raytracing... */</span></div>
<div class="line"><span class="lineno"> 3741</span>    <a class="code hl_function" href="jurassic_8c.html#a44e1e4b6ab44e79d049f99a04e79df9f">raytrace</a>(ctl, atm, obs, los, ir);</div>
<div class="line"><span class="lineno"> 3742</span> </div>
<div class="line"><span class="lineno"> 3743</span>    <span class="comment">/* Nadir? */</span></div>
<div class="line"><span class="lineno"> 3744</span>    <span class="keywordflow">if</span> (obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>[ir] &lt;= zmin) {</div>
<div class="line"><span class="lineno"> 3745</span>      <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>[ir], xo);</div>
<div class="line"><span class="lineno"> 3746</span>      <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>[ir], xv);</div>
<div class="line"><span class="lineno"> 3747</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 3748</span>        xd[i] = xo[i] - xv[i];</div>
<div class="line"><span class="lineno"> 3749</span>      z[ir] = <a class="code hl_define" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a>(xo) * <a class="code hl_define" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a>(xd) / <a class="code hl_define" href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a>(xo, xd);</div>
<div class="line"><span class="lineno"> 3750</span>      nadir++;</div>
<div class="line"><span class="lineno"> 3751</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3752</span>      z[ir] = obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>[ir];</div>
<div class="line"><span class="lineno"> 3753</span>  }</div>
<div class="line"><span class="lineno"> 3754</span>  <span class="keywordflow">if</span> (nadir &gt; 0 &amp;&amp; nadir &lt; obs-&gt;nr)</div>
<div class="line"><span class="lineno"> 3755</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Limb and nadir not simultaneously possible!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3756</span> </div>
<div class="line"><span class="lineno"> 3757</span>  <span class="comment">/* Nadir? */</span></div>
<div class="line"><span class="lineno"> 3758</span>  <span class="keywordflow">if</span> (nadir)</div>
<div class="line"><span class="lineno"> 3759</span>    strcat(rfmflg, <span class="stringliteral">&quot; NAD&quot;</span>);</div>
<div class="line"><span class="lineno"> 3760</span> </div>
<div class="line"><span class="lineno"> 3761</span>  <span class="comment">/* Get surface temperature... */</span></div>
<div class="line"><span class="lineno"> 3762</span>  tsurf = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[gsl_stats_min_index(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>)];</div>
<div class="line"><span class="lineno"> 3763</span> </div>
<div class="line"><span class="lineno"> 3764</span>  <span class="comment">/* Refraction? */</span></div>
<div class="line"><span class="lineno"> 3765</span>  <span class="keywordflow">if</span> (!nadir &amp;&amp; !ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a840532f5c38a5b325317cede07b40990">refrac</a>)</div>
<div class="line"><span class="lineno"> 3766</span>    strcat(rfmflg, <span class="stringliteral">&quot; GEO&quot;</span>);</div>
<div class="line"><span class="lineno"> 3767</span> </div>
<div class="line"><span class="lineno"> 3768</span>  <span class="comment">/* Continua? */</span></div>
<div class="line"><span class="lineno"> 3769</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a417bdd14462698d3ced23bc954fa48a0">ctm_co2</a> || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a73f4f8e915d10ba9048b798580f7dddb">ctm_h2o</a> || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5b53512f37127a12ef73a85dc8ccee4c">ctm_n2</a> || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad66545f9845ba89aa91fd173b50600ce">ctm_o2</a>)</div>
<div class="line"><span class="lineno"> 3770</span>    strcat(rfmflg, <span class="stringliteral">&quot; CTM&quot;</span>);</div>
<div class="line"><span class="lineno"> 3771</span> </div>
<div class="line"><span class="lineno"> 3772</span>  <span class="comment">/* Write atmospheric data file... */</span></div>
<div class="line"><span class="lineno"> 3773</span>  <a class="code hl_function" href="jurassic_8c.html#a675d14cbd1ae26f72e86f828d8367240">write_atm_rfm</a>(<span class="stringliteral">&quot;rfm.atm&quot;</span>, ctl, atm);</div>
<div class="line"><span class="lineno"> 3774</span> </div>
<div class="line"><span class="lineno"> 3775</span>  <span class="comment">/* Loop over channels... */</span></div>
<div class="line"><span class="lineno"> 3776</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 3777</span> </div>
<div class="line"><span class="lineno"> 3778</span>    <span class="comment">/* Read filter function... */</span></div>
<div class="line"><span class="lineno"> 3779</span>    sprintf(filename, <span class="stringliteral">&quot;%s_%.4f.filt&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">tblbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 3780</span>    <a class="code hl_function" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd">read_shape</a>(filename, nu, f, &amp;n);</div>
<div class="line"><span class="lineno"> 3781</span> </div>
<div class="line"><span class="lineno"> 3782</span>    <span class="comment">/* Set spectral range... */</span></div>
<div class="line"><span class="lineno"> 3783</span>    nu0 = nu[0];</div>
<div class="line"><span class="lineno"> 3784</span>    nu1 = nu[n - 1];</div>
<div class="line"><span class="lineno"> 3785</span> </div>
<div class="line"><span class="lineno"> 3786</span>    <span class="comment">/* Create RFM driver file... */</span></div>
<div class="line"><span class="lineno"> 3787</span>    <span class="keywordflow">if</span> (!(out = fopen(<span class="stringliteral">&quot;rfm.drv&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno"> 3788</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3789</span>    fprintf(out, <span class="stringliteral">&quot;*HDR\nRFM call by JURASSIC.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3790</span>    fprintf(out, <span class="stringliteral">&quot;*FLG\n%s\n&quot;</span>, rfmflg);</div>
<div class="line"><span class="lineno"> 3791</span>    fprintf(out, <span class="stringliteral">&quot;*SPC\n%.4f %.4f 0.0005\n&quot;</span>, nu0, nu1);</div>
<div class="line"><span class="lineno"> 3792</span>    fprintf(out, <span class="stringliteral">&quot;*GAS\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3793</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 3794</span>      fprintf(out, <span class="stringliteral">&quot;%s\n&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 3795</span>    fprintf(out, <span class="stringliteral">&quot;*ATM\nrfm.atm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3796</span>    fprintf(out, <span class="stringliteral">&quot;*TAN\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3797</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 3798</span>      fprintf(out, <span class="stringliteral">&quot;%g\n&quot;</span>, z[ir]);</div>
<div class="line"><span class="lineno"> 3799</span>    fprintf(out, <span class="stringliteral">&quot;*SFC\n%g 1.0\n&quot;</span>, tsurf);</div>
<div class="line"><span class="lineno"> 3800</span>    <span class="keywordflow">if</span> (obsz &gt;= 0)</div>
<div class="line"><span class="lineno"> 3801</span>      fprintf(out, <span class="stringliteral">&quot;*OBS\n%g\n&quot;</span>, obsz);</div>
<div class="line"><span class="lineno"> 3802</span>    fprintf(out, <span class="stringliteral">&quot;*HIT\n%s\n&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a32f95b8c7a13422eb1614bc86261d8f2">rfmhit</a>);</div>
<div class="line"><span class="lineno"> 3803</span>    fprintf(out, <span class="stringliteral">&quot;*XSC\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3804</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 3805</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6ea477ad330f7edacbef53573d224d9b">rfmxsc</a>[ig][0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 3806</span>        fprintf(out, <span class="stringliteral">&quot;%s\n&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6ea477ad330f7edacbef53573d224d9b">rfmxsc</a>[ig]);</div>
<div class="line"><span class="lineno"> 3807</span>    fprintf(out, <span class="stringliteral">&quot;*END\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3808</span>    fclose(out);</div>
<div class="line"><span class="lineno"> 3809</span> </div>
<div class="line"><span class="lineno"> 3810</span>    <span class="comment">/* Remove temporary files... */</span></div>
<div class="line"><span class="lineno"> 3811</span>    <span class="keywordflow">if</span> (system(<span class="stringliteral">&quot;rm -f rfm.runlog rad_*.asc tra_*.asc&quot;</span>))</div>
<div class="line"><span class="lineno"> 3812</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot remove temporary files!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3813</span> </div>
<div class="line"><span class="lineno"> 3814</span>    <span class="comment">/* Call RFM... */</span></div>
<div class="line"><span class="lineno"> 3815</span>    sprintf(cmd, <span class="stringliteral">&quot;echo | %s&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a342dfe238de9dfcb389b07477f8ef527">rfmbin</a>);</div>
<div class="line"><span class="lineno"> 3816</span>    <span class="keywordflow">if</span> (system(cmd))</div>
<div class="line"><span class="lineno"> 3817</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error while calling RFM!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3818</span> </div>
<div class="line"><span class="lineno"> 3819</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 3820</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++) {</div>
<div class="line"><span class="lineno"> 3821</span>      obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[id][ir] = <a class="code hl_function" href="jurassic_8c.html#a134dbd60b73c18eda7032e58284dbade">read_obs_rfm</a>(<span class="stringliteral">&quot;rad&quot;</span>, z[ir], nu, f, n) * 1e-5;</div>
<div class="line"><span class="lineno"> 3822</span>      obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[id][ir] = <a class="code hl_function" href="jurassic_8c.html#a134dbd60b73c18eda7032e58284dbade">read_obs_rfm</a>(<span class="stringliteral">&quot;tra&quot;</span>, z[ir], nu, f, n);</div>
<div class="line"><span class="lineno"> 3823</span>    }</div>
<div class="line"><span class="lineno"> 3824</span>  }</div>
<div class="line"><span class="lineno"> 3825</span> </div>
<div class="line"><span class="lineno"> 3826</span>  <span class="comment">/* Remove temporary files... */</span></div>
<div class="line"><span class="lineno"> 3827</span>  <span class="keywordflow">if</span> (system(<span class="stringliteral">&quot;rm -f rfm.drv rfm.atm rfm.runlog rad_*.asc tra_*.asc&quot;</span>))</div>
<div class="line"><span class="lineno"> 3828</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error while removing temporary files!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3829</span> </div>
<div class="line"><span class="lineno"> 3830</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 3831</span>  free(los);</div>
<div class="line"><span class="lineno"> 3832</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a134dbd60b73c18eda7032e58284dbade"><div class="ttname"><a href="jurassic_8c.html#a134dbd60b73c18eda7032e58284dbade">read_obs_rfm</a></div><div class="ttdeci">double read_obs_rfm(const char *basename, const double z, const double *nu, const double *f, const int n)</div><div class="ttdoc">Read and spectrally convolve an RFM output spectrum.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l05673">jurassic.c:5673</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a675d14cbd1ae26f72e86f828d8367240"><div class="ttname"><a href="jurassic_8c.html#a675d14cbd1ae26f72e86f828d8367240">write_atm_rfm</a></div><div class="ttdeci">void write_atm_rfm(const char *filename, const ctl_t *ctl, const atm_t *atm)</div><div class="ttdoc">Write atmospheric profile in RFM-compatible format.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06817">jurassic.c:6817</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ad6dc7f479ca53ad9866d0e1df8f5ffcd"><div class="ttname"><a href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd">read_shape</a></div><div class="ttdeci">void read_shape(const char *filename, double *x, double *y, int *n)</div><div class="ttdoc">Read a two-column shape function from an ASCII file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l05845">jurassic.c:5845</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a05b49c662c073f89e86804f7856622a0"><div class="ttname"><a href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a></div><div class="ttdeci">#define LEN</div><div class="ttdoc">Maximum length of ASCII data lines.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00267">jurassic.h:267</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a7705bd290b81177c733651a18441be93"><div class="ttname"><a href="jurassic_8h.html#a7705bd290b81177c733651a18441be93">NSHAPE</a></div><div class="ttdeci">#define NSHAPE</div><div class="ttdoc">Maximum number of shape function grid points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00292">jurassic.h:292</a></div></div>
<div class="ttc" id="astructctl__t_html_a32f95b8c7a13422eb1614bc86261d8f2"><div class="ttname"><a href="structctl__t.html#a32f95b8c7a13422eb1614bc86261d8f2">ctl_t::rfmhit</a></div><div class="ttdeci">char rfmhit[LEN]</div><div class="ttdoc">HITRAN file for RFM.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01201">jurassic.h:1201</a></div></div>
<div class="ttc" id="astructctl__t_html_a333796df0ab2dc191cb6c7287d7487c8"><div class="ttname"><a href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">ctl_t::tblbase</a></div><div class="ttdeci">char tblbase[LEN]</div><div class="ttdoc">Basename for table files and filter function files.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01102">jurassic.h:1102</a></div></div>
<div class="ttc" id="astructctl__t_html_a342dfe238de9dfcb389b07477f8ef527"><div class="ttname"><a href="structctl__t.html#a342dfe238de9dfcb389b07477f8ef527">ctl_t::rfmbin</a></div><div class="ttdeci">char rfmbin[LEN]</div><div class="ttdoc">Path to RFM binary.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01198">jurassic.h:1198</a></div></div>
<div class="ttc" id="astructctl__t_html_a6ea477ad330f7edacbef53573d224d9b"><div class="ttname"><a href="structctl__t.html#a6ea477ad330f7edacbef53573d224d9b">ctl_t::rfmxsc</a></div><div class="ttdeci">char rfmxsc[NG][LEN]</div><div class="ttdoc">Emitter cross-section files for RFM.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01204">jurassic.h:1204</a></div></div>
<div class="ttc" id="astructctl__t_html_a840532f5c38a5b325317cede07b40990"><div class="ttname"><a href="structctl__t.html#a840532f5c38a5b325317cede07b40990">ctl_t::refrac</a></div><div class="ttdeci">int refrac</div><div class="ttdoc">Take into account refractivity (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01129">jurassic.h:1129</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a2caf20484e8e2f52ff3650321b7c704c_cgraph.png" border="0" usemap="#ajurassic_8h_a2caf20484e8e2f52ff3650321b7c704c_cgraph" alt=""/></div>
<map name="ajurassic_8h_a2caf20484e8e2f52ff3650321b7c704c_cgraph" id="ajurassic_8h_a2caf20484e8e2f52ff3650321b7c704c_cgraph">
<area shape="rect" title="Interface routine for the Reference Forward Model (RFM)." alt="" coords="5,222,93,249"/>
<area shape="rect" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="452,7,524,34"/>
<area shape="rect" href="jurassic_8c.html#a44e1e4b6ab44e79d049f99a04e79df9f" title="Perform line&#45;of&#45;sight (LOS) ray tracing through the atmosphere." alt="" coords="160,134,228,161"/>
<area shape="rect" href="jurassic_8c.html#a134dbd60b73c18eda7032e58284dbade" title="Read and spectrally convolve an RFM output spectrum." alt="" coords="143,222,245,249"/>
<area shape="rect" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two&#45;column shape function from an ASCII file." alt="" coords="149,273,239,299"/>
<area shape="rect" href="jurassic_8c.html#a675d14cbd1ae26f72e86f828d8367240" title="Write atmospheric profile in RFM&#45;compatible format." alt="" coords="141,323,247,350"/>
<area shape="rect" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="Converts Cartesian coordinates to geographic coordinates." alt="" coords="452,83,524,110"/>
<area shape="rect" href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612" title="Interpolate atmospheric state variables at a given altitude." alt="" coords="307,159,390,186"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="451,210,525,237"/>
<area shape="rect" href="jurassic_8c.html#a9020f32787ea7be08486d537a4f5c0fc" title="Determine the tangent point along a line of sight (LOS)." alt="" coords="299,58,399,85"/>
<area shape="rect" href="jurassic_8c.html#a19d63e07e3eb8166cbf65ce079e4d156" title="Read a Reference Forward Model (RFM) ASCII spectrum." alt="" coords="295,311,403,338"/>
</map>
</div>

</div>
</div>
<a id="ac7826de16feb2eb6730b661bf8deba90" name="ac7826de16feb2eb6730b661bf8deba90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7826de16feb2eb6730b661bf8deba90">&#9670;&nbsp;</a></span>formod_srcfunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void formod_srcfunc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate the source function (Planck radiance) at a given temperature. </p>
<p >Computes source function values by linearly interpolating between precomputed Planck radiances in the lookup table. The resulting radiance spectrum corresponds to the input temperature and is stored in <code>src</code> for all spectral channels.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining the number of spectral channels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbl</td><td>Emissivity and source-function lookup table containing Planck radiances (<a class="el" href="structtbl__t.html#a0829f62f18df6865078916867fb45049">tbl_t::sr</a>) and corresponding temperatures (<a class="el" href="structtbl__t.html#acbbff4883292be53dfee5ec3258e0bed">tbl_t::st</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Temperature [K] for which the source function is evaluated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">src</td><td>Output array of interpolated source-function values [Wmsrcm] per spectral channel.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Linear interpolation is used between the two nearest temperature grid points. The function does not extrapolate beyond the tabulated temperature range.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid.">locate_reg</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03836">3836</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3840</span>               {</div>
<div class="line"><span class="lineno"> 3841</span> </div>
<div class="line"><span class="lineno"> 3842</span>  <span class="comment">/* Determine index in temperature array... */</span></div>
<div class="line"><span class="lineno"> 3843</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> it = <a class="code hl_function" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#acbbff4883292be53dfee5ec3258e0bed">st</a>, <a class="code hl_define" href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">TBLNS</a>, t);</div>
<div class="line"><span class="lineno"> 3844</span> </div>
<div class="line"><span class="lineno"> 3845</span>  <span class="comment">/* Interpolate Planck function value... */</span></div>
<div class="line"><span class="lineno"> 3846</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 3847</span>    src[<span class="keywordtype">id</span>] = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#acbbff4883292be53dfee5ec3258e0bed">st</a>[it], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a0829f62f18df6865078916867fb45049">sr</a>[it][<span class="keywordtype">id</span>],</div>
<div class="line"><span class="lineno"> 3848</span>                  tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#acbbff4883292be53dfee5ec3258e0bed">st</a>[it + 1], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a0829f62f18df6865078916867fb45049">sr</a>[it + 1][<span class="keywordtype">id</span>], t);</div>
<div class="line"><span class="lineno"> 3849</span>}</div>
<div class="ttc" id="ajurassic_8h_html_acc1bfd45871746b198d5db5cd89beb63"><div class="ttname"><a href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">TBLNS</a></div><div class="ttdeci">#define TBLNS</div><div class="ttdoc">Maximum number of source function temperature levels.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00317">jurassic.h:317</a></div></div>
<div class="ttc" id="astructtbl__t_html_a0829f62f18df6865078916867fb45049"><div class="ttname"><a href="structtbl__t.html#a0829f62f18df6865078916867fb45049">tbl_t::sr</a></div><div class="ttdeci">double sr[TBLNS][ND]</div><div class="ttdoc">Source function radiance [W/(m^2 sr cm^-1)].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01438">jurassic.h:1438</a></div></div>
<div class="ttc" id="astructtbl__t_html_acbbff4883292be53dfee5ec3258e0bed"><div class="ttname"><a href="structtbl__t.html#acbbff4883292be53dfee5ec3258e0bed">tbl_t::st</a></div><div class="ttdeci">double st[TBLNS]</div><div class="ttdoc">Source function temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01435">jurassic.h:1435</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_ac7826de16feb2eb6730b661bf8deba90_cgraph.png" border="0" usemap="#ajurassic_8h_ac7826de16feb2eb6730b661bf8deba90_cgraph" alt=""/></div>
<map name="ajurassic_8h_ac7826de16feb2eb6730b661bf8deba90_cgraph" id="ajurassic_8h_ac7826de16feb2eb6730b661bf8deba90_cgraph">
<area shape="rect" title="Interpolate the source function (Planck radiance) at a given temperature." alt="" coords="5,5,117,32"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="165,5,248,32"/>
</map>
</div>

</div>
</div>
<a id="ae3aea782dfca9019f3f2d169f8cc0f6d" name="ae3aea782dfca9019f3f2d169f8cc0f6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3aea782dfca9019f3f2d169f8cc0f6d">&#9670;&nbsp;</a></span>geo2cart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void geo2cart </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates. </p>
<p >This function converts geographic coordinates specified by longitude, latitude, and altitude into Cartesian coordinates. The Earth is approximated as a sphere with radius defined by the constant <code>RE</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td>The altitude above the Earth's surface in kilometers. </td></tr>
    <tr><td class="paramname">lon</td><td>The longitude in degrees. </td></tr>
    <tr><td class="paramname">lat</td><td>The latitude in degrees. </td></tr>
    <tr><td class="paramname">x</td><td>Pointer to an array of three doubles where the computed Cartesian coordinates (x, y, z) will be stored.</td></tr>
  </table>
  </dd>
</dl>
<p>The function computes the Cartesian coordinates using the given altitude, longitude, and latitude. It assumes the Earth is a perfect sphere and uses the following formulas:</p><ul>
<li>\( x = (\textrm{radius}) \cos(\textrm{lat in radians}) \cos(\textrm{lon in radians}) \)</li>
<li>\( y = (\textrm{radius}) \cos(\textrm{lat in radians}) \sin(\textrm{lon in radians}) \)</li>
<li>\( z = (\textrm{radius}) \sin(\textrm{lat in radians}) \)</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The constant <code>RE</code> is defined as the Earth's radius in kilometers. </dd>
<dd>
Longitude and latitude should be in degrees.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://en.wikipedia.org/wiki/Geographic_coordinate_conversion">https://en.wikipedia.org/wiki/Geographic_coordinate_conversion</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03853">3853</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3857</span>             {</div>
<div class="line"><span class="lineno"> 3858</span> </div>
<div class="line"><span class="lineno"> 3859</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> radius = z + <a class="code hl_define" href="jurassic_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a>;</div>
<div class="line"><span class="lineno"> 3860</span> </div>
<div class="line"><span class="lineno"> 3861</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> latrad = lat / 180. * M_PI;</div>
<div class="line"><span class="lineno"> 3862</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> lonrad = lon / 180. * M_PI;</div>
<div class="line"><span class="lineno"> 3863</span> </div>
<div class="line"><span class="lineno"> 3864</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> coslat = cos(latrad);</div>
<div class="line"><span class="lineno"> 3865</span> </div>
<div class="line"><span class="lineno"> 3866</span>  x[0] = radius * coslat * cos(lonrad);</div>
<div class="line"><span class="lineno"> 3867</span>  x[1] = radius * coslat * sin(lonrad);</div>
<div class="line"><span class="lineno"> 3868</span>  x[2] = radius * sin(latrad);</div>
<div class="line"><span class="lineno"> 3869</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad69ab6edb8f722212fb01e12d8809643" name="ad69ab6edb8f722212fb01e12d8809643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad69ab6edb8f722212fb01e12d8809643">&#9670;&nbsp;</a></span>hydrostatic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hydrostatic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjust pressure profile using the hydrostatic equation. </p>
<p >Recomputes the atmospheric pressure field to ensure hydrostatic equilibrium with respect to altitude and temperature. Starting from a reference altitude (<a class="el" href="structctl__t.html#a3fd78306de446288abde8209472e8b51">ctl_t::hydz</a>), the routine integrates the hydrostatic balance equation both upward and downward through the profile using small interpolation steps.</p>
<p >The air density is corrected for humidity using the mean molecular mass of dry air and water vapor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure providing model constants and reference altitude (<a class="el" href="structctl__t.html#a3fd78306de446288abde8209472e8b51">ctl_t::hydz</a>) and HO index (<a class="el" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ctl_t::ig_h2o</a>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atm</td><td>Atmospheric state; input temperatures, heights, and humidities are used to update pressure [hPa].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The integration is performed in log-pressure space assuming hydrostatic balance: \( \frac{dp}{dz} = -\rho g \), <br  />
 using 20 linear substeps between adjacent levels.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a6440afc9207bc5eba00d9161ff744e16" title="Standard gravity [m/s^2].">G0</a>, <a class="el" href="jurassic_8h.html#a7e71def3baefc10ec36f1dd48da4050e" title="Ideal gas constant [J/(mol K)].">RI</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03873">3873</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3875</span>              {</div>
<div class="line"><span class="lineno"> 3876</span> </div>
<div class="line"><span class="lineno"> 3877</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> mmair = 28.96456e-3, mmh2o = 18.0153e-3;</div>
<div class="line"><span class="lineno"> 3878</span> </div>
<div class="line"><span class="lineno"> 3879</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ipts = 20;</div>
<div class="line"><span class="lineno"> 3880</span> </div>
<div class="line"><span class="lineno"> 3881</span>  <span class="keywordtype">double</span> dzmin = 1e99, e = 0;</div>
<div class="line"><span class="lineno"> 3882</span> </div>
<div class="line"><span class="lineno"> 3883</span>  <span class="keywordtype">int</span> ipref = 0;</div>
<div class="line"><span class="lineno"> 3884</span> </div>
<div class="line"><span class="lineno"> 3885</span>  <span class="comment">/* Check reference height... */</span></div>
<div class="line"><span class="lineno"> 3886</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3fd78306de446288abde8209472e8b51">hydz</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 3887</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3888</span> </div>
<div class="line"><span class="lineno"> 3889</span>  <span class="comment">/* Find air parcel next to reference height... */</span></div>
<div class="line"><span class="lineno"> 3890</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 3891</span>    <span class="keywordflow">if</span> (fabs(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3fd78306de446288abde8209472e8b51">hydz</a>) &lt; dzmin) {</div>
<div class="line"><span class="lineno"> 3892</span>      dzmin = fabs(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3fd78306de446288abde8209472e8b51">hydz</a>);</div>
<div class="line"><span class="lineno"> 3893</span>      ipref = ip;</div>
<div class="line"><span class="lineno"> 3894</span>    }</div>
<div class="line"><span class="lineno"> 3895</span> </div>
<div class="line"><span class="lineno"> 3896</span>  <span class="comment">/* Upper part of profile... */</span></div>
<div class="line"><span class="lineno"> 3897</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = ipref + 1; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 3898</span>    <span class="keywordtype">double</span> mean = 0;</div>
<div class="line"><span class="lineno"> 3899</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ipts; i++) {</div>
<div class="line"><span class="lineno"> 3900</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3901</span>        e = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(0.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a>][ip - 1],</div>
<div class="line"><span class="lineno"> 3902</span>                ipts - 1.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a>][ip], (<span class="keywordtype">double</span>) i);</div>
<div class="line"><span class="lineno"> 3903</span>      mean += (e * mmh2o + (1 - e) * mmair)</div>
<div class="line"><span class="lineno"> 3904</span>        * <a class="code hl_define" href="jurassic_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> / <a class="code hl_define" href="jurassic_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a></div>
<div class="line"><span class="lineno"> 3905</span>        / <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(0.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip - 1], ipts - 1.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip], (<span class="keywordtype">double</span>) i) / ipts;</div>
<div class="line"><span class="lineno"> 3906</span>    }</div>
<div class="line"><span class="lineno"> 3907</span> </div>
<div class="line"><span class="lineno"> 3908</span>    <span class="comment">/* Compute p(z,T)... */</span></div>
<div class="line"><span class="lineno"> 3909</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] =</div>
<div class="line"><span class="lineno"> 3910</span>      exp(log(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip - 1]) - mean * 1000 * (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] - atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip - 1]));</div>
<div class="line"><span class="lineno"> 3911</span>  }</div>
<div class="line"><span class="lineno"> 3912</span> </div>
<div class="line"><span class="lineno"> 3913</span>  <span class="comment">/* Lower part of profile... */</span></div>
<div class="line"><span class="lineno"> 3914</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = ipref - 1; ip &gt;= 0; ip--) {</div>
<div class="line"><span class="lineno"> 3915</span>    <span class="keywordtype">double</span> mean = 0;</div>
<div class="line"><span class="lineno"> 3916</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ipts; i++) {</div>
<div class="line"><span class="lineno"> 3917</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3918</span>        e = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(0.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a>][ip + 1],</div>
<div class="line"><span class="lineno"> 3919</span>                ipts - 1.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a>][ip], (<span class="keywordtype">double</span>) i);</div>
<div class="line"><span class="lineno"> 3920</span>      mean += (e * mmh2o + (1 - e) * mmair)</div>
<div class="line"><span class="lineno"> 3921</span>        * <a class="code hl_define" href="jurassic_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> / <a class="code hl_define" href="jurassic_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a></div>
<div class="line"><span class="lineno"> 3922</span>        / <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(0.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip + 1], ipts - 1.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip], (<span class="keywordtype">double</span>) i) / ipts;</div>
<div class="line"><span class="lineno"> 3923</span>    }</div>
<div class="line"><span class="lineno"> 3924</span> </div>
<div class="line"><span class="lineno"> 3925</span>    <span class="comment">/* Compute p(z,T)... */</span></div>
<div class="line"><span class="lineno"> 3926</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] =</div>
<div class="line"><span class="lineno"> 3927</span>      exp(log(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip + 1]) - mean * 1000 * (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] - atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip + 1]));</div>
<div class="line"><span class="lineno"> 3928</span>  }</div>
<div class="line"><span class="lineno"> 3929</span>}</div>
<div class="ttc" id="ajurassic_8h_html_a6440afc9207bc5eba00d9161ff744e16"><div class="ttname"><a href="jurassic_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a></div><div class="ttdeci">#define G0</div><div class="ttdoc">Standard gravity [m/s^2].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00148">jurassic.h:148</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a7e71def3baefc10ec36f1dd48da4050e"><div class="ttname"><a href="jurassic_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a></div><div class="ttdeci">#define RI</div><div class="ttdoc">Ideal gas constant [J/(mol K)].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00193">jurassic.h:193</a></div></div>
<div class="ttc" id="astructctl__t_html_a3fd78306de446288abde8209472e8b51"><div class="ttname"><a href="structctl__t.html#a3fd78306de446288abde8209472e8b51">ctl_t::hydz</a></div><div class="ttdeci">double hydz</div><div class="ttdoc">Reference height for hydrostatic pressure profile (-999 to skip) [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01114">jurassic.h:1114</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a342f4954ef3678480cae2efb366a7b3e" name="a342f4954ef3678480cae2efb366a7b3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342f4954ef3678480cae2efb366a7b3e">&#9670;&nbsp;</a></span>idx2name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void idx2name </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>quantity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a quantity index to a descriptive name string. </p>
<p >Translates a model quantity index (e.g., pressure, temperature, gas mixing ratio, extinction, or surface parameter) into a human-readable name. The function uses the index mapping defined in the control structure to assign appropriate labels.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure containing gas, window, cloud, and surface setup information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>Quantity index (see <a class="el" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a>, <a class="el" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a>, <a class="el" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a>, <a class="el" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a>, etc.). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">quantity</td><td>Character buffer to receive the descriptive quantity name (e.g., "PRESSURE", "H2O", "CLOUD_HEIGHT", "SURFACE_EMISSIVITY_1000.0").</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function writes directly to <code>quantity</code> using <code>sprintf()</code>. The caller must ensure sufficient buffer size ( LEN).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924" title="Index for pressure.">IDXP</a>, <a class="el" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70" title="Index for temperature.">IDXT</a>, <a class="el" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc" title="Indices for volume mixing ratios.">IDXQ</a>, <a class="el" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6" title="Indices for extinction.">IDXK</a>, <a class="el" href="jurassic_8h.html#a04eaf14380553f171f54680560527fe5" title="Index for cloud layer height.">IDXCLZ</a>, <a class="el" href="jurassic_8h.html#a3b420330ad2457758ef539d8c9e0bd99" title="Index for cloud layer depth.">IDXCLDZ</a>, <a class="el" href="jurassic_8h.html#a809f947437669a6b3930302f30375d41" title="Indices for cloud layer extinction.">IDXCLK</a>, <a class="el" href="jurassic_8h.html#a7abc6f3d1a1993a0337a736d79cf6ecc" title="Index for surface layer temperature.">IDXSFT</a>, <a class="el" href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35" title="Indices for surface layer emissivity.">IDXSFEPS</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03933">3933</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3936</span>                  {</div>
<div class="line"><span class="lineno"> 3937</span> </div>
<div class="line"><span class="lineno"> 3938</span>  <span class="keywordflow">if</span> (idx == <a class="code hl_define" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a>)</div>
<div class="line"><span class="lineno"> 3939</span>    sprintf(quantity, <span class="stringliteral">&quot;PRESSURE&quot;</span>);</div>
<div class="line"><span class="lineno"> 3940</span> </div>
<div class="line"><span class="lineno"> 3941</span>  <span class="keywordflow">if</span> (idx == <a class="code hl_define" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a>)</div>
<div class="line"><span class="lineno"> 3942</span>    sprintf(quantity, <span class="stringliteral">&quot;TEMPERATURE&quot;</span>);</div>
<div class="line"><span class="lineno"> 3943</span> </div>
<div class="line"><span class="lineno"> 3944</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 3945</span>    <span class="keywordflow">if</span> (idx == <a class="code hl_define" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a>(ig))</div>
<div class="line"><span class="lineno"> 3946</span>      sprintf(quantity, <span class="stringliteral">&quot;%s&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 3947</span> </div>
<div class="line"><span class="lineno"> 3948</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 3949</span>    <span class="keywordflow">if</span> (idx == <a class="code hl_define" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a>(iw))</div>
<div class="line"><span class="lineno"> 3950</span>      sprintf(quantity, <span class="stringliteral">&quot;EXTINCT_WINDOW_%d&quot;</span>, iw);</div>
<div class="line"><span class="lineno"> 3951</span> </div>
<div class="line"><span class="lineno"> 3952</span>  <span class="keywordflow">if</span> (idx == <a class="code hl_define" href="jurassic_8h.html#a04eaf14380553f171f54680560527fe5">IDXCLZ</a>)</div>
<div class="line"><span class="lineno"> 3953</span>    sprintf(quantity, <span class="stringliteral">&quot;CLOUD_HEIGHT&quot;</span>);</div>
<div class="line"><span class="lineno"> 3954</span> </div>
<div class="line"><span class="lineno"> 3955</span>  <span class="keywordflow">if</span> (idx == <a class="code hl_define" href="jurassic_8h.html#a3b420330ad2457758ef539d8c9e0bd99">IDXCLDZ</a>)</div>
<div class="line"><span class="lineno"> 3956</span>    sprintf(quantity, <span class="stringliteral">&quot;CLOUD_DEPTH&quot;</span>);</div>
<div class="line"><span class="lineno"> 3957</span> </div>
<div class="line"><span class="lineno"> 3958</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 3959</span>    <span class="keywordflow">if</span> (idx == <a class="code hl_define" href="jurassic_8h.html#a809f947437669a6b3930302f30375d41">IDXCLK</a>(icl))</div>
<div class="line"><span class="lineno"> 3960</span>      sprintf(quantity, <span class="stringliteral">&quot;CLOUD_EXTINCT_%.4f&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f3c54e7d6c87fe31e3bd0f54df1fdf0">clnu</a>[icl]);</div>
<div class="line"><span class="lineno"> 3961</span> </div>
<div class="line"><span class="lineno"> 3962</span>  <span class="keywordflow">if</span> (idx == <a class="code hl_define" href="jurassic_8h.html#a7abc6f3d1a1993a0337a736d79cf6ecc">IDXSFT</a>)</div>
<div class="line"><span class="lineno"> 3963</span>    sprintf(quantity, <span class="stringliteral">&quot;SURFACE_TEMPERATURE&quot;</span>);</div>
<div class="line"><span class="lineno"> 3964</span> </div>
<div class="line"><span class="lineno"> 3965</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 3966</span>    <span class="keywordflow">if</span> (idx == <a class="code hl_define" href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35">IDXSFEPS</a>(isf))</div>
<div class="line"><span class="lineno"> 3967</span>      sprintf(quantity, <span class="stringliteral">&quot;SURFACE_EMISSIVITY_%.4f&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a29804fac77623ca3d1e32f92955ac501">sfnu</a>[isf]);</div>
<div class="line"><span class="lineno"> 3968</span>}</div>
<div class="ttc" id="astructctl__t_html_a29804fac77623ca3d1e32f92955ac501"><div class="ttname"><a href="structctl__t.html#a29804fac77623ca3d1e32f92955ac501">ctl_t::sfnu</a></div><div class="ttdeci">double sfnu[NSF]</div><div class="ttdoc">Surface layer wavenumber [cm^-1].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01093">jurassic.h:1093</a></div></div>
<div class="ttc" id="astructctl__t_html_a7f3c54e7d6c87fe31e3bd0f54df1fdf0"><div class="ttname"><a href="structctl__t.html#a7f3c54e7d6c87fe31e3bd0f54df1fdf0">ctl_t::clnu</a></div><div class="ttdeci">double clnu[NCL]</div><div class="ttdoc">Cloud layer wavenumber [cm^-1].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01087">jurassic.h:1087</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6852ec1675d0539a21df1fc4ecee1f0" name="ab6852ec1675d0539a21df1fc4ecee1f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6852ec1675d0539a21df1fc4ecee1f0">&#9670;&nbsp;</a></span>init_srcfunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_srcfunc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the source-function (Planck radiance) lookup table. </p>
<p >Computes channel-averaged Planck radiances for a range of temperatures and stores them in the source-function table. For each spectral channel, the Planck function is integrated over the instrument filter function defined in the corresponding filter file (*.filt).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining spectral channels and table base name. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tbl</td><td>Emissivity and source-function lookup table to populate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The source function is tabulated for <a class="el" href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">TBLNS</a> temperature levels uniformly distributed between <a class="el" href="jurassic_8h.html#af7e87bb3f38e7b4eed703578b90cd3a4">TMIN</a> and <a class="el" href="jurassic_8h.html#af7a16e2716eaac90fb331c55876cf511">TMAX</a>. Integration over the spectral response is performed using linear interpolation and uniform grid spacing.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a>, <a class="el" href="jurassic_8h.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two-column shape function from an ASCII file.">read_shape</a>, <a class="el" href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid.">locate_irr</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee" title="Compute spectral radiance using Plancks law.">PLANCK</a>, <a class="el" href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63" title="Maximum number of source function temperature levels.">TBLNS</a>, <a class="el" href="jurassic_8h.html#af7e87bb3f38e7b4eed703578b90cd3a4" title="Minimum temperature for source function [K].">TMIN</a>, <a class="el" href="jurassic_8h.html#af7a16e2716eaac90fb331c55876cf511" title="Maximum temperature for source function [K].">TMAX</a></dd></dl>
<dl class="section user"><dt>Parallelization</dt><dd>Implemented with OpenMP to compute each temperature level concurrently.</dd></dl>
<dl class="section user"><dt>Output</dt><dd>Writes diagnostic information via <a class="el" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a> at verbosity levels 1 and 2.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Requires valid filter files named <code>&lt;tblbase&gt;_&lt;wavenumber&gt;.filt</code>.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l03972">3972</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3974</span>              {</div>
<div class="line"><span class="lineno"> 3975</span> </div>
<div class="line"><span class="lineno"> 3976</span>  <span class="keywordtype">char</span> filename[2 * <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 3977</span> </div>
<div class="line"><span class="lineno"> 3978</span>  <span class="keywordtype">double</span> f[<a class="code hl_define" href="jurassic_8h.html#a7705bd290b81177c733651a18441be93">NSHAPE</a>], nu[<a class="code hl_define" href="jurassic_8h.html#a7705bd290b81177c733651a18441be93">NSHAPE</a>];</div>
<div class="line"><span class="lineno"> 3979</span> </div>
<div class="line"><span class="lineno"> 3980</span>  <span class="keywordtype">int</span> n;</div>
<div class="line"><span class="lineno"> 3981</span> </div>
<div class="line"><span class="lineno"> 3982</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 3983</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Initialize source function table...&quot;</span>);</div>
<div class="line"><span class="lineno"> 3984</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of data points: %d&quot;</span>, <a class="code hl_define" href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">TBLNS</a>);</div>
<div class="line"><span class="lineno"> 3985</span> </div>
<div class="line"><span class="lineno"> 3986</span>  <span class="comment">/* Loop over channels... */</span></div>
<div class="line"><span class="lineno"> 3987</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 3988</span> </div>
<div class="line"><span class="lineno"> 3989</span>    <span class="comment">/* Read filter function... */</span></div>
<div class="line"><span class="lineno"> 3990</span>    sprintf(filename, <span class="stringliteral">&quot;%s_%.4f.filt&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">tblbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 3991</span>    <a class="code hl_function" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd">read_shape</a>(filename, nu, f, &amp;n);</div>
<div class="line"><span class="lineno"> 3992</span> </div>
<div class="line"><span class="lineno"> 3993</span>    <span class="comment">/* Get minimum grid spacing... */</span></div>
<div class="line"><span class="lineno"> 3994</span>    <span class="keywordtype">double</span> dnu = 1.0;</div>
<div class="line"><span class="lineno"> 3995</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; n; i++)</div>
<div class="line"><span class="lineno"> 3996</span>      dnu = <a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(dnu, nu[i] - nu[i - 1]);</div>
<div class="line"><span class="lineno"> 3997</span> </div>
<div class="line"><span class="lineno"> 3998</span>    <span class="comment">/* Compute source function table... */</span></div>
<div class="line"><span class="lineno"> 3999</span><span class="preprocessor">#pragma omp parallel for default(none) shared(ctl,tbl,id,nu,f,n,dnu)</span></div>
<div class="line"><span class="lineno"> 4000</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 0; it &lt; <a class="code hl_define" href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">TBLNS</a>; it++) {</div>
<div class="line"><span class="lineno"> 4001</span> </div>
<div class="line"><span class="lineno"> 4002</span>      <span class="comment">/* Set temperature... */</span></div>
<div class="line"><span class="lineno"> 4003</span>      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#acbbff4883292be53dfee5ec3258e0bed">st</a>[it] = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(0.0, <a class="code hl_define" href="jurassic_8h.html#af7e87bb3f38e7b4eed703578b90cd3a4">TMIN</a>, <a class="code hl_define" href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">TBLNS</a> - 1.0, <a class="code hl_define" href="jurassic_8h.html#af7a16e2716eaac90fb331c55876cf511">TMAX</a>, (<span class="keywordtype">double</span>) it);</div>
<div class="line"><span class="lineno"> 4004</span> </div>
<div class="line"><span class="lineno"> 4005</span>      <span class="comment">/* Integrate Planck function... */</span></div>
<div class="line"><span class="lineno"> 4006</span>      <span class="keywordtype">double</span> fsum = tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a0829f62f18df6865078916867fb45049">sr</a>[it][id] = 0;</div>
<div class="line"><span class="lineno"> 4007</span>      <span class="keywordflow">for</span> (<span class="keywordtype">double</span> fnu = nu[0]; fnu &lt;= nu[n - 1]; fnu += dnu) {</div>
<div class="line"><span class="lineno"> 4008</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> i = <a class="code hl_function" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(nu, n, fnu);</div>
<div class="line"><span class="lineno"> 4009</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> ff = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(nu[i], f[i], nu[i + 1], f[i + 1], fnu);</div>
<div class="line"><span class="lineno"> 4010</span>        fsum += ff;</div>
<div class="line"><span class="lineno"> 4011</span>        tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a0829f62f18df6865078916867fb45049">sr</a>[it][id] += ff * <a class="code hl_define" href="jurassic_8h.html#ab737f801dafc49850e131f6a42cd45ee">PLANCK</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#acbbff4883292be53dfee5ec3258e0bed">st</a>[it], fnu);</div>
<div class="line"><span class="lineno"> 4012</span>      }</div>
<div class="line"><span class="lineno"> 4013</span>      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a0829f62f18df6865078916867fb45049">sr</a>[it][id] /= fsum;</div>
<div class="line"><span class="lineno"> 4014</span>    }</div>
<div class="line"><span class="lineno"> 4015</span> </div>
<div class="line"><span class="lineno"> 4016</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 4017</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2,</div>
<div class="line"><span class="lineno"> 4018</span>        <span class="stringliteral">&quot;channel= %.4f cm^-1 | T= %g ... %g K | B= %g ... %g W/(m^2 sr cm^-1)&quot;</span>,</div>
<div class="line"><span class="lineno"> 4019</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#acbbff4883292be53dfee5ec3258e0bed">st</a>[0], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#acbbff4883292be53dfee5ec3258e0bed">st</a>[<a class="code hl_define" href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">TBLNS</a> - 1], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a0829f62f18df6865078916867fb45049">sr</a>[0][<span class="keywordtype">id</span>],</div>
<div class="line"><span class="lineno"> 4020</span>        tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a0829f62f18df6865078916867fb45049">sr</a>[<a class="code hl_define" href="jurassic_8h.html#acc1bfd45871746b198d5db5cd89beb63">TBLNS</a> - 1][<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 4021</span>  }</div>
<div class="line"><span class="lineno"> 4022</span>}</div>
<div class="ttc" id="ajurassic_8h_html_acaa1c3fa56061380a29889d703236251"><div class="ttname"><a href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a></div><div class="ttdeci">#define LOG(level,...)</div><div class="ttdoc">Print a log message with a specified logging level.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00878">jurassic.h:878</a></div></div>
<div class="ttc" id="ajurassic_8h_html_af7a16e2716eaac90fb331c55876cf511"><div class="ttname"><a href="jurassic_8h.html#af7a16e2716eaac90fb331c55876cf511">TMAX</a></div><div class="ttdeci">#define TMAX</div><div class="ttdoc">Maximum temperature for source function [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00208">jurassic.h:208</a></div></div>
<div class="ttc" id="ajurassic_8h_html_af7e87bb3f38e7b4eed703578b90cd3a4"><div class="ttname"><a href="jurassic_8h.html#af7e87bb3f38e7b4eed703578b90cd3a4">TMIN</a></div><div class="ttdeci">#define TMIN</div><div class="ttdoc">Minimum temperature for source function [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00203">jurassic.h:203</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_ab6852ec1675d0539a21df1fc4ecee1f0_cgraph.png" border="0" usemap="#ajurassic_8h_ab6852ec1675d0539a21df1fc4ecee1f0_cgraph" alt=""/></div>
<map name="ajurassic_8h_ab6852ec1675d0539a21df1fc4ecee1f0_cgraph" id="ajurassic_8h_ab6852ec1675d0539a21df1fc4ecee1f0_cgraph">
<area shape="rect" title="Initialize the source&#45;function (Planck radiance) lookup table." alt="" coords="5,31,95,57"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="150,5,225,32"/>
<area shape="rect" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two&#45;column shape function from an ASCII file." alt="" coords="143,56,232,83"/>
</map>
</div>

</div>
</div>
<a id="a82151ea4448e70f46f7f3b770bb77612" name="a82151ea4448e70f46f7f3b770bb77612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82151ea4448e70f46f7f3b770bb77612">&#9670;&nbsp;</a></span>intpol_atm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_atm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate atmospheric state variables at a given altitude. </p>
<p >Computes pressure, temperature, volume mixing ratios, and extinction coefficients at the specified altitude by interpolating between adjacent model levels in the atmospheric profile.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining the number of gases (<a class="el" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ctl_t::ng</a>) and spectral windows (<a class="el" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">ctl_t::nw</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Atmospheric profile providing altitude, pressure, temperature, gas mixing ratios, and extinction data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Target altitude [km]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p</td><td>Interpolated pressure [hPa]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">t</td><td>Interpolated temperature [K]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">q</td><td>Interpolated gas volume mixing ratios [ppv], length <a class="el" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ctl_t::ng</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">k</td><td>Interpolated extinction coefficients [km], length <a class="el" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">ctl_t::nw</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Pressure is interpolated logarithmically using <a class="el" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca">LOGY</a>, while other quantities use linear interpolation (<a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a>, <a class="el" href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid.">locate_irr</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca" title="Compute logarithmic interpolation in y.">LOGY</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04026">4026</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4033</span>             {</div>
<div class="line"><span class="lineno"> 4034</span> </div>
<div class="line"><span class="lineno"> 4035</span>  <span class="comment">/* Get array index... */</span></div>
<div class="line"><span class="lineno"> 4036</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ip = <a class="code hl_function" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, z);</div>
<div class="line"><span class="lineno"> 4037</span> </div>
<div class="line"><span class="lineno"> 4038</span>  <span class="comment">/* Interpolate... */</span></div>
<div class="line"><span class="lineno"> 4039</span>  *p = <a class="code hl_define" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca">LOGY</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip + 1], z);</div>
<div class="line"><span class="lineno"> 4040</span>  *t = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip + 1], z);</div>
<div class="line"><span class="lineno"> 4041</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 4042</span>    q[ig] =</div>
<div class="line"><span class="lineno"> 4043</span>      <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip + 1], z);</div>
<div class="line"><span class="lineno"> 4044</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 4045</span>    k[iw] =</div>
<div class="line"><span class="lineno"> 4046</span>      <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip + 1], z);</div>
<div class="line"><span class="lineno"> 4047</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a82151ea4448e70f46f7f3b770bb77612_cgraph.png" border="0" usemap="#ajurassic_8h_a82151ea4448e70f46f7f3b770bb77612_cgraph" alt=""/></div>
<map name="ajurassic_8h_a82151ea4448e70f46f7f3b770bb77612_cgraph" id="ajurassic_8h_a82151ea4448e70f46f7f3b770bb77612_cgraph">
<area shape="rect" title="Interpolate atmospheric state variables at a given altitude." alt="" coords="5,5,88,32"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="136,5,211,32"/>
</map>
</div>

</div>
</div>
<a id="a5e22cd63c35ef6e2c9b9023e2c3945d8" name="a5e22cd63c35ef6e2c9b9023e2c3945d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e22cd63c35ef6e2c9b9023e2c3945d8">&#9670;&nbsp;</a></span>intpol_tbl_cga()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_tbl_cga </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structlos__t.html">los_t</a> *&#160;</td>
          <td class="paramname"><em>los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_path</em>[ND][NG], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_seg</em>[ND]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate emissivities and transmittances using the CurtisGodson approximation (CGA). </p>
<p >Computes gas transmittance along a line-of-sight segment by interpolating precomputed emissivity values from lookup tables. The interpolation is performed in pressure, temperature, and column density space using bilinear (in p, T) and logarithmic (in p) interpolation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining number of gases (<a class="el" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ctl_t::ng</a>) and channels (<a class="el" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">ctl_t::nd</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbl</td><td>Emissivity lookup tables (<a class="el" href="structtbl__t.html">tbl_t</a>) containing tabulated pressure, temperature, and column density grids. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">los</td><td>Line-of-sight structure providing CurtisGodson mean parameters and column densities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Index of the current LOS point. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tau_path</td><td>Path transmittance array [nd][ng]; updated cumulatively for each gas. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tau_seg</td><td>Total segment transmittance per channel [nd].</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Uses pretabulated emissivity data (<code>tbl-&gt;eps</code>) for each gas and channel.</li>
<li>Applies logarithmic interpolation in pressure (<a class="el" href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3">LOGX</a>) and linear interpolation in temperature (<a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>).</li>
<li>Enforces emissivity limits in the range [0, 1].</li>
<li>Returns unity transmittance if data are missing or column density  0.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a>, <a class="el" href="structlos__t.html" title="Line-of-sight data.">los_t</a>, <a class="el" href="jurassic_8h.html#a7683ce6b4628d0d910fdb9d360e2022a" title="Interpolate emissivity from lookup tables as a function of column density.">intpol_tbl_eps</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3" title="Compute logarithmic interpolation in x.">LOGX</a>, <a class="el" href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid.">locate_irr</a>, <a class="el" href="jurassic_8h.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid.">locate_reg</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04051">4051</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4057</span>                      {</div>
<div class="line"><span class="lineno"> 4058</span> </div>
<div class="line"><span class="lineno"> 4059</span>  <span class="keywordtype">double</span> eps;</div>
<div class="line"><span class="lineno"> 4060</span> </div>
<div class="line"><span class="lineno"> 4061</span>  <span class="comment">/* Loop over channels... */</span></div>
<div class="line"><span class="lineno"> 4062</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 4063</span> </div>
<div class="line"><span class="lineno"> 4064</span>    <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 4065</span>    tau_seg[id] = 1;</div>
<div class="line"><span class="lineno"> 4066</span> </div>
<div class="line"><span class="lineno"> 4067</span>    <span class="comment">/* Loop over emitters.... */</span></div>
<div class="line"><span class="lineno"> 4068</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 4069</span> </div>
<div class="line"><span class="lineno"> 4070</span>      <span class="comment">/* Check size of table (pressure) and column density... */</span></div>
<div class="line"><span class="lineno"> 4071</span>      <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig] &lt; 30 || los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig] &lt;= 0)</div>
<div class="line"><span class="lineno"> 4072</span>        eps = 0;</div>
<div class="line"><span class="lineno"> 4073</span> </div>
<div class="line"><span class="lineno"> 4074</span>      <span class="comment">/* Check transmittance... */</span></div>
<div class="line"><span class="lineno"> 4075</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tau_path[<span class="keywordtype">id</span>][ig] &lt; 1e-9)</div>
<div class="line"><span class="lineno"> 4076</span>        eps = 1;</div>
<div class="line"><span class="lineno"> 4077</span> </div>
<div class="line"><span class="lineno"> 4078</span>      <span class="comment">/* Interpolate... */</span></div>
<div class="line"><span class="lineno"> 4079</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4080</span> </div>
<div class="line"><span class="lineno"> 4081</span>        <span class="comment">/* Determine pressure and temperature indices... */</span></div>
<div class="line"><span class="lineno"> 4082</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ipr =</div>
<div class="line"><span class="lineno"> 4083</span>          <a class="code hl_function" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig], los-&gt;<a class="code hl_variable" href="structlos__t.html#ae42d3b7f23d178426c006a6cd0adf923">cgp</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4084</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> it0 = <a class="code hl_function" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ipr],</div>
<div class="line"><span class="lineno"> 4085</span>                                   los-&gt;<a class="code hl_variable" href="structlos__t.html#a5ac900c2b42594489375f26f55e4c229">cgt</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4086</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> it1 =</div>
<div class="line"><span class="lineno"> 4087</span>          <a class="code hl_function" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr + 1], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ipr + 1],</div>
<div class="line"><span class="lineno"> 4088</span>                     los-&gt;<a class="code hl_variable" href="structlos__t.html#a5ac900c2b42594489375f26f55e4c229">cgt</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4089</span> </div>
<div class="line"><span class="lineno"> 4090</span>        <span class="comment">/* Check size of table (temperature and column density)... */</span></div>
<div class="line"><span class="lineno"> 4091</span>        <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ipr] &lt; 2 || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ipr + 1] &lt; 2</div>
<div class="line"><span class="lineno"> 4092</span>            || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ipr][it0] &lt; 2</div>
<div class="line"><span class="lineno"> 4093</span>            || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ipr][it0 + 1] &lt; 2</div>
<div class="line"><span class="lineno"> 4094</span>            || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ipr + 1][it1] &lt; 2</div>
<div class="line"><span class="lineno"> 4095</span>            || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ipr + 1][it1 + 1] &lt; 2)</div>
<div class="line"><span class="lineno"> 4096</span>          eps = 0;</div>
<div class="line"><span class="lineno"> 4097</span> </div>
<div class="line"><span class="lineno"> 4098</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4099</span> </div>
<div class="line"><span class="lineno"> 4100</span>          <span class="comment">/* Get emissivities of extended path... */</span></div>
<div class="line"><span class="lineno"> 4101</span>          <span class="keywordtype">double</span> eps00</div>
<div class="line"><span class="lineno"> 4102</span>            = <a class="code hl_function" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a>(tbl, ig, <span class="keywordtype">id</span>, ipr, it0, los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4103</span>          <span class="keywordtype">double</span> eps01 =</div>
<div class="line"><span class="lineno"> 4104</span>            <a class="code hl_function" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a>(tbl, ig, <span class="keywordtype">id</span>, ipr, it0 + 1, los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4105</span>          <span class="keywordtype">double</span> eps10 =</div>
<div class="line"><span class="lineno"> 4106</span>            <a class="code hl_function" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a>(tbl, ig, <span class="keywordtype">id</span>, ipr + 1, it1, los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4107</span>          <span class="keywordtype">double</span> eps11 =</div>
<div class="line"><span class="lineno"> 4108</span>            <a class="code hl_function" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a>(tbl, ig, <span class="keywordtype">id</span>, ipr + 1, it1 + 1, los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4109</span> </div>
<div class="line"><span class="lineno"> 4110</span>          <span class="comment">/* Interpolate with respect to temperature... */</span></div>
<div class="line"><span class="lineno"> 4111</span>          eps00 = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr][it0], eps00,</div>
<div class="line"><span class="lineno"> 4112</span>                      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr][it0 + 1], eps01, los-&gt;<a class="code hl_variable" href="structlos__t.html#a5ac900c2b42594489375f26f55e4c229">cgt</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4113</span>          eps11 = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr + 1][it1], eps10,</div>
<div class="line"><span class="lineno"> 4114</span>                      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr + 1][it1 + 1],</div>
<div class="line"><span class="lineno"> 4115</span>                      eps11, los-&gt;<a class="code hl_variable" href="structlos__t.html#a5ac900c2b42594489375f26f55e4c229">cgt</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4116</span> </div>
<div class="line"><span class="lineno"> 4117</span>          <span class="comment">/* Interpolate with respect to pressure... */</span></div>
<div class="line"><span class="lineno"> 4118</span>          eps00 = <a class="code hl_define" href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3">LOGX</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig][ipr], eps00,</div>
<div class="line"><span class="lineno"> 4119</span>                       tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig][ipr + 1], eps11, los-&gt;<a class="code hl_variable" href="structlos__t.html#ae42d3b7f23d178426c006a6cd0adf923">cgp</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4120</span> </div>
<div class="line"><span class="lineno"> 4121</span>          <span class="comment">/* Check emissivity range... */</span></div>
<div class="line"><span class="lineno"> 4122</span>          eps00 = <a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(eps00, 1), 0);</div>
<div class="line"><span class="lineno"> 4123</span> </div>
<div class="line"><span class="lineno"> 4124</span>          <span class="comment">/* Determine segment emissivity... */</span></div>
<div class="line"><span class="lineno"> 4125</span>          eps = 1 - (1 - eps00) / tau_path[<span class="keywordtype">id</span>][ig];</div>
<div class="line"><span class="lineno"> 4126</span>        }</div>
<div class="line"><span class="lineno"> 4127</span>      }</div>
<div class="line"><span class="lineno"> 4128</span> </div>
<div class="line"><span class="lineno"> 4129</span>      <span class="comment">/* Get transmittance of extended path... */</span></div>
<div class="line"><span class="lineno"> 4130</span>      tau_path[id][ig] *= (1 - eps);</div>
<div class="line"><span class="lineno"> 4131</span> </div>
<div class="line"><span class="lineno"> 4132</span>      <span class="comment">/* Get segment transmittance... */</span></div>
<div class="line"><span class="lineno"> 4133</span>      tau_seg[id] *= (1 - eps);</div>
<div class="line"><span class="lineno"> 4134</span>    }</div>
<div class="line"><span class="lineno"> 4135</span>  }</div>
<div class="line"><span class="lineno"> 4136</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a7683ce6b4628d0d910fdb9d360e2022a"><div class="ttname"><a href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a></div><div class="ttdeci">double intpol_tbl_eps(const tbl_t *tbl, const int ig, const int id, const int ip, const int it, const double u)</div><div class="ttdoc">Interpolate emissivity from lookup tables as a function of column density.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04236">jurassic.c:4236</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a870fa40d24bd17e7cc7ec906662047b3"><div class="ttname"><a href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3">LOGX</a></div><div class="ttdeci">#define LOGX(x0, y0, x1, y1, x)</div><div class="ttdoc">Compute logarithmic interpolation in x.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00569">jurassic.h:569</a></div></div>
<div class="ttc" id="astructlos__t_html_a0f2b75b236bd24e06006c1d8e4b091e8"><div class="ttname"><a href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">los_t::cgu</a></div><div class="ttdeci">double cgu[NLOS][NG]</div><div class="ttdoc">Curtis-Godson column density [molecules/cm^2].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01260">jurassic.h:1260</a></div></div>
<div class="ttc" id="astructlos__t_html_a5ac900c2b42594489375f26f55e4c229"><div class="ttname"><a href="structlos__t.html#a5ac900c2b42594489375f26f55e4c229">los_t::cgt</a></div><div class="ttdeci">double cgt[NLOS][NG]</div><div class="ttdoc">Curtis-Godson temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01257">jurassic.h:1257</a></div></div>
<div class="ttc" id="astructlos__t_html_ae42d3b7f23d178426c006a6cd0adf923"><div class="ttname"><a href="structlos__t.html#ae42d3b7f23d178426c006a6cd0adf923">los_t::cgp</a></div><div class="ttdeci">double cgp[NLOS][NG]</div><div class="ttdoc">Curtis-Godson pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01254">jurassic.h:1254</a></div></div>
<div class="ttc" id="astructtbl__t_html_a100378aeb57261da41b95604b10af6fd"><div class="ttname"><a href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">tbl_t::p</a></div><div class="ttdeci">double p[ND][NG][TBLNP]</div><div class="ttdoc">Pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01423">jurassic.h:1423</a></div></div>
<div class="ttc" id="astructtbl__t_html_a1675f08cd8ed441e415ec83b9bf010b3"><div class="ttname"><a href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">tbl_t::nu</a></div><div class="ttdeci">int nu[ND][NG][TBLNP][TBLNT]</div><div class="ttdoc">Number of column densities.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01420">jurassic.h:1420</a></div></div>
<div class="ttc" id="astructtbl__t_html_a454a107571770aaaf5cbdd9d6ee27aab"><div class="ttname"><a href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">tbl_t::nt</a></div><div class="ttdeci">int nt[ND][NG][TBLNP]</div><div class="ttdoc">Number of temperatures.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01417">jurassic.h:1417</a></div></div>
<div class="ttc" id="astructtbl__t_html_ab9ecd0fd977282440f479d0e01d6a2bc"><div class="ttname"><a href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">tbl_t::t</a></div><div class="ttdeci">double t[ND][NG][TBLNP][TBLNT]</div><div class="ttdoc">Temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01426">jurassic.h:1426</a></div></div>
<div class="ttc" id="astructtbl__t_html_adc68798047aad09d90b16c84aba2117c"><div class="ttname"><a href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">tbl_t::np</a></div><div class="ttdeci">int np[ND][NG]</div><div class="ttdoc">Number of pressure levels.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01414">jurassic.h:1414</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a5e22cd63c35ef6e2c9b9023e2c3945d8_cgraph.png" border="0" usemap="#ajurassic_8h_a5e22cd63c35ef6e2c9b9023e2c3945d8_cgraph" alt=""/></div>
<map name="ajurassic_8h_a5e22cd63c35ef6e2c9b9023e2c3945d8_cgraph" id="ajurassic_8h_a5e22cd63c35ef6e2c9b9023e2c3945d8_cgraph">
<area shape="rect" title="Interpolate emissivities and transmittances using the CurtisGodson approximation (CGA)." alt="" coords="5,56,108,83"/>
<area shape="rect" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a" title="Interpolate emissivity from lookup tables as a function of column density." alt="" coords="156,5,259,32"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="170,56,245,83"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="166,107,249,133"/>
<area shape="rect" href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids." alt="" coords="307,5,385,32"/>
</map>
</div>

</div>
</div>
<a id="a2b67aa3affea0dd3c6da502dab26d22d" name="a2b67aa3affea0dd3c6da502dab26d22d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b67aa3affea0dd3c6da502dab26d22d">&#9670;&nbsp;</a></span>intpol_tbl_ega()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_tbl_ega </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structlos__t.html">los_t</a> *&#160;</td>
          <td class="paramname"><em>los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_path</em>[ND][NG], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_seg</em>[ND]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate emissivities and transmittances using the Emissivity Growth Approximation (EGA). </p>
<p >Computes gas transmittance along a line-of-sight segment by interpolating emissivity values from lookup tables based on the Emissivity Growth Approximation (EGA). The interpolation is performed in pressure, temperature, and effective column density space derived from the local LOS properties.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining number of gases (<a class="el" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ctl_t::ng</a>) and channels (<a class="el" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">ctl_t::nd</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbl</td><td>Emissivity lookup tables (<a class="el" href="structtbl__t.html">tbl_t</a>) containing tabulated pressure, temperature, and column density grids. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">los</td><td>Line-of-sight structure providing local pressure, temperature, and column density data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Index of the current LOS point. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tau_path</td><td>Path transmittance array [nd][ng]; updated cumulatively for each gas. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tau_seg</td><td>Total segment transmittance per channel [nd].</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Uses pretabulated emissivity data (<code>tbl-&gt;eps</code>) and performs bilinear interpolation in pressure and temperature.</li>
<li>Column density interpolation is handled by <a class="el" href="jurassic_8h.html#a7134ded8183d6692b868ce0d411c6138">intpol_tbl_u</a> according to the emissivity growth relation.</li>
<li>Enforces emissivity limits within [0, 1].</li>
<li>Returns unity transmittance if lookup data are invalid or column density  0.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a>, <a class="el" href="structlos__t.html" title="Line-of-sight data.">los_t</a>, <a class="el" href="jurassic_8h.html#a7134ded8183d6692b868ce0d411c6138" title="Interpolate column density from lookup tables as a function of emissivity.">intpol_tbl_u</a>, <a class="el" href="jurassic_8h.html#a7683ce6b4628d0d910fdb9d360e2022a" title="Interpolate emissivity from lookup tables as a function of column density.">intpol_tbl_eps</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid.">locate_irr</a>, <a class="el" href="jurassic_8h.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid.">locate_reg</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Implements the EGA variant of the forward model, selected when <a class="el" href="structctl__t.html#a76702f4f08a76f29e138d97c7d2b1833">ctl_t::formod</a> = 1.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04140">4140</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4146</span>                      {</div>
<div class="line"><span class="lineno"> 4147</span> </div>
<div class="line"><span class="lineno"> 4148</span>  <span class="keywordtype">double</span> eps, u;</div>
<div class="line"><span class="lineno"> 4149</span> </div>
<div class="line"><span class="lineno"> 4150</span>  <span class="comment">/* Loop over channels... */</span></div>
<div class="line"><span class="lineno"> 4151</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 4152</span> </div>
<div class="line"><span class="lineno"> 4153</span>    <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 4154</span>    tau_seg[id] = 1;</div>
<div class="line"><span class="lineno"> 4155</span> </div>
<div class="line"><span class="lineno"> 4156</span>    <span class="comment">/* Loop over emitters.... */</span></div>
<div class="line"><span class="lineno"> 4157</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 4158</span> </div>
<div class="line"><span class="lineno"> 4159</span>      <span class="comment">/* Check size of table (pressure) and column density... */</span></div>
<div class="line"><span class="lineno"> 4160</span>      <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig] &lt; 30 || los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig] &lt;= 0)</div>
<div class="line"><span class="lineno"> 4161</span>        eps = 0;</div>
<div class="line"><span class="lineno"> 4162</span> </div>
<div class="line"><span class="lineno"> 4163</span>      <span class="comment">/* Check transmittance... */</span></div>
<div class="line"><span class="lineno"> 4164</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tau_path[<span class="keywordtype">id</span>][ig] &lt; 1e-9)</div>
<div class="line"><span class="lineno"> 4165</span>        eps = 1;</div>
<div class="line"><span class="lineno"> 4166</span> </div>
<div class="line"><span class="lineno"> 4167</span>      <span class="comment">/* Interpolate... */</span></div>
<div class="line"><span class="lineno"> 4168</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4169</span> </div>
<div class="line"><span class="lineno"> 4170</span>        <span class="comment">/* Determine pressure and temperature indices... */</span></div>
<div class="line"><span class="lineno"> 4171</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ipr =</div>
<div class="line"><span class="lineno"> 4172</span>          <a class="code hl_function" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig], los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 4173</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> it0 =</div>
<div class="line"><span class="lineno"> 4174</span>          <a class="code hl_function" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ipr], los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip]);</div>
<div class="line"><span class="lineno"> 4175</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> it1 =</div>
<div class="line"><span class="lineno"> 4176</span>          <a class="code hl_function" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr + 1], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ipr + 1],</div>
<div class="line"><span class="lineno"> 4177</span>                     los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip]);</div>
<div class="line"><span class="lineno"> 4178</span> </div>
<div class="line"><span class="lineno"> 4179</span>        <span class="comment">/* Check size of table (temperature and column density)... */</span></div>
<div class="line"><span class="lineno"> 4180</span>        <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ipr] &lt; 2 || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ipr + 1] &lt; 2</div>
<div class="line"><span class="lineno"> 4181</span>            || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ipr][it0] &lt; 2</div>
<div class="line"><span class="lineno"> 4182</span>            || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ipr][it0 + 1] &lt; 2</div>
<div class="line"><span class="lineno"> 4183</span>            || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ipr + 1][it1] &lt; 2</div>
<div class="line"><span class="lineno"> 4184</span>            || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ipr + 1][it1 + 1] &lt; 2)</div>
<div class="line"><span class="lineno"> 4185</span>          eps = 0;</div>
<div class="line"><span class="lineno"> 4186</span> </div>
<div class="line"><span class="lineno"> 4187</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4188</span> </div>
<div class="line"><span class="lineno"> 4189</span>          <span class="comment">/* Get emissivities of extended path... */</span></div>
<div class="line"><span class="lineno"> 4190</span>          u = <a class="code hl_function" href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138">intpol_tbl_u</a>(tbl, ig, <span class="keywordtype">id</span>, ipr, it0, 1 - tau_path[<span class="keywordtype">id</span>][ig]);</div>
<div class="line"><span class="lineno"> 4191</span>          <span class="keywordtype">double</span> eps00</div>
<div class="line"><span class="lineno"> 4192</span>            = <a class="code hl_function" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a>(tbl, ig, <span class="keywordtype">id</span>, ipr, it0, u + los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4193</span> </div>
<div class="line"><span class="lineno"> 4194</span>          u = <a class="code hl_function" href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138">intpol_tbl_u</a>(tbl, ig, <span class="keywordtype">id</span>, ipr, it0 + 1, 1 - tau_path[<span class="keywordtype">id</span>][ig]);</div>
<div class="line"><span class="lineno"> 4195</span>          <span class="keywordtype">double</span> eps01 =</div>
<div class="line"><span class="lineno"> 4196</span>            <a class="code hl_function" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a>(tbl, ig, <span class="keywordtype">id</span>, ipr, it0 + 1, u + los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4197</span> </div>
<div class="line"><span class="lineno"> 4198</span>          u = <a class="code hl_function" href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138">intpol_tbl_u</a>(tbl, ig, <span class="keywordtype">id</span>, ipr + 1, it1, 1 - tau_path[<span class="keywordtype">id</span>][ig]);</div>
<div class="line"><span class="lineno"> 4199</span>          <span class="keywordtype">double</span> eps10 =</div>
<div class="line"><span class="lineno"> 4200</span>            <a class="code hl_function" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a>(tbl, ig, <span class="keywordtype">id</span>, ipr + 1, it1, u + los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4201</span> </div>
<div class="line"><span class="lineno"> 4202</span>          u =</div>
<div class="line"><span class="lineno"> 4203</span>            <a class="code hl_function" href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138">intpol_tbl_u</a>(tbl, ig, <span class="keywordtype">id</span>, ipr + 1, it1 + 1, 1 - tau_path[<span class="keywordtype">id</span>][ig]);</div>
<div class="line"><span class="lineno"> 4204</span>          <span class="keywordtype">double</span> eps11 =</div>
<div class="line"><span class="lineno"> 4205</span>            <a class="code hl_function" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a>(tbl, ig, <span class="keywordtype">id</span>, ipr + 1, it1 + 1, u + los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ig]);</div>
<div class="line"><span class="lineno"> 4206</span> </div>
<div class="line"><span class="lineno"> 4207</span>          <span class="comment">/* Interpolate with respect to temperature... */</span></div>
<div class="line"><span class="lineno"> 4208</span>          eps00 = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr][it0], eps00,</div>
<div class="line"><span class="lineno"> 4209</span>                      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr][it0 + 1], eps01, los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip]);</div>
<div class="line"><span class="lineno"> 4210</span>          eps11 = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr + 1][it1], eps10,</div>
<div class="line"><span class="lineno"> 4211</span>                      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ipr + 1][it1 + 1], eps11, los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip]);</div>
<div class="line"><span class="lineno"> 4212</span> </div>
<div class="line"><span class="lineno"> 4213</span>          <span class="comment">/* Interpolate with respect to pressure... */</span></div>
<div class="line"><span class="lineno"> 4214</span>          eps00 = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig][ipr], eps00,</div>
<div class="line"><span class="lineno"> 4215</span>                      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig][ipr + 1], eps11, los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 4216</span> </div>
<div class="line"><span class="lineno"> 4217</span>          <span class="comment">/* Check emissivity range... */</span></div>
<div class="line"><span class="lineno"> 4218</span>          eps00 = <a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(eps00, 1), 0);</div>
<div class="line"><span class="lineno"> 4219</span> </div>
<div class="line"><span class="lineno"> 4220</span>          <span class="comment">/* Determine segment emissivity... */</span></div>
<div class="line"><span class="lineno"> 4221</span>          eps = 1 - (1 - eps00) / tau_path[<span class="keywordtype">id</span>][ig];</div>
<div class="line"><span class="lineno"> 4222</span>        }</div>
<div class="line"><span class="lineno"> 4223</span>      }</div>
<div class="line"><span class="lineno"> 4224</span> </div>
<div class="line"><span class="lineno"> 4225</span>      <span class="comment">/* Get transmittance of extended path... */</span></div>
<div class="line"><span class="lineno"> 4226</span>      tau_path[id][ig] *= (1 - eps);</div>
<div class="line"><span class="lineno"> 4227</span> </div>
<div class="line"><span class="lineno"> 4228</span>      <span class="comment">/* Get segment transmittance... */</span></div>
<div class="line"><span class="lineno"> 4229</span>      tau_seg[id] *= (1 - eps);</div>
<div class="line"><span class="lineno"> 4230</span>    }</div>
<div class="line"><span class="lineno"> 4231</span>  }</div>
<div class="line"><span class="lineno"> 4232</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a7134ded8183d6692b868ce0d411c6138"><div class="ttname"><a href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138">intpol_tbl_u</a></div><div class="ttdeci">double intpol_tbl_u(const tbl_t *tbl, const int ig, const int id, const int ip, const int it, const double eps)</div><div class="ttdoc">Interpolate column density from lookup tables as a function of emissivity.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04268">jurassic.c:4268</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a2b67aa3affea0dd3c6da502dab26d22d_cgraph.png" border="0" usemap="#ajurassic_8h_a2b67aa3affea0dd3c6da502dab26d22d_cgraph" alt=""/></div>
<map name="ajurassic_8h_a2b67aa3affea0dd3c6da502dab26d22d_cgraph" id="ajurassic_8h_a2b67aa3affea0dd3c6da502dab26d22d_cgraph">
<area shape="rect" title="Interpolate emissivities and transmittances using the Emissivity Growth Approximation (EGA)." alt="" coords="5,81,108,108"/>
<area shape="rect" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a" title="Interpolate emissivity from lookup tables as a function of column density." alt="" coords="156,5,259,32"/>
<area shape="rect" href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138" title="Interpolate column density from lookup tables as a function of emissivity." alt="" coords="163,56,251,83"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="170,107,245,133"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="166,157,249,184"/>
<area shape="rect" href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids." alt="" coords="307,31,385,57"/>
</map>
</div>

</div>
</div>
<a id="a7683ce6b4628d0d910fdb9d360e2022a" name="a7683ce6b4628d0d910fdb9d360e2022a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7683ce6b4628d0d910fdb9d360e2022a">&#9670;&nbsp;</a></span>intpol_tbl_eps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double intpol_tbl_eps </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Interpolate emissivity from lookup tables as a function of column density. </p>
<p >Retrieves the emissivity corresponding to a given column density <code>u</code> for a specific gas, channel, pressure level, and temperature index from the precomputed emissivity tables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tbl</td><td>Emissivity lookup tables (<a class="el" href="structtbl__t.html">tbl_t</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ig</td><td>Gas index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Channel index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Pressure level index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">it</td><td>Temperature level index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Column density [molecules/cm]. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Interpolated emissivity value in the range [0, 1].</dd></dl>
<ul>
<li>Performs linear interpolation in column density between adjacent grid points using <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>.</li>
<li>Applies lower-bound extrapolation proportional to <code>u</code> for <code>u &lt; u_min</code>.</li>
<li>Applies exponential upper-bound extrapolation ensuring asymptotic emissivity growth (<code>eps  1</code> as <code>u  </code>).</li>
<li>The input arrays are taken from <code>tbl-&gt;u</code> and <code>tbl-&gt;eps</code>.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids.">locate_tbl</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Used by both the CurtisGodson (CGA) and Emissivity Growth Approximation (EGA) interpolation schemes.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04236">4236</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4242</span>                  {</div>
<div class="line"><span class="lineno"> 4243</span> </div>
<div class="line"><span class="lineno"> 4244</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nu = tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[id][ig][ip][it];</div>
<div class="line"><span class="lineno"> 4245</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> *u_arr = tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[id][ig][ip][it];</div>
<div class="line"><span class="lineno"> 4246</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> *eps_arr = tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[id][ig][ip][it];</div>
<div class="line"><span class="lineno"> 4247</span> </div>
<div class="line"><span class="lineno"> 4248</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> u_min = u_arr[0];</div>
<div class="line"><span class="lineno"> 4249</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> u_max = u_arr[nu - 1];</div>
<div class="line"><span class="lineno"> 4250</span> </div>
<div class="line"><span class="lineno"> 4251</span>  <span class="comment">/* Lower boundary extrapolation... */</span></div>
<div class="line"><span class="lineno"> 4252</span>  <span class="keywordflow">if</span> (u &lt; u_min)</div>
<div class="line"><span class="lineno"> 4253</span>    <span class="keywordflow">return</span> eps_arr[0] * u / u_min;</div>
<div class="line"><span class="lineno"> 4254</span> </div>
<div class="line"><span class="lineno"> 4255</span>  <span class="comment">/* Upper boundary extrapolation... */</span></div>
<div class="line"><span class="lineno"> 4256</span>  <span class="keywordflow">if</span> (u &gt; u_max) {</div>
<div class="line"><span class="lineno"> 4257</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> a = log(1.0 - eps_arr[nu - 1]) / u_max;</div>
<div class="line"><span class="lineno"> 4258</span>    <span class="keywordflow">return</span> 1.0 - exp(a * u);</div>
<div class="line"><span class="lineno"> 4259</span>  }</div>
<div class="line"><span class="lineno"> 4260</span> </div>
<div class="line"><span class="lineno"> 4261</span>  <span class="comment">/* Interpolation... */</span></div>
<div class="line"><span class="lineno"> 4262</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_function" href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f">locate_tbl</a>(u_arr, nu, u);</div>
<div class="line"><span class="lineno"> 4263</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(u_arr[idx], eps_arr[idx], u_arr[idx + 1], eps_arr[idx + 1], u);</div>
<div class="line"><span class="lineno"> 4264</span>}</div>
<div class="ttc" id="ajurassic_8c_html_af353b2a27de539a038750c3224d31d8f"><div class="ttname"><a href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f">locate_tbl</a></div><div class="ttdeci">int locate_tbl(const float *xx, const int n, const double x)</div><div class="ttdoc">Locate index for interpolation within emissivity table grids.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04477">jurassic.c:4477</a></div></div>
<div class="ttc" id="astructtbl__t_html_a47489f640511083a74d6271a12141ce8"><div class="ttname"><a href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">tbl_t::eps</a></div><div class="ttdeci">float eps[ND][NG][TBLNP][TBLNT][TBLNU]</div><div class="ttdoc">Emissivity.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01432">jurassic.h:1432</a></div></div>
<div class="ttc" id="astructtbl__t_html_a9514535df8449c5188e687a2747bfba0"><div class="ttname"><a href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">tbl_t::u</a></div><div class="ttdeci">float u[ND][NG][TBLNP][TBLNT][TBLNU]</div><div class="ttdoc">Column density [molecules/cm^2].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01429">jurassic.h:1429</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a7683ce6b4628d0d910fdb9d360e2022a_cgraph.png" border="0" usemap="#ajurassic_8h_a7683ce6b4628d0d910fdb9d360e2022a_cgraph" alt=""/></div>
<map name="ajurassic_8h_a7683ce6b4628d0d910fdb9d360e2022a_cgraph" id="ajurassic_8h_a7683ce6b4628d0d910fdb9d360e2022a_cgraph">
<area shape="rect" title="Interpolate emissivity from lookup tables as a function of column density." alt="" coords="5,5,108,32"/>
<area shape="rect" href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids." alt="" coords="156,5,235,32"/>
</map>
</div>

</div>
</div>
<a id="a7134ded8183d6692b868ce0d411c6138" name="a7134ded8183d6692b868ce0d411c6138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7134ded8183d6692b868ce0d411c6138">&#9670;&nbsp;</a></span>intpol_tbl_u()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double intpol_tbl_u </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>eps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Interpolate column density from lookup tables as a function of emissivity. </p>
<p >Returns the column density corresponding to a given emissivity <code>eps</code> for a specific gas, channel, pressure level, and temperature index from the precomputed emissivity tables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tbl</td><td>Emissivity lookup tables (<a class="el" href="structtbl__t.html">tbl_t</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ig</td><td>Gas index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Channel index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Pressure level index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">it</td><td>Temperature level index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eps</td><td>Emissivity value (01). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Interpolated column density [molecules/cm].</dd></dl>
<ul>
<li>Performs linear interpolation in emissivity between adjacent table entries using <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>.</li>
<li>For <code>eps &lt; eps_min</code>, applies linear extrapolation proportional to emissivity.</li>
<li>For <code>eps &gt; eps_max</code>, applies exponential extrapolation following the emissivity growth law.</li>
<li>The lookup is performed using <code>tbl-&gt;eps</code> and <code>tbl-&gt;u</code>.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids.">locate_tbl</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Used in the Emissivity Growth Approximation (EGA) to determine effective column density from transmittance.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04268">4268</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4274</span>                    {</div>
<div class="line"><span class="lineno"> 4275</span> </div>
<div class="line"><span class="lineno"> 4276</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nu = tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[id][ig][ip][it];</div>
<div class="line"><span class="lineno"> 4277</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> *eps_arr = tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[id][ig][ip][it];</div>
<div class="line"><span class="lineno"> 4278</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> *u_arr = tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[id][ig][ip][it];</div>
<div class="line"><span class="lineno"> 4279</span> </div>
<div class="line"><span class="lineno"> 4280</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> eps_min = eps_arr[0];</div>
<div class="line"><span class="lineno"> 4281</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> eps_max = eps_arr[nu - 1];</div>
<div class="line"><span class="lineno"> 4282</span> </div>
<div class="line"><span class="lineno"> 4283</span>  <span class="comment">/* Lower boundary extrapolation... */</span></div>
<div class="line"><span class="lineno"> 4284</span>  <span class="keywordflow">if</span> (eps &lt; eps_min)</div>
<div class="line"><span class="lineno"> 4285</span>    <span class="keywordflow">return</span> u_arr[0] * eps / eps_min;</div>
<div class="line"><span class="lineno"> 4286</span> </div>
<div class="line"><span class="lineno"> 4287</span>  <span class="comment">/* Upper boundary extrapolation... */</span></div>
<div class="line"><span class="lineno"> 4288</span>  <span class="keywordflow">if</span> (eps &gt; eps_max) {</div>
<div class="line"><span class="lineno"> 4289</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> a = log(1.0 - eps_max) / u_arr[nu - 1];</div>
<div class="line"><span class="lineno"> 4290</span>    <span class="keywordflow">return</span> log(1.0 - eps) / a;</div>
<div class="line"><span class="lineno"> 4291</span>  }</div>
<div class="line"><span class="lineno"> 4292</span> </div>
<div class="line"><span class="lineno"> 4293</span>  <span class="comment">/* Interpolation... */</span></div>
<div class="line"><span class="lineno"> 4294</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_function" href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f">locate_tbl</a>(eps_arr, nu, eps);</div>
<div class="line"><span class="lineno"> 4295</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(eps_arr[idx], u_arr[idx], eps_arr[idx + 1], u_arr[idx + 1], eps);</div>
<div class="line"><span class="lineno"> 4296</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a7134ded8183d6692b868ce0d411c6138_cgraph.png" border="0" usemap="#ajurassic_8h_a7134ded8183d6692b868ce0d411c6138_cgraph" alt=""/></div>
<map name="ajurassic_8h_a7134ded8183d6692b868ce0d411c6138_cgraph" id="ajurassic_8h_a7134ded8183d6692b868ce0d411c6138_cgraph">
<area shape="rect" title="Interpolate column density from lookup tables as a function of emissivity." alt="" coords="5,5,93,32"/>
<area shape="rect" href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids." alt="" coords="141,5,220,32"/>
</map>
</div>

</div>
</div>
<a id="acc0c1829ca7770d2dd6342f2cdf10bb9" name="acc0c1829ca7770d2dd6342f2cdf10bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc0c1829ca7770d2dd6342f2cdf10bb9">&#9670;&nbsp;</a></span>jsec2time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void jsec2time </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>jsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>mon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>remain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts Julian seconds to calendar date and time components. </p>
<p >This function converts Julian seconds to calendar date and time components, including year, month, day, hour, minute, and second. It also calculates the fractional part of the seconds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jsec</td><td>Julian seconds to convert. </td></tr>
    <tr><td class="paramname">year</td><td>Pointer to store the year. </td></tr>
    <tr><td class="paramname">mon</td><td>Pointer to store the month. </td></tr>
    <tr><td class="paramname">day</td><td>Pointer to store the day. </td></tr>
    <tr><td class="paramname">hour</td><td>Pointer to store the hour. </td></tr>
    <tr><td class="paramname">min</td><td>Pointer to store the minute. </td></tr>
    <tr><td class="paramname">sec</td><td>Pointer to store the second. </td></tr>
    <tr><td class="paramname">remain</td><td>Pointer to store the fractional part of seconds.</td></tr>
  </table>
  </dd>
</dl>
<p>The function initializes a time structure <code>t0</code> with a fixed starting date and time. It then converts the Julian seconds to a time_t type by adding the seconds to the epoch time. Next, it converts the time_t value to a UTC time structure <code>t1</code>. Finally, it extracts the year, month, day, hour, minute, and second components from <code>t1</code> and calculates the fractional part of seconds, which is stored in <code>remain</code>.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04300">4300</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4308</span>                  {</div>
<div class="line"><span class="lineno"> 4309</span> </div>
<div class="line"><span class="lineno"> 4310</span>  <span class="keyword">struct </span>tm t0, *t1;</div>
<div class="line"><span class="lineno"> 4311</span> </div>
<div class="line"><span class="lineno"> 4312</span>  t0.tm_year = 100;</div>
<div class="line"><span class="lineno"> 4313</span>  t0.tm_mon = 0;</div>
<div class="line"><span class="lineno"> 4314</span>  t0.tm_mday = 1;</div>
<div class="line"><span class="lineno"> 4315</span>  t0.tm_hour = 0;</div>
<div class="line"><span class="lineno"> 4316</span>  t0.tm_min = 0;</div>
<div class="line"><span class="lineno"> 4317</span>  t0.tm_sec = 0;</div>
<div class="line"><span class="lineno"> 4318</span> </div>
<div class="line"><span class="lineno"> 4319</span>  <span class="keyword">const</span> time_t jsec0 = (time_t) jsec + timegm(&amp;t0);</div>
<div class="line"><span class="lineno"> 4320</span>  t1 = gmtime(&amp;jsec0);</div>
<div class="line"><span class="lineno"> 4321</span> </div>
<div class="line"><span class="lineno"> 4322</span>  *year = t1-&gt;tm_year + 1900;</div>
<div class="line"><span class="lineno"> 4323</span>  *mon = t1-&gt;tm_mon + 1;</div>
<div class="line"><span class="lineno"> 4324</span>  *day = t1-&gt;tm_mday;</div>
<div class="line"><span class="lineno"> 4325</span>  *hour = t1-&gt;tm_hour;</div>
<div class="line"><span class="lineno"> 4326</span>  *min = t1-&gt;tm_min;</div>
<div class="line"><span class="lineno"> 4327</span>  *sec = t1-&gt;tm_sec;</div>
<div class="line"><span class="lineno"> 4328</span>  *remain = jsec - floor(jsec);</div>
<div class="line"><span class="lineno"> 4329</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab49799958d13e57af5b20527f0990ce6" name="ab49799958d13e57af5b20527f0990ce6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab49799958d13e57af5b20527f0990ce6">&#9670;&nbsp;</a></span>kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kernel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the Jacobian (kernel) matrix by finite differences. </p>
<p >Evaluates the sensitivity of the simulated radiances to each element of the atmospheric state vector by perturbing one parameter at a time and re-running the forward model. The result is the Jacobian matrix \( K = \partial y / \partial x \), where <em>y</em> is the measurement vector and <em>x</em> is the state vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining retrieval configuration and model setup. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbl</td><td>Emissivity lookup tables used by the forward model. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Atmospheric state vector and profile data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs</td><td>Observation geometry and radiance data. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">k</td><td>Jacobian matrix [mn], where <em>m</em> is the number of measurements and <em>n</em> the number of state variables.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The undisturbed forward model is first computed to obtain the reference measurement vector.</li>
<li>Each state vector element is perturbed by an adaptive step <code>h</code> depending on its physical type (pressure, temperature, VMR, etc.).</li>
<li>For each perturbation, the forward model is re-evaluated, and the corresponding column of <em>K</em> is estimated using finite differences.</li>
<li>Parallelized over state vector elements using OpenMP.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Typical perturbation sizes:<ul>
<li>Pressure: 1 % or  1e7 hPa <br  />
</li>
<li>Temperature: 1 K <br  />
</li>
<li>VMR: 1 % or  1e15 <br  />
</li>
<li>Extinction: 1e4 km <br  />
</li>
<li>Cloud and surface parameters: 1 K or 1e2 as appropriate.</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a>, <a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a>, <a class="el" href="jurassic_8h.html#abe93da56294b380e322c18ca2838fd51" title="Execute the selected forward model.">formod</a>, <a class="el" href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure.">x2atm</a>, <a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x</a>, <a class="el" href="jurassic_8h.html#ad6380c9458cf356667952f9651932e27" title="Convert observation radiances into a measurement vector.">obs2y</a>, <a class="el" href="jurassic_8h.html#ad4d49729d85da58030daa13689c5edd1" title="Copy or initialize atmospheric profile data.">copy_atm</a>, <a class="el" href="jurassic_8h.html#aa855e52716bd4b479bb0d2446b300a4e" title="Copy or initialize observation geometry and radiance data.">copy_obs</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Computationally intensive; requires one forward model evaluation per state vector element.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04333">4333</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4338</span>                 {</div>
<div class="line"><span class="lineno"> 4339</span> </div>
<div class="line"><span class="lineno"> 4340</span>  <span class="keywordtype">int</span> *iqa;</div>
<div class="line"><span class="lineno"> 4341</span> </div>
<div class="line"><span class="lineno"> 4342</span>  <span class="comment">/* Get sizes... */</span></div>
<div class="line"><span class="lineno"> 4343</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> m = k-&gt;size1;</div>
<div class="line"><span class="lineno"> 4344</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = k-&gt;size2;</div>
<div class="line"><span class="lineno"> 4345</span> </div>
<div class="line"><span class="lineno"> 4346</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 4347</span>  gsl_vector *x0 = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 4348</span>  gsl_vector *yy0 = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 4349</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(iqa, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 4350</span>        <a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><span class="lineno"> 4351</span> </div>
<div class="line"><span class="lineno"> 4352</span>  <span class="comment">/* Compute radiance for undisturbed atmospheric data... */</span></div>
<div class="line"><span class="lineno"> 4353</span>  <a class="code hl_function" href="jurassic_8c.html#abe93da56294b380e322c18ca2838fd51">formod</a>(ctl, tbl, atm, obs);</div>
<div class="line"><span class="lineno"> 4354</span> </div>
<div class="line"><span class="lineno"> 4355</span>  <span class="comment">/* Compose vectors... */</span></div>
<div class="line"><span class="lineno"> 4356</span>  <a class="code hl_function" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x</a>(ctl, atm, x0, iqa, NULL);</div>
<div class="line"><span class="lineno"> 4357</span>  <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, obs, yy0, NULL, NULL);</div>
<div class="line"><span class="lineno"> 4358</span> </div>
<div class="line"><span class="lineno"> 4359</span>  <span class="comment">/* Initialize kernel matrix... */</span></div>
<div class="line"><span class="lineno"> 4360</span>  gsl_matrix_set_zero(k);</div>
<div class="line"><span class="lineno"> 4361</span> </div>
<div class="line"><span class="lineno"> 4362</span>  <span class="comment">/* Loop over state vector elements... */</span></div>
<div class="line"><span class="lineno"> 4363</span><span class="preprocessor">#pragma omp parallel for default(none) shared(ctl,tbl,atm,obs,k,x0,yy0,n,m,iqa)</span></div>
<div class="line"><span class="lineno"> 4364</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; j++) {</div>
<div class="line"><span class="lineno"> 4365</span> </div>
<div class="line"><span class="lineno"> 4366</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 4367</span>    <a class="code hl_struct" href="structatm__t.html">atm_t</a> *atm1;</div>
<div class="line"><span class="lineno"> 4368</span>    <a class="code hl_struct" href="structobs__t.html">obs_t</a> *obs1;</div>
<div class="line"><span class="lineno"> 4369</span>    <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(atm1, <a class="code hl_struct" href="structatm__t.html">atm_t</a>, 1);</div>
<div class="line"><span class="lineno"> 4370</span>    <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(obs1, <a class="code hl_struct" href="structobs__t.html">obs_t</a>, 1);</div>
<div class="line"><span class="lineno"> 4371</span>    gsl_vector *x1 = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 4372</span>    gsl_vector *yy1 = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 4373</span> </div>
<div class="line"><span class="lineno"> 4374</span>    <span class="comment">/* Set perturbation size... */</span></div>
<div class="line"><span class="lineno"> 4375</span>    <span class="keywordtype">double</span> h;</div>
<div class="line"><span class="lineno"> 4376</span>    <span class="keywordflow">if</span> (iqa[j] == <a class="code hl_define" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a>)</div>
<div class="line"><span class="lineno"> 4377</span>      h = <a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(fabs(0.01 * gsl_vector_get(x0, j)), 1e-7);</div>
<div class="line"><span class="lineno"> 4378</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iqa[j] == <a class="code hl_define" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a>)</div>
<div class="line"><span class="lineno"> 4379</span>      h = 1.0;</div>
<div class="line"><span class="lineno"> 4380</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iqa[j] &gt;= <a class="code hl_define" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a>(0) &amp;&amp; iqa[j] &lt; <a class="code hl_define" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>))</div>
<div class="line"><span class="lineno"> 4381</span>      h = <a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(fabs(0.01 * gsl_vector_get(x0, j)), 1e-15);</div>
<div class="line"><span class="lineno"> 4382</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iqa[j] &gt;= <a class="code hl_define" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a>(0) &amp;&amp; iqa[j] &lt; <a class="code hl_define" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>))</div>
<div class="line"><span class="lineno"> 4383</span>      h = 1e-4;</div>
<div class="line"><span class="lineno"> 4384</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iqa[j] == <a class="code hl_define" href="jurassic_8h.html#a04eaf14380553f171f54680560527fe5">IDXCLZ</a> || iqa[j] == <a class="code hl_define" href="jurassic_8h.html#a3b420330ad2457758ef539d8c9e0bd99">IDXCLDZ</a>)</div>
<div class="line"><span class="lineno"> 4385</span>      h = 1.0;</div>
<div class="line"><span class="lineno"> 4386</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iqa[j] &gt;= <a class="code hl_define" href="jurassic_8h.html#a809f947437669a6b3930302f30375d41">IDXCLK</a>(0) &amp;&amp; iqa[j] &lt; <a class="code hl_define" href="jurassic_8h.html#a809f947437669a6b3930302f30375d41">IDXCLK</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>))</div>
<div class="line"><span class="lineno"> 4387</span>      h = 1e-4;</div>
<div class="line"><span class="lineno"> 4388</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iqa[j] == <a class="code hl_define" href="jurassic_8h.html#a7abc6f3d1a1993a0337a736d79cf6ecc">IDXSFT</a>)</div>
<div class="line"><span class="lineno"> 4389</span>      h = 1.0;</div>
<div class="line"><span class="lineno"> 4390</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iqa[j] &gt;= <a class="code hl_define" href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35">IDXSFEPS</a>(0) &amp;&amp; iqa[j] &lt; <a class="code hl_define" href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35">IDXSFEPS</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>))</div>
<div class="line"><span class="lineno"> 4391</span>      h = 1e-2;</div>
<div class="line"><span class="lineno"> 4392</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4393</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot set perturbation size!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4394</span> </div>
<div class="line"><span class="lineno"> 4395</span>    <span class="comment">/* Disturb state vector element... */</span></div>
<div class="line"><span class="lineno"> 4396</span>    gsl_vector_memcpy(x1, x0);</div>
<div class="line"><span class="lineno"> 4397</span>    gsl_vector_set(x1, j, gsl_vector_get(x1, j) + h);</div>
<div class="line"><span class="lineno"> 4398</span>    <a class="code hl_function" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1">copy_atm</a>(ctl, atm1, atm, 0);</div>
<div class="line"><span class="lineno"> 4399</span>    <a class="code hl_function" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e">copy_obs</a>(ctl, obs1, obs, 0);</div>
<div class="line"><span class="lineno"> 4400</span>    <a class="code hl_function" href="jurassic_8c.html#a59e72c7cead4b4b7aaf096803bc7360c">x2atm</a>(ctl, x1, atm1);</div>
<div class="line"><span class="lineno"> 4401</span> </div>
<div class="line"><span class="lineno"> 4402</span>    <span class="comment">/* Compute radiance for disturbed atmospheric data... */</span></div>
<div class="line"><span class="lineno"> 4403</span>    <a class="code hl_function" href="jurassic_8c.html#abe93da56294b380e322c18ca2838fd51">formod</a>(ctl, tbl, atm1, obs1);</div>
<div class="line"><span class="lineno"> 4404</span> </div>
<div class="line"><span class="lineno"> 4405</span>    <span class="comment">/* Compose measurement vector for disturbed radiance data... */</span></div>
<div class="line"><span class="lineno"> 4406</span>    <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, obs1, yy1, NULL, NULL);</div>
<div class="line"><span class="lineno"> 4407</span> </div>
<div class="line"><span class="lineno"> 4408</span>    <span class="comment">/* Compute derivatives... */</span></div>
<div class="line"><span class="lineno"> 4409</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; i++)</div>
<div class="line"><span class="lineno"> 4410</span>      gsl_matrix_set(k, i, j,</div>
<div class="line"><span class="lineno"> 4411</span>                     (gsl_vector_get(yy1, i) - gsl_vector_get(yy0, i)) / h);</div>
<div class="line"><span class="lineno"> 4412</span> </div>
<div class="line"><span class="lineno"> 4413</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 4414</span>    gsl_vector_free(x1);</div>
<div class="line"><span class="lineno"> 4415</span>    gsl_vector_free(yy1);</div>
<div class="line"><span class="lineno"> 4416</span>    free(atm1);</div>
<div class="line"><span class="lineno"> 4417</span>    free(obs1);</div>
<div class="line"><span class="lineno"> 4418</span>  }</div>
<div class="line"><span class="lineno"> 4419</span> </div>
<div class="line"><span class="lineno"> 4420</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 4421</span>  gsl_vector_free(x0);</div>
<div class="line"><span class="lineno"> 4422</span>  gsl_vector_free(yy0);</div>
<div class="line"><span class="lineno"> 4423</span>  free(iqa);</div>
<div class="line"><span class="lineno"> 4424</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a59e72c7cead4b4b7aaf096803bc7360c"><div class="ttname"><a href="jurassic_8c.html#a59e72c7cead4b4b7aaf096803bc7360c">x2atm</a></div><div class="ttdeci">void x2atm(const ctl_t *ctl, const gsl_vector *x, atm_t *atm)</div><div class="ttdoc">Map retrieval state vector back to atmospheric structure.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07577">jurassic.c:7577</a></div></div>
<div class="ttc" id="ajurassic_8c_html_abe93da56294b380e322c18ca2838fd51"><div class="ttname"><a href="jurassic_8c.html#abe93da56294b380e322c18ca2838fd51">formod</a></div><div class="ttdeci">void formod(const ctl_t *ctl, const tbl_t *tbl, atm_t *atm, obs_t *obs)</div><div class="ttdoc">Execute the selected forward model.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03409">jurassic.c:3409</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ad6380c9458cf356667952f9651932e27"><div class="ttname"><a href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a></div><div class="ttdeci">size_t obs2y(const ctl_t *ctl, const obs_t *obs, gsl_vector *y, int *ida, int *ira)</div><div class="ttdoc">Convert observation radiances into a measurement vector.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04574">jurassic.c:4574</a></div></div>
<div class="ttc" id="ajurassic_8c_html_adfbb04487aa1c1d4175afca6e521e20b"><div class="ttname"><a href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x</a></div><div class="ttdeci">size_t atm2x(const ctl_t *ctl, const atm_t *atm, gsl_vector *x, int *iqa, int *ipa)</div><div class="ttdoc">Convert atmospheric data to state vector elements.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l00110">jurassic.c:110</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_ab49799958d13e57af5b20527f0990ce6_cgraph.png" border="0" usemap="#ajurassic_8h_ab49799958d13e57af5b20527f0990ce6_cgraph" alt=""/></div>
<map name="ajurassic_8h_ab49799958d13e57af5b20527f0990ce6_cgraph" id="ajurassic_8h_ab49799958d13e57af5b20527f0990ce6_cgraph">
<area shape="rect" title="Compute the Jacobian (kernel) matrix by finite differences." alt="" coords="5,588,63,615"/>
<area shape="rect" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements." alt="" coords="121,360,179,387"/>
<area shape="rect" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1" title="Copy or initialize atmospheric profile data." alt="" coords="111,512,189,539"/>
<area shape="rect" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e" title="Copy or initialize observation geometry and radiance data." alt="" coords="409,613,486,640"/>
<area shape="rect" href="jurassic_8c.html#abe93da56294b380e322c18ca2838fd51" title="Execute the selected forward model." alt="" coords="119,563,181,589"/>
<area shape="rect" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27" title="Convert observation radiances into a measurement vector." alt="" coords="122,664,178,691"/>
<area shape="rect" href="jurassic_8c.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure." alt="" coords="121,715,179,741"/>
<area shape="rect" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f" title="Append a single atmospheric value to the state vector." alt="" coords="245,259,333,285"/>
<area shape="rect" href="jurassic_8c.html#ab0c3109373d1d5edcf57840c288f6f53" title="Apply field&#45;of&#45;view (FOV) convolution to modeled radiances." alt="" coords="245,512,332,539"/>
<area shape="rect" href="jurassic_8c.html#a9727c4e0e5bc85384762b6ad81a8c3be" title="Compute line&#45;of&#45;sight radiances using the pencil&#45;beam forward model." alt="" coords="237,309,340,336"/>
<area shape="rect" href="jurassic_8c.html#a2caf20484e8e2f52ff3650321b7c704c" title="Interface routine for the Reference Forward Model (RFM)." alt="" coords="245,664,333,691"/>
<area shape="rect" href="jurassic_8c.html#ad69ab6edb8f722212fb01e12d8809643" title="Adjust pressure profile using the hydrostatic equation." alt="" coords="246,563,331,589"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="725,385,799,412"/>
<area shape="rect" href="jurassic_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="412,157,483,184"/>
<area shape="rect" href="jurassic_8c.html#a363f5205cd58d7a22133f704f1137181" title="Compute total extinction including gaseous continua." alt="" coords="388,107,507,133"/>
<area shape="rect" href="jurassic_8c.html#ac7826de16feb2eb6730b661bf8deba90" title="Interpolate the source function (Planck radiance) at a given temperature." alt="" coords="391,208,503,235"/>
<area shape="rect" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="726,689,798,716"/>
<area shape="rect" href="jurassic_8c.html#a5e22cd63c35ef6e2c9b9023e2c3945d8" title="Interpolate emissivities and transmittances using the CurtisGodson approximation (CGA)." alt="" coords="557,259,660,285"/>
<area shape="rect" href="jurassic_8c.html#a2b67aa3affea0dd3c6da502dab26d22d" title="Interpolate emissivities and transmittances using the Emissivity Growth Approximation (EGA)." alt="" coords="557,309,660,336"/>
<area shape="rect" href="jurassic_8c.html#a44e1e4b6ab44e79d049f99a04e79df9f" title="Perform line&#45;of&#45;sight (LOS) ray tracing through the atmosphere." alt="" coords="413,512,481,539"/>
<area shape="rect" href="jurassic_8c.html#a9a962bab37658297e87de9631c67707b" title="Compute carbon dioxide continuum (optical depth)." alt="" coords="576,56,641,83"/>
<area shape="rect" href="jurassic_8c.html#a5b99f6f4581181857d4b89b27e8c2f87" title="Compute water vapor continuum (optical depth)." alt="" coords="576,107,641,133"/>
<area shape="rect" href="jurassic_8c.html#ad788eb8a3a6df141d82f28adbd610668" title="Compute N collision&#45;induced absorption coefficient." alt="" coords="579,157,638,184"/>
<area shape="rect" href="jurassic_8c.html#a2d55d073ef8855381487a486970152f5" title="Compute O collision&#45;induced absorption coefficient." alt="" coords="579,5,638,32"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="721,208,803,235"/>
<area shape="rect" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a" title="Interpolate emissivity from lookup tables as a function of column density." alt="" coords="711,259,813,285"/>
<area shape="rect" href="jurassic_8c.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids." alt="" coords="861,284,940,311"/>
<area shape="rect" href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138" title="Interpolate column density from lookup tables as a function of emissivity." alt="" coords="718,309,806,336"/>
<area shape="rect" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="Converts Cartesian coordinates to geographic coordinates." alt="" coords="726,563,798,589"/>
<area shape="rect" href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612" title="Interpolate atmospheric state variables at a given altitude." alt="" coords="567,461,650,488"/>
<area shape="rect" href="jurassic_8c.html#a9020f32787ea7be08486d537a4f5c0fc" title="Determine the tangent point along a line of sight (LOS)." alt="" coords="559,613,659,640"/>
<area shape="rect" href="jurassic_8c.html#a134dbd60b73c18eda7032e58284dbade" title="Read and spectrally convolve an RFM output spectrum." alt="" coords="397,664,498,691"/>
<area shape="rect" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two&#45;column shape function from an ASCII file." alt="" coords="403,715,492,741"/>
<area shape="rect" href="jurassic_8c.html#a675d14cbd1ae26f72e86f828d8367240" title="Write atmospheric profile in RFM&#45;compatible format." alt="" coords="395,765,500,792"/>
<area shape="rect" href="jurassic_8c.html#a19d63e07e3eb8166cbf65ce079e4d156" title="Read a Reference Forward Model (RFM) ASCII spectrum." alt="" coords="555,765,663,792"/>
<area shape="rect" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992" title="Helper function to extract a single value from the retrieval state vector." alt="" coords="245,715,333,741"/>
</map>
</div>

</div>
</div>
<a id="a4e1b87dc3c93a23c89f739adf10b60dc" name="a4e1b87dc3c93a23c89f739adf10b60dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e1b87dc3c93a23c89f739adf10b60dc">&#9670;&nbsp;</a></span>locate_irr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int locate_irr </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locate index for interpolation on an irregular grid. </p>
<p >Finds the lower index <code>ilo</code> such that \( xx[ilo] \le x &lt; xx[ilo+1] \) for monotonically increasing or decreasing grids. <br  />
 Used in interpolation routines for altitude, pressure, temperature, or wavenumber profiles that are not evenly spaced.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xx</td><td>Array of monotonic grid values (increasing or decreasing). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Target value to locate within the grid range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index <code>ilo</code> of the lower grid point surrounding <code>x</code>.</dd></dl>
<ul>
<li>Uses a binary search algorithm with \( O(\log n) \) complexity. <br  />
</li>
<li>Handles both increasing and decreasing grids automatically. <br  />
</li>
<li>Returns the index of the lower neighbor suitable for use in interpolation routines such as <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>, <a class="el" href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3">LOGX</a>, or <a class="el" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca">LOGY</a>.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3" title="Compute logarithmic interpolation in x.">LOGX</a>, <a class="el" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca" title="Compute logarithmic interpolation in y.">LOGY</a>, <a class="el" href="jurassic_8h.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid.">locate_reg</a>, <a class="el" href="jurassic_8h.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids.">locate_tbl</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Assumes <code>x</code> lies within the range of <code>xx</code>; no bounds checking beyond the first and last grid points is performed.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04428">4428</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4431</span>                  {</div>
<div class="line"><span class="lineno"> 4432</span> </div>
<div class="line"><span class="lineno"> 4433</span>  <span class="keywordtype">int</span> ilo = 0;</div>
<div class="line"><span class="lineno"> 4434</span>  <span class="keywordtype">int</span> ihi = n - 1;</div>
<div class="line"><span class="lineno"> 4435</span>  <span class="keywordtype">int</span> i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 4436</span> </div>
<div class="line"><span class="lineno"> 4437</span>  <span class="keywordflow">if</span> (xx[i] &lt; xx[i + 1])</div>
<div class="line"><span class="lineno"> 4438</span>    <span class="keywordflow">while</span> (ihi &gt; ilo + 1) {</div>
<div class="line"><span class="lineno"> 4439</span>      i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 4440</span>      <span class="keywordflow">if</span> (xx[i] &gt; x)</div>
<div class="line"><span class="lineno"> 4441</span>        ihi = i;</div>
<div class="line"><span class="lineno"> 4442</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4443</span>        ilo = i;</div>
<div class="line"><span class="lineno"> 4444</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4445</span>    <span class="keywordflow">while</span> (ihi &gt; ilo + 1) {</div>
<div class="line"><span class="lineno"> 4446</span>      i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 4447</span>      <span class="keywordflow">if</span> (xx[i] &lt;= x)</div>
<div class="line"><span class="lineno"> 4448</span>        ihi = i;</div>
<div class="line"><span class="lineno"> 4449</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4450</span>        ilo = i;</div>
<div class="line"><span class="lineno"> 4451</span>    }</div>
<div class="line"><span class="lineno"> 4452</span> </div>
<div class="line"><span class="lineno"> 4453</span>  <span class="keywordflow">return</span> ilo;</div>
<div class="line"><span class="lineno"> 4454</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a3c8ab98f21179741b274439786726d" name="a2a3c8ab98f21179741b274439786726d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a3c8ab98f21179741b274439786726d">&#9670;&nbsp;</a></span>locate_reg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int locate_reg </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locate index for interpolation on a regular (uniform) grid. </p>
<p >Computes the lower index <code>i</code> such that \( xx[i] \le x &lt; xx[i+1] \) for evenly spaced grid points. Used for quick index lookup when the grid spacing is constant.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xx</td><td>Array of regularly spaced grid values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Target value to locate within the grid range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index <code>i</code> of the lower grid point surrounding <code>x</code>.</dd></dl>
<ul>
<li>Computes the index directly from the grid spacing using \( i = (x - xx_0) / (xx_1 - xx_0) \).</li>
<li>Clamps the result to <code>[0, n - 2]</code> to avoid out-of-bounds indices.</li>
<li>Suitable for use with uniform grids such as pressure, temperature, or wavelength tables.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid.">locate_irr</a>, <a class="el" href="jurassic_8h.html#af353b2a27de539a038750c3224d31d8f" title="Locate index for interpolation within emissivity table grids.">locate_tbl</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a870fa40d24bd17e7cc7ec906662047b3" title="Compute logarithmic interpolation in x.">LOGX</a>, <a class="el" href="jurassic_8h.html#a6df174578bf85b1e9f33c597f5f8e5ca" title="Compute logarithmic interpolation in y.">LOGY</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Assumes uniform grid spacing; results are invalid for irregularly spaced arrays.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04458">4458</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4461</span>                  {</div>
<div class="line"><span class="lineno"> 4462</span> </div>
<div class="line"><span class="lineno"> 4463</span>  <span class="comment">/* Calculate index... */</span></div>
<div class="line"><span class="lineno"> 4464</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> i = (int) ((x - xx[0]) / (xx[1] - xx[0]));</div>
<div class="line"><span class="lineno"> 4465</span> </div>
<div class="line"><span class="lineno"> 4466</span>  <span class="comment">/* Check range... */</span></div>
<div class="line"><span class="lineno"> 4467</span>  <span class="keywordflow">if</span> (i &lt; 0)</div>
<div class="line"><span class="lineno"> 4468</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 4469</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt; n - 2)</div>
<div class="line"><span class="lineno"> 4470</span>    <span class="keywordflow">return</span> n - 2;</div>
<div class="line"><span class="lineno"> 4471</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4472</span>    <span class="keywordflow">return</span> i;</div>
<div class="line"><span class="lineno"> 4473</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af353b2a27de539a038750c3224d31d8f" name="af353b2a27de539a038750c3224d31d8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af353b2a27de539a038750c3224d31d8f">&#9670;&nbsp;</a></span>locate_tbl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int locate_tbl </td>
          <td>(</td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Locate index for interpolation within emissivity table grids. </p>
<p >Finds the lower index <code>ilo</code> such that \( xx[ilo] \le x &lt; xx[ilo+1] \) in a monotonically increasing single-precision grid. <br  />
 Used for emissivity and column density interpolation in table-based routines such as <a class="el" href="jurassic_8h.html#a7683ce6b4628d0d910fdb9d360e2022a">intpol_tbl_eps</a> and <a class="el" href="jurassic_8h.html#a7134ded8183d6692b868ce0d411c6138">intpol_tbl_u</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xx</td><td>Monotonic (increasing) single-precision grid array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Target value to locate within the grid range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index <code>ilo</code> of the lower grid point surrounding <code>x</code>.</dd></dl>
<ul>
<li>Implements a binary search with \( O(\log n) \) complexity.</li>
<li>Optimized for lookup tables stored in <code>float</code> to minimize memory use.</li>
<li>Returns an index suitable for linear interpolation with <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a7683ce6b4628d0d910fdb9d360e2022a" title="Interpolate emissivity from lookup tables as a function of column density.">intpol_tbl_eps</a>, <a class="el" href="jurassic_8h.html#a7134ded8183d6692b868ce0d411c6138" title="Interpolate column density from lookup tables as a function of emissivity.">intpol_tbl_u</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid.">locate_irr</a>, <a class="el" href="jurassic_8h.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid.">locate_reg</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Assumes monotonic grid input (increasing order) and that <code>x</code> lies within the table range.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04477">4477</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4480</span>                  {</div>
<div class="line"><span class="lineno"> 4481</span> </div>
<div class="line"><span class="lineno"> 4482</span>  <span class="keywordtype">int</span> ilo = 0;</div>
<div class="line"><span class="lineno"> 4483</span>  <span class="keywordtype">int</span> ihi = n - 1;</div>
<div class="line"><span class="lineno"> 4484</span>  <span class="keywordtype">int</span> i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 4485</span> </div>
<div class="line"><span class="lineno"> 4486</span>  <span class="keywordflow">while</span> (ihi &gt; ilo + 1) {</div>
<div class="line"><span class="lineno"> 4487</span>    i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 4488</span>    <span class="keywordflow">if</span> (xx[i] &gt; x)</div>
<div class="line"><span class="lineno"> 4489</span>      ihi = i;</div>
<div class="line"><span class="lineno"> 4490</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4491</span>      ilo = i;</div>
<div class="line"><span class="lineno"> 4492</span>  }</div>
<div class="line"><span class="lineno"> 4493</span> </div>
<div class="line"><span class="lineno"> 4494</span>  <span class="keywordflow">return</span> ilo;</div>
<div class="line"><span class="lineno"> 4495</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab86061d2a35e1ebf8c06ba0d13cf652b" name="ab86061d2a35e1ebf8c06ba0d13cf652b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab86061d2a35e1ebf8c06ba0d13cf652b">&#9670;&nbsp;</a></span>matrix_invert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void matrix_invert </td>
          <td>(</td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Invert a square matrix, optimized for diagonal or symmetric positive-definite matrices. </p>
<p >Performs in-place inversion of the matrix \(\mathbf{A}\) using either:</p><ul>
<li><b>Fast diagonal inversion</b>, if the matrix is strictly diagonal.</li>
<li><b>Cholesky decomposition</b>, if the matrix is full and symmetric positive-definite.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Square matrix (<code>gsl_matrix</code>) to be inverted in place.</td></tr>
  </table>
  </dd>
</dl>
<p>The function first checks whether the input matrix is diagonal by testing all off-diagonal elements. If diagonal, each diagonal element \(a_{ii}\) is replaced by its reciprocal \(1/a_{ii}\).</p>
<p >For non-diagonal matrices, a Cholesky decomposition is performed: </p><p class="formulaDsp">
\[
\mathbf{A} = \mathbf{L}\mathbf{L}^T
\]
</p>
<p> followed by inversion using the Cholesky factors, yielding \(\mathbf{A}^{-1}\).</p>
<p >This approach assumes \(\mathbf{A}\) is <b>symmetric and positive-definite</b>.</p>
<dl class="section see"><dt>See also</dt><dd>gsl_linalg_cholesky_decomp, gsl_linalg_cholesky_invert</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The inversion is performed <b>in place</b>; the input matrix is overwritten.</li>
<li>No explicit symmetry or definiteness checks are performed  invalid input may result in numerical instability or GSL errors.</li>
<li>Diagonal detection assumes exact zeros for off-diagonal elements.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>For ill-conditioned matrices, consider using singular value decomposition (SVD) or regularization methods instead of direct inversion.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04499">4499</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4500</span>                 {</div>
<div class="line"><span class="lineno"> 4501</span> </div>
<div class="line"><span class="lineno"> 4502</span>  <span class="keywordtype">size_t</span> diag = 1;</div>
<div class="line"><span class="lineno"> 4503</span> </div>
<div class="line"><span class="lineno"> 4504</span>  <span class="comment">/* Get size... */</span></div>
<div class="line"><span class="lineno"> 4505</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = a-&gt;size1;</div>
<div class="line"><span class="lineno"> 4506</span> </div>
<div class="line"><span class="lineno"> 4507</span>  <span class="comment">/* Check if matrix is diagonal... */</span></div>
<div class="line"><span class="lineno"> 4508</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n &amp;&amp; diag; i++)</div>
<div class="line"><span class="lineno"> 4509</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &lt; n; j++)</div>
<div class="line"><span class="lineno"> 4510</span>      <span class="keywordflow">if</span> (gsl_matrix_get(a, i, j) != 0) {</div>
<div class="line"><span class="lineno"> 4511</span>        diag = 0;</div>
<div class="line"><span class="lineno"> 4512</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4513</span>      }</div>
<div class="line"><span class="lineno"> 4514</span> </div>
<div class="line"><span class="lineno"> 4515</span>  <span class="comment">/* Quick inversion of diagonal matrix... */</span></div>
<div class="line"><span class="lineno"> 4516</span>  <span class="keywordflow">if</span> (diag)</div>
<div class="line"><span class="lineno"> 4517</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; i++)</div>
<div class="line"><span class="lineno"> 4518</span>      gsl_matrix_set(a, i, i, 1 / gsl_matrix_get(a, i, i));</div>
<div class="line"><span class="lineno"> 4519</span> </div>
<div class="line"><span class="lineno"> 4520</span>  <span class="comment">/* Matrix inversion by means of Cholesky decomposition... */</span></div>
<div class="line"><span class="lineno"> 4521</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4522</span>    gsl_linalg_cholesky_decomp(a);</div>
<div class="line"><span class="lineno"> 4523</span>    gsl_linalg_cholesky_invert(a);</div>
<div class="line"><span class="lineno"> 4524</span>  }</div>
<div class="line"><span class="lineno"> 4525</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4aee3f51e782400eb3b82f7a68ac2209" name="a4aee3f51e782400eb3b82f7a68ac2209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aee3f51e782400eb3b82f7a68ac2209">&#9670;&nbsp;</a></span>matrix_product()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void matrix_product </td>
          <td>(</td>
          <td class="paramtype">const gsl_matrix *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>transpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute structured matrix products of the form \(A^T B A\) or \(A B A^T\). </p>
<p >Evaluates matrix products commonly used in covariance propagation and optimal estimation, depending on the specified transpose mode:</p><ul>
<li><b>transpose = 1</b>  computes \(\mathbf{A}^T \mathbf{B} \mathbf{A}\)</li>
<li><b>transpose = 2</b>  computes \(\mathbf{A} \mathbf{B} \mathbf{A}^T\)</li>
</ul>
<p >The vector \(\mathbf{b}\) represents the diagonal elements of \(\mathbf{B}\), i.e. a diagonal weighting or covariance matrix.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Input matrix \(\mathbf{A}\) (size mn). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Vector representing the diagonal of \(\mathbf{B}\) (length m or n). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transpose</td><td>Operation selector:<ul>
<li>1  compute \(A^T B A\)</li>
<li>2  compute \(A B A^T\) </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c</td><td>Output matrix to store the resulting product.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The function internally forms the scaled matrix \((B^{1/2} A)\) or \((A B^{1/2})\), then multiplies it using BLAS <code>dgemm</code> routines for efficiency: <p class="formulaDsp">
\[
  A^T B A = (B^{1/2}A)^T (B^{1/2}A), \quad
  A B A^T = (A B^{1/2}) (A B^{1/2})^T
  \]
</p>
</li>
<li>The input matrix \(\mathbf{A}\) is not modified.</li>
<li>This operation is typically used in computing gain matrices, propagated covariances, or sensitivity matrices in retrieval algorithms.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>gsl_blas_dgemm, <a class="el" href="jurassic_8h.html#ab86061d2a35e1ebf8c06ba0d13cf652b" title="Invert a square matrix, optimized for diagonal or symmetric positive-definite matrices.">matrix_invert</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Assumes \(\mathbf{B}\) is diagonal (provided as a vector of its diagonal elements).</li>
<li>The output matrix \(\mathbf{C}\) must be pre-allocated to the correct size.</li>
<li>No symmetry enforcement or normalization is applied.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>If <code>transpose</code> is not 1 or 2, the function performs no operation.</li>
<li>Numerical stability depends on the conditioning of A and the scaling of B.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04529">4529</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4533</span>                 {</div>
<div class="line"><span class="lineno"> 4534</span> </div>
<div class="line"><span class="lineno"> 4535</span>  <span class="comment">/* Set sizes... */</span></div>
<div class="line"><span class="lineno"> 4536</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> m = a-&gt;size1;</div>
<div class="line"><span class="lineno"> 4537</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = a-&gt;size2;</div>
<div class="line"><span class="lineno"> 4538</span> </div>
<div class="line"><span class="lineno"> 4539</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 4540</span>  gsl_matrix *aux = gsl_matrix_alloc(m, n);</div>
<div class="line"><span class="lineno"> 4541</span> </div>
<div class="line"><span class="lineno"> 4542</span>  <span class="comment">/* Compute A^T B A... */</span></div>
<div class="line"><span class="lineno"> 4543</span>  <span class="keywordflow">if</span> (transpose == 1) {</div>
<div class="line"><span class="lineno"> 4544</span> </div>
<div class="line"><span class="lineno"> 4545</span>    <span class="comment">/* Compute B^1/2 A... */</span></div>
<div class="line"><span class="lineno"> 4546</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; i++)</div>
<div class="line"><span class="lineno"> 4547</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; j++)</div>
<div class="line"><span class="lineno"> 4548</span>        gsl_matrix_set(aux, i, j,</div>
<div class="line"><span class="lineno"> 4549</span>                       gsl_vector_get(b, i) * gsl_matrix_get(a, i, j));</div>
<div class="line"><span class="lineno"> 4550</span> </div>
<div class="line"><span class="lineno"> 4551</span>    <span class="comment">/* Compute A^T B A = (B^1/2 A)^T (B^1/2 A)... */</span></div>
<div class="line"><span class="lineno"> 4552</span>    gsl_blas_dgemm(CblasTrans, CblasNoTrans, 1.0, aux, aux, 0.0, c);</div>
<div class="line"><span class="lineno"> 4553</span>  }</div>
<div class="line"><span class="lineno"> 4554</span> </div>
<div class="line"><span class="lineno"> 4555</span>  <span class="comment">/* Compute A B A^T... */</span></div>
<div class="line"><span class="lineno"> 4556</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (transpose == 2) {</div>
<div class="line"><span class="lineno"> 4557</span> </div>
<div class="line"><span class="lineno"> 4558</span>    <span class="comment">/* Compute A B^1/2... */</span></div>
<div class="line"><span class="lineno"> 4559</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; i++)</div>
<div class="line"><span class="lineno"> 4560</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; j++)</div>
<div class="line"><span class="lineno"> 4561</span>        gsl_matrix_set(aux, i, j,</div>
<div class="line"><span class="lineno"> 4562</span>                       gsl_matrix_get(a, i, j) * gsl_vector_get(b, j));</div>
<div class="line"><span class="lineno"> 4563</span> </div>
<div class="line"><span class="lineno"> 4564</span>    <span class="comment">/* Compute A B A^T = (A B^1/2) (A B^1/2)^T... */</span></div>
<div class="line"><span class="lineno"> 4565</span>    gsl_blas_dgemm(CblasNoTrans, CblasTrans, 1.0, aux, aux, 0.0, c);</div>
<div class="line"><span class="lineno"> 4566</span>  }</div>
<div class="line"><span class="lineno"> 4567</span> </div>
<div class="line"><span class="lineno"> 4568</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 4569</span>  gsl_matrix_free(aux);</div>
<div class="line"><span class="lineno"> 4570</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6380c9458cf356667952f9651932e27" name="ad6380c9458cf356667952f9651932e27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6380c9458cf356667952f9651932e27">&#9670;&nbsp;</a></span>obs2y()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t obs2y </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ida</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ira</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert observation radiances into a measurement vector. </p>
<p >Extracts all finite radiance values from the observation structure and stores them sequentially in a GSL vector. <br  />
 Optionally records detector (<code>id</code>) and ray path (<code>ir</code>) indices for each measurement element.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure containing observation setup (e.g. number of detectors). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs</td><td>Observation data structure containing radiances. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">y</td><td>Measurement vector to store radiances (may be NULL). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ida</td><td>Optional array to store detector indices (may be NULL). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ira</td><td>Optional array to store ray path indices (may be NULL). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of valid (finite) radiance values added to the vector.</dd></dl>
<ul>
<li>Loops over all detector channels (<code>nd</code>) and ray paths (<code>nr</code>).</li>
<li>Skips non-finite (<code>NaN</code> or <code>Inf</code>) radiance values.</li>
<li>Produces a compact measurement vector for use in retrievals and Jacobian computations.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x</a>, <a class="el" href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure.">x2atm</a>, <a class="el" href="jurassic_8h.html#ab49799958d13e57af5b20527f0990ce6" title="Compute the Jacobian (kernel) matrix by finite differences.">kernel</a>, <a class="el" href="jurassic_8h.html#abe93da56294b380e322c18ca2838fd51" title="Execute the selected forward model.">formod</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Arrays <code>ida</code> and <code>ira</code> must be preallocated with sufficient size to hold all finite radiances if provided.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04574">4574</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4579</span>            {</div>
<div class="line"><span class="lineno"> 4580</span> </div>
<div class="line"><span class="lineno"> 4581</span>  <span class="keywordtype">size_t</span> m = 0;</div>
<div class="line"><span class="lineno"> 4582</span> </div>
<div class="line"><span class="lineno"> 4583</span>  <span class="comment">/* Determine measurement vector... */</span></div>
<div class="line"><span class="lineno"> 4584</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 4585</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 4586</span>      <span class="keywordflow">if</span> (isfinite(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir])) {</div>
<div class="line"><span class="lineno"> 4587</span>        <span class="keywordflow">if</span> (y != NULL)</div>
<div class="line"><span class="lineno"> 4588</span>          gsl_vector_set(y, m, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir]);</div>
<div class="line"><span class="lineno"> 4589</span>        <span class="keywordflow">if</span> (ida != NULL)</div>
<div class="line"><span class="lineno"> 4590</span>          ida[m] = id;</div>
<div class="line"><span class="lineno"> 4591</span>        <span class="keywordflow">if</span> (ira != NULL)</div>
<div class="line"><span class="lineno"> 4592</span>          ira[m] = ir;</div>
<div class="line"><span class="lineno"> 4593</span>        m++;</div>
<div class="line"><span class="lineno"> 4594</span>      }</div>
<div class="line"><span class="lineno"> 4595</span> </div>
<div class="line"><span class="lineno"> 4596</span>  <span class="keywordflow">return</span> m;</div>
<div class="line"><span class="lineno"> 4597</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a881a1d24ae59077428bb4548fdefa2ee" name="a881a1d24ae59077428bb4548fdefa2ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a881a1d24ae59077428bb4548fdefa2ee">&#9670;&nbsp;</a></span>optimal_estimation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void optimal_estimation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structret__t.html">ret_t</a> *&#160;</td>
          <td class="paramname"><em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs_meas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm_apr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>chisq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform optimal estimation retrieval using LevenbergMarquardt minimization. </p>
<p >This function performs an optimal estimation of atmospheric state variables based on measured observations, a priori information, and forward radiative transfer modeling. The estimation follows the Rodgers (2000) formalism and uses a LevenbergMarquardt algorithm to iteratively minimize the cost function:</p>
<p > = (x - x_a)^T S_a (x - x_a) + (y - F(x))^T S_ (y - F(x)),</p>
<p >where <code>x</code> is the atmospheric state vector, <code>x_a</code> is its a priori estimate, <code>S_a</code> is the a priori covariance matrix, <code>y</code> is the measurement vector, <code>F(x)</code> is the forward model, and <code>S_</code> is the measurement error covariance.</p>
<p >The routine updates the atmospheric state until convergence criteria are met or the maximum number of iterations is reached. Optionally, the full retrieval error budget and averaging kernel analysis are computed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>Retrieval configuration and output container. Determines convergence, kernel recomputation frequency, and error analysis options. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control parameters describing problem setup (grids, species, etc.). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbl</td><td>Lookup tables required by the forward model. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs_meas</td><td>Measured observations used as input. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">obs_i</td><td>Intermediate and final modeled observations corresponding to the retrieved state. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm_apr</td><td>A priori atmospheric state used as reference. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">atm_i</td><td>Atmospheric state vector to be iteratively retrieved and updated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">chisq</td><td>Final value of the cost function () upon convergence.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Aborts early if the problem dimension is zero (no observations or unknowns).</li>
<li>State updates are constrained to physically meaningful bounds (pressure, temperature, etc.).</li>
<li>Matrix computations are performed using GSL (GNU Scientific Library).</li>
<li>If retrieval error analysis is enabled (<code>ret-&gt;err_ana</code>), the function produces:<ul>
<li>Retrieval covariance matrix</li>
<li>Error decomposition (noise, forward model)</li>
<li>Gain matrix</li>
<li>Averaging kernel matrix and diagnostic analysis</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Input structures must be properly initialized. The function allocates several GSL matrices and vectors, all of which are freed before returning. The caller is responsible only for memory outside this function.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#abe93da56294b380e322c18ca2838fd51" title="Execute the selected forward model.">formod()</a>, <a class="el" href="jurassic_8h.html#a092636f1592a6e34378a13f3e03e2f87" title="Compute the normalized quadratic cost function for optimal estimation.">cost_function()</a>, <a class="el" href="jurassic_8h.html#a04a9fd3342f5477d3cb1825fa60ed2a9" title="Analyze averaging kernel (AVK) matrix for retrieval diagnostics.">analyze_avk()</a>, <a class="el" href="jurassic_8h.html#ae9a11e5f03e0a307add4daf864977cec" title="Construct the a priori covariance matrix  for retrieval parameters.">set_cov_apr()</a>, <a class="el" href="jurassic_8h.html#a6bb69eac608c4019c689bf8280912c1f" title="Construct measurement error standard deviations and their inverse.">set_cov_meas()</a></dd></dl>
<dl class="section user"><dt>Reference</dt><dd>Rodgers, C. D. (2000). <em>Inverse Methods for Atmospheric Sounding: Theory and Practice.</em></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04601">4601</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4609</span>                 {</div>
<div class="line"><span class="lineno"> 4610</span> </div>
<div class="line"><span class="lineno"> 4611</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> ipa[<a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>], iqa[<a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>];</div>
<div class="line"><span class="lineno"> 4612</span> </div>
<div class="line"><span class="lineno"> 4613</span>  <span class="keywordtype">double</span> disq = 0, lmpar = 0.001;</div>
<div class="line"><span class="lineno"> 4614</span> </div>
<div class="line"><span class="lineno"> 4615</span>  <span class="comment">/* ------------------------------------------------------------</span></div>
<div class="line"><span class="lineno"> 4616</span><span class="comment">     Initialize...</span></div>
<div class="line"><span class="lineno"> 4617</span><span class="comment">     ------------------------------------------------------------ */</span></div>
<div class="line"><span class="lineno"> 4618</span> </div>
<div class="line"><span class="lineno"> 4619</span>  <span class="comment">/* Get sizes... */</span></div>
<div class="line"><span class="lineno"> 4620</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> m = <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, obs_meas, NULL, NULL, NULL);</div>
<div class="line"><span class="lineno"> 4621</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = <a class="code hl_function" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x</a>(ctl, atm_apr, NULL, iqa, ipa);</div>
<div class="line"><span class="lineno"> 4622</span>  <span class="keywordflow">if</span> (m == 0 || n == 0) {</div>
<div class="line"><span class="lineno"> 4623</span>    <a class="code hl_define" href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Check problem definition (m = 0 or n = 0)!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4624</span>    *chisq = GSL_NAN;</div>
<div class="line"><span class="lineno"> 4625</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 4626</span>  }</div>
<div class="line"><span class="lineno"> 4627</span> </div>
<div class="line"><span class="lineno"> 4628</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 4629</span>  gsl_matrix *a = gsl_matrix_alloc(n, n);</div>
<div class="line"><span class="lineno"> 4630</span>  gsl_matrix *cov = gsl_matrix_alloc(n, n);</div>
<div class="line"><span class="lineno"> 4631</span>  gsl_matrix *k_i = gsl_matrix_alloc(m, n);</div>
<div class="line"><span class="lineno"> 4632</span>  gsl_matrix *s_a_inv = gsl_matrix_alloc(n, n);</div>
<div class="line"><span class="lineno"> 4633</span> </div>
<div class="line"><span class="lineno"> 4634</span>  gsl_vector *b = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 4635</span>  gsl_vector *dx = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 4636</span>  gsl_vector *dy = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 4637</span>  gsl_vector *sig_eps_inv = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 4638</span>  gsl_vector *sig_formod = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 4639</span>  gsl_vector *sig_noise = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 4640</span>  gsl_vector *x_a = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 4641</span>  gsl_vector *x_i = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 4642</span>  gsl_vector *x_step = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 4643</span>  gsl_vector *y_aux = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 4644</span>  gsl_vector *y_i = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 4645</span>  gsl_vector *y_m = gsl_vector_alloc(m);</div>
<div class="line"><span class="lineno"> 4646</span> </div>
<div class="line"><span class="lineno"> 4647</span>  <span class="comment">/* Set initial state... */</span></div>
<div class="line"><span class="lineno"> 4648</span>  <a class="code hl_function" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1">copy_atm</a>(ctl, atm_i, atm_apr, 0);</div>
<div class="line"><span class="lineno"> 4649</span>  <a class="code hl_function" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e">copy_obs</a>(ctl, obs_i, obs_meas, 0);</div>
<div class="line"><span class="lineno"> 4650</span>  <a class="code hl_function" href="jurassic_8c.html#abe93da56294b380e322c18ca2838fd51">formod</a>(ctl, tbl, atm_i, obs_i);</div>
<div class="line"><span class="lineno"> 4651</span> </div>
<div class="line"><span class="lineno"> 4652</span>  <span class="comment">/* Set state vectors and observation vectors... */</span></div>
<div class="line"><span class="lineno"> 4653</span>  <a class="code hl_function" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x</a>(ctl, atm_apr, x_a, NULL, NULL);</div>
<div class="line"><span class="lineno"> 4654</span>  <a class="code hl_function" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x</a>(ctl, atm_i, x_i, NULL, NULL);</div>
<div class="line"><span class="lineno"> 4655</span>  <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, obs_meas, y_m, NULL, NULL);</div>
<div class="line"><span class="lineno"> 4656</span>  <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, obs_i, y_i, NULL, NULL);</div>
<div class="line"><span class="lineno"> 4657</span> </div>
<div class="line"><span class="lineno"> 4658</span>  <span class="comment">/* Set inverse a priori covariance S_a^-1... */</span></div>
<div class="line"><span class="lineno"> 4659</span>  <a class="code hl_function" href="jurassic_8c.html#ae9a11e5f03e0a307add4daf864977cec">set_cov_apr</a>(ret, ctl, atm_apr, iqa, ipa, s_a_inv);</div>
<div class="line"><span class="lineno"> 4660</span>  <a class="code hl_function" href="jurassic_8c.html#ae4d82cfc384f2845f2bd5ebbe66b6b26">write_matrix</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;matrix_cov_apr.tab&quot;</span>, ctl, s_a_inv,</div>
<div class="line"><span class="lineno"> 4661</span>               atm_i, obs_i, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 4662</span>  <a class="code hl_function" href="jurassic_8c.html#ab86061d2a35e1ebf8c06ba0d13cf652b">matrix_invert</a>(s_a_inv);</div>
<div class="line"><span class="lineno"> 4663</span> </div>
<div class="line"><span class="lineno"> 4664</span>  <span class="comment">/* Get measurement errors... */</span></div>
<div class="line"><span class="lineno"> 4665</span>  <a class="code hl_function" href="jurassic_8c.html#a6bb69eac608c4019c689bf8280912c1f">set_cov_meas</a>(ret, ctl, obs_meas, sig_noise, sig_formod, sig_eps_inv);</div>
<div class="line"><span class="lineno"> 4666</span> </div>
<div class="line"><span class="lineno"> 4667</span>  <span class="comment">/* Determine dx = x_i - x_a and dy = y - F(x_i) ... */</span></div>
<div class="line"><span class="lineno"> 4668</span>  gsl_vector_memcpy(dx, x_i);</div>
<div class="line"><span class="lineno"> 4669</span>  gsl_vector_sub(dx, x_a);</div>
<div class="line"><span class="lineno"> 4670</span>  gsl_vector_memcpy(dy, y_m);</div>
<div class="line"><span class="lineno"> 4671</span>  gsl_vector_sub(dy, y_i);</div>
<div class="line"><span class="lineno"> 4672</span> </div>
<div class="line"><span class="lineno"> 4673</span>  <span class="comment">/* Compute cost function... */</span></div>
<div class="line"><span class="lineno"> 4674</span>  *chisq = <a class="code hl_function" href="jurassic_8c.html#a092636f1592a6e34378a13f3e03e2f87">cost_function</a>(dx, dy, s_a_inv, sig_eps_inv);</div>
<div class="line"><span class="lineno"> 4675</span> </div>
<div class="line"><span class="lineno"> 4676</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 4677</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;it= %d / chi^2/m= %g&quot;</span>, 0, *chisq);</div>
<div class="line"><span class="lineno"> 4678</span> </div>
<div class="line"><span class="lineno"> 4679</span>  <span class="comment">/* Compute initial kernel... */</span></div>
<div class="line"><span class="lineno"> 4680</span>  <a class="code hl_function" href="jurassic_8c.html#ab49799958d13e57af5b20527f0990ce6">kernel</a>(ctl, tbl, atm_i, obs_i, k_i);</div>
<div class="line"><span class="lineno"> 4681</span> </div>
<div class="line"><span class="lineno"> 4682</span>  <span class="comment">/* ------------------------------------------------------------</span></div>
<div class="line"><span class="lineno"> 4683</span><span class="comment">     Levenberg-Marquardt minimization...</span></div>
<div class="line"><span class="lineno"> 4684</span><span class="comment">     ------------------------------------------------------------ */</span></div>
<div class="line"><span class="lineno"> 4685</span> </div>
<div class="line"><span class="lineno"> 4686</span>  <span class="comment">/* Outer loop... */</span></div>
<div class="line"><span class="lineno"> 4687</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 1; it &lt;= ret-&gt;<a class="code hl_variable" href="structret__t.html#aa88d6539597eb1b823c8e68d6b903c3b">conv_itmax</a>; it++) {</div>
<div class="line"><span class="lineno"> 4688</span> </div>
<div class="line"><span class="lineno"> 4689</span>    <span class="comment">/* Store current cost function value... */</span></div>
<div class="line"><span class="lineno"> 4690</span>    <span class="keywordtype">double</span> chisq_old = *chisq;</div>
<div class="line"><span class="lineno"> 4691</span> </div>
<div class="line"><span class="lineno"> 4692</span>    <span class="comment">/* Compute kernel matrix K_i... */</span></div>
<div class="line"><span class="lineno"> 4693</span>    <span class="keywordflow">if</span> (it &gt; 1 &amp;&amp; it % ret-&gt;<a class="code hl_variable" href="structret__t.html#a9f62c84930d539206014752d3e63b4d0">kernel_recomp</a> == 0)</div>
<div class="line"><span class="lineno"> 4694</span>      <a class="code hl_function" href="jurassic_8c.html#ab49799958d13e57af5b20527f0990ce6">kernel</a>(ctl, tbl, atm_i, obs_i, k_i);</div>
<div class="line"><span class="lineno"> 4695</span> </div>
<div class="line"><span class="lineno"> 4696</span>    <span class="comment">/* Compute K_i^T * S_eps^{-1} * K_i ... */</span></div>
<div class="line"><span class="lineno"> 4697</span>    <span class="keywordflow">if</span> (it == 1 || it % ret-&gt;<a class="code hl_variable" href="structret__t.html#a9f62c84930d539206014752d3e63b4d0">kernel_recomp</a> == 0)</div>
<div class="line"><span class="lineno"> 4698</span>      <a class="code hl_function" href="jurassic_8c.html#a4aee3f51e782400eb3b82f7a68ac2209">matrix_product</a>(k_i, sig_eps_inv, 1, cov);</div>
<div class="line"><span class="lineno"> 4699</span> </div>
<div class="line"><span class="lineno"> 4700</span>    <span class="comment">/* Determine b = K_i^T * S_eps^{-1} * dy - S_a^{-1} * dx ... */</span></div>
<div class="line"><span class="lineno"> 4701</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; i++)</div>
<div class="line"><span class="lineno"> 4702</span>      gsl_vector_set(y_aux, i, gsl_vector_get(dy, i)</div>
<div class="line"><span class="lineno"> 4703</span>                     * <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(gsl_vector_get(sig_eps_inv, i)));</div>
<div class="line"><span class="lineno"> 4704</span>    gsl_blas_dgemv(CblasTrans, 1.0, k_i, y_aux, 0.0, b);</div>
<div class="line"><span class="lineno"> 4705</span>    gsl_blas_dgemv(CblasNoTrans, -1.0, s_a_inv, dx, 1.0, b);</div>
<div class="line"><span class="lineno"> 4706</span> </div>
<div class="line"><span class="lineno"> 4707</span>    <span class="comment">/* Inner loop... */</span></div>
<div class="line"><span class="lineno"> 4708</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it2 = 0; it2 &lt; 20; it2++) {</div>
<div class="line"><span class="lineno"> 4709</span> </div>
<div class="line"><span class="lineno"> 4710</span>      <span class="comment">/* Compute A = (1 + lmpar) * S_a^{-1} + K_i^T * S_eps^{-1} * K_i ... */</span></div>
<div class="line"><span class="lineno"> 4711</span>      gsl_matrix_memcpy(a, s_a_inv);</div>
<div class="line"><span class="lineno"> 4712</span>      gsl_matrix_scale(a, 1 + lmpar);</div>
<div class="line"><span class="lineno"> 4713</span>      gsl_matrix_add(a, cov);</div>
<div class="line"><span class="lineno"> 4714</span> </div>
<div class="line"><span class="lineno"> 4715</span>      <span class="comment">/* Solve A * x_step = b by means of Cholesky decomposition... */</span></div>
<div class="line"><span class="lineno"> 4716</span>      gsl_linalg_cholesky_decomp(a);</div>
<div class="line"><span class="lineno"> 4717</span>      gsl_linalg_cholesky_solve(a, b, x_step);</div>
<div class="line"><span class="lineno"> 4718</span> </div>
<div class="line"><span class="lineno"> 4719</span>      <span class="comment">/* Update atmospheric state... */</span></div>
<div class="line"><span class="lineno"> 4720</span>      gsl_vector_add(x_i, x_step);</div>
<div class="line"><span class="lineno"> 4721</span>      <a class="code hl_function" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1">copy_atm</a>(ctl, atm_i, atm_apr, 0);</div>
<div class="line"><span class="lineno"> 4722</span>      <a class="code hl_function" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e">copy_obs</a>(ctl, obs_i, obs_meas, 0);</div>
<div class="line"><span class="lineno"> 4723</span>      <a class="code hl_function" href="jurassic_8c.html#a59e72c7cead4b4b7aaf096803bc7360c">x2atm</a>(ctl, x_i, atm_i);</div>
<div class="line"><span class="lineno"> 4724</span> </div>
<div class="line"><span class="lineno"> 4725</span>      <span class="comment">/* Check atmospheric state... */</span></div>
<div class="line"><span class="lineno"> 4726</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 4727</span>        atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = <a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], 5e-7), 5e4);</div>
<div class="line"><span class="lineno"> 4728</span>        atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip] = <a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip], 100), 400);</div>
<div class="line"><span class="lineno"> 4729</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 4730</span>          atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip] = <a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip], 0), 1);</div>
<div class="line"><span class="lineno"> 4731</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 4732</span>          atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip] = <a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip], 0);</div>
<div class="line"><span class="lineno"> 4733</span>      }</div>
<div class="line"><span class="lineno"> 4734</span>      atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a> = <a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>, 0);</div>
<div class="line"><span class="lineno"> 4735</span>      atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a> = <a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>, 0.1);</div>
<div class="line"><span class="lineno"> 4736</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 4737</span>        atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl] = <a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl], 0);</div>
<div class="line"><span class="lineno"> 4738</span>      atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a> = <a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>, 100), 400);</div>
<div class="line"><span class="lineno"> 4739</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 4740</span>        atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf] = <a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_define" href="jurassic_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(atm_i-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf], 0), 1);</div>
<div class="line"><span class="lineno"> 4741</span> </div>
<div class="line"><span class="lineno"> 4742</span>      <span class="comment">/* Forward calculation... */</span></div>
<div class="line"><span class="lineno"> 4743</span>      <a class="code hl_function" href="jurassic_8c.html#abe93da56294b380e322c18ca2838fd51">formod</a>(ctl, tbl, atm_i, obs_i);</div>
<div class="line"><span class="lineno"> 4744</span>      <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, obs_i, y_i, NULL, NULL);</div>
<div class="line"><span class="lineno"> 4745</span> </div>
<div class="line"><span class="lineno"> 4746</span>      <span class="comment">/* Determine dx = x_i - x_a and dy = y - F(x_i) ... */</span></div>
<div class="line"><span class="lineno"> 4747</span>      gsl_vector_memcpy(dx, x_i);</div>
<div class="line"><span class="lineno"> 4748</span>      gsl_vector_sub(dx, x_a);</div>
<div class="line"><span class="lineno"> 4749</span>      gsl_vector_memcpy(dy, y_m);</div>
<div class="line"><span class="lineno"> 4750</span>      gsl_vector_sub(dy, y_i);</div>
<div class="line"><span class="lineno"> 4751</span> </div>
<div class="line"><span class="lineno"> 4752</span>      <span class="comment">/* Compute cost function... */</span></div>
<div class="line"><span class="lineno"> 4753</span>      *chisq = <a class="code hl_function" href="jurassic_8c.html#a092636f1592a6e34378a13f3e03e2f87">cost_function</a>(dx, dy, s_a_inv, sig_eps_inv);</div>
<div class="line"><span class="lineno"> 4754</span> </div>
<div class="line"><span class="lineno"> 4755</span>      <span class="comment">/* Modify Levenberg-Marquardt parameter... */</span></div>
<div class="line"><span class="lineno"> 4756</span>      <span class="keywordflow">if</span> (*chisq &gt; chisq_old) {</div>
<div class="line"><span class="lineno"> 4757</span>        lmpar *= 10;</div>
<div class="line"><span class="lineno"> 4758</span>        gsl_vector_sub(x_i, x_step);</div>
<div class="line"><span class="lineno"> 4759</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4760</span>        lmpar /= 10;</div>
<div class="line"><span class="lineno"> 4761</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4762</span>      }</div>
<div class="line"><span class="lineno"> 4763</span>    }</div>
<div class="line"><span class="lineno"> 4764</span> </div>
<div class="line"><span class="lineno"> 4765</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 4766</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;it= %d / chi^2/m= %g&quot;</span>, it, *chisq);</div>
<div class="line"><span class="lineno"> 4767</span> </div>
<div class="line"><span class="lineno"> 4768</span>    <span class="comment">/* Get normalized step size in state space... */</span></div>
<div class="line"><span class="lineno"> 4769</span>    gsl_blas_ddot(x_step, b, &amp;disq);</div>
<div class="line"><span class="lineno"> 4770</span>    disq /= (double) n;</div>
<div class="line"><span class="lineno"> 4771</span> </div>
<div class="line"><span class="lineno"> 4772</span>    <span class="comment">/* Convergence test... */</span></div>
<div class="line"><span class="lineno"> 4773</span>    <span class="keywordflow">if</span> ((it == 1 || it % ret-&gt;<a class="code hl_variable" href="structret__t.html#a9f62c84930d539206014752d3e63b4d0">kernel_recomp</a> == 0) &amp;&amp; disq &lt; ret-&gt;<a class="code hl_variable" href="structret__t.html#a5dee82585b029a4af837e27763984cee">conv_dmin</a>)</div>
<div class="line"><span class="lineno"> 4774</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4775</span>  }</div>
<div class="line"><span class="lineno"> 4776</span> </div>
<div class="line"><span class="lineno"> 4777</span>  <span class="comment">/* ------------------------------------------------------------</span></div>
<div class="line"><span class="lineno"> 4778</span><span class="comment">     Analysis of retrieval results...</span></div>
<div class="line"><span class="lineno"> 4779</span><span class="comment">     ------------------------------------------------------------ */</span></div>
<div class="line"><span class="lineno"> 4780</span> </div>
<div class="line"><span class="lineno"> 4781</span>  <span class="comment">/* Check if error analysis is requested... */</span></div>
<div class="line"><span class="lineno"> 4782</span>  <span class="keywordflow">if</span> (ret-&gt;<a class="code hl_variable" href="structret__t.html#a53daece1342c39cb7720864e844bf0b5">err_ana</a>) {</div>
<div class="line"><span class="lineno"> 4783</span> </div>
<div class="line"><span class="lineno"> 4784</span>    <span class="comment">/* Store results... */</span></div>
<div class="line"><span class="lineno"> 4785</span>    <a class="code hl_function" href="jurassic_8c.html#a26be12322766162766071e8cd3587515">write_atm</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;atm_final.tab&quot;</span>, ctl, atm_i);</div>
<div class="line"><span class="lineno"> 4786</span>    <a class="code hl_function" href="jurassic_8c.html#aaa92bd5536bbf6cb6b4f541e24dac461">write_obs</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;obs_final.tab&quot;</span>, ctl, obs_i);</div>
<div class="line"><span class="lineno"> 4787</span>    <a class="code hl_function" href="jurassic_8c.html#ae4d82cfc384f2845f2bd5ebbe66b6b26">write_matrix</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;matrix_kernel.tab&quot;</span>, ctl, k_i,</div>
<div class="line"><span class="lineno"> 4788</span>                 atm_i, obs_i, <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 4789</span> </div>
<div class="line"><span class="lineno"> 4790</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 4791</span>    gsl_matrix *auxnm = gsl_matrix_alloc(n, m);</div>
<div class="line"><span class="lineno"> 4792</span>    gsl_matrix *corr = gsl_matrix_alloc(n, n);</div>
<div class="line"><span class="lineno"> 4793</span>    gsl_matrix *gain = gsl_matrix_alloc(n, m);</div>
<div class="line"><span class="lineno"> 4794</span> </div>
<div class="line"><span class="lineno"> 4795</span>    <span class="comment">/* Compute inverse retrieval covariance...</span></div>
<div class="line"><span class="lineno"> 4796</span><span class="comment">       cov^{-1} = S_a^{-1} + K_i^T * S_eps^{-1} * K_i */</span></div>
<div class="line"><span class="lineno"> 4797</span>    <a class="code hl_function" href="jurassic_8c.html#a4aee3f51e782400eb3b82f7a68ac2209">matrix_product</a>(k_i, sig_eps_inv, 1, cov);</div>
<div class="line"><span class="lineno"> 4798</span>    gsl_matrix_add(cov, s_a_inv);</div>
<div class="line"><span class="lineno"> 4799</span> </div>
<div class="line"><span class="lineno"> 4800</span>    <span class="comment">/* Compute retrieval covariance... */</span></div>
<div class="line"><span class="lineno"> 4801</span>    <a class="code hl_function" href="jurassic_8c.html#ab86061d2a35e1ebf8c06ba0d13cf652b">matrix_invert</a>(cov);</div>
<div class="line"><span class="lineno"> 4802</span>    <a class="code hl_function" href="jurassic_8c.html#ae4d82cfc384f2845f2bd5ebbe66b6b26">write_matrix</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;matrix_cov_ret.tab&quot;</span>, ctl, cov,</div>
<div class="line"><span class="lineno"> 4803</span>                 atm_i, obs_i, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 4804</span>    <a class="code hl_function" href="jurassic_8c.html#aec8df2858073df466eb01b273cc888ab">write_stddev</a>(<span class="stringliteral">&quot;total&quot;</span>, ret, ctl, atm_i, cov);</div>
<div class="line"><span class="lineno"> 4805</span> </div>
<div class="line"><span class="lineno"> 4806</span>    <span class="comment">/* Compute correlation matrix... */</span></div>
<div class="line"><span class="lineno"> 4807</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; i++)</div>
<div class="line"><span class="lineno"> 4808</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; j++)</div>
<div class="line"><span class="lineno"> 4809</span>        gsl_matrix_set(corr, i, j, gsl_matrix_get(cov, i, j)</div>
<div class="line"><span class="lineno"> 4810</span>                       / sqrt(gsl_matrix_get(cov, i, i))</div>
<div class="line"><span class="lineno"> 4811</span>                       / sqrt(gsl_matrix_get(cov, j, j)));</div>
<div class="line"><span class="lineno"> 4812</span>    <a class="code hl_function" href="jurassic_8c.html#ae4d82cfc384f2845f2bd5ebbe66b6b26">write_matrix</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;matrix_corr.tab&quot;</span>, ctl, corr,</div>
<div class="line"><span class="lineno"> 4813</span>                 atm_i, obs_i, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 4814</span> </div>
<div class="line"><span class="lineno"> 4815</span>    <span class="comment">/* Compute gain matrix...</span></div>
<div class="line"><span class="lineno"> 4816</span><span class="comment">       G = cov * K^T * S_eps^{-1} */</span></div>
<div class="line"><span class="lineno"> 4817</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; i++)</div>
<div class="line"><span class="lineno"> 4818</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; m; j++)</div>
<div class="line"><span class="lineno"> 4819</span>        gsl_matrix_set(auxnm, i, j, gsl_matrix_get(k_i, j, i)</div>
<div class="line"><span class="lineno"> 4820</span>                       * <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(gsl_vector_get(sig_eps_inv, j)));</div>
<div class="line"><span class="lineno"> 4821</span>    gsl_blas_dgemm(CblasNoTrans, CblasNoTrans, 1.0, cov, auxnm, 0.0, gain);</div>
<div class="line"><span class="lineno"> 4822</span>    <a class="code hl_function" href="jurassic_8c.html#ae4d82cfc384f2845f2bd5ebbe66b6b26">write_matrix</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;matrix_gain.tab&quot;</span>, ctl, gain,</div>
<div class="line"><span class="lineno"> 4823</span>                 atm_i, obs_i, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>);</div>
<div class="line"><span class="lineno"> 4824</span> </div>
<div class="line"><span class="lineno"> 4825</span>    <span class="comment">/* Compute retrieval error due to noise... */</span></div>
<div class="line"><span class="lineno"> 4826</span>    <a class="code hl_function" href="jurassic_8c.html#a4aee3f51e782400eb3b82f7a68ac2209">matrix_product</a>(gain, sig_noise, 2, a);</div>
<div class="line"><span class="lineno"> 4827</span>    <a class="code hl_function" href="jurassic_8c.html#aec8df2858073df466eb01b273cc888ab">write_stddev</a>(<span class="stringliteral">&quot;noise&quot;</span>, ret, ctl, atm_i, a);</div>
<div class="line"><span class="lineno"> 4828</span> </div>
<div class="line"><span class="lineno"> 4829</span>    <span class="comment">/* Compute retrieval error  due to forward model errors... */</span></div>
<div class="line"><span class="lineno"> 4830</span>    <a class="code hl_function" href="jurassic_8c.html#a4aee3f51e782400eb3b82f7a68ac2209">matrix_product</a>(gain, sig_formod, 2, a);</div>
<div class="line"><span class="lineno"> 4831</span>    <a class="code hl_function" href="jurassic_8c.html#aec8df2858073df466eb01b273cc888ab">write_stddev</a>(<span class="stringliteral">&quot;formod&quot;</span>, ret, ctl, atm_i, a);</div>
<div class="line"><span class="lineno"> 4832</span> </div>
<div class="line"><span class="lineno"> 4833</span>    <span class="comment">/* Compute averaging kernel matrix</span></div>
<div class="line"><span class="lineno"> 4834</span><span class="comment">       A = G * K ... */</span></div>
<div class="line"><span class="lineno"> 4835</span>    gsl_blas_dgemm(CblasNoTrans, CblasNoTrans, 1.0, gain, k_i, 0.0, a);</div>
<div class="line"><span class="lineno"> 4836</span>    <a class="code hl_function" href="jurassic_8c.html#ae4d82cfc384f2845f2bd5ebbe66b6b26">write_matrix</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, <span class="stringliteral">&quot;matrix_avk.tab&quot;</span>, ctl, a,</div>
<div class="line"><span class="lineno"> 4837</span>                 atm_i, obs_i, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 4838</span> </div>
<div class="line"><span class="lineno"> 4839</span>    <span class="comment">/* Analyze averaging kernel matrix... */</span></div>
<div class="line"><span class="lineno"> 4840</span>    <a class="code hl_function" href="jurassic_8c.html#a04a9fd3342f5477d3cb1825fa60ed2a9">analyze_avk</a>(ret, ctl, atm_i, iqa, ipa, a);</div>
<div class="line"><span class="lineno"> 4841</span> </div>
<div class="line"><span class="lineno"> 4842</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 4843</span>    gsl_matrix_free(auxnm);</div>
<div class="line"><span class="lineno"> 4844</span>    gsl_matrix_free(corr);</div>
<div class="line"><span class="lineno"> 4845</span>    gsl_matrix_free(gain);</div>
<div class="line"><span class="lineno"> 4846</span>  }</div>
<div class="line"><span class="lineno"> 4847</span> </div>
<div class="line"><span class="lineno"> 4848</span>  <span class="comment">/* ------------------------------------------------------------</span></div>
<div class="line"><span class="lineno"> 4849</span><span class="comment">     Finalize...</span></div>
<div class="line"><span class="lineno"> 4850</span><span class="comment">     ------------------------------------------------------------ */</span></div>
<div class="line"><span class="lineno"> 4851</span> </div>
<div class="line"><span class="lineno"> 4852</span>  gsl_matrix_free(a);</div>
<div class="line"><span class="lineno"> 4853</span>  gsl_matrix_free(cov);</div>
<div class="line"><span class="lineno"> 4854</span>  gsl_matrix_free(k_i);</div>
<div class="line"><span class="lineno"> 4855</span>  gsl_matrix_free(s_a_inv);</div>
<div class="line"><span class="lineno"> 4856</span> </div>
<div class="line"><span class="lineno"> 4857</span>  gsl_vector_free(b);</div>
<div class="line"><span class="lineno"> 4858</span>  gsl_vector_free(dx);</div>
<div class="line"><span class="lineno"> 4859</span>  gsl_vector_free(dy);</div>
<div class="line"><span class="lineno"> 4860</span>  gsl_vector_free(sig_eps_inv);</div>
<div class="line"><span class="lineno"> 4861</span>  gsl_vector_free(sig_formod);</div>
<div class="line"><span class="lineno"> 4862</span>  gsl_vector_free(sig_noise);</div>
<div class="line"><span class="lineno"> 4863</span>  gsl_vector_free(x_a);</div>
<div class="line"><span class="lineno"> 4864</span>  gsl_vector_free(x_i);</div>
<div class="line"><span class="lineno"> 4865</span>  gsl_vector_free(x_step);</div>
<div class="line"><span class="lineno"> 4866</span>  gsl_vector_free(y_aux);</div>
<div class="line"><span class="lineno"> 4867</span>  gsl_vector_free(y_i);</div>
<div class="line"><span class="lineno"> 4868</span>  gsl_vector_free(y_m);</div>
<div class="line"><span class="lineno"> 4869</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a04a9fd3342f5477d3cb1825fa60ed2a9"><div class="ttname"><a href="jurassic_8c.html#a04a9fd3342f5477d3cb1825fa60ed2a9">analyze_avk</a></div><div class="ttdeci">void analyze_avk(const ret_t *ret, const ctl_t *ctl, const atm_t *atm, const int *iqa, const int *ipa, const gsl_matrix *avk)</div><div class="ttdoc">Analyze averaging kernel (AVK) matrix for retrieval diagnostics.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l00029">jurassic.c:29</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a092636f1592a6e34378a13f3e03e2f87"><div class="ttname"><a href="jurassic_8c.html#a092636f1592a6e34378a13f3e03e2f87">cost_function</a></div><div class="ttdeci">double cost_function(const gsl_vector *dx, const gsl_vector *dy, const gsl_matrix *s_a_inv, const gsl_vector *sig_eps_inv)</div><div class="ttdoc">Compute the normalized quadratic cost function for optimal estimation.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l01179">jurassic.c:1179</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a4aee3f51e782400eb3b82f7a68ac2209"><div class="ttname"><a href="jurassic_8c.html#a4aee3f51e782400eb3b82f7a68ac2209">matrix_product</a></div><div class="ttdeci">void matrix_product(const gsl_matrix *a, const gsl_vector *b, const int transpose, gsl_matrix *c)</div><div class="ttdoc">Compute structured matrix products of the form  or .</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04529">jurassic.c:4529</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a6bb69eac608c4019c689bf8280912c1f"><div class="ttname"><a href="jurassic_8c.html#a6bb69eac608c4019c689bf8280912c1f">set_cov_meas</a></div><div class="ttdeci">void set_cov_meas(const ret_t *ret, const ctl_t *ctl, const obs_t *obs, gsl_vector *sig_noise, gsl_vector *sig_formod, gsl_vector *sig_eps_inv)</div><div class="ttdoc">Construct measurement error standard deviations and their inverse.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06447">jurassic.c:6447</a></div></div>
<div class="ttc" id="ajurassic_8c_html_aaa92bd5536bbf6cb6b4f541e24dac461"><div class="ttname"><a href="jurassic_8c.html#aaa92bd5536bbf6cb6b4f541e24dac461">write_obs</a></div><div class="ttdeci">void write_obs(const char *dirname, const char *filename, const ctl_t *ctl, const obs_t *obs)</div><div class="ttdoc">Write observation data to an output file in ASCII or binary format.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07033">jurassic.c:7033</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ab49799958d13e57af5b20527f0990ce6"><div class="ttname"><a href="jurassic_8c.html#ab49799958d13e57af5b20527f0990ce6">kernel</a></div><div class="ttdeci">void kernel(const ctl_t *ctl, const tbl_t *tbl, atm_t *atm, obs_t *obs, gsl_matrix *k)</div><div class="ttdoc">Compute the Jacobian (kernel) matrix by finite differences.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04333">jurassic.c:4333</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ab86061d2a35e1ebf8c06ba0d13cf652b"><div class="ttname"><a href="jurassic_8c.html#ab86061d2a35e1ebf8c06ba0d13cf652b">matrix_invert</a></div><div class="ttdeci">void matrix_invert(gsl_matrix *a)</div><div class="ttdoc">Invert a square matrix, optimized for diagonal or symmetric positive-definite matrices.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04499">jurassic.c:4499</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ae4d82cfc384f2845f2bd5ebbe66b6b26"><div class="ttname"><a href="jurassic_8c.html#ae4d82cfc384f2845f2bd5ebbe66b6b26">write_matrix</a></div><div class="ttdeci">void write_matrix(const char *dirname, const char *filename, const ctl_t *ctl, const gsl_matrix *matrix, const atm_t *atm, const obs_t *obs, const char *rowspace, const char *colspace, const char *sort)</div><div class="ttdoc">Write a fully annotated matrix (e.g., Jacobian or gain matrix) to file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06855">jurassic.c:6855</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ae9a11e5f03e0a307add4daf864977cec"><div class="ttname"><a href="jurassic_8c.html#ae9a11e5f03e0a307add4daf864977cec">set_cov_apr</a></div><div class="ttdeci">void set_cov_apr(const ret_t *ret, const ctl_t *ctl, const atm_t *atm, const int *iqa, const int *ipa, gsl_matrix *s_a)</div><div class="ttdoc">Construct the a priori covariance matrix  for retrieval parameters.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06336">jurassic.c:6336</a></div></div>
<div class="ttc" id="ajurassic_8c_html_aec8df2858073df466eb01b273cc888ab"><div class="ttname"><a href="jurassic_8c.html#aec8df2858073df466eb01b273cc888ab">write_stddev</a></div><div class="ttdeci">void write_stddev(const char *quantity, const ret_t *ret, const ctl_t *ctl, const atm_t *atm, const gsl_matrix *s)</div><div class="ttdoc">Write retrieval standard deviation profiles to disk.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07253">jurassic.c:7253</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a8f75b971030a39ef811d3526a62b36b8"><div class="ttname"><a href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a></div><div class="ttdeci">#define WARN(...)</div><div class="ttdoc">Print a warning message with contextual information.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00915">jurassic.h:915</a></div></div>
<div class="ttc" id="astructret__t_html_a53daece1342c39cb7720864e844bf0b5"><div class="ttname"><a href="structret__t.html#a53daece1342c39cb7720864e844bf0b5">ret_t::err_ana</a></div><div class="ttdeci">int err_ana</div><div class="ttdoc">Carry out error analysis (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01344">jurassic.h:1344</a></div></div>
<div class="ttc" id="astructret__t_html_a5dee82585b029a4af837e27763984cee"><div class="ttname"><a href="structret__t.html#a5dee82585b029a4af837e27763984cee">ret_t::conv_dmin</a></div><div class="ttdeci">double conv_dmin</div><div class="ttdoc">Minimum normalized step size in state space.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01341">jurassic.h:1341</a></div></div>
<div class="ttc" id="astructret__t_html_a9f62c84930d539206014752d3e63b4d0"><div class="ttname"><a href="structret__t.html#a9f62c84930d539206014752d3e63b4d0">ret_t::kernel_recomp</a></div><div class="ttdeci">int kernel_recomp</div><div class="ttdoc">Re-computation of kernel matrix (number of iterations).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01335">jurassic.h:1335</a></div></div>
<div class="ttc" id="astructret__t_html_aa88d6539597eb1b823c8e68d6b903c3b"><div class="ttname"><a href="structret__t.html#aa88d6539597eb1b823c8e68d6b903c3b">ret_t::conv_itmax</a></div><div class="ttdeci">int conv_itmax</div><div class="ttdoc">Maximum number of iterations.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01338">jurassic.h:1338</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a881a1d24ae59077428bb4548fdefa2ee_cgraph.png" border="0" usemap="#ajurassic_8h_a881a1d24ae59077428bb4548fdefa2ee_cgraph" alt=""/></div>
<map name="ajurassic_8h_a881a1d24ae59077428bb4548fdefa2ee_cgraph" id="ajurassic_8h_a881a1d24ae59077428bb4548fdefa2ee_cgraph">
<area shape="rect" title="Perform optimal estimation retrieval using LevenbergMarquardt minimization." alt="" coords="5,622,136,648"/>
<area shape="rect" href="jurassic_8c.html#a04a9fd3342f5477d3cb1825fa60ed2a9" title="Analyze averaging kernel (AVK) matrix for retrieval diagnostics." alt="" coords="191,267,284,294"/>
<area shape="rect" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1" title="Copy or initialize atmospheric profile data." alt="" coords="372,343,451,370"/>
<area shape="rect" href="jurassic_8c.html#a26be12322766162766071e8cd3587515" title="Write atmospheric data to a file." alt="" coords="372,242,451,268"/>
<area shape="rect" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements." alt="" coords="383,787,440,814"/>
<area shape="rect" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e" title="Copy or initialize observation geometry and radiance data." alt="" coords="707,686,785,712"/>
<area shape="rect" href="jurassic_8c.html#a092636f1592a6e34378a13f3e03e2f87" title="Compute the normalized quadratic cost function for optimal estimation." alt="" coords="187,470,287,496"/>
<area shape="rect" href="jurassic_8c.html#abe93da56294b380e322c18ca2838fd51" title="Execute the selected forward model." alt="" coords="380,495,443,522"/>
<area shape="rect" href="jurassic_8c.html#ab49799958d13e57af5b20527f0990ce6" title="Compute the Jacobian (kernel) matrix by finite differences." alt="" coords="209,571,266,598"/>
<area shape="rect" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27" title="Convert observation radiances into a measurement vector." alt="" coords="383,888,439,915"/>
<area shape="rect" href="jurassic_8c.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure." alt="" coords="383,406,440,432"/>
<area shape="rect" href="jurassic_8c.html#ab86061d2a35e1ebf8c06ba0d13cf652b" title="Invert a square matrix, optimized for diagonal or symmetric positive&#45;definite matrices." alt="" coords="189,723,285,750"/>
<area shape="rect" href="jurassic_8c.html#a4aee3f51e782400eb3b82f7a68ac2209" title="Compute structured matrix products of the form &#160;or ." alt="" coords="184,774,291,800"/>
<area shape="rect" href="jurassic_8c.html#ae9a11e5f03e0a307add4daf864977cec" title="Construct the a priori covariance matrix &#160;for retrieval parameters." alt="" coords="191,672,284,699"/>
<area shape="rect" href="jurassic_8c.html#a6bb69eac608c4019c689bf8280912c1f" title="Construct measurement error standard deviations and their inverse." alt="" coords="184,875,291,902"/>
<area shape="rect" href="jurassic_8c.html#ae4d82cfc384f2845f2bd5ebbe66b6b26" title="Write a fully annotated matrix (e.g., Jacobian or gain matrix) to file." alt="" coords="191,976,283,1003"/>
<area shape="rect" href="jurassic_8c.html#aaa92bd5536bbf6cb6b4f541e24dac461" title="Write observation data to an output file in ASCII or binary format." alt="" coords="198,1027,277,1054"/>
<area shape="rect" href="jurassic_8c.html#aec8df2858073df466eb01b273cc888ab" title="Write retrieval standard deviation profiles to disk." alt="" coords="189,318,285,344"/>
<area shape="rect" href="jurassic_8c.html#acbc0cac17f91169e812ecee2bc7fc990" title="Analyze averaging kernel submatrix for a specific retrieved quantity." alt="" coords="339,191,484,218"/>
<area shape="rect" href="jurassic_8c.html#aedaa4b13833a182bbff8034a3b2edae0" title="Write atmospheric data to an ASCII file." alt="" coords="532,179,639,206"/>
<area shape="rect" href="jurassic_8c.html#abb2306151e16b13ed93d84d379c8bb0e" title="Write atmospheric data to a binary file." alt="" coords="534,230,637,256"/>
<area shape="rect" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f" title="Append a single atmospheric value to the state vector." alt="" coords="541,787,629,814"/>
<area shape="rect" href="jurassic_8c.html#ab0c3109373d1d5edcf57840c288f6f53" title="Apply field&#45;of&#45;view (FOV) convolution to modeled radiances." alt="" coords="542,534,629,560"/>
<area shape="rect" href="jurassic_8c.html#a9727c4e0e5bc85384762b6ad81a8c3be" title="Compute line&#45;of&#45;sight radiances using the pencil&#45;beam forward model." alt="" coords="534,331,637,358"/>
<area shape="rect" href="jurassic_8c.html#a2caf20484e8e2f52ff3650321b7c704c" title="Interface routine for the Reference Forward Model (RFM)." alt="" coords="541,483,629,510"/>
<area shape="rect" href="jurassic_8c.html#ad69ab6edb8f722212fb01e12d8809643" title="Adjust pressure profile using the hydrostatic equation." alt="" coords="543,432,628,459"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="1018,382,1093,408"/>
<area shape="rect" href="jurassic_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="711,280,781,307"/>
<area shape="rect" href="jurassic_8c.html#a363f5205cd58d7a22133f704f1137181" title="Compute total extinction including gaseous continua." alt="" coords="687,128,805,155"/>
<area shape="rect" href="jurassic_8c.html#ac7826de16feb2eb6730b661bf8deba90" title="Interpolate the source function (Planck radiance) at a given temperature." alt="" coords="690,27,802,54"/>
<area shape="rect" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="869,483,941,510"/>
<area shape="rect" href="jurassic_8c.html#a5e22cd63c35ef6e2c9b9023e2c3945d8" title="Interpolate emissivities and transmittances using the CurtisGodson approximation (CGA)." alt="" coords="853,230,956,256"/>
<area shape="rect" href="jurassic_8c.html#a2b67aa3affea0dd3c6da502dab26d22d" title="Interpolate emissivities and transmittances using the Emissivity Growth Approximation (EGA)." alt="" coords="853,280,956,307"/>
<area shape="rect" href="jurassic_8c.html#a44e1e4b6ab44e79d049f99a04e79df9f" title="Perform line&#45;of&#45;sight (LOS) ray tracing through the atmosphere." alt="" coords="712,331,780,358"/>
<area shape="rect" href="jurassic_8c.html#a9a962bab37658297e87de9631c67707b" title="Compute carbon dioxide continuum (optical depth)." alt="" coords="872,179,937,206"/>
<area shape="rect" href="jurassic_8c.html#a5b99f6f4581181857d4b89b27e8c2f87" title="Compute water vapor continuum (optical depth)." alt="" coords="872,128,937,155"/>
<area shape="rect" href="jurassic_8c.html#ad788eb8a3a6df141d82f28adbd610668" title="Compute N collision&#45;induced absorption coefficient." alt="" coords="875,78,934,104"/>
<area shape="rect" href="jurassic_8c.html#a2d55d073ef8855381487a486970152f5" title="Compute O collision&#45;induced absorption coefficient." alt="" coords="875,27,934,54"/>
<area shape="rect" href="jurassic_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate index for interpolation on a regular (uniform) grid." alt="" coords="1014,78,1097,104"/>
<area shape="rect" href="jurassic_8c.html#a7683ce6b4628d0d910fdb9d360e2022a" title="Interpolate emissivity from lookup tables as a function of column density." alt="" coords="1004,230,1107,256"/>
<area shape="rect" href="jurassic_8c.html#a7134ded8183d6692b868ce0d411c6138" title="Interpolate column density from lookup tables as a function of emissivity." alt="" coords="1011,280,1099,307"/>
<area shape="rect" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="Converts Cartesian coordinates to geographic coordinates." alt="" coords="869,382,941,408"/>
<area shape="rect" href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612" title="Interpolate atmospheric state variables at a given altitude." alt="" coords="863,331,946,358"/>
<area shape="rect" href="jurassic_8c.html#a134dbd60b73c18eda7032e58284dbade" title="Read and spectrally convolve an RFM output spectrum." alt="" coords="695,584,797,611"/>
<area shape="rect" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two&#45;column shape function from an ASCII file." alt="" coords="701,432,791,459"/>
<area shape="rect" href="jurassic_8c.html#a675d14cbd1ae26f72e86f828d8367240" title="Write atmospheric profile in RFM&#45;compatible format." alt="" coords="693,534,799,560"/>
<area shape="rect" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992" title="Helper function to extract a single value from the retrieval state vector." alt="" coords="541,280,629,307"/>
<area shape="rect" href="jurassic_8c.html#a342f4954ef3678480cae2efb366a7b3e" title="Convert a quantity index to a descriptive name string." alt="" coords="373,976,450,1003"/>
<area shape="rect" href="jurassic_8c.html#a78c1bf52aacddbf614a0c254868195f6" title="Write observation data to an ASCII text file." alt="" coords="358,1027,465,1054"/>
<area shape="rect" href="jurassic_8c.html#a3c5b6b84f5c15574a22021a17a6afdca" title="Write observation data in binary format to an output file stream." alt="" coords="360,1078,463,1104"/>
</map>
</div>

</div>
</div>
<a id="a44e1e4b6ab44e79d049f99a04e79df9f" name="a44e1e4b6ab44e79d049f99a04e79df9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44e1e4b6ab44e79d049f99a04e79df9f">&#9670;&nbsp;</a></span>raytrace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void raytrace </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlos__t.html">los_t</a> *&#160;</td>
          <td class="paramname"><em>los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform line-of-sight (LOS) ray tracing through the atmosphere. </p>
<p >Computes the geometric path of a viewing ray from the observer to the atmosphere (and possibly the surface), accounting for spherical geometry, optional refraction, and cloud or surface interactions. <br  />
 Fills the LOS structure with pressure, temperature, gas concentrations, extinction, and path length at each step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure containing model and numerical settings. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Atmospheric state structure (profiles of p, T, q, k, etc.). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">obs</td><td>Observation geometry and radiance data; updated tangent point. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">los</td><td>Line-of-sight structure to be populated with sampled quantities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ir</td><td>Index of the current ray path in the observation set.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Integrates along the viewing ray starting at the observer position.</li>
<li>Performs stepwise propagation with step length <code>ds</code> determined by altitude and user-specified controls (<code>rayds</code>, <code>raydz</code>).</li>
<li>Interpolates atmospheric variables at each step using <a class="el" href="jurassic_8h.html#a82151ea4448e70f46f7f3b770bb77612">intpol_atm</a>.</li>
<li>Detects surface intersection or top-of-atmosphere exit and terminates accordingly.</li>
<li>Optionally accounts for <b>refraction</b> via the refractive index <code>n(p, T)</code>.</li>
<li>Accumulates <b>column densities</b> and <b>CurtisGodson means</b> for each gas.</li>
<li>Supports <b>cloud extinction</b> and <b>surface emissivity</b> interpolation.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The routine enforces that atmospheric grids include the surface (z = 0 km). Rays starting above the atmosphere are propagated downward until entry.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a82151ea4448e70f46f7f3b770bb77612" title="Interpolate atmospheric state variables at a given altitude.">intpol_atm</a>, <a class="el" href="jurassic_8h.html#a9020f32787ea7be08486d537a4f5c0fc" title="Determine the tangent point along a line of sight (LOS).">tangent_point</a>, <a class="el" href="jurassic_8h.html#a9727c4e0e5bc85384762b6ad81a8c3be" title="Compute line-of-sight radiances using the pencil-beam forward model.">formod_pencil</a>, <a class="el" href="jurassic_8h.html#ad69ab6edb8f722212fb01e12d8809643" title="Adjust pressure profile using the hydrostatic equation.">hydrostatic</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Fails if the observer is below the surface or the atmosphere lacks z = 0.</li>
<li>Aborts if the number of LOS points exceeds <code>NLOS</code>.</li>
<li>Assumes monotonic altitude ordering in atmospheric data.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l04873">4873</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4878</span>                {</div>
<div class="line"><span class="lineno"> 4879</span> </div>
<div class="line"><span class="lineno"> 4880</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> h = 0.02, zrefrac = 60;</div>
<div class="line"><span class="lineno"> 4881</span> </div>
<div class="line"><span class="lineno"> 4882</span>  <span class="keywordtype">double</span> ex0[3], ex1[3], k[<a class="code hl_define" href="jurassic_8h.html#af9cccf331f045b89a9f12366df5f7687">NW</a>], lat, lon, n, ng[3], norm, p, q[<a class="code hl_define" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a>], t,</div>
<div class="line"><span class="lineno"> 4883</span>    x[3], xh[3], xobs[3], xvp[3], z = 1e99, zmax, zmin;</div>
<div class="line"><span class="lineno"> 4884</span> </div>
<div class="line"><span class="lineno"> 4885</span>  <span class="keywordtype">int</span> stop = 0;</div>
<div class="line"><span class="lineno"> 4886</span> </div>
<div class="line"><span class="lineno"> 4887</span>  <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 4888</span>  los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> = 0;</div>
<div class="line"><span class="lineno"> 4889</span>  los-&gt;<a class="code hl_variable" href="structlos__t.html#a203d2c0dc9cc278bbd6b51714c759191">sft</a> = -999;</div>
<div class="line"><span class="lineno"> 4890</span>  obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>[ir] = obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[ir];</div>
<div class="line"><span class="lineno"> 4891</span>  obs-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>[ir] = obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>[ir];</div>
<div class="line"><span class="lineno"> 4892</span>  obs-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>[ir] = obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>[ir];</div>
<div class="line"><span class="lineno"> 4893</span> </div>
<div class="line"><span class="lineno"> 4894</span>  <span class="comment">/* Get altitude range of atmospheric data... */</span></div>
<div class="line"><span class="lineno"> 4895</span>  gsl_stats_minmax(&amp;zmin, &amp;zmax, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 4896</span> </div>
<div class="line"><span class="lineno"> 4897</span>  <span class="comment">/* Ensure that altitude grid includes the local geometric surface... */</span></div>
<div class="line"><span class="lineno"> 4898</span>  <span class="keywordflow">if</span> (zmin &gt; 1e-3 || zmin &lt; -1e-3)</div>
<div class="line"><span class="lineno"> 4899</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Atmospheric profiles must include surface level (z = 0 km)!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4900</span> </div>
<div class="line"><span class="lineno"> 4901</span>  <span class="comment">/* Check observer altitude... */</span></div>
<div class="line"><span class="lineno"> 4902</span>  <span class="keywordflow">if</span> (obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[ir] &lt; zmin)</div>
<div class="line"><span class="lineno"> 4903</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Observer below surface!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4904</span> </div>
<div class="line"><span class="lineno"> 4905</span>  <span class="comment">/* Check view point altitude... */</span></div>
<div class="line"><span class="lineno"> 4906</span>  <span class="keywordflow">if</span> (obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[ir] &gt; zmax)</div>
<div class="line"><span class="lineno"> 4907</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 4908</span> </div>
<div class="line"><span class="lineno"> 4909</span>  <span class="comment">/* Determine Cartesian coordinates for observer and view point... */</span></div>
<div class="line"><span class="lineno"> 4910</span>  <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>[ir], xobs);</div>
<div class="line"><span class="lineno"> 4911</span>  <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>[ir], xvp);</div>
<div class="line"><span class="lineno"> 4912</span> </div>
<div class="line"><span class="lineno"> 4913</span>  <span class="comment">/* Determine initial tangent vector... */</span></div>
<div class="line"><span class="lineno"> 4914</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 4915</span>    ex0[i] = xvp[i] - xobs[i];</div>
<div class="line"><span class="lineno"> 4916</span>  norm = <a class="code hl_define" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a>(ex0);</div>
<div class="line"><span class="lineno"> 4917</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 4918</span>    ex0[i] /= norm;</div>
<div class="line"><span class="lineno"> 4919</span> </div>
<div class="line"><span class="lineno"> 4920</span>  <span class="comment">/* Observer within atmosphere... */</span></div>
<div class="line"><span class="lineno"> 4921</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 4922</span>    x[i] = xobs[i];</div>
<div class="line"><span class="lineno"> 4923</span> </div>
<div class="line"><span class="lineno"> 4924</span>  <span class="comment">/* Observer above atmosphere (search entry point)... */</span></div>
<div class="line"><span class="lineno"> 4925</span>  <span class="keywordflow">if</span> (obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[ir] &gt; zmax) {</div>
<div class="line"><span class="lineno"> 4926</span>    <span class="keywordtype">double</span> dmax = norm, dmin = 0;</div>
<div class="line"><span class="lineno"> 4927</span>    <span class="keywordflow">while</span> (fabs(dmin - dmax) &gt; 0.001) {</div>
<div class="line"><span class="lineno"> 4928</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> d = (dmax + dmin) / 2;</div>
<div class="line"><span class="lineno"> 4929</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 4930</span>        x[i] = xobs[i] + d * ex0[i];</div>
<div class="line"><span class="lineno"> 4931</span>      <a class="code hl_function" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a>(x, &amp;z, &amp;lon, &amp;lat);</div>
<div class="line"><span class="lineno"> 4932</span>      <span class="keywordflow">if</span> (z &lt;= zmax &amp;&amp; z &gt; zmax - 0.001)</div>
<div class="line"><span class="lineno"> 4933</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4934</span>      <span class="keywordflow">if</span> (z &lt; zmax - 0.0005)</div>
<div class="line"><span class="lineno"> 4935</span>        dmax = d;</div>
<div class="line"><span class="lineno"> 4936</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4937</span>        dmin = d;</div>
<div class="line"><span class="lineno"> 4938</span>    }</div>
<div class="line"><span class="lineno"> 4939</span>  }</div>
<div class="line"><span class="lineno"> 4940</span> </div>
<div class="line"><span class="lineno"> 4941</span>  <span class="comment">/* Ray-tracing... */</span></div>
<div class="line"><span class="lineno"> 4942</span>  <span class="keywordflow">while</span> (1) {</div>
<div class="line"><span class="lineno"> 4943</span> </div>
<div class="line"><span class="lineno"> 4944</span>    <span class="comment">/* Set step length... */</span></div>
<div class="line"><span class="lineno"> 4945</span>    <span class="keywordtype">double</span> ds = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#add30b1dee3914f1d1473df0fccabb364">rayds</a>;</div>
<div class="line"><span class="lineno"> 4946</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee8d7ddf07ec801c7d4a2037cb23a6e7">raydz</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 4947</span>      norm = <a class="code hl_define" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a>(x);</div>
<div class="line"><span class="lineno"> 4948</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 4949</span>        xh[i] = x[i] / norm;</div>
<div class="line"><span class="lineno"> 4950</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> cosa = fabs(<a class="code hl_define" href="jurassic_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a>(ex0, xh));</div>
<div class="line"><span class="lineno"> 4951</span>      <span class="keywordflow">if</span> (cosa != 0)</div>
<div class="line"><span class="lineno"> 4952</span>        ds = <a class="code hl_define" href="jurassic_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#add30b1dee3914f1d1473df0fccabb364">rayds</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee8d7ddf07ec801c7d4a2037cb23a6e7">raydz</a> / cosa);</div>
<div class="line"><span class="lineno"> 4953</span>    }</div>
<div class="line"><span class="lineno"> 4954</span> </div>
<div class="line"><span class="lineno"> 4955</span>    <span class="comment">/* Determine geolocation... */</span></div>
<div class="line"><span class="lineno"> 4956</span>    <a class="code hl_function" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a>(x, &amp;z, &amp;lon, &amp;lat);</div>
<div class="line"><span class="lineno"> 4957</span> </div>
<div class="line"><span class="lineno"> 4958</span>    <span class="comment">/* Check if LOS hits the ground or has left atmosphere... */</span></div>
<div class="line"><span class="lineno"> 4959</span>    <span class="keywordflow">if</span> (z &lt; zmin || z &gt; zmax) {</div>
<div class="line"><span class="lineno"> 4960</span>      stop = (z &lt; zmin ? 2 : 1);</div>
<div class="line"><span class="lineno"> 4961</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> frac =</div>
<div class="line"><span class="lineno"> 4962</span>        ((z &lt;</div>
<div class="line"><span class="lineno"> 4963</span>          zmin ? zmin : zmax) - los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1]) / (z - los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> -</div>
<div class="line"><span class="lineno"> 4964</span>                                                                   1]);</div>
<div class="line"><span class="lineno"> 4965</span>      <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1], los-&gt;<a class="code hl_variable" href="structlos__t.html#a5f4f0f880e8649bd90459fe7c14811dc">lon</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1],</div>
<div class="line"><span class="lineno"> 4966</span>               los-&gt;<a class="code hl_variable" href="structlos__t.html#ab1339541546c449911407fdabf0beea3">lat</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1], xh);</div>
<div class="line"><span class="lineno"> 4967</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 4968</span>        x[i] = xh[i] + frac * (x[i] - xh[i]);</div>
<div class="line"><span class="lineno"> 4969</span>      <a class="code hl_function" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a>(x, &amp;z, &amp;lon, &amp;lat);</div>
<div class="line"><span class="lineno"> 4970</span>      los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1] = ds * frac;</div>
<div class="line"><span class="lineno"> 4971</span>      ds = 0;</div>
<div class="line"><span class="lineno"> 4972</span>    }</div>
<div class="line"><span class="lineno"> 4973</span> </div>
<div class="line"><span class="lineno"> 4974</span>    <span class="comment">/* Interpolate atmospheric data... */</span></div>
<div class="line"><span class="lineno"> 4975</span>    <a class="code hl_function" href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612">intpol_atm</a>(ctl, atm, z, &amp;p, &amp;t, q, k);</div>
<div class="line"><span class="lineno"> 4976</span> </div>
<div class="line"><span class="lineno"> 4977</span>    <span class="comment">/* Save data... */</span></div>
<div class="line"><span class="lineno"> 4978</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#a5f4f0f880e8649bd90459fe7c14811dc">lon</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>] = lon;</div>
<div class="line"><span class="lineno"> 4979</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#ab1339541546c449911407fdabf0beea3">lat</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>] = lat;</div>
<div class="line"><span class="lineno"> 4980</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>] = z;</div>
<div class="line"><span class="lineno"> 4981</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>] = p;</div>
<div class="line"><span class="lineno"> 4982</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>] = t;</div>
<div class="line"><span class="lineno"> 4983</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 4984</span>      los-&gt;<a class="code hl_variable" href="structlos__t.html#a1a0f916b58e4aa17b792002b7385bcff">q</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>][ig] = q[ig];</div>
<div class="line"><span class="lineno"> 4985</span>    for (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 4986</span>      los-&gt;<a class="code hl_variable" href="structlos__t.html#acba1f4bef3b96b5412b5fb9b8dea6cba">k</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>][<span class="keywordtype">id</span>] = k[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6f1ec265b1a0c94431403038d6dbef00">window</a>[<span class="keywordtype">id</span>]];</div>
<div class="line"><span class="lineno"> 4987</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>] = ds;</div>
<div class="line"><span class="lineno"> 4988</span> </div>
<div class="line"><span class="lineno"> 4989</span>    <span class="comment">/* Add cloud extinction... */</span></div>
<div class="line"><span class="lineno"> 4990</span>    if (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &gt; 0 &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 4991</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> aux = exp(-0.5 * <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>((z - atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>) / atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>));</div>
<div class="line"><span class="lineno"> 4992</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 4993</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> icl = <a class="code hl_function" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f3c54e7d6c87fe31e3bd0f54df1fdf0">clnu</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 4994</span>        los-&gt;<a class="code hl_variable" href="structlos__t.html#acba1f4bef3b96b5412b5fb9b8dea6cba">k</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>][id]</div>
<div class="line"><span class="lineno"> 4995</span>          += aux * <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f3c54e7d6c87fe31e3bd0f54df1fdf0">clnu</a>[icl], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl],</div>
<div class="line"><span class="lineno"> 4996</span>                       ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f3c54e7d6c87fe31e3bd0f54df1fdf0">clnu</a>[icl + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl + 1], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 4997</span>      }</div>
<div class="line"><span class="lineno"> 4998</span>    }</div>
<div class="line"><span class="lineno"> 4999</span> </div>
<div class="line"><span class="lineno"> 5000</span>    <span class="comment">/* Increment and check number of LOS points... */</span></div>
<div class="line"><span class="lineno"> 5001</span>    <span class="keywordflow">if</span> ((++los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>) &gt; <a class="code hl_define" href="jurassic_8h.html#aecba64d582576f89695ab0ff97805b3e">NLOS</a>)</div>
<div class="line"><span class="lineno"> 5002</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many LOS points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5003</span> </div>
<div class="line"><span class="lineno"> 5004</span>    <span class="comment">/* Check stop flag... */</span></div>
<div class="line"><span class="lineno"> 5005</span>    <span class="keywordflow">if</span> (stop) {</div>
<div class="line"><span class="lineno"> 5006</span> </div>
<div class="line"><span class="lineno"> 5007</span>      <span class="comment">/* Set surface temperature... */</span></div>
<div class="line"><span class="lineno"> 5008</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &gt; 0 &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 5009</span>        t = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>;</div>
<div class="line"><span class="lineno"> 5010</span>      los-&gt;<a class="code hl_variable" href="structlos__t.html#a203d2c0dc9cc278bbd6b51714c759191">sft</a> = (stop == 2 ? t : -999);</div>
<div class="line"><span class="lineno"> 5011</span> </div>
<div class="line"><span class="lineno"> 5012</span>      <span class="comment">/* Set surface emissivity... */</span></div>
<div class="line"><span class="lineno"> 5013</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 5014</span>        los-&gt;<a class="code hl_variable" href="structlos__t.html#addaf4b2df1ce35bb8e4e43bd6d61e2b2">sfeps</a>[id] = 1.0;</div>
<div class="line"><span class="lineno"> 5015</span>        <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 5016</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> isf = <a class="code hl_function" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a29804fac77623ca3d1e32f92955ac501">sfnu</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 5017</span>          los-&gt;<a class="code hl_variable" href="structlos__t.html#addaf4b2df1ce35bb8e4e43bd6d61e2b2">sfeps</a>[id] = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a29804fac77623ca3d1e32f92955ac501">sfnu</a>[isf], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf],</div>
<div class="line"><span class="lineno"> 5018</span>                               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a29804fac77623ca3d1e32f92955ac501">sfnu</a>[isf + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf + 1],</div>
<div class="line"><span class="lineno"> 5019</span>                               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 5020</span>        }</div>
<div class="line"><span class="lineno"> 5021</span>      }</div>
<div class="line"><span class="lineno"> 5022</span> </div>
<div class="line"><span class="lineno"> 5023</span>      <span class="comment">/* Leave raytracer... */</span></div>
<div class="line"><span class="lineno"> 5024</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5025</span>    }</div>
<div class="line"><span class="lineno"> 5026</span> </div>
<div class="line"><span class="lineno"> 5027</span>    <span class="comment">/* Determine refractivity... */</span></div>
<div class="line"><span class="lineno"> 5028</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a840532f5c38a5b325317cede07b40990">refrac</a> &amp;&amp; z &lt;= zrefrac)</div>
<div class="line"><span class="lineno"> 5029</span>      n = 1 + <a class="code hl_define" href="jurassic_8h.html#adfef660f42c1ea3245fcd48cd013754a">REFRAC</a>(p, t);</div>
<div class="line"><span class="lineno"> 5030</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5031</span>      n = 1;</div>
<div class="line"><span class="lineno"> 5032</span> </div>
<div class="line"><span class="lineno"> 5033</span>    <span class="comment">/* Construct new tangent vector (first term)... */</span></div>
<div class="line"><span class="lineno"> 5034</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 5035</span>      ex1[i] = ex0[i] * n;</div>
<div class="line"><span class="lineno"> 5036</span> </div>
<div class="line"><span class="lineno"> 5037</span>    <span class="comment">/* Compute gradient of refractivity... */</span></div>
<div class="line"><span class="lineno"> 5038</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a840532f5c38a5b325317cede07b40990">refrac</a> &amp;&amp; z &lt;= zrefrac) {</div>
<div class="line"><span class="lineno"> 5039</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 5040</span>        xh[i] = x[i] + 0.5 * ds * ex0[i];</div>
<div class="line"><span class="lineno"> 5041</span>      <a class="code hl_function" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a>(xh, &amp;z, &amp;lon, &amp;lat);</div>
<div class="line"><span class="lineno"> 5042</span>      <a class="code hl_function" href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612">intpol_atm</a>(ctl, atm, z, &amp;p, &amp;t, q, k);</div>
<div class="line"><span class="lineno"> 5043</span>      n = <a class="code hl_define" href="jurassic_8h.html#adfef660f42c1ea3245fcd48cd013754a">REFRAC</a>(p, t);</div>
<div class="line"><span class="lineno"> 5044</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><span class="lineno"> 5045</span>        xh[i] += h;</div>
<div class="line"><span class="lineno"> 5046</span>        <a class="code hl_function" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a>(xh, &amp;z, &amp;lon, &amp;lat);</div>
<div class="line"><span class="lineno"> 5047</span>        <a class="code hl_function" href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612">intpol_atm</a>(ctl, atm, z, &amp;p, &amp;t, q, k);</div>
<div class="line"><span class="lineno"> 5048</span>        ng[i] = (<a class="code hl_define" href="jurassic_8h.html#adfef660f42c1ea3245fcd48cd013754a">REFRAC</a>(p, t) - n) / h;</div>
<div class="line"><span class="lineno"> 5049</span>        xh[i] -= h;</div>
<div class="line"><span class="lineno"> 5050</span>      }</div>
<div class="line"><span class="lineno"> 5051</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5052</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 5053</span>        ng[i] = 0;</div>
<div class="line"><span class="lineno"> 5054</span> </div>
<div class="line"><span class="lineno"> 5055</span>    <span class="comment">/* Construct new tangent vector (second term)... */</span></div>
<div class="line"><span class="lineno"> 5056</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 5057</span>      ex1[i] += ds * ng[i];</div>
<div class="line"><span class="lineno"> 5058</span> </div>
<div class="line"><span class="lineno"> 5059</span>    <span class="comment">/* Normalize new tangent vector... */</span></div>
<div class="line"><span class="lineno"> 5060</span>    norm = <a class="code hl_define" href="jurassic_8h.html#a7fa3afb5cf2625deb1e859cbb93d2943">NORM</a>(ex1);</div>
<div class="line"><span class="lineno"> 5061</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 5062</span>      ex1[i] /= norm;</div>
<div class="line"><span class="lineno"> 5063</span> </div>
<div class="line"><span class="lineno"> 5064</span>    <span class="comment">/* Determine next point of LOS... */</span></div>
<div class="line"><span class="lineno"> 5065</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 5066</span>      x[i] += 0.5 * ds * (ex0[i] + ex1[i]);</div>
<div class="line"><span class="lineno"> 5067</span> </div>
<div class="line"><span class="lineno"> 5068</span>    <span class="comment">/* Copy tangent vector... */</span></div>
<div class="line"><span class="lineno"> 5069</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 5070</span>      ex0[i] = ex1[i];</div>
<div class="line"><span class="lineno"> 5071</span>  }</div>
<div class="line"><span class="lineno"> 5072</span> </div>
<div class="line"><span class="lineno"> 5073</span>  <span class="comment">/* Get tangent point (to be done before changing segment lengths!)... */</span></div>
<div class="line"><span class="lineno"> 5074</span>  <a class="code hl_function" href="jurassic_8c.html#a9020f32787ea7be08486d537a4f5c0fc">tangent_point</a>(los, &amp;obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>[ir], &amp;obs-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>[ir], &amp;obs-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>[ir]);</div>
<div class="line"><span class="lineno"> 5075</span> </div>
<div class="line"><span class="lineno"> 5076</span>  <span class="comment">/* Change segment lengths according to trapezoid rule... */</span></div>
<div class="line"><span class="lineno"> 5077</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1; ip &gt;= 1; ip--)</div>
<div class="line"><span class="lineno"> 5078</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[ip] = 0.5 * (los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[ip - 1] + los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[ip]);</div>
<div class="line"><span class="lineno"> 5079</span>  los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[0] *= 0.5;</div>
<div class="line"><span class="lineno"> 5080</span> </div>
<div class="line"><span class="lineno"> 5081</span>  <span class="comment">/* Compute column density... */</span></div>
<div class="line"><span class="lineno"> 5082</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 5083</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 5084</span>      los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ig] = 10 * los-&gt;<a class="code hl_variable" href="structlos__t.html#a1a0f916b58e4aa17b792002b7385bcff">q</a>[ip][ig] * los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[ip]</div>
<div class="line"><span class="lineno"> 5085</span>        / (<a class="code hl_define" href="jurassic_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a> * los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip]) * los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[ip];</div>
<div class="line"><span class="lineno"> 5086</span> </div>
<div class="line"><span class="lineno"> 5087</span>  <span class="comment">/* Compute Curtis-Godson means... */</span></div>
<div class="line"><span class="lineno"> 5088</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 5089</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[0][ig] = los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[0][ig];</div>
<div class="line"><span class="lineno"> 5090</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#ae42d3b7f23d178426c006a6cd0adf923">cgp</a>[0][ig] = los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[0][ig] * los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[0];</div>
<div class="line"><span class="lineno"> 5091</span>    los-&gt;<a class="code hl_variable" href="structlos__t.html#a5ac900c2b42594489375f26f55e4c229">cgt</a>[0][ig] = los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[0][ig] * los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[0];</div>
<div class="line"><span class="lineno"> 5092</span>  }</div>
<div class="line"><span class="lineno"> 5093</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 1; ip &lt; los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 5094</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 5095</span>      los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig] = los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip - 1][ig] + los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ig];</div>
<div class="line"><span class="lineno"> 5096</span>      los-&gt;<a class="code hl_variable" href="structlos__t.html#ae42d3b7f23d178426c006a6cd0adf923">cgp</a>[ip][ig] = los-&gt;<a class="code hl_variable" href="structlos__t.html#ae42d3b7f23d178426c006a6cd0adf923">cgp</a>[ip - 1][ig] + los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ig] * los-&gt;<a class="code hl_variable" href="structlos__t.html#aec5a63bda3ad49f3dd865fe5887108c9">p</a>[ip];</div>
<div class="line"><span class="lineno"> 5097</span>      los-&gt;<a class="code hl_variable" href="structlos__t.html#a5ac900c2b42594489375f26f55e4c229">cgt</a>[ip][ig] = los-&gt;<a class="code hl_variable" href="structlos__t.html#a5ac900c2b42594489375f26f55e4c229">cgt</a>[ip - 1][ig] + los-&gt;<a class="code hl_variable" href="structlos__t.html#aa53eeaf4d2b6033c0f455a70efad410c">u</a>[ip][ig] * los-&gt;<a class="code hl_variable" href="structlos__t.html#ae9885d0d23e84e6d0443d0d8e04c8867">t</a>[ip];</div>
<div class="line"><span class="lineno"> 5098</span>    }</div>
<div class="line"><span class="lineno"> 5099</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 5100</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 5101</span>      <span class="keywordflow">if</span> (los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig] != 0) {</div>
<div class="line"><span class="lineno"> 5102</span>        los-&gt;<a class="code hl_variable" href="structlos__t.html#ae42d3b7f23d178426c006a6cd0adf923">cgp</a>[ip][ig] /= los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig];</div>
<div class="line"><span class="lineno"> 5103</span>        los-&gt;<a class="code hl_variable" href="structlos__t.html#a5ac900c2b42594489375f26f55e4c229">cgt</a>[ip][ig] /= los-&gt;<a class="code hl_variable" href="structlos__t.html#a0f2b75b236bd24e06006c1d8e4b091e8">cgu</a>[ip][ig];</div>
<div class="line"><span class="lineno"> 5104</span>      }</div>
<div class="line"><span class="lineno"> 5105</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a82151ea4448e70f46f7f3b770bb77612"><div class="ttname"><a href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612">intpol_atm</a></div><div class="ttdeci">void intpol_atm(const ctl_t *ctl, const atm_t *atm, const double z, double *p, double *t, double *q, double *k)</div><div class="ttdoc">Interpolate atmospheric state variables at a given altitude.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l04026">jurassic.c:4026</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a9020f32787ea7be08486d537a4f5c0fc"><div class="ttname"><a href="jurassic_8c.html#a9020f32787ea7be08486d537a4f5c0fc">tangent_point</a></div><div class="ttdeci">void tangent_point(const los_t *los, double *tpz, double *tplon, double *tplat)</div><div class="ttdoc">Determine the tangent point along a line of sight (LOS).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06491">jurassic.c:6491</a></div></div>
<div class="ttc" id="ajurassic_8c_html_aaf98f7230de0893b8dc4833d3c83c7a4"><div class="ttname"><a href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a></div><div class="ttdeci">void cart2geo(const double *x, double *z, double *lon, double *lat)</div><div class="ttdoc">Converts Cartesian coordinates to geographic coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l00185">jurassic.c:185</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a1841fd1a462d245d8c73dce55e2f45da"><div class="ttname"><a href="jurassic_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a></div><div class="ttdeci">#define KB</div><div class="ttdoc">Boltzmann constant [kg m^2/(K s^2)].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00158">jurassic.h:158</a></div></div>
<div class="ttc" id="ajurassic_8h_html_adfef660f42c1ea3245fcd48cd013754a"><div class="ttname"><a href="jurassic_8h.html#adfef660f42c1ea3245fcd48cd013754a">REFRAC</a></div><div class="ttdeci">#define REFRAC(p, T)</div><div class="ttdoc">Compute air refractivity (n - 1).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00798">jurassic.h:798</a></div></div>
<div class="ttc" id="ajurassic_8h_html_aecba64d582576f89695ab0ff97805b3e"><div class="ttname"><a href="jurassic_8h.html#aecba64d582576f89695ab0ff97805b3e">NLOS</a></div><div class="ttdeci">#define NLOS</div><div class="ttdoc">Maximum number of LOS points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00287">jurassic.h:287</a></div></div>
<div class="ttc" id="ajurassic_8h_html_af9cccf331f045b89a9f12366df5f7687"><div class="ttname"><a href="jurassic_8h.html#af9cccf331f045b89a9f12366df5f7687">NW</a></div><div class="ttdeci">#define NW</div><div class="ttdoc">Maximum number of spectral windows.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00262">jurassic.h:262</a></div></div>
<div class="ttc" id="astructctl__t_html_a6f1ec265b1a0c94431403038d6dbef00"><div class="ttname"><a href="structctl__t.html#a6f1ec265b1a0c94431403038d6dbef00">ctl_t::window</a></div><div class="ttdeci">int window[ND]</div><div class="ttdoc">Window index of each channel.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01081">jurassic.h:1081</a></div></div>
<div class="ttc" id="astructctl__t_html_add30b1dee3914f1d1473df0fccabb364"><div class="ttname"><a href="structctl__t.html#add30b1dee3914f1d1473df0fccabb364">ctl_t::rayds</a></div><div class="ttdeci">double rayds</div><div class="ttdoc">Maximum step length for raytracing [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01132">jurassic.h:1132</a></div></div>
<div class="ttc" id="astructctl__t_html_aee8d7ddf07ec801c7d4a2037cb23a6e7"><div class="ttname"><a href="structctl__t.html#aee8d7ddf07ec801c7d4a2037cb23a6e7">ctl_t::raydz</a></div><div class="ttdeci">double raydz</div><div class="ttdoc">Vertical step length for raytracing [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01135">jurassic.h:1135</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a44e1e4b6ab44e79d049f99a04e79df9f_cgraph.png" border="0" usemap="#ajurassic_8h_a44e1e4b6ab44e79d049f99a04e79df9f_cgraph" alt=""/></div>
<map name="ajurassic_8h_a44e1e4b6ab44e79d049f99a04e79df9f_cgraph" id="ajurassic_8h_a44e1e4b6ab44e79d049f99a04e79df9f_cgraph">
<area shape="rect" title="Perform line&#45;of&#45;sight (LOS) ray tracing through the atmosphere." alt="" coords="5,93,73,120"/>
<area shape="rect" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="Converts Cartesian coordinates to geographic coordinates." alt="" coords="271,5,343,32"/>
<area shape="rect" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="271,68,343,95"/>
<area shape="rect" href="jurassic_8c.html#a82151ea4448e70f46f7f3b770bb77612" title="Interpolate atmospheric state variables at a given altitude." alt="" coords="130,144,213,171"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="269,169,344,196"/>
<area shape="rect" href="jurassic_8c.html#a9020f32787ea7be08486d537a4f5c0fc" title="Determine the tangent point along a line of sight (LOS)." alt="" coords="121,43,221,69"/>
</map>
</div>

</div>
</div>
<a id="aa4a7b8ec913874ba418cfb4280fd3b84" name="aa4a7b8ec913874ba418cfb4280fd3b84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a7b8ec913874ba418cfb4280fd3b84">&#9670;&nbsp;</a></span>read_atm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_atm </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read atmospheric input data from a file. </p>
<p >This function reads atmospheric data from the file specified by <code>filename</code>, optionally prefixed by the directory <code>dirname</code>. The file format (ASCII or binary) is determined by the control structure <code>ctl</code>. The data are stored in the atmospheric structure <code>atm</code>.</p>
<p >Supported file formats are:</p><ul>
<li>ASCII format (<code>ctl-&gt;atmfmt == 1</code>)</li>
<li>Binary format (<code>ctl-&gt;atmfmt == 2</code>)</li>
</ul>
<p >The function initializes the atmospheric data container, opens the specified file, reads its contents according to the selected format, and performs sanity checks on the number of data points. It also logs basic statistical information about the loaded atmospheric fields (time, altitude, longitude, latitude, pressure, temperature, and species/emitter mixing ratios).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirname</td><td>Optional directory path where the atmospheric file resides. If NULL, only <code>filename</code> is used.</td></tr>
    <tr><td class="paramname">filename</td><td>Name of the atmospheric data file to read.</td></tr>
    <tr><td class="paramname">ctl</td><td>Pointer to a control structure specifying input parameters, file format, number of emitters, spectral windows, and additional atmospheric configuration.</td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to an atmospheric data structure that will be filled with the values read from the file. The structure must be allocated before calling this function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function aborts execution using ERRMSG on critical errors, such as failure to open the file, unknown file format, or absence of readable data.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that the <code>atm</code> structure has been properly allocated, and that the control parameters in <code>ctl</code> are valid before calling this function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05109">5109</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5113</span>              {</div>
<div class="line"><span class="lineno"> 5114</span> </div>
<div class="line"><span class="lineno"> 5115</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 5116</span> </div>
<div class="line"><span class="lineno"> 5117</span>  <span class="keywordtype">char</span> file[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 5118</span> </div>
<div class="line"><span class="lineno"> 5119</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 5120</span>  atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> = 0;</div>
<div class="line"><span class="lineno"> 5121</span> </div>
<div class="line"><span class="lineno"> 5122</span>  <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 5123</span>  <span class="keywordflow">if</span> (dirname != NULL)</div>
<div class="line"><span class="lineno"> 5124</span>    sprintf(file, <span class="stringliteral">&quot;%s/%s&quot;</span>, dirname, filename);</div>
<div class="line"><span class="lineno"> 5125</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5126</span>    sprintf(file, <span class="stringliteral">&quot;%s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 5127</span> </div>
<div class="line"><span class="lineno"> 5128</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5129</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read atmospheric data: %s&quot;</span>, file);</div>
<div class="line"><span class="lineno"> 5130</span> </div>
<div class="line"><span class="lineno"> 5131</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 5132</span>  <span class="keywordflow">if</span> (!(in = fopen(file, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 5133</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5134</span> </div>
<div class="line"><span class="lineno"> 5135</span>  <span class="comment">/* Read ASCII data... */</span></div>
<div class="line"><span class="lineno"> 5136</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0ff333a479f441f6f356f60ab0eeb577">atmfmt</a> == 1)</div>
<div class="line"><span class="lineno"> 5137</span>    <a class="code hl_function" href="jurassic_8c.html#ad731b63e75c5d5f3350000401d7e2817">read_atm_asc</a>(in, ctl, atm);</div>
<div class="line"><span class="lineno"> 5138</span> </div>
<div class="line"><span class="lineno"> 5139</span>  <span class="comment">/* Read binary data... */</span></div>
<div class="line"><span class="lineno"> 5140</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0ff333a479f441f6f356f60ab0eeb577">atmfmt</a> == 2)</div>
<div class="line"><span class="lineno"> 5141</span>    <a class="code hl_function" href="jurassic_8c.html#a0c68478f392d35086c456de7ce58a190">read_atm_bin</a>(in, ctl, atm);</div>
<div class="line"><span class="lineno"> 5142</span> </div>
<div class="line"><span class="lineno"> 5143</span>  <span class="comment">/* Error... */</span></div>
<div class="line"><span class="lineno"> 5144</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5145</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Unknown atmospheric data file format, check ATMFMT!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5146</span> </div>
<div class="line"><span class="lineno"> 5147</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 5148</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 5149</span> </div>
<div class="line"><span class="lineno"> 5150</span>  <span class="comment">/* Check number of points... */</span></div>
<div class="line"><span class="lineno"> 5151</span>  <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> &lt; 1)</div>
<div class="line"><span class="lineno"> 5152</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Could not read any data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5153</span> </div>
<div class="line"><span class="lineno"> 5154</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5155</span>  <span class="keywordtype">double</span> mini, maxi;</div>
<div class="line"><span class="lineno"> 5156</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of data points: %d&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5157</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5158</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time range: %.2f ... %.2f s&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5159</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5160</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Altitude range: %g ... %g km&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5161</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5162</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5163</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5164</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5165</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5166</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Pressure range: %g ... %g hPa&quot;</span>, maxi, mini);</div>
<div class="line"><span class="lineno"> 5167</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5168</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Temperature range: %g ... %g K&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5169</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 5170</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig], 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5171</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Emitter %s range: %g ... %g ppv&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], mini, maxi);</div>
<div class="line"><span class="lineno"> 5172</span>  }</div>
<div class="line"><span class="lineno"> 5173</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++) {</div>
<div class="line"><span class="lineno"> 5174</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw], 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5175</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Extinction range (window %d): %g ... %g km^-1&quot;</span>, iw, mini, maxi);</div>
<div class="line"><span class="lineno"> 5176</span>  }</div>
<div class="line"><span class="lineno"> 5177</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &gt; 0 &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> == 0) {</div>
<div class="line"><span class="lineno"> 5178</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Cloud layer: z= %g km | dz= %g km | k= %g ... %g km^-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 5179</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[0], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> - 1]);</div>
<div class="line"><span class="lineno"> 5180</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5181</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Cloud layer: none&quot;</span>);</div>
<div class="line"><span class="lineno"> 5182</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &gt; 0 &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> == 0) {</div>
<div class="line"><span class="lineno"> 5183</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2,</div>
<div class="line"><span class="lineno"> 5184</span>        <span class="stringliteral">&quot;Surface layer: T_s = %g K | eps= %g ... %g&quot;</span>,</div>
<div class="line"><span class="lineno"> 5185</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[0], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> - 1]);</div>
<div class="line"><span class="lineno"> 5186</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5187</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Surface layer: none&quot;</span>);</div>
<div class="line"><span class="lineno"> 5188</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a0c68478f392d35086c456de7ce58a190"><div class="ttname"><a href="jurassic_8c.html#a0c68478f392d35086c456de7ce58a190">read_atm_bin</a></div><div class="ttdeci">void read_atm_bin(FILE *in, const ctl_t *ctl, atm_t *atm)</div><div class="ttdoc">Read atmospheric data in binary format.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l05236">jurassic.c:5236</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ad731b63e75c5d5f3350000401d7e2817"><div class="ttname"><a href="jurassic_8c.html#ad731b63e75c5d5f3350000401d7e2817">read_atm_asc</a></div><div class="ttdeci">void read_atm_asc(FILE *in, const ctl_t *ctl, atm_t *atm)</div><div class="ttdoc">Read atmospheric data in ASCII format.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l05192">jurassic.c:5192</a></div></div>
<div class="ttc" id="astructctl__t_html_a0ff333a479f441f6f356f60ab0eeb577"><div class="ttname"><a href="structctl__t.html#a0ff333a479f441f6f356f60ab0eeb577">ctl_t::atmfmt</a></div><div class="ttdeci">int atmfmt</div><div class="ttdoc">Atmospheric data file format (1=ASCII, 2=binary).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01108">jurassic.h:1108</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_aa4a7b8ec913874ba418cfb4280fd3b84_cgraph.png" border="0" usemap="#ajurassic_8h_aa4a7b8ec913874ba418cfb4280fd3b84_cgraph" alt=""/></div>
<map name="ajurassic_8h_aa4a7b8ec913874ba418cfb4280fd3b84_cgraph" id="ajurassic_8h_aa4a7b8ec913874ba418cfb4280fd3b84_cgraph">
<area shape="rect" title="Read atmospheric input data from a file." alt="" coords="5,31,81,57"/>
<area shape="rect" href="jurassic_8c.html#ad731b63e75c5d5f3350000401d7e2817" title="Read atmospheric data in ASCII format." alt="" coords="129,5,233,32"/>
<area shape="rect" href="jurassic_8c.html#a0c68478f392d35086c456de7ce58a190" title="Read atmospheric data in binary format." alt="" coords="131,56,231,83"/>
</map>
</div>

</div>
</div>
<a id="ad731b63e75c5d5f3350000401d7e2817" name="ad731b63e75c5d5f3350000401d7e2817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad731b63e75c5d5f3350000401d7e2817">&#9670;&nbsp;</a></span>read_atm_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_atm_asc </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read atmospheric data in ASCII format. </p>
<p >This function parses atmospheric input data from an opened ASCII file stream (<code>in</code>) and stores the values in the atmospheric structure <code>atm</code>. The number and type of fields to read are determined by the control structure <code>ctl</code>. Each line of the ASCII file corresponds to a single atmospheric data point.</p>
<p >The expected order of fields in each line is:</p><ul>
<li>Time</li>
<li>Altitude</li>
<li>Longitude</li>
<li>Latitude</li>
<li>Pressure</li>
<li>Temperature</li>
<li>Mixing ratios for each gas/emitter (<code>ctl-&gt;ng</code> values)</li>
<li>Extinction coefficients for each spectral window (<code>ctl-&gt;nw</code> values)</li>
</ul>
<p >Additionally, if cloud or surface layer parameters are enabled in <code>ctl</code>, they are read once from the first line only:</p><ul>
<li>Cloud layer: altitude, thickness, and extinction (<code>ctl-&gt;ncl</code> values)</li>
<li>Surface layer: temperature and emissivity (<code>ctl-&gt;nsf</code> values)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Pointer to an already opened input file stream containing ASCII atmospheric data.</td></tr>
    <tr><td class="paramname">ctl</td><td>Pointer to a control structure defining the number of gases, spectral windows, and whether cloud or surface layer information should be read.</td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to an initialized atmospheric structure where the parsed data points will be stored. The function updates <code>atm-&gt;np</code> to reflect the number of successfully read data records.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function continues reading until EOF is reached. Each successfully parsed line increments the atmospheric data point counter.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The function terminates execution using <code>ERRMSG</code> if more than <code>NP</code> data points are encountered, or if the input format deviates from expectations.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05192">5192</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5195</span>              {</div>
<div class="line"><span class="lineno"> 5196</span> </div>
<div class="line"><span class="lineno"> 5197</span>  <span class="keywordtype">char</span> line[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], *tok;</div>
<div class="line"><span class="lineno"> 5198</span> </div>
<div class="line"><span class="lineno"> 5199</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 5200</span>  atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> = 0;</div>
<div class="line"><span class="lineno"> 5201</span> </div>
<div class="line"><span class="lineno"> 5202</span>  <span class="comment">/* Read line... */</span></div>
<div class="line"><span class="lineno"> 5203</span>  <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in)) {</div>
<div class="line"><span class="lineno"> 5204</span> </div>
<div class="line"><span class="lineno"> 5205</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 5206</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(line, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 5207</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 5208</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 5209</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 5210</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 5211</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 5212</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 5213</span>      <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 5214</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 5215</span>      <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 5216</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &gt; 0 &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> == 0) {</div>
<div class="line"><span class="lineno"> 5217</span>      <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>);</div>
<div class="line"><span class="lineno"> 5218</span>      <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>);</div>
<div class="line"><span class="lineno"> 5219</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 5220</span>        <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl]);</div>
<div class="line"><span class="lineno"> 5221</span>    }</div>
<div class="line"><span class="lineno"> 5222</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &gt; 0 &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> == 0) {</div>
<div class="line"><span class="lineno"> 5223</span>      <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>);</div>
<div class="line"><span class="lineno"> 5224</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 5225</span>        <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf]);</div>
<div class="line"><span class="lineno"> 5226</span>    }</div>
<div class="line"><span class="lineno"> 5227</span> </div>
<div class="line"><span class="lineno"> 5228</span>    <span class="comment">/* Increment data point counter... */</span></div>
<div class="line"><span class="lineno"> 5229</span>    <span class="keywordflow">if</span> ((++atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>) &gt; <a class="code hl_define" href="jurassic_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a>)</div>
<div class="line"><span class="lineno"> 5230</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many data points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5231</span>  }</div>
<div class="line"><span class="lineno"> 5232</span>}</div>
<div class="ttc" id="ajurassic_8h_html_a8b61d1304377b77925b2802459ddae98"><div class="ttname"><a href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a></div><div class="ttdeci">#define TOK(line, tok, format, var)</div><div class="ttdoc">Tokenize a string and parse a variable.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00834">jurassic.h:834</a></div></div>
<div class="ttc" id="ajurassic_8h_html_ab04c88bedc6b2be8ddfe7aa8d3e93f06"><div class="ttname"><a href="jurassic_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a></div><div class="ttdeci">#define NP</div><div class="ttdoc">Maximum number of atmospheric data points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00247">jurassic.h:247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c68478f392d35086c456de7ce58a190" name="a0c68478f392d35086c456de7ce58a190"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c68478f392d35086c456de7ce58a190">&#9670;&nbsp;</a></span>read_atm_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_atm_bin </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read atmospheric data in binary format. </p>
<p >This function reads atmospheric input data from a binary file stream (<code>in</code>) and stores the decoded values in the atmospheric structure <code>atm</code>. The expected binary format is predefined and must match the configuration provided in the control structure <code>ctl</code>. The function reads a header containing metadata describing the dataset, followed by the atmospheric fields and optional cloud/surface layer properties.</p>
<p >The binary file layout is expected to follow this structure:</p><ol type="1">
<li><b>Magic identifier</b> (4 bytes, ignored except for presence)</li>
<li><b>Header integers</b>:<ul>
<li>Number of gas species (<code>ng</code>)</li>
<li>Number of spectral windows (<code>nw</code>)</li>
<li>Number of cloud layer extinction elements (<code>ncl</code>)</li>
<li>Number of surface emissivity elements (<code>nsf</code>) These must match the corresponding values in <code>ctl</code>.</li>
</ul>
</li>
<li><b>Data payload</b>:<ul>
<li>Number of points (<code>np</code>)</li>
<li>Arrays of size <code>np</code> for time, altitude, longitude, latitude, pressure, temperature</li>
<li>For each gas species: mixing ratio array of length <code>np</code></li>
<li>For each spectral window: extinction coefficient array of length <code>np</code></li>
</ul>
</li>
<li><b>Optional layered parameters</b>:<ul>
<li>Cloud layer altitude, thickness, and extinction (<code>ctl-&gt;ncl</code> values)</li>
<li>Surface temperature and emissivity (<code>ctl-&gt;nsf</code> values)</li>
</ul>
</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Pointer to an opened binary input file stream.</td></tr>
    <tr><td class="paramname">ctl</td><td>Pointer to a control structure specifying expected dimensions of atmospheric fields and optional layers. Used for header validation.</td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to an allocated atmospheric data structure that will be filled with the contents of the binary file. All arrays must be allocated prior to calling this function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does <b>not</b> allocate memory; it assumes storage for all atmospheric variables already exists and matches the expected sizes.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Execution is terminated via <code>ERRMSG</code> if:<ul>
<li>The binary header does not match the control structure.</li>
<li>The binary stream does not contain the expected amount of data.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05236">5236</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5239</span>              {</div>
<div class="line"><span class="lineno"> 5240</span> </div>
<div class="line"><span class="lineno"> 5241</span>  <span class="comment">/* Read header... */</span></div>
<div class="line"><span class="lineno"> 5242</span>  <span class="keywordtype">char</span> magic[4];</div>
<div class="line"><span class="lineno"> 5243</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(magic, <span class="keywordtype">char</span>,</div>
<div class="line"><span class="lineno"> 5244</span>        4,</div>
<div class="line"><span class="lineno"> 5245</span>        in);</div>
<div class="line"><span class="lineno"> 5246</span>  <span class="keywordflow">if</span> (memcmp(magic, <span class="stringliteral">&quot;ATM1&quot;</span>, 4) != 0)</div>
<div class="line"><span class="lineno"> 5247</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Invalid magic string!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5248</span> </div>
<div class="line"><span class="lineno"> 5249</span>  <span class="keywordtype">int</span> ng, nw, ncl, nsf;</div>
<div class="line"><span class="lineno"> 5250</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;ng, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 5251</span>        1,</div>
<div class="line"><span class="lineno"> 5252</span>        in);</div>
<div class="line"><span class="lineno"> 5253</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;nw, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 5254</span>        1,</div>
<div class="line"><span class="lineno"> 5255</span>        in);</div>
<div class="line"><span class="lineno"> 5256</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;ncl, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 5257</span>        1,</div>
<div class="line"><span class="lineno"> 5258</span>        in);</div>
<div class="line"><span class="lineno"> 5259</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;nsf, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 5260</span>        1,</div>
<div class="line"><span class="lineno"> 5261</span>        in);</div>
<div class="line"><span class="lineno"> 5262</span>  <span class="keywordflow">if</span> (ng != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a> || nw != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a> || ncl != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> || nsf != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>)</div>
<div class="line"><span class="lineno"> 5263</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error reading file header!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5264</span> </div>
<div class="line"><span class="lineno"> 5265</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 5266</span>  <span class="keywordtype">size_t</span> np;</div>
<div class="line"><span class="lineno"> 5267</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;np, <span class="keywordtype">size_t</span>,</div>
<div class="line"><span class="lineno"> 5268</span>        1,</div>
<div class="line"><span class="lineno"> 5269</span>        in);</div>
<div class="line"><span class="lineno"> 5270</span>  atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> = (int) np;</div>
<div class="line"><span class="lineno"> 5271</span>  <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> &gt; <a class="code hl_define" href="jurassic_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a>)</div>
<div class="line"><span class="lineno"> 5272</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many data points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5273</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5274</span>        np,</div>
<div class="line"><span class="lineno"> 5275</span>        in);</div>
<div class="line"><span class="lineno"> 5276</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5277</span>        np,</div>
<div class="line"><span class="lineno"> 5278</span>        in);</div>
<div class="line"><span class="lineno"> 5279</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5280</span>        np,</div>
<div class="line"><span class="lineno"> 5281</span>        in);</div>
<div class="line"><span class="lineno"> 5282</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5283</span>        np,</div>
<div class="line"><span class="lineno"> 5284</span>        in);</div>
<div class="line"><span class="lineno"> 5285</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5286</span>        np,</div>
<div class="line"><span class="lineno"> 5287</span>        in);</div>
<div class="line"><span class="lineno"> 5288</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5289</span>        np,</div>
<div class="line"><span class="lineno"> 5290</span>        in);</div>
<div class="line"><span class="lineno"> 5291</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 5292</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5293</span>          np,</div>
<div class="line"><span class="lineno"> 5294</span>          in);</div>
<div class="line"><span class="lineno"> 5295</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 5296</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5297</span>          np,</div>
<div class="line"><span class="lineno"> 5298</span>          in);</div>
<div class="line"><span class="lineno"> 5299</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 5300</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5301</span>          1,</div>
<div class="line"><span class="lineno"> 5302</span>          in);</div>
<div class="line"><span class="lineno"> 5303</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5304</span>          1,</div>
<div class="line"><span class="lineno"> 5305</span>          in);</div>
<div class="line"><span class="lineno"> 5306</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5307</span>            (<span class="keywordtype">size_t</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>,</div>
<div class="line"><span class="lineno"> 5308</span>          in);</div>
<div class="line"><span class="lineno"> 5309</span>  }</div>
<div class="line"><span class="lineno"> 5310</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>) {</div>
<div class="line"><span class="lineno"> 5311</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5312</span>          1,</div>
<div class="line"><span class="lineno"> 5313</span>          in);</div>
<div class="line"><span class="lineno"> 5314</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5315</span>            (<span class="keywordtype">size_t</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>,</div>
<div class="line"><span class="lineno"> 5316</span>          in);</div>
<div class="line"><span class="lineno"> 5317</span>  }</div>
<div class="line"><span class="lineno"> 5318</span>}</div>
<div class="ttc" id="ajurassic_8h_html_ae8c13542ca31cfbccfc436aabd8851f6"><div class="ttname"><a href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a></div><div class="ttdeci">#define FREAD(ptr, type, size, out)</div><div class="ttdoc">Read binary data from a file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00502">jurassic.h:502</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3635d1716488dea37d1176c1fb02675f" name="a3635d1716488dea37d1176c1fb02675f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3635d1716488dea37d1176c1fb02675f">&#9670;&nbsp;</a></span>read_ctl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_ctl </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read model control parameters from command-line and configuration input. </p>
<p >Parses all numerical and string parameters required to initialize a JURASSIC simulation, including atmospheric composition, radiative channels, cloud and surface options, continua, ray-tracing setup, retrieval parameters, and output settings. <br  />
 Populates the <a class="el" href="structctl__t.html">ctl_t</a> structure with all configuration values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">argc</td><td>Argument count from the command line. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">argv</td><td>Argument vector containing user-specified options. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ctl</td><td>Control structure to be filled with parsed settings.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Uses <a class="el" href="jurassic_8h.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a> to extract keyvalue pairs from the command line or control file.</li>
<li>Initializes:<ul>
<li><b>Emitters and gases</b> (<code>NG</code>, <code>EMITTER</code>),</li>
<li><b>Spectral channels</b> (<code>ND</code>, <code>NU</code>, <code>WINDOW</code>),</li>
<li><b>Cloud parameters</b> (<code>NCL</code>, <code>CLNU</code>),</li>
<li><b>Surface parameters</b> (<code>NSF</code>, <code>SFNU</code>, <code>SFTYPE</code>, <code>SFSZA</code>),</li>
<li><b>Hydrostatic reference height</b> (<code>HYDZ</code>),</li>
<li><b>Continuum flags</b> (<code>CTM_CO2</code>, <code>CTM_H2O</code>, <code>CTM_N2</code>, <code>CTM_O2</code>),</li>
<li><b>Ray-tracing options</b> (<code>REFRAC</code>, <code>RAYDS</code>, <code>RAYDZ</code>),</li>
<li><b>Field-of-view</b> (<code>FOV</code>),</li>
<li><b>Retrieval limits</b> (<code>RETP_ZMIN</code>, <code>RETQ_ZMAX</code>, etc.),</li>
<li><b>Output flags</b> (<code>WRITE_BBT</code>, <code>WRITE_MATRIX</code>),</li>
<li><b>External forward model paths</b> (<code>RFMBIN</code>, <code>RFMHIT</code>, <code>RFMXSC</code>).</li>
</ul>
</li>
<li>Validates array bounds and logical parameter ranges.</li>
<li>Automatically detects major gas species indices (e.g. CO, HO, N, O).</li>
<li>Logs the executable name, version, and compilation time at startup.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="jurassic_8h.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3" title="Scan control file or command-line arguments for a configuration variable.">scan_ctl</a>, <a class="el" href="jurassic_8h.html#a832e63c37527025311d1886a60dff605" title="Find gas species index by name.">find_emitter</a>, <a class="el" href="jurassic_8h.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two-column shape function from an ASCII file.">read_shape</a>, <a class="el" href="jurassic_8h.html#abe93da56294b380e322c18ca2838fd51" title="Execute the selected forward model.">formod</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Aborts if mandatory keys are missing or exceed defined limits (e.g. <code>NG &gt; NG_MAX</code>).</li>
<li>Requires consistent index ordering (e.g. <code>NCL &gt; 1</code>, <code>NSF &gt; 1</code>).</li>
<li>Undefined or invalid parameters trigger <code><a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG()</a></code> aborts.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05322">5322</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5325</span>              {</div>
<div class="line"><span class="lineno"> 5326</span> </div>
<div class="line"><span class="lineno"> 5327</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5328</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;\nJuelich Rapid Spectral Simulation Code (JURASSIC)\n&quot;</span></div>
<div class="line"><span class="lineno"> 5329</span>      <span class="stringliteral">&quot;(executable: %s | version: %s | compiled: %s, %s)\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 5330</span>      argv[0], VERSION, __DATE__, __TIME__);</div>
<div class="line"><span class="lineno"> 5331</span> </div>
<div class="line"><span class="lineno"> 5332</span>  <span class="comment">/* Emitters... */</span></div>
<div class="line"><span class="lineno"> 5333</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;NG&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5334</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a> &gt; <a class="code hl_define" href="jurassic_8h.html#ac29517e805c6a27f76e87e634eaf2929">NG</a>)</div>
<div class="line"><span class="lineno"> 5335</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set 0 &lt;= NG &lt;= MAX!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5336</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 5337</span>    <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;EMITTER&quot;</span>, ig, <span class="stringliteral">&quot;&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 5338</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a253c2c449b1d7e2f0eeda2ed62c8a4fe">ig_co2</a> = <a class="code hl_function" href="jurassic_8c.html#a832e63c37527025311d1886a60dff605">find_emitter</a>(ctl, <span class="stringliteral">&quot;CO2&quot;</span>);</div>
<div class="line"><span class="lineno"> 5339</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae2af3d94af749a1d5ca2ca2d2b92067c">ig_h2o</a> = <a class="code hl_function" href="jurassic_8c.html#a832e63c37527025311d1886a60dff605">find_emitter</a>(ctl, <span class="stringliteral">&quot;H2O&quot;</span>);</div>
<div class="line"><span class="lineno"> 5340</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aad56428f3ab41bd9c3b28a84c970d3b9">ig_n2</a> = <a class="code hl_function" href="jurassic_8c.html#a832e63c37527025311d1886a60dff605">find_emitter</a>(ctl, <span class="stringliteral">&quot;N2&quot;</span>);</div>
<div class="line"><span class="lineno"> 5341</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8b568f9d63b3d40886e073290532a28d">ig_o2</a> = <a class="code hl_function" href="jurassic_8c.html#a832e63c37527025311d1886a60dff605">find_emitter</a>(ctl, <span class="stringliteral">&quot;O2&quot;</span>);</div>
<div class="line"><span class="lineno"> 5342</span> </div>
<div class="line"><span class="lineno"> 5343</span>  <span class="comment">/* Radiance channels... */</span></div>
<div class="line"><span class="lineno"> 5344</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ND&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5345</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a> &gt; <a class="code hl_define" href="jurassic_8h.html#a68d169e5b90cf721678bc7ab0f964a99">ND</a>)</div>
<div class="line"><span class="lineno"> 5346</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set 0 &lt;= ND &lt;= MAX!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5347</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 5348</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;NU&quot;</span>, <span class="keywordtype">id</span>, <span class="stringliteral">&quot;&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5349</span> </div>
<div class="line"><span class="lineno"> 5350</span>  <span class="comment">/* Spectral windows... */</span></div>
<div class="line"><span class="lineno"> 5351</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;NW&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5352</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a> &gt; <a class="code hl_define" href="jurassic_8h.html#af9cccf331f045b89a9f12366df5f7687">NW</a>)</div>
<div class="line"><span class="lineno"> 5353</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set 0 &lt;= NW &lt;= MAX!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5354</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 5355</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6f1ec265b1a0c94431403038d6dbef00">window</a>[<span class="keywordtype">id</span>] = (<span class="keywordtype">int</span>) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;WINDOW&quot;</span>, <span class="keywordtype">id</span>, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5356</span> </div>
<div class="line"><span class="lineno"> 5357</span>  <span class="comment">/* Cloud data... */</span></div>
<div class="line"><span class="lineno"> 5358</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;NCL&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5359</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &gt; <a class="code hl_define" href="jurassic_8h.html#ae5207491b45fa8881c40214d7ac0d214">NCL</a>)</div>
<div class="line"><span class="lineno"> 5360</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set 0 &lt;= NCL &lt;= MAX!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5361</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> == 1)</div>
<div class="line"><span class="lineno"> 5362</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set NCL &gt; 1!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5363</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 5364</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f3c54e7d6c87fe31e3bd0f54df1fdf0">clnu</a>[icl] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;CLNU&quot;</span>, icl, <span class="stringliteral">&quot;&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5365</span> </div>
<div class="line"><span class="lineno"> 5366</span>  <span class="comment">/* Surface data... */</span></div>
<div class="line"><span class="lineno"> 5367</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;NSF&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5368</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &gt; <a class="code hl_define" href="jurassic_8h.html#ae3c34ac35580d9f179172c9d99940327">NSF</a>)</div>
<div class="line"><span class="lineno"> 5369</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set 0 &lt;= NSF &lt;= MAX!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5370</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> == 1)</div>
<div class="line"><span class="lineno"> 5371</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set NSF &gt; 1!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5372</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 5373</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a29804fac77623ca3d1e32f92955ac501">sfnu</a>[isf] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;SFNU&quot;</span>, isf, <span class="stringliteral">&quot;&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5374</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8ff7b3f429eb1f23d768fd189d963169">sftype</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;SFTYPE&quot;</span>, -1, <span class="stringliteral">&quot;2&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5375</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8ff7b3f429eb1f23d768fd189d963169">sftype</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8ff7b3f429eb1f23d768fd189d963169">sftype</a> &gt; 3)</div>
<div class="line"><span class="lineno"> 5376</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set 0 &lt;= SFTYPE &lt;= 3!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5377</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8e7cd04d65ba7ae0efb60e09678a566c">sfsza</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;SFSZA&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5378</span> </div>
<div class="line"><span class="lineno"> 5379</span>  <span class="comment">/* Emissivity look-up tables... */</span></div>
<div class="line"><span class="lineno"> 5380</span>  <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;TBLBASE&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">tblbase</a>);</div>
<div class="line"><span class="lineno"> 5381</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae9e580318eb04b3963daaa98a9651129">tblfmt</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;TBLFMT&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5382</span> </div>
<div class="line"><span class="lineno"> 5383</span>  <span class="comment">/* File formats... */</span></div>
<div class="line"><span class="lineno"> 5384</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0ff333a479f441f6f356f60ab0eeb577">atmfmt</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ATMFMT&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5385</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab313bb0c5f05e01cdda367977c39f29a">obsfmt</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;OBSFMT&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5386</span> </div>
<div class="line"><span class="lineno"> 5387</span>  <span class="comment">/* Hydrostatic equilibrium... */</span></div>
<div class="line"><span class="lineno"> 5388</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3fd78306de446288abde8209472e8b51">hydz</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;HYDZ&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5389</span> </div>
<div class="line"><span class="lineno"> 5390</span>  <span class="comment">/* Continua... */</span></div>
<div class="line"><span class="lineno"> 5391</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a417bdd14462698d3ced23bc954fa48a0">ctm_co2</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;CTM_CO2&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5392</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a73f4f8e915d10ba9048b798580f7dddb">ctm_h2o</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;CTM_H2O&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5393</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5b53512f37127a12ef73a85dc8ccee4c">ctm_n2</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;CTM_N2&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5394</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad66545f9845ba89aa91fd173b50600ce">ctm_o2</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;CTM_O2&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5395</span> </div>
<div class="line"><span class="lineno"> 5396</span>  <span class="comment">/* Ray-tracing... */</span></div>
<div class="line"><span class="lineno"> 5397</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a840532f5c38a5b325317cede07b40990">refrac</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;REFRAC&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5398</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#add30b1dee3914f1d1473df0fccabb364">rayds</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RAYDS&quot;</span>, -1, <span class="stringliteral">&quot;10&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5399</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee8d7ddf07ec801c7d4a2037cb23a6e7">raydz</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RAYDZ&quot;</span>, -1, <span class="stringliteral">&quot;0.1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5400</span> </div>
<div class="line"><span class="lineno"> 5401</span>  <span class="comment">/* Field of view... */</span></div>
<div class="line"><span class="lineno"> 5402</span>  <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;FOV&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6dd6b751109cac0ebf94f3bcae7a01e8">fov</a>);</div>
<div class="line"><span class="lineno"> 5403</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6dd6b751109cac0ebf94f3bcae7a01e8">fov</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5404</span>    <a class="code hl_function" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd">read_shape</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6dd6b751109cac0ebf94f3bcae7a01e8">fov</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac995bb7e49db8132059101867cc00e38">fov_dz</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af728c5c4b398624439a3a7d881476dd2">fov_w</a>, &amp;ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8feb52a8c01e8348012c0f2f714f2f92">fov_n</a>);</div>
<div class="line"><span class="lineno"> 5405</span> </div>
<div class="line"><span class="lineno"> 5406</span>  <span class="comment">/* Retrieval interface... */</span></div>
<div class="line"><span class="lineno"> 5407</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1184388515bcde02af618c43495164a1">retp_zmin</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RETP_ZMIN&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5408</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb1ec420b7e90ebf056640417572a225">retp_zmax</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RETP_ZMAX&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5409</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8df8e6875b7fe5ab5e2805390b3f9c3f">rett_zmin</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RETT_ZMIN&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5410</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4ceaa6f495415c535223541d957491d3">rett_zmax</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RETT_ZMAX&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5411</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 5412</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7d487af5fe0e4d378d90865f589c7ddc">retq_zmin</a>[ig] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RETQ_ZMIN&quot;</span>, ig, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5413</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a785678f0cb53cbf59f390ad671f262f3">retq_zmax</a>[ig] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RETQ_ZMAX&quot;</span>, ig, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5414</span>  }</div>
<div class="line"><span class="lineno"> 5415</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++) {</div>
<div class="line"><span class="lineno"> 5416</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aab99fb086f49aee8e2aa5fd1c517a221">retk_zmin</a>[iw] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RETK_ZMIN&quot;</span>, iw, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5417</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26933d7ba71ac03f208a4c3b59c6c12a">retk_zmax</a>[iw] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RETK_ZMAX&quot;</span>, iw, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5418</span>  }</div>
<div class="line"><span class="lineno"> 5419</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a59116b56f658e88f16fdadd8f8573b9b">ret_clz</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RET_CLZ&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5420</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae25be11810f5e53581c26f20fe22fe7d">ret_cldz</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RET_CLDZ&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5421</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad6e4dce394bf7b0dd53d37cd9417cbd2">ret_clk</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RET_CLK&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5422</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5771f0852888a5ac64c5cdcc588f684b">ret_sft</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RET_SFT&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5423</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a563edaaec6157678618fed9fbc85b79c">ret_sfeps</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RET_SFEPS&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5424</span> </div>
<div class="line"><span class="lineno"> 5425</span>  <span class="comment">/* Output flags... */</span></div>
<div class="line"><span class="lineno"> 5426</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af700a5fe670e013c550494cee733b60c">write_bbt</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;WRITE_BBT&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5427</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a090c906958cc2f98fff69d4cc7c0f40c">write_matrix</a> =</div>
<div class="line"><span class="lineno"> 5428</span>    (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;WRITE_MATRIX&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5429</span> </div>
<div class="line"><span class="lineno"> 5430</span>  <span class="comment">/* External forward models... */</span></div>
<div class="line"><span class="lineno"> 5431</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a76702f4f08a76f29e138d97c7d2b1833">formod</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;FORMOD&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5432</span>  <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RFMBIN&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a342dfe238de9dfcb389b07477f8ef527">rfmbin</a>);</div>
<div class="line"><span class="lineno"> 5433</span>  <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RFMHIT&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a32f95b8c7a13422eb1614bc86261d8f2">rfmhit</a>);</div>
<div class="line"><span class="lineno"> 5434</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 5435</span>    <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;RFMXSC&quot;</span>, ig, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6ea477ad330f7edacbef53573d224d9b">rfmxsc</a>[ig]);</div>
<div class="line"><span class="lineno"> 5436</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a832e63c37527025311d1886a60dff605"><div class="ttname"><a href="jurassic_8c.html#a832e63c37527025311d1886a60dff605">find_emitter</a></div><div class="ttdeci">int find_emitter(const ctl_t *ctl, const char *emitter)</div><div class="ttdoc">Find gas species index by name.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03396">jurassic.c:3396</a></div></div>
<div class="ttc" id="ajurassic_8c_html_abb6ce9b0361afe11cb23b8ac1e0c7fa3"><div class="ttname"><a href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a></div><div class="ttdeci">double scan_ctl(int argc, char *argv[], const char *varname, const int arridx, const char *defvalue, char *value)</div><div class="ttdoc">Scan control file or command-line arguments for a configuration variable.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06267">jurassic.c:6267</a></div></div>
<div class="ttc" id="ajurassic_8h_html_ae3c34ac35580d9f179172c9d99940327"><div class="ttname"><a href="jurassic_8h.html#ae3c34ac35580d9f179172c9d99940327">NSF</a></div><div class="ttdeci">#define NSF</div><div class="ttdoc">Maximum number of surface layer spectral grid points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00257">jurassic.h:257</a></div></div>
<div class="ttc" id="ajurassic_8h_html_ae5207491b45fa8881c40214d7ac0d214"><div class="ttname"><a href="jurassic_8h.html#ae5207491b45fa8881c40214d7ac0d214">NCL</a></div><div class="ttdeci">#define NCL</div><div class="ttdoc">Maximum number of cloud layer spectral grid points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00232">jurassic.h:232</a></div></div>
<div class="ttc" id="astructctl__t_html_a090c906958cc2f98fff69d4cc7c0f40c"><div class="ttname"><a href="structctl__t.html#a090c906958cc2f98fff69d4cc7c0f40c">ctl_t::write_matrix</a></div><div class="ttdeci">int write_matrix</div><div class="ttdoc">Write matrix file (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01192">jurassic.h:1192</a></div></div>
<div class="ttc" id="astructctl__t_html_ab313bb0c5f05e01cdda367977c39f29a"><div class="ttname"><a href="structctl__t.html#ab313bb0c5f05e01cdda367977c39f29a">ctl_t::obsfmt</a></div><div class="ttdeci">int obsfmt</div><div class="ttdoc">Observation data file format (1=ASCII, 2=binary).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01111">jurassic.h:1111</a></div></div>
<div class="ttc" id="astructctl__t_html_ae9e580318eb04b3963daaa98a9651129"><div class="ttname"><a href="structctl__t.html#ae9e580318eb04b3963daaa98a9651129">ctl_t::tblfmt</a></div><div class="ttdeci">int tblfmt</div><div class="ttdoc">Look-up table file format (1=ASCII, 2=binary).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01105">jurassic.h:1105</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a3635d1716488dea37d1176c1fb02675f_cgraph.png" border="0" usemap="#ajurassic_8h_a3635d1716488dea37d1176c1fb02675f_cgraph" alt=""/></div>
<map name="ajurassic_8h_a3635d1716488dea37d1176c1fb02675f_cgraph" id="ajurassic_8h_a3635d1716488dea37d1176c1fb02675f_cgraph">
<area shape="rect" title="Read model control parameters from command&#45;line and configuration input." alt="" coords="5,56,73,83"/>
<area shape="rect" href="jurassic_8c.html#a832e63c37527025311d1886a60dff605" title="Find gas species index by name." alt="" coords="121,5,211,32"/>
<area shape="rect" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two&#45;column shape function from an ASCII file." alt="" coords="121,56,211,83"/>
<area shape="rect" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3" title="Scan control file or command&#45;line arguments for a configuration variable." alt="" coords="131,107,201,133"/>
</map>
</div>

</div>
</div>
<a id="a1380c5f839b8a1cca792a83de445a4b3" name="a1380c5f839b8a1cca792a83de445a4b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1380c5f839b8a1cca792a83de445a4b3">&#9670;&nbsp;</a></span>read_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_matrix </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>matrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a numerical matrix from an ASCII file. </p>
<p >Loads values into a GSL matrix from a text file containing sparse or indexed entries in tabular format. <br  />
 Each valid line is parsed for row and column indices and the corresponding value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirname</td><td>Directory path containing the matrix file (may be NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Name of the matrix file to read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">matrix</td><td>Pointer to the GSL matrix to be filled with values.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Opens the specified file and scans it line by line.</li>
<li>Initializes the matrix to zero before filling.</li>
<li>Each line is expected to contain at least 13 formatted fields, where:<ul>
<li>The first integer gives the row index,</li>
<li>The seventh integer gives the column index,</li>
<li>The thirteenth floating-point number is the matrix element value. <br  />
</li>
</ul>
</li>
<li>All successfully parsed entries are written to the corresponding positions in the GSL matrix using <code>gsl_matrix_set()</code>.</li>
<li>Non-matching lines are ignored.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>gsl_matrix, <a class="el" href="jurassic_8h.html#a3635d1716488dea37d1176c1fb02675f" title="Read model control parameters from command-line and configuration input.">read_ctl</a>, <a class="el" href="jurassic_8h.html#aa4a7b8ec913874ba418cfb4280fd3b84" title="Read atmospheric input data from a file.">read_atm</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Aborts if the file cannot be opened.</li>
<li>Expects 0-based integer indices consistent with matrix dimensions.</li>
<li>Lines not matching the expected 13-field format are skipped silently.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05440">5440</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5443</span>                      {</div>
<div class="line"><span class="lineno"> 5444</span> </div>
<div class="line"><span class="lineno"> 5445</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 5446</span> </div>
<div class="line"><span class="lineno"> 5447</span>  <span class="keywordtype">char</span> dum[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], file[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], line[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 5448</span> </div>
<div class="line"><span class="lineno"> 5449</span>  <span class="keywordtype">double</span> value;</div>
<div class="line"><span class="lineno"> 5450</span> </div>
<div class="line"><span class="lineno"> 5451</span>  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno"> 5452</span> </div>
<div class="line"><span class="lineno"> 5453</span>  <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 5454</span>  <span class="keywordflow">if</span> (dirname != NULL)</div>
<div class="line"><span class="lineno"> 5455</span>    sprintf(file, <span class="stringliteral">&quot;%s/%s&quot;</span>, dirname, filename);</div>
<div class="line"><span class="lineno"> 5456</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5457</span>    sprintf(file, <span class="stringliteral">&quot;%s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 5458</span> </div>
<div class="line"><span class="lineno"> 5459</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5460</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read matrix: %s&quot;</span>, file);</div>
<div class="line"><span class="lineno"> 5461</span> </div>
<div class="line"><span class="lineno"> 5462</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 5463</span>  <span class="keywordflow">if</span> (!(in = fopen(file, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 5464</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5465</span> </div>
<div class="line"><span class="lineno"> 5466</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 5467</span>  gsl_matrix_set_zero(matrix);</div>
<div class="line"><span class="lineno"> 5468</span>  <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in))</div>
<div class="line"><span class="lineno"> 5469</span>    <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%d %s %s %s %s %s %d %s %s %s %s %s %lg&quot;</span>,</div>
<div class="line"><span class="lineno"> 5470</span>               &amp;i, dum, dum, dum, dum, dum,</div>
<div class="line"><span class="lineno"> 5471</span>               &amp;j, dum, dum, dum, dum, dum, &amp;value) == 13)</div>
<div class="line"><span class="lineno"> 5472</span>      gsl_matrix_set(matrix, (<span class="keywordtype">size_t</span>) i, (<span class="keywordtype">size_t</span>) j, value);</div>
<div class="line"><span class="lineno"> 5473</span> </div>
<div class="line"><span class="lineno"> 5474</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 5475</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 5476</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa92ca8109106ef5912a265d7c882038d" name="aa92ca8109106ef5912a265d7c882038d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa92ca8109106ef5912a265d7c882038d">&#9670;&nbsp;</a></span>read_obs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_obs </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read observation data from an input file. </p>
<p >This function reads atmospheric observation data from the specified file and stores the results in the provided <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a> structure. The file may be in ASCII or binary format, depending on the control settings passed via <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>. After reading the data, the routine performs basic validation (e.g., verifies that at least one observation entry was loaded) and logs diagnostic statistics such as ranges of times, observer coordinates, view point coordinates, tangent point coordinates, radiance or brightness temperature values, and transmittances.</p>
<p >The input file path is constructed from the provided directory and filename. If a directory name is given, the file is assumed to reside within it; otherwise, the filename is used as-is. Depending on the value of <code>ctl-&gt;obsfmt</code>, the function dispatches either to <a class="el" href="jurassic_8h.html#a96625d07215f4c342fb3304618a07fd0" title="Read ASCII-formatted observation data from an open file stream.">read_obs_asc()</a> for ASCII files or <a class="el" href="jurassic_8h.html#aa1a252223bd58c083b0ef8a8ff3391d0" title="Read binary-formatted observation data from an open file stream.">read_obs_bin()</a> for binary files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirname</td><td>Directory containing the input file, or <code>NULL</code> to use only <code>filename</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Name of the observation file to read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to a control structure specifying file format and other options. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">obs</td><td>Pointer to an observation structure where the data will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function terminates with an error message if the file cannot be opened, the observation format is unknown, or no valid data is read.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The <code>obs</code> structure must be properly allocated before calling this function. The function assumes its arrays are large enough to store all values contained in the input file.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a96625d07215f4c342fb3304618a07fd0" title="Read ASCII-formatted observation data from an open file stream.">read_obs_asc()</a>, <a class="el" href="jurassic_8h.html#aa1a252223bd58c083b0ef8a8ff3391d0" title="Read binary-formatted observation data from an open file stream.">read_obs_bin()</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05480">5480</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5484</span>              {</div>
<div class="line"><span class="lineno"> 5485</span> </div>
<div class="line"><span class="lineno"> 5486</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 5487</span> </div>
<div class="line"><span class="lineno"> 5488</span>  <span class="keywordtype">char</span> file[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 5489</span> </div>
<div class="line"><span class="lineno"> 5490</span>  <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 5491</span>  <span class="keywordflow">if</span> (dirname != NULL)</div>
<div class="line"><span class="lineno"> 5492</span>    sprintf(file, <span class="stringliteral">&quot;%s/%s&quot;</span>, dirname, filename);</div>
<div class="line"><span class="lineno"> 5493</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5494</span>    sprintf(file, <span class="stringliteral">&quot;%s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 5495</span> </div>
<div class="line"><span class="lineno"> 5496</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5497</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read observation data: %s&quot;</span>, file);</div>
<div class="line"><span class="lineno"> 5498</span> </div>
<div class="line"><span class="lineno"> 5499</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 5500</span>  <span class="keywordflow">if</span> (!(in = fopen(file, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 5501</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5502</span> </div>
<div class="line"><span class="lineno"> 5503</span>  <span class="comment">/* Read ASCII data... */</span></div>
<div class="line"><span class="lineno"> 5504</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab313bb0c5f05e01cdda367977c39f29a">obsfmt</a> == 1)</div>
<div class="line"><span class="lineno"> 5505</span>    <a class="code hl_function" href="jurassic_8c.html#a96625d07215f4c342fb3304618a07fd0">read_obs_asc</a>(in, ctl, obs);</div>
<div class="line"><span class="lineno"> 5506</span> </div>
<div class="line"><span class="lineno"> 5507</span>  <span class="comment">/* Read binary data... */</span></div>
<div class="line"><span class="lineno"> 5508</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab313bb0c5f05e01cdda367977c39f29a">obsfmt</a> == 2)</div>
<div class="line"><span class="lineno"> 5509</span>    <a class="code hl_function" href="jurassic_8c.html#aa1a252223bd58c083b0ef8a8ff3391d0">read_obs_bin</a>(in, ctl, obs);</div>
<div class="line"><span class="lineno"> 5510</span> </div>
<div class="line"><span class="lineno"> 5511</span>  <span class="comment">/* Error... */</span></div>
<div class="line"><span class="lineno"> 5512</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5513</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Unknown observation file format!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5514</span> </div>
<div class="line"><span class="lineno"> 5515</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 5516</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 5517</span> </div>
<div class="line"><span class="lineno"> 5518</span>  <span class="comment">/* Check number of points... */</span></div>
<div class="line"><span class="lineno"> 5519</span>  <span class="keywordflow">if</span> (obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a> &lt; 1)</div>
<div class="line"><span class="lineno"> 5520</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Could not read any data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5521</span> </div>
<div class="line"><span class="lineno"> 5522</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5523</span>  <span class="keywordtype">double</span> mini, maxi;</div>
<div class="line"><span class="lineno"> 5524</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of ray paths: %d&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5525</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5526</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time range: %.2f ... %.2f s&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5527</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5528</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Observer altitude range: %g ... %g km&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5529</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5530</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Observer longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5531</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5532</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Observer latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5533</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5534</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;View point altitude range: %g ... %g km&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5535</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5536</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;View point longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5537</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5538</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;View point latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5539</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5540</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Tangent point altitude range: %g ... %g km&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5541</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5542</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Tangent point longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5543</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5544</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Tangent point latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5545</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 5546</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>], 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5547</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af700a5fe670e013c550494cee733b60c">write_bbt</a>) {</div>
<div class="line"><span class="lineno"> 5548</span>      <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Brightness temperature (%.4f cm^-1) range: %g ... %g K&quot;</span>,</div>
<div class="line"><span class="lineno"> 5549</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], mini, maxi);</div>
<div class="line"><span class="lineno"> 5550</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5551</span>      <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Radiance (%.4f cm^-1) range: %g ... %g W/(m^2 sr cm^-1)&quot;</span>,</div>
<div class="line"><span class="lineno"> 5552</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], mini, maxi);</div>
<div class="line"><span class="lineno"> 5553</span>    }</div>
<div class="line"><span class="lineno"> 5554</span>  }</div>
<div class="line"><span class="lineno"> 5555</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 5556</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[<span class="keywordtype">id</span>], 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 5557</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af700a5fe670e013c550494cee733b60c">write_bbt</a>) {</div>
<div class="line"><span class="lineno"> 5558</span>      <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Transmittance (%.4f cm^-1) range: %g ... %g&quot;</span>,</div>
<div class="line"><span class="lineno"> 5559</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], mini, maxi);</div>
<div class="line"><span class="lineno"> 5560</span>    }</div>
<div class="line"><span class="lineno"> 5561</span>  }</div>
<div class="line"><span class="lineno"> 5562</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a96625d07215f4c342fb3304618a07fd0"><div class="ttname"><a href="jurassic_8c.html#a96625d07215f4c342fb3304618a07fd0">read_obs_asc</a></div><div class="ttdeci">void read_obs_asc(FILE *in, const ctl_t *ctl, obs_t *obs)</div><div class="ttdoc">Read ASCII-formatted observation data from an open file stream.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l05566">jurassic.c:5566</a></div></div>
<div class="ttc" id="ajurassic_8c_html_aa1a252223bd58c083b0ef8a8ff3391d0"><div class="ttname"><a href="jurassic_8c.html#aa1a252223bd58c083b0ef8a8ff3391d0">read_obs_bin</a></div><div class="ttdeci">void read_obs_bin(FILE *in, const ctl_t *ctl, obs_t *obs)</div><div class="ttdoc">Read binary-formatted observation data from an open file stream.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l05603">jurassic.c:5603</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_aa92ca8109106ef5912a265d7c882038d_cgraph.png" border="0" usemap="#ajurassic_8h_aa92ca8109106ef5912a265d7c882038d_cgraph" alt=""/></div>
<map name="ajurassic_8h_aa92ca8109106ef5912a265d7c882038d_cgraph" id="ajurassic_8h_aa92ca8109106ef5912a265d7c882038d_cgraph">
<area shape="rect" title="Read observation data from an input file." alt="" coords="5,31,80,57"/>
<area shape="rect" href="jurassic_8c.html#a96625d07215f4c342fb3304618a07fd0" title="Read ASCII&#45;formatted observation data from an open file stream." alt="" coords="128,5,231,32"/>
<area shape="rect" href="jurassic_8c.html#aa1a252223bd58c083b0ef8a8ff3391d0" title="Read binary&#45;formatted observation data from an open file stream." alt="" coords="130,56,229,83"/>
</map>
</div>

</div>
</div>
<a id="a96625d07215f4c342fb3304618a07fd0" name="a96625d07215f4c342fb3304618a07fd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96625d07215f4c342fb3304618a07fd0">&#9670;&nbsp;</a></span>read_obs_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_obs_asc </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read ASCII-formatted observation data from an open file stream. </p>
<p >This function parses atmospheric observation data from an ASCII text file and stores it in the provided <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a> structure. Each line in the input file is expected to contain numerical values representing a single observation record, including time, observer coordinates, view point coordinates, tangent point coordinates, radiance or brightness temperature values, and transmittances. The number of radiance and transmittance values per record is determined by <code>ctl-&gt;nd</code>.</p>
<p >The function reads the file line by line, tokenizes the data fields, and fills the corresponding observation arrays. The number of successfully read observation entries is stored in <code>obs-&gt;nr</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Open file pointer from which the ASCII observation data will be read. The file must already be opened in read mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure containing metadata such as the number of spectral channels (<code>nd</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">obs</td><td>Observation structure where parsed data will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is a C function and assumes that the <code>obs</code> structure has been preallocated with sufficient space for all records and spectral channels. No memory allocation is performed inside this routine.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The function terminates with an error message if the number of entries exceeds the predefined limit <code>NR</code>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aa92ca8109106ef5912a265d7c882038d" title="Read observation data from an input file.">read_obs()</a>, <a class="el" href="jurassic_8h.html#aa1a252223bd58c083b0ef8a8ff3391d0" title="Read binary-formatted observation data from an open file stream.">read_obs_bin()</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05566">5566</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5569</span>              {</div>
<div class="line"><span class="lineno"> 5570</span> </div>
<div class="line"><span class="lineno"> 5571</span>  <span class="keywordtype">char</span> line[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], *tok;</div>
<div class="line"><span class="lineno"> 5572</span> </div>
<div class="line"><span class="lineno"> 5573</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 5574</span>  obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a> = 0;</div>
<div class="line"><span class="lineno"> 5575</span> </div>
<div class="line"><span class="lineno"> 5576</span>  <span class="comment">/* Read line... */</span></div>
<div class="line"><span class="lineno"> 5577</span>  <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in)) {</div>
<div class="line"><span class="lineno"> 5578</span> </div>
<div class="line"><span class="lineno"> 5579</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 5580</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(line, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5581</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5582</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5583</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5584</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5585</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5586</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5587</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5588</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5589</span>    <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>[obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5590</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 5591</span>      <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5592</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 5593</span>      <a class="code hl_define" href="jurassic_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[<span class="keywordtype">id</span>][obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>]);</div>
<div class="line"><span class="lineno"> 5594</span> </div>
<div class="line"><span class="lineno"> 5595</span>    <span class="comment">/* Increment counter... */</span></div>
<div class="line"><span class="lineno"> 5596</span>    <span class="keywordflow">if</span> ((++obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>) &gt; <a class="code hl_define" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>)</div>
<div class="line"><span class="lineno"> 5597</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many rays!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5598</span>  }</div>
<div class="line"><span class="lineno"> 5599</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1a252223bd58c083b0ef8a8ff3391d0" name="aa1a252223bd58c083b0ef8a8ff3391d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a252223bd58c083b0ef8a8ff3391d0">&#9670;&nbsp;</a></span>read_obs_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_obs_bin </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read binary-formatted observation data from an open file stream. </p>
<p >This C function reads observation data stored in a compact binary format and initializes the provided <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a> structure with the values retrieved from the input file. The binary format begins with a header that contains a magic identifier and the expected number of spectral channels. The number of channels in the file must match <code>ctl-&gt;nd</code>, otherwise the routine aborts with an error.</p>
<p >After verifying the header, the function reads the number of ray paths and then sequentially loads arrays corresponding to observation time, observer location, view point location, tangent point location, radiance (or brightness temperature), and transmittance data. The number of ray paths is assigned to <code>obs-&gt;nr</code>. All arrays must have been allocated prior to calling this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Open file stream positioned at the beginning of the binary observation data. The file must be opened in binary mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to a control structure specifying the number of spectral channels (<code>nd</code>) and other configuration settings. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">obs</td><td>Pointer to an observation structure where the decoded binary data will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is a C routine and does not perform any memory allocation. The caller must ensure that all arrays in <code>obs</code> have sufficient capacity for the data being read.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The function terminates with an error message if the binary header does not match the expected channel count, if more data than allowed by <code>NR</code> is encountered, or if any read operation fails.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aa92ca8109106ef5912a265d7c882038d" title="Read observation data from an input file.">read_obs()</a>, <a class="el" href="jurassic_8h.html#a96625d07215f4c342fb3304618a07fd0" title="Read ASCII-formatted observation data from an open file stream.">read_obs_asc()</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05603">5603</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5606</span>              {</div>
<div class="line"><span class="lineno"> 5607</span> </div>
<div class="line"><span class="lineno"> 5608</span>  <span class="comment">/* Read header... */</span></div>
<div class="line"><span class="lineno"> 5609</span>  <span class="keywordtype">char</span> magic[4];</div>
<div class="line"><span class="lineno"> 5610</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(magic, <span class="keywordtype">char</span>,</div>
<div class="line"><span class="lineno"> 5611</span>        4,</div>
<div class="line"><span class="lineno"> 5612</span>        in);</div>
<div class="line"><span class="lineno"> 5613</span>  <span class="keywordflow">if</span> (memcmp(magic, <span class="stringliteral">&quot;OBS1&quot;</span>, 4) != 0)</div>
<div class="line"><span class="lineno"> 5614</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Invalid magic string!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5615</span> </div>
<div class="line"><span class="lineno"> 5616</span>  <span class="keywordtype">int</span> nd;</div>
<div class="line"><span class="lineno"> 5617</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;nd, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 5618</span>        1,</div>
<div class="line"><span class="lineno"> 5619</span>        in);</div>
<div class="line"><span class="lineno"> 5620</span>  <span class="keywordflow">if</span> (nd != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>)</div>
<div class="line"><span class="lineno"> 5621</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error reading file header!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5622</span> </div>
<div class="line"><span class="lineno"> 5623</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 5624</span>  <span class="keywordtype">size_t</span> nr;</div>
<div class="line"><span class="lineno"> 5625</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;nr, <span class="keywordtype">size_t</span>,</div>
<div class="line"><span class="lineno"> 5626</span>        1,</div>
<div class="line"><span class="lineno"> 5627</span>        in);</div>
<div class="line"><span class="lineno"> 5628</span>  obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a> = (int) nr;</div>
<div class="line"><span class="lineno"> 5629</span>  <span class="keywordflow">if</span> (obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a> &gt; <a class="code hl_define" href="jurassic_8h.html#af146485306ae74a2edf18636300fd107">NR</a>)</div>
<div class="line"><span class="lineno"> 5630</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many ray paths!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5631</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5632</span>        nr,</div>
<div class="line"><span class="lineno"> 5633</span>        in);</div>
<div class="line"><span class="lineno"> 5634</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5635</span>        nr,</div>
<div class="line"><span class="lineno"> 5636</span>        in);</div>
<div class="line"><span class="lineno"> 5637</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5638</span>        nr,</div>
<div class="line"><span class="lineno"> 5639</span>        in);</div>
<div class="line"><span class="lineno"> 5640</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5641</span>        nr,</div>
<div class="line"><span class="lineno"> 5642</span>        in);</div>
<div class="line"><span class="lineno"> 5643</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5644</span>        nr,</div>
<div class="line"><span class="lineno"> 5645</span>        in);</div>
<div class="line"><span class="lineno"> 5646</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5647</span>        nr,</div>
<div class="line"><span class="lineno"> 5648</span>        in);</div>
<div class="line"><span class="lineno"> 5649</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5650</span>        nr,</div>
<div class="line"><span class="lineno"> 5651</span>        in);</div>
<div class="line"><span class="lineno"> 5652</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5653</span>        nr,</div>
<div class="line"><span class="lineno"> 5654</span>        in);</div>
<div class="line"><span class="lineno"> 5655</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5656</span>        nr,</div>
<div class="line"><span class="lineno"> 5657</span>        in);</div>
<div class="line"><span class="lineno"> 5658</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5659</span>        nr,</div>
<div class="line"><span class="lineno"> 5660</span>        in);</div>
<div class="line"><span class="lineno"> 5661</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 5662</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5663</span>          nr,</div>
<div class="line"><span class="lineno"> 5664</span>          in);</div>
<div class="line"><span class="lineno"> 5665</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 5666</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[<span class="keywordtype">id</span>], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5667</span>          nr,</div>
<div class="line"><span class="lineno"> 5668</span>          in);</div>
<div class="line"><span class="lineno"> 5669</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a134dbd60b73c18eda7032e58284dbade" name="a134dbd60b73c18eda7032e58284dbade"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a134dbd60b73c18eda7032e58284dbade">&#9670;&nbsp;</a></span>read_obs_rfm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double read_obs_rfm </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>basename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read and spectrally convolve an RFM output spectrum. </p>
<p >Opens the appropriate RFM ASCII spectrum file for a given tangent or observation altitude and convolves the high-resolution spectrum with a provided instrument filter function. <br  />
 Returns the integrated (filtered) radiance value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">basename</td><td>Base filename of the RFM output (e.g. "rad" or "tra"). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Altitude [km] used to select the corresponding RFM file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Wavenumber grid [cm] of the filter function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Filter transmission values corresponding to <code>nu</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of points in <code>nu</code> and <code>f</code> arrays.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Filtered radiance value integrated over the instrument bandpass.</dd></dl>
<ul>
<li>The routine looks for an RFM output file named <code>basename_&lt;altitude_in_meters&gt;.asc</code> (e.g. <code>rad_04500.asc</code>).</li>
<li>If not found, it retries with altitude+1 meter to tolerate rounding.</li>
<li>The file is read using <a class="el" href="jurassic_8c.html#a19d63e07e3eb8166cbf65ce079e4d156">read_rfm_spec()</a> into arrays of wavenumbers (<code>nurfm</code>) and radiances (<code>rad</code>).</li>
<li>The input filter function \( f(\nu) \) is linearly interpolated onto the RFM wavenumber grid, and the spectrum is convolved as <p class="formulaDsp">
\[
      R = \frac{\int f(\nu) \, I(\nu) \, d\nu}{\int f(\nu) \, d\nu}
  \]
</p>
</li>
<li>Linear interpolation is used for both spectral alignment and filter sampling.</li>
<li>Returns the resulting band-averaged radiance in the same units as the input.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a19d63e07e3eb8166cbf65ce079e4d156" title="Read a Reference Forward Model (RFM) ASCII spectrum.">read_rfm_spec</a>, <a class="el" href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid.">locate_irr</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a2caf20484e8e2f52ff3650321b7c704c" title="Interface routine for the Reference Forward Model (RFM).">formod_rfm</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Aborts if the corresponding RFM file cannot be found.</li>
<li>Assumes <code>nu</code> and <code>f</code> arrays are monotonic and have at least two points.</li>
<li>Files must contain RFM ASCII spectra in expected column format.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05673">5673</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5678</span>               {</div>
<div class="line"><span class="lineno"> 5679</span> </div>
<div class="line"><span class="lineno"> 5680</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 5681</span> </div>
<div class="line"><span class="lineno"> 5682</span>  <span class="keywordtype">char</span> filename[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 5683</span> </div>
<div class="line"><span class="lineno"> 5684</span>  <span class="keywordtype">double</span> filt, fsum = 0, nu2[<a class="code hl_define" href="jurassic_8h.html#a7705bd290b81177c733651a18441be93">NSHAPE</a>], *nurfm, *rad, radsum = 0;</div>
<div class="line"><span class="lineno"> 5685</span> </div>
<div class="line"><span class="lineno"> 5686</span>  <span class="keywordtype">int</span> npts;</div>
<div class="line"><span class="lineno"> 5687</span> </div>
<div class="line"><span class="lineno"> 5688</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 5689</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(nurfm, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5690</span>        <a class="code hl_define" href="jurassic_8h.html#a4afe3221b6cc7d990b27a05a924ee2a2">RFMNPTS</a>);</div>
<div class="line"><span class="lineno"> 5691</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rad, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 5692</span>        <a class="code hl_define" href="jurassic_8h.html#a4afe3221b6cc7d990b27a05a924ee2a2">RFMNPTS</a>);</div>
<div class="line"><span class="lineno"> 5693</span> </div>
<div class="line"><span class="lineno"> 5694</span>  <span class="comment">/* Search RFM spectrum... */</span></div>
<div class="line"><span class="lineno"> 5695</span>  sprintf(filename, <span class="stringliteral">&quot;%s_%05d.asc&quot;</span>, basename, (<span class="keywordtype">int</span>) (z * 1000));</div>
<div class="line"><span class="lineno"> 5696</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>))) {</div>
<div class="line"><span class="lineno"> 5697</span>    sprintf(filename, <span class="stringliteral">&quot;%s_%05d.asc&quot;</span>, basename, (<span class="keywordtype">int</span>) (z * 1000) + 1);</div>
<div class="line"><span class="lineno"> 5698</span>    <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 5699</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot find RFM data file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5700</span>  }</div>
<div class="line"><span class="lineno"> 5701</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 5702</span> </div>
<div class="line"><span class="lineno"> 5703</span>  <span class="comment">/* Read RFM spectrum... */</span></div>
<div class="line"><span class="lineno"> 5704</span>  <a class="code hl_function" href="jurassic_8c.html#a19d63e07e3eb8166cbf65ce079e4d156">read_rfm_spec</a>(filename, nurfm, rad, &amp;npts);</div>
<div class="line"><span class="lineno"> 5705</span> </div>
<div class="line"><span class="lineno"> 5706</span>  <span class="comment">/* Set wavenumbers... */</span></div>
<div class="line"><span class="lineno"> 5707</span>  nu2[0] = nu[0];</div>
<div class="line"><span class="lineno"> 5708</span>  nu2[n - 1] = nu[n - 1];</div>
<div class="line"><span class="lineno"> 5709</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; n - 1; i++)</div>
<div class="line"><span class="lineno"> 5710</span>    nu2[i] = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(0.0, nu2[0], n - 1.0, nu2[n - 1], i);</div>
<div class="line"><span class="lineno"> 5711</span> </div>
<div class="line"><span class="lineno"> 5712</span>  <span class="comment">/* Convolute... */</span></div>
<div class="line"><span class="lineno"> 5713</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipts = 0; ipts &lt; npts; ipts++)</div>
<div class="line"><span class="lineno"> 5714</span>    <span class="keywordflow">if</span> (nurfm[ipts] &gt;= nu2[0] &amp;&amp; nurfm[ipts] &lt;= nu2[n - 1]) {</div>
<div class="line"><span class="lineno"> 5715</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_function" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(nu2, n, nurfm[ipts]);</div>
<div class="line"><span class="lineno"> 5716</span>      filt = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(nu2[idx], f[idx], nu2[idx + 1], f[idx + 1], nurfm[ipts]);</div>
<div class="line"><span class="lineno"> 5717</span>      fsum += filt;</div>
<div class="line"><span class="lineno"> 5718</span>      radsum += filt * rad[ipts];</div>
<div class="line"><span class="lineno"> 5719</span>    }</div>
<div class="line"><span class="lineno"> 5720</span> </div>
<div class="line"><span class="lineno"> 5721</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 5722</span>  free(nurfm);</div>
<div class="line"><span class="lineno"> 5723</span>  free(rad);</div>
<div class="line"><span class="lineno"> 5724</span> </div>
<div class="line"><span class="lineno"> 5725</span>  <span class="comment">/* Return radiance... */</span></div>
<div class="line"><span class="lineno"> 5726</span>  <span class="keywordflow">return</span> radsum / fsum;</div>
<div class="line"><span class="lineno"> 5727</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a19d63e07e3eb8166cbf65ce079e4d156"><div class="ttname"><a href="jurassic_8c.html#a19d63e07e3eb8166cbf65ce079e4d156">read_rfm_spec</a></div><div class="ttdeci">void read_rfm_spec(const char *filename, double *nu, double *rad, int *npts)</div><div class="ttdoc">Read a Reference Forward Model (RFM) ASCII spectrum.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l05784">jurassic.c:5784</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a4afe3221b6cc7d990b27a05a924ee2a2"><div class="ttname"><a href="jurassic_8h.html#a4afe3221b6cc7d990b27a05a924ee2a2">RFMNPTS</a></div><div class="ttdeci">#define RFMNPTS</div><div class="ttdoc">Maximum number of RFM spectral grid points.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00327">jurassic.h:327</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a134dbd60b73c18eda7032e58284dbade_cgraph.png" border="0" usemap="#ajurassic_8h_a134dbd60b73c18eda7032e58284dbade_cgraph" alt=""/></div>
<map name="ajurassic_8h_a134dbd60b73c18eda7032e58284dbade_cgraph" id="ajurassic_8h_a134dbd60b73c18eda7032e58284dbade_cgraph">
<area shape="rect" title="Read and spectrally convolve an RFM output spectrum." alt="" coords="5,31,107,57"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="171,5,246,32"/>
<area shape="rect" href="jurassic_8c.html#a19d63e07e3eb8166cbf65ce079e4d156" title="Read a Reference Forward Model (RFM) ASCII spectrum." alt="" coords="155,56,263,83"/>
</map>
</div>

</div>
</div>
<a id="aba21310ce74a394f3faad06002e14d46" name="aba21310ce74a394f3faad06002e14d46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba21310ce74a394f3faad06002e14d46">&#9670;&nbsp;</a></span>read_ret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_ret </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structret__t.html">ret_t</a> *&#160;</td>
          <td class="paramname"><em>ret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read retrieval configuration and error parameters. </p>
<p >Initializes the retrieval control structure (<code><a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a></code>) by reading all iteration and uncertainty parameters from the command line or an input control file using the <code><a class="el" href="jurassic_8h.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3" title="Scan control file or command-line arguments for a configuration variable.">scan_ctl()</a></code> interface.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">argc</td><td>Number of command-line arguments. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">argv</td><td>Command-line argument vector. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to global control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) defining the number of emitters, detectors, windows, clouds, etc. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>Pointer to retrieval configuration structure (<code><a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a></code>) to be populated with iteration and error settings.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following initialization steps:</p>
<ol type="1">
<li><b>Iteration control parameters</b><ul>
<li><code>KERNEL_RECOMP</code>  number of iterations between kernel recomputations. <br  />
</li>
<li><code>CONV_ITMAX</code>  maximum number of retrieval iterations. <br  />
</li>
<li><code>CONV_DMIN</code>  minimum normalized step size for convergence.</li>
</ul>
</li>
<li><b>Error analysis flag</b><ul>
<li><code>ERR_ANA</code>  enables or disables retrieval error analysis (0 = off, 1 = on).</li>
</ul>
</li>
<li><b>Instrument and forward model errors</b><ul>
<li><code>ERR_FORMOD[id]</code>  relative (%) forward model uncertainty per detector channel. <br  />
</li>
<li><code>ERR_NOISE[id]</code>  absolute instrument noise per detector channel <br  />
 [W/(msrcm)] or [K] depending on <code>write_bbt</code>.</li>
</ul>
</li>
<li><b>Pressure and temperature retrieval uncertainties</b><ul>
<li><code>ERR_PRESS</code>, <code>ERR_PRESS_CZ</code>, <code>ERR_PRESS_CH</code>  pressure error [%] and correlation lengths [km]. <br  />
</li>
<li><code>ERR_TEMP</code>, <code>ERR_TEMP_CZ</code>, <code>ERR_TEMP_CH</code>  temperature error [K] and correlation lengths [km].</li>
</ul>
</li>
<li><b>Volume mixing ratio (VMR) errors</b><ul>
<li><code>ERR_Q[ig]</code>, <code>ERR_Q_CZ[ig]</code>, <code>ERR_Q_CH[ig]</code>  per gas [%] and correlation lengths [km].</li>
</ul>
</li>
<li><b>Extinction errors</b><ul>
<li><code>ERR_K[iw]</code>, <code>ERR_K_CZ[iw]</code>, <code>ERR_K_CH[iw]</code>  per spectral window [km] and correlation lengths [km].</li>
</ul>
</li>
<li><b>Cloud retrieval parameters</b><ul>
<li><code>ERR_CLZ</code>  cloud top height error [km]. <br  />
</li>
<li><code>ERR_CLDZ</code>  cloud depth error [km]. <br  />
</li>
<li><code>ERR_CLK[icl]</code>  cloud extinction error per frequency [km].</li>
</ul>
</li>
<li><b>Surface retrieval parameters</b><ul>
<li><code>ERR_SFT</code>  surface temperature error [K]. <br  />
</li>
<li><code>ERR_SFEPS[isf]</code>  surface emissivity errors (dimensionless).</li>
</ul>
</li>
</ol>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3" title="Scan control file or command-line arguments for a configuration variable.">scan_ctl</a>, <a class="el" href="jurassic_8h.html#ae9a11e5f03e0a307add4daf864977cec" title="Construct the a priori covariance matrix  for retrieval parameters.">set_cov_apr</a>, <a class="el" href="jurassic_8h.html#a6bb69eac608c4019c689bf8280912c1f" title="Construct measurement error standard deviations and their inverse.">set_cov_meas</a>, <a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Each parameter can be specified either in the control file or on the command line (the latter overrides file values).</li>
<li>Default values are used when a parameter is not explicitly defined.</li>
<li>Correlation lengths of <code>-999</code> indicate uncorrelated (diagonal) treatment.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Input validation is minimal; ensure consistency between <code>ctl</code> and <code>ret</code> dimensions.</li>
<li>Missing mandatory parameters trigger runtime errors.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05731">5731</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5735</span>              {</div>
<div class="line"><span class="lineno"> 5736</span> </div>
<div class="line"><span class="lineno"> 5737</span>  <span class="comment">/* Iteration control... */</span></div>
<div class="line"><span class="lineno"> 5738</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a9f62c84930d539206014752d3e63b4d0">kernel_recomp</a> =</div>
<div class="line"><span class="lineno"> 5739</span>    (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;KERNEL_RECOMP&quot;</span>, -1, <span class="stringliteral">&quot;3&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5740</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#aa88d6539597eb1b823c8e68d6b903c3b">conv_itmax</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;CONV_ITMAX&quot;</span>, -1, <span class="stringliteral">&quot;30&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5741</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a5dee82585b029a4af837e27763984cee">conv_dmin</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;CONV_DMIN&quot;</span>, -1, <span class="stringliteral">&quot;0.1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5742</span> </div>
<div class="line"><span class="lineno"> 5743</span>  <span class="comment">/* Error analysis... */</span></div>
<div class="line"><span class="lineno"> 5744</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a53daece1342c39cb7720864e844bf0b5">err_ana</a> = (int) <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_ANA&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5745</span> </div>
<div class="line"><span class="lineno"> 5746</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 5747</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#a56c0b2147bb67a0a1179b3a7c3a6af23">err_formod</a>[<span class="keywordtype">id</span>] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_FORMOD&quot;</span>, <span class="keywordtype">id</span>, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5748</span> </div>
<div class="line"><span class="lineno"> 5749</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 5750</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#a6d522896a7cb7ef82a84ca9b3c8e195b">err_noise</a>[<span class="keywordtype">id</span>] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_NOISE&quot;</span>, <span class="keywordtype">id</span>, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5751</span> </div>
<div class="line"><span class="lineno"> 5752</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a37a4b935012a65da5c1ad692ee74cefe">err_press</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_PRESS&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5753</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a28b6420599cf7a0012082165d131acd6">err_press_cz</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_PRESS_CZ&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5754</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#ab8c7a6e941f1b6e41c095d1efbfab387">err_press_ch</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_PRESS_CH&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5755</span> </div>
<div class="line"><span class="lineno"> 5756</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a616ca08dddf3dfd071d523f052966b12">err_temp</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_TEMP&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5757</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a55bb904242ed4b26f1c8f5a27a4ef50a">err_temp_cz</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_TEMP_CZ&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5758</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a9d21bed9a5bbb7f044c0ed2c99c746ec">err_temp_ch</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_TEMP_CH&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5759</span> </div>
<div class="line"><span class="lineno"> 5760</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 5761</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#ad7a4d797ec29d85e0f9e4b6a0c153acb">err_q</a>[ig] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_Q&quot;</span>, ig, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5762</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#a61899a5b81d134ceff4a527383a3c55d">err_q_cz</a>[ig] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_Q_CZ&quot;</span>, ig, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5763</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#ac7074498033f17991268df8300b6553a">err_q_ch</a>[ig] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_Q_CH&quot;</span>, ig, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5764</span>  }</div>
<div class="line"><span class="lineno"> 5765</span> </div>
<div class="line"><span class="lineno"> 5766</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++) {</div>
<div class="line"><span class="lineno"> 5767</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#af4eb3f8fad1ee4d4bd4ff4176ad3575f">err_k</a>[iw] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_K&quot;</span>, iw, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5768</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#a45f25383fd186884b8a51310837b43cd">err_k_cz</a>[iw] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_K_CZ&quot;</span>, iw, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5769</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#a53df3475ac7e045917bd54caef5058ee">err_k_ch</a>[iw] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_K_CH&quot;</span>, iw, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5770</span>  }</div>
<div class="line"><span class="lineno"> 5771</span> </div>
<div class="line"><span class="lineno"> 5772</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a76cf97eefeca4904c682f93b3a9cd724">err_clz</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_CLZ&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5773</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#ab4447de9632efb35e2d9d82f1e69c2c3">err_cldz</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_CLDZ&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5774</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 5775</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#a7c9d68bdc86d25320307770ea704d37b">err_clk</a>[icl] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_CLK&quot;</span>, icl, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5776</span> </div>
<div class="line"><span class="lineno"> 5777</span>  ret-&gt;<a class="code hl_variable" href="structret__t.html#a795828c0c29f09adc759aa8d39eeeae9">err_sft</a> = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_SFT&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5778</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 5779</span>    ret-&gt;<a class="code hl_variable" href="structret__t.html#ae0ad7d1672eb774dab0f12cdccfa8b2f">err_sfeps</a>[isf] = <a class="code hl_function" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3">scan_ctl</a>(argc, argv, <span class="stringliteral">&quot;ERR_SFEPS&quot;</span>, isf, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5780</span>}</div>
<div class="ttc" id="astructret__t_html_a28b6420599cf7a0012082165d131acd6"><div class="ttname"><a href="structret__t.html#a28b6420599cf7a0012082165d131acd6">ret_t::err_press_cz</a></div><div class="ttdeci">double err_press_cz</div><div class="ttdoc">Vertical correlation length for pressure error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01356">jurassic.h:1356</a></div></div>
<div class="ttc" id="astructret__t_html_a37a4b935012a65da5c1ad692ee74cefe"><div class="ttname"><a href="structret__t.html#a37a4b935012a65da5c1ad692ee74cefe">ret_t::err_press</a></div><div class="ttdeci">double err_press</div><div class="ttdoc">Pressure error [%].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01353">jurassic.h:1353</a></div></div>
<div class="ttc" id="astructret__t_html_a45f25383fd186884b8a51310837b43cd"><div class="ttname"><a href="structret__t.html#a45f25383fd186884b8a51310837b43cd">ret_t::err_k_cz</a></div><div class="ttdeci">double err_k_cz[NW]</div><div class="ttdoc">Vertical correlation length for extinction error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01383">jurassic.h:1383</a></div></div>
<div class="ttc" id="astructret__t_html_a53df3475ac7e045917bd54caef5058ee"><div class="ttname"><a href="structret__t.html#a53df3475ac7e045917bd54caef5058ee">ret_t::err_k_ch</a></div><div class="ttdeci">double err_k_ch[NW]</div><div class="ttdoc">Horizontal correlation length for extinction error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01386">jurassic.h:1386</a></div></div>
<div class="ttc" id="astructret__t_html_a55bb904242ed4b26f1c8f5a27a4ef50a"><div class="ttname"><a href="structret__t.html#a55bb904242ed4b26f1c8f5a27a4ef50a">ret_t::err_temp_cz</a></div><div class="ttdeci">double err_temp_cz</div><div class="ttdoc">Vertical correlation length for temperature error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01365">jurassic.h:1365</a></div></div>
<div class="ttc" id="astructret__t_html_a56c0b2147bb67a0a1179b3a7c3a6af23"><div class="ttname"><a href="structret__t.html#a56c0b2147bb67a0a1179b3a7c3a6af23">ret_t::err_formod</a></div><div class="ttdeci">double err_formod[ND]</div><div class="ttdoc">Forward model error [%].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01347">jurassic.h:1347</a></div></div>
<div class="ttc" id="astructret__t_html_a616ca08dddf3dfd071d523f052966b12"><div class="ttname"><a href="structret__t.html#a616ca08dddf3dfd071d523f052966b12">ret_t::err_temp</a></div><div class="ttdeci">double err_temp</div><div class="ttdoc">Temperature error [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01362">jurassic.h:1362</a></div></div>
<div class="ttc" id="astructret__t_html_a61899a5b81d134ceff4a527383a3c55d"><div class="ttname"><a href="structret__t.html#a61899a5b81d134ceff4a527383a3c55d">ret_t::err_q_cz</a></div><div class="ttdeci">double err_q_cz[NG]</div><div class="ttdoc">Vertical correlation length for volume mixing ratio error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01374">jurassic.h:1374</a></div></div>
<div class="ttc" id="astructret__t_html_a6d522896a7cb7ef82a84ca9b3c8e195b"><div class="ttname"><a href="structret__t.html#a6d522896a7cb7ef82a84ca9b3c8e195b">ret_t::err_noise</a></div><div class="ttdeci">double err_noise[ND]</div><div class="ttdoc">Noise error [W/(m^2 sr cm^-1)].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01350">jurassic.h:1350</a></div></div>
<div class="ttc" id="astructret__t_html_a76cf97eefeca4904c682f93b3a9cd724"><div class="ttname"><a href="structret__t.html#a76cf97eefeca4904c682f93b3a9cd724">ret_t::err_clz</a></div><div class="ttdeci">double err_clz</div><div class="ttdoc">Cloud height error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01389">jurassic.h:1389</a></div></div>
<div class="ttc" id="astructret__t_html_a795828c0c29f09adc759aa8d39eeeae9"><div class="ttname"><a href="structret__t.html#a795828c0c29f09adc759aa8d39eeeae9">ret_t::err_sft</a></div><div class="ttdeci">double err_sft</div><div class="ttdoc">Surface temperature error [K].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01398">jurassic.h:1398</a></div></div>
<div class="ttc" id="astructret__t_html_a7c9d68bdc86d25320307770ea704d37b"><div class="ttname"><a href="structret__t.html#a7c9d68bdc86d25320307770ea704d37b">ret_t::err_clk</a></div><div class="ttdeci">double err_clk[NCL]</div><div class="ttdoc">Cloud extinction error [km^-1].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01395">jurassic.h:1395</a></div></div>
<div class="ttc" id="astructret__t_html_a9d21bed9a5bbb7f044c0ed2c99c746ec"><div class="ttname"><a href="structret__t.html#a9d21bed9a5bbb7f044c0ed2c99c746ec">ret_t::err_temp_ch</a></div><div class="ttdeci">double err_temp_ch</div><div class="ttdoc">Horizontal correlation length for temperature error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01368">jurassic.h:1368</a></div></div>
<div class="ttc" id="astructret__t_html_ab4447de9632efb35e2d9d82f1e69c2c3"><div class="ttname"><a href="structret__t.html#ab4447de9632efb35e2d9d82f1e69c2c3">ret_t::err_cldz</a></div><div class="ttdeci">double err_cldz</div><div class="ttdoc">Cloud depth error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01392">jurassic.h:1392</a></div></div>
<div class="ttc" id="astructret__t_html_ab8c7a6e941f1b6e41c095d1efbfab387"><div class="ttname"><a href="structret__t.html#ab8c7a6e941f1b6e41c095d1efbfab387">ret_t::err_press_ch</a></div><div class="ttdeci">double err_press_ch</div><div class="ttdoc">Horizontal correlation length for pressure error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01359">jurassic.h:1359</a></div></div>
<div class="ttc" id="astructret__t_html_ac7074498033f17991268df8300b6553a"><div class="ttname"><a href="structret__t.html#ac7074498033f17991268df8300b6553a">ret_t::err_q_ch</a></div><div class="ttdeci">double err_q_ch[NG]</div><div class="ttdoc">Horizontal correlation length for volume mixing ratio error [km].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01377">jurassic.h:1377</a></div></div>
<div class="ttc" id="astructret__t_html_ad7a4d797ec29d85e0f9e4b6a0c153acb"><div class="ttname"><a href="structret__t.html#ad7a4d797ec29d85e0f9e4b6a0c153acb">ret_t::err_q</a></div><div class="ttdeci">double err_q[NG]</div><div class="ttdoc">Volume mixing ratio error [%].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01371">jurassic.h:1371</a></div></div>
<div class="ttc" id="astructret__t_html_ae0ad7d1672eb774dab0f12cdccfa8b2f"><div class="ttname"><a href="structret__t.html#ae0ad7d1672eb774dab0f12cdccfa8b2f">ret_t::err_sfeps</a></div><div class="ttdeci">double err_sfeps[NSF]</div><div class="ttdoc">Surface emissivity error.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01401">jurassic.h:1401</a></div></div>
<div class="ttc" id="astructret__t_html_af4eb3f8fad1ee4d4bd4ff4176ad3575f"><div class="ttname"><a href="structret__t.html#af4eb3f8fad1ee4d4bd4ff4176ad3575f">ret_t::err_k</a></div><div class="ttdeci">double err_k[NW]</div><div class="ttdoc">Extinction error [km^-1].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01380">jurassic.h:1380</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_aba21310ce74a394f3faad06002e14d46_cgraph.png" border="0" usemap="#ajurassic_8h_aba21310ce74a394f3faad06002e14d46_cgraph" alt=""/></div>
<map name="ajurassic_8h_aba21310ce74a394f3faad06002e14d46_cgraph" id="ajurassic_8h_aba21310ce74a394f3faad06002e14d46_cgraph">
<area shape="rect" title="Read retrieval configuration and error parameters." alt="" coords="5,5,75,32"/>
<area shape="rect" href="jurassic_8c.html#abb6ce9b0361afe11cb23b8ac1e0c7fa3" title="Scan control file or command&#45;line arguments for a configuration variable." alt="" coords="123,5,193,32"/>
</map>
</div>

</div>
</div>
<a id="a19d63e07e3eb8166cbf65ce079e4d156" name="a19d63e07e3eb8166cbf65ce079e4d156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19d63e07e3eb8166cbf65ce079e4d156">&#9670;&nbsp;</a></span>read_rfm_spec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_rfm_spec </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>npts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a Reference Forward Model (RFM) ASCII spectrum. </p>
<p >Parses an RFM output file containing high-resolution spectral radiances and fills the provided arrays with wavenumber and radiance values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Name of the RFM ASCII spectrum file (e.g. "rad_04500.asc"). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nu</td><td>Array to receive the spectral wavenumber grid [cm]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rad</td><td>Array to receive the corresponding radiances. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">npts</td><td>Pointer to integer receiving the number of spectral points.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Expects the RFM file to begin with a four-line header. The final header line must contain, in order:<ul>
<li>the number of spectral points (<code>npts</code>),</li>
<li>starting wavenumber <code>nu0</code> [cm],</li>
<li>spectral increment <code>dnu</code> [cm],</li>
<li>ending wavenumber <code>nu1</code> [cm].</li>
</ul>
</li>
<li>Radiance data follow as a sequence of floating-point values, separated by spaces, tabs, or line breaks.</li>
<li>The wavenumber grid is reconstructed using linear interpolation between <code>nu0</code> and <code>nu1</code>: <p class="formulaDsp">
\[
      \nu_i = \nu_0 + i \, \frac{\nu_1 - \nu_0}{N - 1}, \quad i = 0,\dots,N-1
  \]
</p>
</li>
<li>Uses dynamic line buffering and token-based parsing for efficiency.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a134dbd60b73c18eda7032e58284dbade" title="Read and spectrally convolve an RFM output spectrum.">read_obs_rfm</a>, <a class="el" href="jurassic_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid.">locate_irr</a>, <a class="el" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83" title="Compute linear interpolation.">LIN</a>, <a class="el" href="jurassic_8h.html#a2caf20484e8e2f52ff3650321b7c704c" title="Interface routine for the Reference Forward Model (RFM).">formod_rfm</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Aborts if the file cannot be opened or has an invalid header format.</li>
<li>Aborts if the number of grid points exceeds <code>RFMNPTS</code>.</li>
<li>Assumes ASCII format consistent with standard RFM <code>.asc</code> output.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This routine reads only the spectral intensity data  additional metadata (e.g., gas profiles, geometry) must be handled separately.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05784">5784</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5788</span>             {</div>
<div class="line"><span class="lineno"> 5789</span> </div>
<div class="line"><span class="lineno"> 5790</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 5791</span> </div>
<div class="line"><span class="lineno"> 5792</span>  <span class="keywordtype">char</span> *line = NULL, *tok;</div>
<div class="line"><span class="lineno"> 5793</span> </div>
<div class="line"><span class="lineno"> 5794</span>  <span class="keywordtype">size_t</span> line_buf_size = 0;</div>
<div class="line"><span class="lineno"> 5795</span> </div>
<div class="line"><span class="lineno"> 5796</span>  <span class="keywordtype">double</span> dnu, nu0, nu1;</div>
<div class="line"><span class="lineno"> 5797</span> </div>
<div class="line"><span class="lineno"> 5798</span>  <span class="keywordtype">int</span> ipts = 0;</div>
<div class="line"><span class="lineno"> 5799</span> </div>
<div class="line"><span class="lineno"> 5800</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5801</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read RFM data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 5802</span> </div>
<div class="line"><span class="lineno"> 5803</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 5804</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 5805</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5806</span> </div>
<div class="line"><span class="lineno"> 5807</span>  <span class="comment">/* Read header... */</span></div>
<div class="line"><span class="lineno"> 5808</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line"><span class="lineno"> 5809</span>    <span class="keywordflow">if</span> (getline(&amp;line, &amp;line_buf_size, in) == -1)</div>
<div class="line"><span class="lineno"> 5810</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error while reading file header!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5811</span>  <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%d %lg %lg %lg&quot;</span>, npts, &amp;nu0, &amp;dnu, &amp;nu1) != 4)</div>
<div class="line"><span class="lineno"> 5812</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Invalid spectrum header format!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5813</span> </div>
<div class="line"><span class="lineno"> 5814</span>  <span class="comment">/* Check number of spectral grid points... */</span></div>
<div class="line"><span class="lineno"> 5815</span>  <span class="keywordflow">if</span> (*npts &gt; <a class="code hl_define" href="jurassic_8h.html#a4afe3221b6cc7d990b27a05a924ee2a2">RFMNPTS</a>)</div>
<div class="line"><span class="lineno"> 5816</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many spectral grid points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5817</span> </div>
<div class="line"><span class="lineno"> 5818</span>  <span class="comment">/* Read radiance data... */</span></div>
<div class="line"><span class="lineno"> 5819</span>  <span class="keywordflow">while</span> (getline(&amp;line, &amp;line_buf_size, in) != -1 &amp;&amp; ipts &lt; *npts) {</div>
<div class="line"><span class="lineno"> 5820</span>    tok = strtok(line, <span class="stringliteral">&quot; \t\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 5821</span>    <span class="keywordflow">while</span> (tok != NULL &amp;&amp; ipts &lt; *npts) {</div>
<div class="line"><span class="lineno"> 5822</span>      <span class="keywordflow">if</span> (sscanf(tok, <span class="stringliteral">&quot;%lg&quot;</span>, &amp;rad[ipts]) == 1)</div>
<div class="line"><span class="lineno"> 5823</span>        ipts++;</div>
<div class="line"><span class="lineno"> 5824</span>      tok = strtok(NULL, <span class="stringliteral">&quot; \t\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 5825</span>    }</div>
<div class="line"><span class="lineno"> 5826</span>  }</div>
<div class="line"><span class="lineno"> 5827</span> </div>
<div class="line"><span class="lineno"> 5828</span>  <span class="comment">/* Check number of spectral grid points... */</span></div>
<div class="line"><span class="lineno"> 5829</span>  <span class="keywordflow">if</span> (ipts != *npts)</div>
<div class="line"><span class="lineno"> 5830</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error while reading RFM data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5831</span> </div>
<div class="line"><span class="lineno"> 5832</span>  <span class="comment">/* Compute wavenumbers... */</span></div>
<div class="line"><span class="lineno"> 5833</span>  <span class="keywordflow">for</span> (ipts = 0; ipts &lt; *npts; ipts++)</div>
<div class="line"><span class="lineno"> 5834</span>    nu[ipts] = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(0.0, nu0, (<span class="keywordtype">double</span>) (*npts - 1), nu1, (<span class="keywordtype">double</span>) ipts);</div>
<div class="line"><span class="lineno"> 5835</span> </div>
<div class="line"><span class="lineno"> 5836</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 5837</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 5838</span> </div>
<div class="line"><span class="lineno"> 5839</span>  <span class="comment">/* Free.. */</span></div>
<div class="line"><span class="lineno"> 5840</span>  free(line);</div>
<div class="line"><span class="lineno"> 5841</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6dc7f479ca53ad9866d0e1df8f5ffcd" name="ad6dc7f479ca53ad9866d0e1df8f5ffcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6dc7f479ca53ad9866d0e1df8f5ffcd">&#9670;&nbsp;</a></span>read_shape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_shape </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a two-column shape function from an ASCII file. </p>
<p >Loads tabulated xy data pairs (e.g., filter transmission or field-of-view weighting function) into the provided arrays.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Name of the ASCII file containing the shape function. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>Array to receive the abscissa values. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">y</td><td>Array to receive the ordinate values. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">n</td><td>Pointer to integer receiving the number of data points read.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The input file must contain at least two whitespace-separated columns:<ul>
<li>Column 1: abscissa (<code>x</code>), typically wavenumber [cm] or angular offset [deg].</li>
<li>Column 2: ordinate (<code>y</code>), typically transmission or weighting value.</li>
</ul>
</li>
<li>Comment lines or malformed entries are ignored.</li>
<li>The routine logs the number of data points and their value ranges.</li>
<li>Data are stored directly in the provided arrays for subsequent interpolation or convolution.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>gsl_stats_minmax, <a class="el" href="jurassic_8h.html#ab0c3109373d1d5edcf57840c288f6f53" title="Apply field-of-view (FOV) convolution to modeled radiances.">formod_fov</a>, <a class="el" href="jurassic_8h.html#ab6852ec1675d0539a21df1fc4ecee1f0" title="Initialize the source-function (Planck radiance) lookup table.">init_srcfunc</a>, <a class="el" href="jurassic_8h.html#a134dbd60b73c18eda7032e58284dbade" title="Read and spectrally convolve an RFM output spectrum.">read_obs_rfm</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Aborts if the file cannot be opened or if fewer than two valid points are read.</li>
<li>Aborts if the number of data points exceeds <code>NSHAPE</code>.</li>
<li>Assumes numeric ASCII format and monotonic ordering of <code>x</code> values.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This generic shape reader is used for both spectral filter functions and angular field-of-view profiles.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05845">5845</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5849</span>          {</div>
<div class="line"><span class="lineno"> 5850</span> </div>
<div class="line"><span class="lineno"> 5851</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 5852</span> </div>
<div class="line"><span class="lineno"> 5853</span>  <span class="keywordtype">char</span> line[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 5854</span> </div>
<div class="line"><span class="lineno"> 5855</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5856</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read shape function: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 5857</span> </div>
<div class="line"><span class="lineno"> 5858</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 5859</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 5860</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5861</span> </div>
<div class="line"><span class="lineno"> 5862</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 5863</span>  *n = 0;</div>
<div class="line"><span class="lineno"> 5864</span>  <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in))</div>
<div class="line"><span class="lineno"> 5865</span>    <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%lg %lg&quot;</span>, &amp;x[*n], &amp;y[*n]) == 2)</div>
<div class="line"><span class="lineno"> 5866</span>      <span class="keywordflow">if</span> ((++(*n)) &gt; <a class="code hl_define" href="jurassic_8h.html#a7705bd290b81177c733651a18441be93">NSHAPE</a>)</div>
<div class="line"><span class="lineno"> 5867</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many data points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5868</span> </div>
<div class="line"><span class="lineno"> 5869</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 5870</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 5871</span> </div>
<div class="line"><span class="lineno"> 5872</span>  <span class="comment">/* Check number of data points... */</span></div>
<div class="line"><span class="lineno"> 5873</span>  <span class="keywordflow">if</span> (*n &lt; 2)</div>
<div class="line"><span class="lineno"> 5874</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Could not read any data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5875</span> </div>
<div class="line"><span class="lineno"> 5876</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5877</span>  <span class="keywordtype">double</span> mini, maxi;</div>
<div class="line"><span class="lineno"> 5878</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of data points: %d&quot;</span>, *n);</div>
<div class="line"><span class="lineno"> 5879</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, x, 1, (<span class="keywordtype">size_t</span>) *n);</div>
<div class="line"><span class="lineno"> 5880</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Range of x values: %.4f ... %.4f&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5881</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, y, 1, (<span class="keywordtype">size_t</span>) *n);</div>
<div class="line"><span class="lineno"> 5882</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Range of y values: %g ... %g&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5883</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="accf7b334232cd5dbb8b2b58b0e81f39a" name="accf7b334232cd5dbb8b2b58b0e81f39a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accf7b334232cd5dbb8b2b58b0e81f39a">&#9670;&nbsp;</a></span>read_tbl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtbl__t.html">tbl_t</a> * read_tbl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read all emissivity lookup tables for all gases and frequencies. </p>
<p >This function allocates a new <code><a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a></code> structure and fills it by reading emissivity lookup tables for each trace gas (<code>ig</code>) and each frequency index (<code>id</code>) specified in the control structure. The lookup tables may be read from ASCII, binary, or per-gas table files depending on <code>ctl-&gt;tblfmt</code>.</p>
<p >After loading all tables, the source function is initialized with <code><a class="el" href="jurassic_8h.html#ab6852ec1675d0539a21df1fc4ecee1f0" title="Initialize the source-function (Planck radiance) lookup table.">init_srcfunc()</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to control structure containing table metadata, number of gases, number of frequencies, filenames, etc.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to a newly allocated <code><a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a></code> structure containing all loaded lookup-table data. The caller owns the returned pointer and must free it when done.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Aborts the program via <code><a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG()</a></code> if unexpected table formats or dimension overflows occur.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05887">5887</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5888</span>                    {</div>
<div class="line"><span class="lineno"> 5889</span> </div>
<div class="line"><span class="lineno"> 5890</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 5891</span>  <a class="code hl_struct" href="structtbl__t.html">tbl_t</a> *tbl;</div>
<div class="line"><span class="lineno"> 5892</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(tbl, <a class="code hl_struct" href="structtbl__t.html">tbl_t</a>, 1);</div>
<div class="line"><span class="lineno"> 5893</span> </div>
<div class="line"><span class="lineno"> 5894</span>  <span class="comment">/* Loop over trace gases and channels... */</span></div>
<div class="line"><span class="lineno"> 5895</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 5896</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 5897</span> </div>
<div class="line"><span class="lineno"> 5898</span>      <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 5899</span>      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig] = -1;</div>
<div class="line"><span class="lineno"> 5900</span> </div>
<div class="line"><span class="lineno"> 5901</span>      <span class="comment">/* Read ASCII look-up tables... */</span></div>
<div class="line"><span class="lineno"> 5902</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae9e580318eb04b3963daaa98a9651129">tblfmt</a> == 1)</div>
<div class="line"><span class="lineno"> 5903</span>        <a class="code hl_function" href="jurassic_8c.html#ac437f3db65946abc16a2e6776f2d9ce6">read_tbl_asc</a>(ctl, tbl, <span class="keywordtype">id</span>, ig);</div>
<div class="line"><span class="lineno"> 5904</span> </div>
<div class="line"><span class="lineno"> 5905</span>      <span class="comment">/* Read binary look-up tables... */</span></div>
<div class="line"><span class="lineno"> 5906</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae9e580318eb04b3963daaa98a9651129">tblfmt</a> == 2)</div>
<div class="line"><span class="lineno"> 5907</span>        <a class="code hl_function" href="jurassic_8c.html#a059d22792e64add177ebc6f8ea0a90ed">read_tbl_bin</a>(ctl, tbl, <span class="keywordtype">id</span>, ig);</div>
<div class="line"><span class="lineno"> 5908</span> </div>
<div class="line"><span class="lineno"> 5909</span>      <span class="comment">/* Read per-gas look-up tables... */</span></div>
<div class="line"><span class="lineno"> 5910</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae9e580318eb04b3963daaa98a9651129">tblfmt</a> == 3)</div>
<div class="line"><span class="lineno"> 5911</span>        <a class="code hl_function" href="jurassic_8c.html#a8270286cb1940c8001c373d0dd70442b">read_tbl_gas</a>(ctl, tbl, <span class="keywordtype">id</span>, ig);</div>
<div class="line"><span class="lineno"> 5912</span> </div>
<div class="line"><span class="lineno"> 5913</span>      <span class="comment">/* Error message... */</span></div>
<div class="line"><span class="lineno"> 5914</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5915</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Unknown look-up table format!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5916</span> </div>
<div class="line"><span class="lineno"> 5917</span>      <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5918</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]; ip++)</div>
<div class="line"><span class="lineno"> 5919</span>        <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2,</div>
<div class="line"><span class="lineno"> 5920</span>            <span class="stringliteral">&quot;p[%2d]= %.5e hPa | T[0:%2d]= %.2f ... %.2f K | u[0:%3d]= %.5e ... %.5e molec/cm^2 | eps[0:%3d]= %.5e ... %.5e&quot;</span>,</div>
<div class="line"><span class="lineno"> 5921</span>            ip, tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig][ip], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip] - 1,</div>
<div class="line"><span class="lineno"> 5922</span>            tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ip][0],</div>
<div class="line"><span class="lineno"> 5923</span>            tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ip][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip] - 1],</div>
<div class="line"><span class="lineno"> 5924</span>            tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][0] - 1, tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[<span class="keywordtype">id</span>][ig][ip][0][0],</div>
<div class="line"><span class="lineno"> 5925</span>            tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[<span class="keywordtype">id</span>][ig][ip][0][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][0] - 1],</div>
<div class="line"><span class="lineno"> 5926</span>            tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][0] - 1, tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[<span class="keywordtype">id</span>][ig][ip][0][0],</div>
<div class="line"><span class="lineno"> 5927</span>            tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[<span class="keywordtype">id</span>][ig][ip][0][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][0] - 1]);</div>
<div class="line"><span class="lineno"> 5928</span>    }</div>
<div class="line"><span class="lineno"> 5929</span> </div>
<div class="line"><span class="lineno"> 5930</span>  <span class="comment">/* Initialize source function... */</span></div>
<div class="line"><span class="lineno"> 5931</span>  <a class="code hl_function" href="jurassic_8c.html#ab6852ec1675d0539a21df1fc4ecee1f0">init_srcfunc</a>(ctl, tbl);</div>
<div class="line"><span class="lineno"> 5932</span> </div>
<div class="line"><span class="lineno"> 5933</span>  <span class="comment">/* Return pointer... */</span></div>
<div class="line"><span class="lineno"> 5934</span>  <span class="keywordflow">return</span> tbl;</div>
<div class="line"><span class="lineno"> 5935</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a059d22792e64add177ebc6f8ea0a90ed"><div class="ttname"><a href="jurassic_8c.html#a059d22792e64add177ebc6f8ea0a90ed">read_tbl_bin</a></div><div class="ttdeci">void read_tbl_bin(const ctl_t *ctl, tbl_t *tbl, const int id, const int ig)</div><div class="ttdoc">Read a single binary emissivity lookup table.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06037">jurassic.c:6037</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a8270286cb1940c8001c373d0dd70442b"><div class="ttname"><a href="jurassic_8c.html#a8270286cb1940c8001c373d0dd70442b">read_tbl_gas</a></div><div class="ttdeci">void read_tbl_gas(const ctl_t *ctl, tbl_t *tbl, const int id, const int ig)</div><div class="ttdoc">Read one frequency block from a per-gas binary table file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06097">jurassic.c:6097</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ab6852ec1675d0539a21df1fc4ecee1f0"><div class="ttname"><a href="jurassic_8c.html#ab6852ec1675d0539a21df1fc4ecee1f0">init_srcfunc</a></div><div class="ttdeci">void init_srcfunc(const ctl_t *ctl, tbl_t *tbl)</div><div class="ttdoc">Initialize the source-function (Planck radiance) lookup table.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03972">jurassic.c:3972</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ac437f3db65946abc16a2e6776f2d9ce6"><div class="ttname"><a href="jurassic_8c.html#ac437f3db65946abc16a2e6776f2d9ce6">read_tbl_asc</a></div><div class="ttdeci">void read_tbl_asc(const ctl_t *ctl, tbl_t *tbl, const int id, const int ig)</div><div class="ttdoc">Read a single ASCII emissivity lookup table.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l05939">jurassic.c:5939</a></div></div>
<div class="ttc" id="astructtbl__t_html"><div class="ttname"><a href="structtbl__t.html">tbl_t</a></div><div class="ttdoc">Emissivity look-up tables.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01411">jurassic.h:1411</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_accf7b334232cd5dbb8b2b58b0e81f39a_cgraph.png" border="0" usemap="#ajurassic_8h_accf7b334232cd5dbb8b2b58b0e81f39a_cgraph" alt=""/></div>
<map name="ajurassic_8h_accf7b334232cd5dbb8b2b58b0e81f39a_cgraph" id="ajurassic_8h_accf7b334232cd5dbb8b2b58b0e81f39a_cgraph">
<area shape="rect" title="Read all emissivity lookup tables for all gases and frequencies." alt="" coords="5,107,73,133"/>
<area shape="rect" href="jurassic_8c.html#ab6852ec1675d0539a21df1fc4ecee1f0" title="Initialize the source&#45;function (Planck radiance) lookup table." alt="" coords="125,31,214,57"/>
<area shape="rect" href="jurassic_8c.html#ac437f3db65946abc16a2e6776f2d9ce6" title="Read a single ASCII emissivity lookup table." alt="" coords="121,81,217,108"/>
<area shape="rect" href="jurassic_8c.html#a059d22792e64add177ebc6f8ea0a90ed" title="Read a single binary emissivity lookup table." alt="" coords="123,132,215,159"/>
<area shape="rect" href="jurassic_8c.html#a8270286cb1940c8001c373d0dd70442b" title="Read one frequency block from a per&#45;gas binary table file." alt="" coords="121,183,217,209"/>
<area shape="rect" href="jurassic_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate index for interpolation on an irregular grid." alt="" coords="297,5,371,32"/>
<area shape="rect" href="jurassic_8c.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two&#45;column shape function from an ASCII file." alt="" coords="289,56,379,83"/>
<area shape="rect" href="jurassic_8c.html#adad0096f4559d524126d7b849cee0fb7" title="Close a per&#45;gas binary table file and optionally rewrite metadata." alt="" coords="267,132,401,159"/>
<area shape="rect" href="jurassic_8c.html#ae21efb7a5b4d98c52355ee78cd4d0df5" title="Open a per&#45;gas binary table file for reading and writing." alt="" coords="269,183,399,209"/>
<area shape="rect" href="jurassic_8c.html#a3441d713489f5900d4d98235a9973653" title="Read one emissivity table block from a per&#45;gas table file." alt="" coords="265,233,403,260"/>
</map>
</div>

</div>
</div>
<a id="ac437f3db65946abc16a2e6776f2d9ce6" name="ac437f3db65946abc16a2e6776f2d9ce6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac437f3db65946abc16a2e6776f2d9ce6">&#9670;&nbsp;</a></span>read_tbl_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_tbl_asc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a single ASCII emissivity lookup table. </p>
<p >This reads one ASCII table corresponding to frequency index <code>id</code> and gas index <code>ig</code>. The table format is: </p><pre class="fragment">pressure   temperature   column_density   emissivity
</pre><p> The function automatically determines the pressure, temperature, and column-density indices based on new values appearing in the file.</p>
<p >Out-of-range values for <code>u</code> or <code>eps</code> are skipped and counted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to control structure specifying filenames and grids. </td></tr>
    <tr><td class="paramname">tbl</td><td>Pointer to the table structure to be filled. </td></tr>
    <tr><td class="paramname">id</td><td>Frequency index. </td></tr>
    <tr><td class="paramname">ig</td><td>Gas index.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Aborts via <code><a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG()</a></code> if table dimensions exceed TBLNP/TBLNT/TBLNU.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l05939">5939</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5943</span>                {</div>
<div class="line"><span class="lineno"> 5944</span> </div>
<div class="line"><span class="lineno"> 5945</span>  <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 5946</span>  <span class="keywordtype">double</span> eps, eps_old = -999, press, press_old = -999, temp, temp_old =</div>
<div class="line"><span class="lineno"> 5947</span>    -999, u, u_old = -999;</div>
<div class="line"><span class="lineno"> 5948</span>  <span class="keywordtype">int</span> nrange = 0;</div>
<div class="line"><span class="lineno"> 5949</span> </div>
<div class="line"><span class="lineno"> 5950</span>  <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 5951</span>  <span class="keywordtype">char</span> filename[2 * <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 5952</span>  sprintf(filename, <span class="stringliteral">&quot;%s_%.4f_%s.tab&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">tblbase</a>,</div>
<div class="line"><span class="lineno"> 5953</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 5954</span> </div>
<div class="line"><span class="lineno"> 5955</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5956</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read emissivity table: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 5957</span> </div>
<div class="line"><span class="lineno"> 5958</span>  <span class="comment">/* Try to open file... */</span></div>
<div class="line"><span class="lineno"> 5959</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 5960</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>))) {</div>
<div class="line"><span class="lineno"> 5961</span>    <a class="code hl_define" href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Missing emissivity table: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 5962</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 5963</span>  }</div>
<div class="line"><span class="lineno"> 5964</span> </div>
<div class="line"><span class="lineno"> 5965</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 5966</span>  <span class="keywordtype">char</span> line[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 5967</span>  <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in)) {</div>
<div class="line"><span class="lineno"> 5968</span> </div>
<div class="line"><span class="lineno"> 5969</span>    <span class="comment">/* Parse line... */</span></div>
<div class="line"><span class="lineno"> 5970</span>    <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%lg %lg %lg %lg&quot;</span>, &amp;press, &amp;temp, &amp;u, &amp;eps) != 4)</div>
<div class="line"><span class="lineno"> 5971</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 5972</span> </div>
<div class="line"><span class="lineno"> 5973</span>    <span class="comment">/* Check ranges... */</span></div>
<div class="line"><span class="lineno"> 5974</span>    <span class="keywordflow">if</span> (u &lt; UMIN || u &gt; <a class="code hl_define" href="jurassic_8h.html#a3376075b6c1085b71a316b5c03838992">UMAX</a> || eps &lt; EPSMIN || eps &gt; <a class="code hl_define" href="jurassic_8h.html#ac90736a71d789b9bf5cd070c8a700358">EPSMAX</a>) {</div>
<div class="line"><span class="lineno"> 5975</span>      nrange++;</div>
<div class="line"><span class="lineno"> 5976</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 5977</span>    }</div>
<div class="line"><span class="lineno"> 5978</span> </div>
<div class="line"><span class="lineno"> 5979</span>    <span class="comment">/* Determine pressure index... */</span></div>
<div class="line"><span class="lineno"> 5980</span>    <span class="keywordflow">if</span> (press != press_old) {</div>
<div class="line"><span class="lineno"> 5981</span>      press_old = press;</div>
<div class="line"><span class="lineno"> 5982</span>      <span class="keywordflow">if</span> ((++tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig]) &gt;= <a class="code hl_define" href="jurassic_8h.html#ae24fde0b49cc53934d13a7ab3f95a4ef">TBLNP</a>)</div>
<div class="line"><span class="lineno"> 5983</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many pressure levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5984</span>      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]] = -1;</div>
<div class="line"><span class="lineno"> 5985</span>    }</div>
<div class="line"><span class="lineno"> 5986</span> </div>
<div class="line"><span class="lineno"> 5987</span>    <span class="comment">/* Determine temperature index... */</span></div>
<div class="line"><span class="lineno"> 5988</span>    <span class="keywordflow">if</span> (temp != temp_old) {</div>
<div class="line"><span class="lineno"> 5989</span>      temp_old = temp;</div>
<div class="line"><span class="lineno"> 5990</span>      <span class="keywordflow">if</span> ((++tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig]]) &gt;= <a class="code hl_define" href="jurassic_8h.html#aad9835e9e4be4ad8ed538f95bdceddea">TBLNT</a>)</div>
<div class="line"><span class="lineno"> 5991</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many temperatures!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5992</span>      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]]</div>
<div class="line"><span class="lineno"> 5993</span>        [tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]]] = -1;</div>
<div class="line"><span class="lineno"> 5994</span>    }</div>
<div class="line"><span class="lineno"> 5995</span> </div>
<div class="line"><span class="lineno"> 5996</span>    <span class="comment">/* Determine column density index... */</span></div>
<div class="line"><span class="lineno"> 5997</span>    <span class="keywordflow">if</span> ((eps &gt; eps_old &amp;&amp; u &gt; u_old) || tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig]]</div>
<div class="line"><span class="lineno"> 5998</span>        [tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig]]] &lt; 0) {</div>
<div class="line"><span class="lineno"> 5999</span>      eps_old = eps;</div>
<div class="line"><span class="lineno"> 6000</span>      u_old = u;</div>
<div class="line"><span class="lineno"> 6001</span>      <span class="keywordflow">if</span> ((++tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig]]</div>
<div class="line"><span class="lineno"> 6002</span>           [tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig]]]) &gt;= <a class="code hl_define" href="jurassic_8h.html#a910036a8c83f3464c3de6bf398467c03">TBLNU</a>)</div>
<div class="line"><span class="lineno"> 6003</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many column densities!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6004</span>    }</div>
<div class="line"><span class="lineno"> 6005</span> </div>
<div class="line"><span class="lineno"> 6006</span>    <span class="comment">/* Store data... */</span></div>
<div class="line"><span class="lineno"> 6007</span>    tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]] = press;</div>
<div class="line"><span class="lineno"> 6008</span>    tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]]]</div>
<div class="line"><span class="lineno"> 6009</span>      = temp;</div>
<div class="line"><span class="lineno"> 6010</span>    tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]]]</div>
<div class="line"><span class="lineno"> 6011</span>      [tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]]</div>
<div class="line"><span class="lineno"> 6012</span>       [tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]]]] = (float) u;</div>
<div class="line"><span class="lineno"> 6013</span>    tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]]]</div>
<div class="line"><span class="lineno"> 6014</span>      [tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]]</div>
<div class="line"><span class="lineno"> 6015</span>       [tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]]]] = (float) eps;</div>
<div class="line"><span class="lineno"> 6016</span>  }</div>
<div class="line"><span class="lineno"> 6017</span> </div>
<div class="line"><span class="lineno"> 6018</span>  <span class="comment">/* Increment counters... */</span></div>
<div class="line"><span class="lineno"> 6019</span>  tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]++;</div>
<div class="line"><span class="lineno"> 6020</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]; ip++) {</div>
<div class="line"><span class="lineno"> 6021</span>    tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][ip]++;</div>
<div class="line"><span class="lineno"> 6022</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 0; it &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][ip]; it++)</div>
<div class="line"><span class="lineno"> 6023</span>      tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it]++;</div>
<div class="line"><span class="lineno"> 6024</span>  }</div>
<div class="line"><span class="lineno"> 6025</span> </div>
<div class="line"><span class="lineno"> 6026</span>  <span class="comment">/* Check ranges... */</span></div>
<div class="line"><span class="lineno"> 6027</span>  <span class="keywordflow">if</span> (nrange &gt; 0)</div>
<div class="line"><span class="lineno"> 6028</span>    <a class="code hl_define" href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Column density or emissivity out of range (%d data points)!&quot;</span>,</div>
<div class="line"><span class="lineno"> 6029</span>         nrange);</div>
<div class="line"><span class="lineno"> 6030</span> </div>
<div class="line"><span class="lineno"> 6031</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 6032</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 6033</span>}</div>
<div class="ttc" id="ajurassic_8h_html_a3376075b6c1085b71a316b5c03838992"><div class="ttname"><a href="jurassic_8h.html#a3376075b6c1085b71a316b5c03838992">UMAX</a></div><div class="ttdeci">#define UMAX</div><div class="ttdoc">Maximum column density [molecules/cm^2].</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00223">jurassic.h:223</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a910036a8c83f3464c3de6bf398467c03"><div class="ttname"><a href="jurassic_8h.html#a910036a8c83f3464c3de6bf398467c03">TBLNU</a></div><div class="ttdeci">#define TBLNU</div><div class="ttdoc">Maximum number of column densities in emissivity tables.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00312">jurassic.h:312</a></div></div>
<div class="ttc" id="ajurassic_8h_html_aad9835e9e4be4ad8ed538f95bdceddea"><div class="ttname"><a href="jurassic_8h.html#aad9835e9e4be4ad8ed538f95bdceddea">TBLNT</a></div><div class="ttdeci">#define TBLNT</div><div class="ttdoc">Maximum number of temperatures in emissivity tables.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00307">jurassic.h:307</a></div></div>
<div class="ttc" id="ajurassic_8h_html_ac90736a71d789b9bf5cd070c8a700358"><div class="ttname"><a href="jurassic_8h.html#ac90736a71d789b9bf5cd070c8a700358">EPSMAX</a></div><div class="ttdeci">#define EPSMAX</div><div class="ttdoc">Maximum emissivity.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00143">jurassic.h:143</a></div></div>
<div class="ttc" id="ajurassic_8h_html_ae24fde0b49cc53934d13a7ab3f95a4ef"><div class="ttname"><a href="jurassic_8h.html#ae24fde0b49cc53934d13a7ab3f95a4ef">TBLNP</a></div><div class="ttdeci">#define TBLNP</div><div class="ttdoc">Maximum number of pressure levels in emissivity tables.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00302">jurassic.h:302</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a059d22792e64add177ebc6f8ea0a90ed" name="a059d22792e64add177ebc6f8ea0a90ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a059d22792e64add177ebc6f8ea0a90ed">&#9670;&nbsp;</a></span>read_tbl_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_tbl_bin </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a single binary emissivity lookup table. </p>
<p >Reads the binary table stored as:</p><ul>
<li>number of pressure levels</li>
<li>pressure grid</li>
<li>for each pressure:<ul>
<li>number of temperatures</li>
<li>temperature grid</li>
<li>for each temperature:<ul>
<li>number of column densities</li>
<li>u array</li>
<li>emissivity array</li>
</ul>
</li>
</ul>
</li>
</ul>
<p >The function fills the corresponding entries of the <code><a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a></code> structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to control structure specifying filenames and grids. </td></tr>
    <tr><td class="paramname">tbl</td><td>Pointer to the table structure to be filled. </td></tr>
    <tr><td class="paramname">id</td><td>Frequency index. </td></tr>
    <tr><td class="paramname">ig</td><td>Gas index.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Aborts via <code><a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG()</a></code> if table dimensions exceed TBLNP/TBLNT/TBLNU.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06037">6037</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6041</span>                {</div>
<div class="line"><span class="lineno"> 6042</span> </div>
<div class="line"><span class="lineno"> 6043</span>  <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 6044</span>  <span class="keywordtype">char</span> filename[2 * <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 6045</span>  sprintf(filename, <span class="stringliteral">&quot;%s_%.4f_%s.bin&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">tblbase</a>,</div>
<div class="line"><span class="lineno"> 6046</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 6047</span> </div>
<div class="line"><span class="lineno"> 6048</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6049</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read emissivity table: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6050</span> </div>
<div class="line"><span class="lineno"> 6051</span>  <span class="comment">/* Try to open file... */</span></div>
<div class="line"><span class="lineno"> 6052</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 6053</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>))) {</div>
<div class="line"><span class="lineno"> 6054</span>    <a class="code hl_define" href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Missing emissivity table: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6055</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 6056</span>  }</div>
<div class="line"><span class="lineno"> 6057</span> </div>
<div class="line"><span class="lineno"> 6058</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 6059</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6060</span>        1,</div>
<div class="line"><span class="lineno"> 6061</span>        in);</div>
<div class="line"><span class="lineno"> 6062</span>  <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig] &gt; <a class="code hl_define" href="jurassic_8h.html#ae24fde0b49cc53934d13a7ab3f95a4ef">TBLNP</a>)</div>
<div class="line"><span class="lineno"> 6063</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many pressure levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6064</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6065</span>          (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig],</div>
<div class="line"><span class="lineno"> 6066</span>        in);</div>
<div class="line"><span class="lineno"> 6067</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]; ip++) {</div>
<div class="line"><span class="lineno"> 6068</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6069</span>          1,</div>
<div class="line"><span class="lineno"> 6070</span>          in);</div>
<div class="line"><span class="lineno"> 6071</span>    <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip] &gt; <a class="code hl_define" href="jurassic_8h.html#aad9835e9e4be4ad8ed538f95bdceddea">TBLNT</a>)</div>
<div class="line"><span class="lineno"> 6072</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many temperatures!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6073</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ip], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6074</span>            (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip],</div>
<div class="line"><span class="lineno"> 6075</span>          in);</div>
<div class="line"><span class="lineno"> 6076</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 0; it &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][ip]; it++) {</div>
<div class="line"><span class="lineno"> 6077</span>      <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6078</span>            1,</div>
<div class="line"><span class="lineno"> 6079</span>            in);</div>
<div class="line"><span class="lineno"> 6080</span>      <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it] &gt; <a class="code hl_define" href="jurassic_8h.html#a910036a8c83f3464c3de6bf398467c03">TBLNU</a>)</div>
<div class="line"><span class="lineno"> 6081</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many column densities!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6082</span>      <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 6083</span>              (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it],</div>
<div class="line"><span class="lineno"> 6084</span>            in);</div>
<div class="line"><span class="lineno"> 6085</span>      <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 6086</span>              (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it],</div>
<div class="line"><span class="lineno"> 6087</span>            in);</div>
<div class="line"><span class="lineno"> 6088</span>    }</div>
<div class="line"><span class="lineno"> 6089</span>  }</div>
<div class="line"><span class="lineno"> 6090</span> </div>
<div class="line"><span class="lineno"> 6091</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 6092</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 6093</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8270286cb1940c8001c373d0dd70442b" name="a8270286cb1940c8001c373d0dd70442b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8270286cb1940c8001c373d0dd70442b">&#9670;&nbsp;</a></span>read_tbl_gas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_tbl_gas </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read one frequency block from a per-gas binary table file. </p>
<p >Opens the gas-specific table file (e.g., <code>base_emitter.tbl</code>) and reads the table block corresponding to frequency <code>ctl-&gt;nu[id]</code>. The block is appended to the in-memory <code><a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to control structure containing table metadata. </td></tr>
    <tr><td class="paramname">tbl</td><td>Pointer to table structure to populate. </td></tr>
    <tr><td class="paramname">id</td><td>Frequency index. </td></tr>
    <tr><td class="paramname">ig</td><td>Gas index.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Missing tables or missing frequency blocks only produce warnings.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06097">6097</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6101</span>                {</div>
<div class="line"><span class="lineno"> 6102</span> </div>
<div class="line"><span class="lineno"> 6103</span>  <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 6104</span>  <span class="keywordtype">char</span> filename[2 * <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 6105</span>  sprintf(filename, <span class="stringliteral">&quot;%s_%s.tbl&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">tblbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 6106</span> </div>
<div class="line"><span class="lineno"> 6107</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6108</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read emissivity table: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6109</span> </div>
<div class="line"><span class="lineno"> 6110</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 6111</span>  <a class="code hl_struct" href="structtbl__gas__t.html">tbl_gas_t</a> gas;</div>
<div class="line"><span class="lineno"> 6112</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="jurassic_8c.html#ae21efb7a5b4d98c52355ee78cd4d0df5">read_tbl_gas_open</a>(filename, &amp;gas) != 0) {</div>
<div class="line"><span class="lineno"> 6113</span>    <a class="code hl_define" href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Missing emissivity table: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6114</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 6115</span>  }</div>
<div class="line"><span class="lineno"> 6116</span> </div>
<div class="line"><span class="lineno"> 6117</span>  <span class="comment">/* Read table... */</span></div>
<div class="line"><span class="lineno"> 6118</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="jurassic_8c.html#a3441d713489f5900d4d98235a9973653">read_tbl_gas_single</a>(&amp;gas, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], tbl, <span class="keywordtype">id</span>, ig) != 0)</div>
<div class="line"><span class="lineno"> 6119</span>    <a class="code hl_define" href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Frequency %.6f missing in %s&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], filename);</div>
<div class="line"><span class="lineno"> 6120</span> </div>
<div class="line"><span class="lineno"> 6121</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 6122</span>  <a class="code hl_function" href="jurassic_8c.html#adad0096f4559d524126d7b849cee0fb7">read_tbl_gas_close</a>(&amp;gas);</div>
<div class="line"><span class="lineno"> 6123</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a3441d713489f5900d4d98235a9973653"><div class="ttname"><a href="jurassic_8c.html#a3441d713489f5900d4d98235a9973653">read_tbl_gas_single</a></div><div class="ttdeci">int read_tbl_gas_single(const tbl_gas_t *g, const double freq, tbl_t *tbl, const int id, const int ig)</div><div class="ttdoc">Read one emissivity table block from a per-gas table file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06189">jurassic.c:6189</a></div></div>
<div class="ttc" id="ajurassic_8c_html_adad0096f4559d524126d7b849cee0fb7"><div class="ttname"><a href="jurassic_8c.html#adad0096f4559d524126d7b849cee0fb7">read_tbl_gas_close</a></div><div class="ttdeci">int read_tbl_gas_close(tbl_gas_t *g)</div><div class="ttdoc">Close a per-gas binary table file and optionally rewrite metadata.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06127">jurassic.c:6127</a></div></div>
<div class="ttc" id="ajurassic_8c_html_ae21efb7a5b4d98c52355ee78cd4d0df5"><div class="ttname"><a href="jurassic_8c.html#ae21efb7a5b4d98c52355ee78cd4d0df5">read_tbl_gas_open</a></div><div class="ttdeci">int read_tbl_gas_open(const char *path, tbl_gas_t *g)</div><div class="ttdoc">Open a per-gas binary table file for reading and writing.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06160">jurassic.c:6160</a></div></div>
<div class="ttc" id="astructtbl__gas__t_html"><div class="ttname"><a href="structtbl__gas__t.html">tbl_gas_t</a></div><div class="ttdoc">In-memory representation of an open per-gas lookup-table file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01468">jurassic.h:1468</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a8270286cb1940c8001c373d0dd70442b_cgraph.png" border="0" usemap="#ajurassic_8h_a8270286cb1940c8001c373d0dd70442b_cgraph" alt=""/></div>
<map name="ajurassic_8h_a8270286cb1940c8001c373d0dd70442b_cgraph" id="ajurassic_8h_a8270286cb1940c8001c373d0dd70442b_cgraph">
<area shape="rect" title="Read one frequency block from a per&#45;gas binary table file." alt="" coords="5,56,101,83"/>
<area shape="rect" href="jurassic_8c.html#adad0096f4559d524126d7b849cee0fb7" title="Close a per&#45;gas binary table file and optionally rewrite metadata." alt="" coords="151,5,285,32"/>
<area shape="rect" href="jurassic_8c.html#ae21efb7a5b4d98c52355ee78cd4d0df5" title="Open a per&#45;gas binary table file for reading and writing." alt="" coords="153,56,283,83"/>
<area shape="rect" href="jurassic_8c.html#a3441d713489f5900d4d98235a9973653" title="Read one emissivity table block from a per&#45;gas table file." alt="" coords="149,107,287,133"/>
</map>
</div>

</div>
</div>
<a id="adad0096f4559d524126d7b849cee0fb7" name="adad0096f4559d524126d7b849cee0fb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adad0096f4559d524126d7b849cee0fb7">&#9670;&nbsp;</a></span>read_tbl_gas_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_tbl_gas_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtbl__gas__t.html">tbl_gas_t</a> *&#160;</td>
          <td class="paramname"><em>g</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close a per-gas binary table file and optionally rewrite metadata. </p>
<p >If the table was modified (<code>g-&gt;dirty != 0</code>), the header and index are rewritten before closing the file. After closing, memory associated with the table index is freed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">g</td><td>Pointer to an open gas-table handle.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on invalid handle.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06127">6127</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6128</span>                {</div>
<div class="line"><span class="lineno"> 6129</span> </div>
<div class="line"><span class="lineno"> 6130</span>  <span class="keywordflow">if</span> (!g || !g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>)</div>
<div class="line"><span class="lineno"> 6131</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 6132</span> </div>
<div class="line"><span class="lineno"> 6133</span>  <span class="keywordflow">if</span> (g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#aac7c1e9ad2362734fdab0720e8f8f7a7">dirty</a>) {</div>
<div class="line"><span class="lineno"> 6134</span> </div>
<div class="line"><span class="lineno"> 6135</span>    <span class="comment">/* Rewind to header... */</span></div>
<div class="line"><span class="lineno"> 6136</span>    fseek(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>, 0, SEEK_SET);</div>
<div class="line"><span class="lineno"> 6137</span> </div>
<div class="line"><span class="lineno"> 6138</span>    <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno"> 6139</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> magic[4] = { <span class="charliteral">&#39;G&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;L&#39;</span>, <span class="charliteral">&#39;1&#39;</span> };</div>
<div class="line"><span class="lineno"> 6140</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(magic, <span class="keywordtype">char</span>,</div>
<div class="line"><span class="lineno"> 6141</span>           4,</div>
<div class="line"><span class="lineno"> 6142</span>           g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6143</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#abd58d0435bed20bf327a61082b379f2c">ntables</a>, int32_t, 1, g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6144</span> </div>
<div class="line"><span class="lineno"> 6145</span>    <span class="comment">/* Write updated index... */</span></div>
<div class="line"><span class="lineno"> 6146</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>, <a class="code hl_struct" href="structtbl__gas__index__t.html">tbl_gas_index_t</a>, <a class="code hl_define" href="jurassic_8h.html#a6f4cdd0162e9f2ab251fa5b23410c8da">MAX_TABLES</a>, g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6147</span>    fflush(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6148</span>  }</div>
<div class="line"><span class="lineno"> 6149</span> </div>
<div class="line"><span class="lineno"> 6150</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 6151</span>  fclose(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6152</span>  free(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>);</div>
<div class="line"><span class="lineno"> 6153</span>  memset(g, 0, <span class="keyword">sizeof</span>(*g));</div>
<div class="line"><span class="lineno"> 6154</span> </div>
<div class="line"><span class="lineno"> 6155</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 6156</span>}</div>
<div class="ttc" id="ajurassic_8h_html_a1e67562ddd8fb52548a4ca02d3640bac"><div class="ttname"><a href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a></div><div class="ttdeci">#define FWRITE(ptr, type, size, out)</div><div class="ttdoc">Write binary data to a file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00525">jurassic.h:525</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a6f4cdd0162e9f2ab251fa5b23410c8da"><div class="ttname"><a href="jurassic_8h.html#a6f4cdd0162e9f2ab251fa5b23410c8da">MAX_TABLES</a></div><div class="ttdeci">#define MAX_TABLES</div><div class="ttdoc">Maximum number of frequency-table entries allowed in a gas table file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00322">jurassic.h:322</a></div></div>
<div class="ttc" id="astructtbl__gas__index__t_html"><div class="ttname"><a href="structtbl__gas__index__t.html">tbl_gas_index_t</a></div><div class="ttdoc">On-disk index entry describing one frequency table block in a gas file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01448">jurassic.h:1448</a></div></div>
<div class="ttc" id="astructtbl__gas__t_html_a77a2f96cfd1070640367c4b9f2c1bffd"><div class="ttname"><a href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">tbl_gas_t::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">Open file handle (&quot;rb+&quot;), NULL if not open.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01471">jurassic.h:1471</a></div></div>
<div class="ttc" id="astructtbl__gas__t_html_aac7c1e9ad2362734fdab0720e8f8f7a7"><div class="ttname"><a href="structtbl__gas__t.html#aac7c1e9ad2362734fdab0720e8f8f7a7">tbl_gas_t::dirty</a></div><div class="ttdeci">int dirty</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01480">jurassic.h:1480</a></div></div>
<div class="ttc" id="astructtbl__gas__t_html_abd58d0435bed20bf327a61082b379f2c"><div class="ttname"><a href="structtbl__gas__t.html#abd58d0435bed20bf327a61082b379f2c">tbl_gas_t::ntables</a></div><div class="ttdeci">int32_t ntables</div><div class="ttdoc">Number of index entries currently in use.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01474">jurassic.h:1474</a></div></div>
<div class="ttc" id="astructtbl__gas__t_html_afa705677b8b06479da2ed90e900cdb91"><div class="ttname"><a href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">tbl_gas_t::index</a></div><div class="ttdeci">tbl_gas_index_t * index</div><div class="ttdoc">In-memory index table of length MAX_TABLES.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01477">jurassic.h:1477</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae21efb7a5b4d98c52355ee78cd4d0df5" name="ae21efb7a5b4d98c52355ee78cd4d0df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae21efb7a5b4d98c52355ee78cd4d0df5">&#9670;&nbsp;</a></span>read_tbl_gas_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_tbl_gas_open </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtbl__gas__t.html">tbl_gas_t</a> *&#160;</td>
          <td class="paramname"><em>g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open a per-gas binary table file for reading and writing. </p>
<p >Reads and validates the file header, then loads the entire index of table blocks. The resulting <code><a class="el" href="structtbl__gas__t.html" title="In-memory representation of an open per-gas lookup-table file.">tbl_gas_t</a></code> structure tracks the file pointer, index, and table count.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>Path to the <code>.tbl</code> file. </td></tr>
    <tr><td class="paramname">g</td><td>Output parameter: populated table-file handle.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 if the file cannot be opened.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Aborts via <code><a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG()</a></code> on invalid magic or format.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06160">6160</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6162</span>                {</div>
<div class="line"><span class="lineno"> 6163</span> </div>
<div class="line"><span class="lineno"> 6164</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 6165</span>  memset(g, 0, <span class="keyword">sizeof</span>(*g));</div>
<div class="line"><span class="lineno"> 6166</span>  g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a> = fopen(path, <span class="stringliteral">&quot;rb+&quot;</span>);   <span class="comment">/* MUST be rb+ for writing later */</span></div>
<div class="line"><span class="lineno"> 6167</span>  <span class="keywordflow">if</span> (!g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>)</div>
<div class="line"><span class="lineno"> 6168</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 6169</span>  <span class="keywordtype">char</span> magic[4];</div>
<div class="line"><span class="lineno"> 6170</span> </div>
<div class="line"><span class="lineno"> 6171</span>  <span class="comment">/* Read header... */</span></div>
<div class="line"><span class="lineno"> 6172</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(magic, <span class="keywordtype">char</span>,</div>
<div class="line"><span class="lineno"> 6173</span>        4,</div>
<div class="line"><span class="lineno"> 6174</span>        g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6175</span>  <span class="keywordflow">if</span> (memcmp(magic, <span class="stringliteral">&quot;GTL1&quot;</span>, 4) != 0)</div>
<div class="line"><span class="lineno"> 6176</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Invalid gas-table file format!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6177</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#abd58d0435bed20bf327a61082b379f2c">ntables</a>, int32_t, 1, g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6178</span> </div>
<div class="line"><span class="lineno"> 6179</span>  <span class="comment">/* Read index... */</span></div>
<div class="line"><span class="lineno"> 6180</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>, <a class="code hl_struct" href="structtbl__gas__index__t.html">tbl_gas_index_t</a>, <a class="code hl_define" href="jurassic_8h.html#a6f4cdd0162e9f2ab251fa5b23410c8da">MAX_TABLES</a>);</div>
<div class="line"><span class="lineno"> 6181</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>, <a class="code hl_struct" href="structtbl__gas__index__t.html">tbl_gas_index_t</a>, <a class="code hl_define" href="jurassic_8h.html#a6f4cdd0162e9f2ab251fa5b23410c8da">MAX_TABLES</a>, g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6182</span>  g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#aac7c1e9ad2362734fdab0720e8f8f7a7">dirty</a> = 0;</div>
<div class="line"><span class="lineno"> 6183</span> </div>
<div class="line"><span class="lineno"> 6184</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 6185</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3441d713489f5900d4d98235a9973653" name="a3441d713489f5900d4d98235a9973653"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3441d713489f5900d4d98235a9973653">&#9670;&nbsp;</a></span>read_tbl_gas_single()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_tbl_gas_single </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtbl__gas__t.html">tbl_gas_t</a> *&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read one emissivity table block from a per-gas table file. </p>
<p >Locates the index entry corresponding to the requested frequency <code>freq</code>. If found, seeks to the stored offset and reads:</p>
<ul>
<li>number of pressure levels</li>
<li>pressure grid</li>
<li>for each pressure:<ul>
<li>number of temperatures</li>
<li>temperature grid</li>
<li>for each temperature:<ul>
<li>number of column densities</li>
<li>u array</li>
<li>emissivity array</li>
</ul>
</li>
</ul>
</li>
</ul>
<p >The data are stored into <code>tbl[id][ig]</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">g</td><td>Pointer to an open gas-table handle. </td></tr>
    <tr><td class="paramname">freq</td><td>Frequency to be read. </td></tr>
    <tr><td class="paramname">tbl</td><td>Pointer to output table structure. </td></tr>
    <tr><td class="paramname">id</td><td>Frequency index. </td></tr>
    <tr><td class="paramname">ig</td><td>Gas index.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 if the frequency is not found.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Aborts on dimension overflow or seek errors.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06189">6189</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6194</span>                {</div>
<div class="line"><span class="lineno"> 6195</span> </div>
<div class="line"><span class="lineno"> 6196</span>  <span class="comment">/* Find freq in index */</span></div>
<div class="line"><span class="lineno"> 6197</span>  <span class="keywordtype">int</span> idx = -1;</div>
<div class="line"><span class="lineno"> 6198</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#abd58d0435bed20bf327a61082b379f2c">ntables</a>; i++) {</div>
<div class="line"><span class="lineno"> 6199</span>    <span class="keywordflow">if</span> (g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>[i].<a class="code hl_variable" href="structtbl__gas__index__t.html#ae92df1b397eddf22dd991d6a9f5e4853">freq</a> == freq) {</div>
<div class="line"><span class="lineno"> 6200</span>      idx = i;</div>
<div class="line"><span class="lineno"> 6201</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6202</span>    }</div>
<div class="line"><span class="lineno"> 6203</span>  }</div>
<div class="line"><span class="lineno"> 6204</span>  <span class="keywordflow">if</span> (idx &lt; 0) {</div>
<div class="line"><span class="lineno"> 6205</span>    <a class="code hl_define" href="jurassic_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Frequency %.4f not found in gas table&quot;</span>, freq);</div>
<div class="line"><span class="lineno"> 6206</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 6207</span>  }</div>
<div class="line"><span class="lineno"> 6208</span> </div>
<div class="line"><span class="lineno"> 6209</span>  <span class="comment">/* Seek to table block... */</span></div>
<div class="line"><span class="lineno"> 6210</span>  <span class="keywordflow">if</span> (fseek(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>, (<span class="keywordtype">long</span>) g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>[idx].<a class="code hl_variable" href="structtbl__gas__index__t.html#a570ddd33828869a540ff5618c7d7efa7">offset</a>, SEEK_SET) != 0)</div>
<div class="line"><span class="lineno"> 6211</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Seek error in read_tbl_gas_single!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6212</span> </div>
<div class="line"><span class="lineno"> 6213</span>  <span class="comment">/* Read number of pressures... */</span></div>
<div class="line"><span class="lineno"> 6214</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6215</span>        1,</div>
<div class="line"><span class="lineno"> 6216</span>        g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6217</span>  <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig] &gt; <a class="code hl_define" href="jurassic_8h.html#ae24fde0b49cc53934d13a7ab3f95a4ef">TBLNP</a>)</div>
<div class="line"><span class="lineno"> 6218</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many pressure levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6219</span> </div>
<div class="line"><span class="lineno"> 6220</span>  <span class="comment">/* Read pressure grid... */</span></div>
<div class="line"><span class="lineno"> 6221</span>  <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6222</span>          (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig],</div>
<div class="line"><span class="lineno"> 6223</span>        g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6224</span> </div>
<div class="line"><span class="lineno"> 6225</span>  <span class="comment">/* Loop over pressure levels... */</span></div>
<div class="line"><span class="lineno"> 6226</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]; ip++) {</div>
<div class="line"><span class="lineno"> 6227</span> </div>
<div class="line"><span class="lineno"> 6228</span>    <span class="comment">/* Read number of temperatures... */</span></div>
<div class="line"><span class="lineno"> 6229</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6230</span>          1,</div>
<div class="line"><span class="lineno"> 6231</span>          g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6232</span>    <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip] &gt; <a class="code hl_define" href="jurassic_8h.html#aad9835e9e4be4ad8ed538f95bdceddea">TBLNT</a>)</div>
<div class="line"><span class="lineno"> 6233</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many temperatures!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6234</span> </div>
<div class="line"><span class="lineno"> 6235</span>    <span class="comment">/* Read temperature grid... */</span></div>
<div class="line"><span class="lineno"> 6236</span>    <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ip], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6237</span>            (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip],</div>
<div class="line"><span class="lineno"> 6238</span>          g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6239</span> </div>
<div class="line"><span class="lineno"> 6240</span>    <span class="comment">/* Loop over temperature levels... */</span></div>
<div class="line"><span class="lineno"> 6241</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 0; it &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][ip]; it++) {</div>
<div class="line"><span class="lineno"> 6242</span> </div>
<div class="line"><span class="lineno"> 6243</span>      <span class="comment">/* Read number of u points... */</span></div>
<div class="line"><span class="lineno"> 6244</span>      <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6245</span>            1,</div>
<div class="line"><span class="lineno"> 6246</span>            g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6247</span>      <span class="keywordflow">if</span> (tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it] &gt; <a class="code hl_define" href="jurassic_8h.html#a910036a8c83f3464c3de6bf398467c03">TBLNU</a>)</div>
<div class="line"><span class="lineno"> 6248</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many column densities!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6249</span> </div>
<div class="line"><span class="lineno"> 6250</span>      <span class="comment">/* Read u grid... */</span></div>
<div class="line"><span class="lineno"> 6251</span>      <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 6252</span>              (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it],</div>
<div class="line"><span class="lineno"> 6253</span>            g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6254</span> </div>
<div class="line"><span class="lineno"> 6255</span>      <span class="comment">/* Read emissivity grid... */</span></div>
<div class="line"><span class="lineno"> 6256</span>      <a class="code hl_define" href="jurassic_8h.html#ae8c13542ca31cfbccfc436aabd8851f6">FREAD</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 6257</span>              (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it],</div>
<div class="line"><span class="lineno"> 6258</span>            g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 6259</span>    }</div>
<div class="line"><span class="lineno"> 6260</span>  }</div>
<div class="line"><span class="lineno"> 6261</span> </div>
<div class="line"><span class="lineno"> 6262</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 6263</span>}</div>
<div class="ttc" id="astructtbl__gas__index__t_html_a570ddd33828869a540ff5618c7d7efa7"><div class="ttname"><a href="structtbl__gas__index__t.html#a570ddd33828869a540ff5618c7d7efa7">tbl_gas_index_t::offset</a></div><div class="ttdeci">int64_t offset</div><div class="ttdoc">Byte offset in file where the serialized block begins.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01454">jurassic.h:1454</a></div></div>
<div class="ttc" id="astructtbl__gas__index__t_html_ae92df1b397eddf22dd991d6a9f5e4853"><div class="ttname"><a href="structtbl__gas__index__t.html#ae92df1b397eddf22dd991d6a9f5e4853">tbl_gas_index_t::freq</a></div><div class="ttdeci">double freq</div><div class="ttdoc">Frequency identifier _j for this table block.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01451">jurassic.h:1451</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb6ce9b0361afe11cb23b8ac1e0c7fa3" name="abb6ce9b0361afe11cb23b8ac1e0c7fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb6ce9b0361afe11cb23b8ac1e0c7fa3">&#9670;&nbsp;</a></span>scan_ctl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double scan_ctl </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>arridx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>defvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scan control file or command-line arguments for a configuration variable. </p>
<p >Searches for a named variable in the JURASSIC control file or command-line arguments, returning its value as a double. Optionally stores the value as a string and supports array-style parameters (e.g., <code>EMITTER[0]</code>, <code>NU[5]</code>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">argc</td><td>Number of command-line arguments. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">argv</td><td>Command-line argument vector. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">varname</td><td>Name of the control variable to read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arridx</td><td>Array index (use -1 for scalar variables). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">defvalue</td><td>Default value if variable is not found (can be empty). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">value</td><td>Optional pointer to a string buffer receiving the value (may be <code>NULL</code> if only numeric output is required).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The variable value converted to <code>double</code>.</dd></dl>
<ul>
<li>The routine first attempts to open the control file provided as the first command-line argument (<code>argv[1]</code>), unless it starts with '-'.</li>
<li>Variable names may appear as either:<ul>
<li><code>VAR</code> (scalar)</li>
<li><code>VAR[index]</code> (explicit array index)</li>
<li><code>VAR[*]</code> (wildcard entry applying to all indices)</li>
</ul>
</li>
<li>The search order is:<ol type="1">
<li>Control file lines of the form: <div class="fragment"><div class="line">VAR[index] = VALUE</div>
<div class="line">VAR[*]     = VALUE</div>
</div><!-- fragment --></li>
<li>Command-line arguments: <div class="fragment"><div class="line">./jurassic ctlfile VAR[index] VALUE</div>
</div><!-- fragment --></li>
</ol>
</li>
<li>If no match is found:<ul>
<li>The default value <code>defvalue</code> is used (if non-empty).</li>
<li>Otherwise, the routine aborts with an error.</li>
</ul>
</li>
<li>The variable value is printed to the log at verbosity level 1.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a3635d1716488dea37d1176c1fb02675f" title="Read model control parameters from command-line and configuration input.">read_ctl</a>, <a class="el" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251" title="Print a log message with a specified logging level.">LOG</a>, <a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Aborts if the control file cannot be opened (unless skipped with '-').</li>
<li>Aborts if a required variable is missing and no default is provided.</li>
<li>Array bounds are not validated against internal limits; use <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> checks to ensure consistency.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>This utility simplifies control input parsing by supporting both command-line overrides and configuration files with the same syntax.</li>
<li>String comparisons are case-insensitive.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06267">6267</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6273</span>               {</div>
<div class="line"><span class="lineno"> 6274</span> </div>
<div class="line"><span class="lineno"> 6275</span>  FILE *in = NULL;</div>
<div class="line"><span class="lineno"> 6276</span> </div>
<div class="line"><span class="lineno"> 6277</span>  <span class="keywordtype">char</span> dummy[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], fullname1[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], fullname2[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], line[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>],</div>
<div class="line"><span class="lineno"> 6278</span>    rvarname[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], rval[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 6279</span> </div>
<div class="line"><span class="lineno"> 6280</span>  <span class="keywordtype">int</span> contain = 0;</div>
<div class="line"><span class="lineno"> 6281</span> </div>
<div class="line"><span class="lineno"> 6282</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 6283</span>  <span class="keywordflow">if</span> (argv[1][0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 6284</span>    <span class="keywordflow">if</span> (!(in = fopen(argv[1], <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 6285</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6286</span> </div>
<div class="line"><span class="lineno"> 6287</span>  <span class="comment">/* Set full variable name... */</span></div>
<div class="line"><span class="lineno"> 6288</span>  <span class="keywordflow">if</span> (arridx &gt;= 0) {</div>
<div class="line"><span class="lineno"> 6289</span>    sprintf(fullname1, <span class="stringliteral">&quot;%s[%d]&quot;</span>, varname, arridx);</div>
<div class="line"><span class="lineno"> 6290</span>    sprintf(fullname2, <span class="stringliteral">&quot;%s[*]&quot;</span>, varname);</div>
<div class="line"><span class="lineno"> 6291</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6292</span>    sprintf(fullname1, <span class="stringliteral">&quot;%s&quot;</span>, varname);</div>
<div class="line"><span class="lineno"> 6293</span>    sprintf(fullname2, <span class="stringliteral">&quot;%s&quot;</span>, varname);</div>
<div class="line"><span class="lineno"> 6294</span>  }</div>
<div class="line"><span class="lineno"> 6295</span> </div>
<div class="line"><span class="lineno"> 6296</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 6297</span>  <span class="keywordflow">if</span> (in != NULL)</div>
<div class="line"><span class="lineno"> 6298</span>    <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in))</div>
<div class="line"><span class="lineno"> 6299</span>      <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%s %s %s&quot;</span>, rvarname, dummy, rval) == 3)</div>
<div class="line"><span class="lineno"> 6300</span>        <span class="keywordflow">if</span> (strcasecmp(rvarname, fullname1) == 0 ||</div>
<div class="line"><span class="lineno"> 6301</span>            strcasecmp(rvarname, fullname2) == 0) {</div>
<div class="line"><span class="lineno"> 6302</span>          contain = 1;</div>
<div class="line"><span class="lineno"> 6303</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6304</span>        }</div>
<div class="line"><span class="lineno"> 6305</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; argc - 1; i++)</div>
<div class="line"><span class="lineno"> 6306</span>    <span class="keywordflow">if</span> (strcasecmp(argv[i], fullname1) == 0 ||</div>
<div class="line"><span class="lineno"> 6307</span>        strcasecmp(argv[i], fullname2) == 0) {</div>
<div class="line"><span class="lineno"> 6308</span>      sprintf(rval, <span class="stringliteral">&quot;%s&quot;</span>, argv[i + 1]);</div>
<div class="line"><span class="lineno"> 6309</span>      contain = 1;</div>
<div class="line"><span class="lineno"> 6310</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6311</span>    }</div>
<div class="line"><span class="lineno"> 6312</span> </div>
<div class="line"><span class="lineno"> 6313</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 6314</span>  <span class="keywordflow">if</span> (in != NULL)</div>
<div class="line"><span class="lineno"> 6315</span>    fclose(in);</div>
<div class="line"><span class="lineno"> 6316</span> </div>
<div class="line"><span class="lineno"> 6317</span>  <span class="comment">/* Check for missing variables... */</span></div>
<div class="line"><span class="lineno"> 6318</span>  <span class="keywordflow">if</span> (!contain) {</div>
<div class="line"><span class="lineno"> 6319</span>    <span class="keywordflow">if</span> (strlen(defvalue) &gt; 0)</div>
<div class="line"><span class="lineno"> 6320</span>      sprintf(rval, <span class="stringliteral">&quot;%s&quot;</span>, defvalue);</div>
<div class="line"><span class="lineno"> 6321</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6322</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Missing variable %s!\n&quot;</span>, fullname1);</div>
<div class="line"><span class="lineno"> 6323</span>  }</div>
<div class="line"><span class="lineno"> 6324</span> </div>
<div class="line"><span class="lineno"> 6325</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6326</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;%s = %s&quot;</span>, fullname1, rval);</div>
<div class="line"><span class="lineno"> 6327</span> </div>
<div class="line"><span class="lineno"> 6328</span>  <span class="comment">/* Return values... */</span></div>
<div class="line"><span class="lineno"> 6329</span>  <span class="keywordflow">if</span> (value != NULL)</div>
<div class="line"><span class="lineno"> 6330</span>    sprintf(value, <span class="stringliteral">&quot;%s&quot;</span>, rval);</div>
<div class="line"><span class="lineno"> 6331</span>  <span class="keywordflow">return</span> atof(rval);</div>
<div class="line"><span class="lineno"> 6332</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9a11e5f03e0a307add4daf864977cec" name="ae9a11e5f03e0a307add4daf864977cec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9a11e5f03e0a307add4daf864977cec">&#9670;&nbsp;</a></span>set_cov_apr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_cov_apr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structret__t.html">ret_t</a> *&#160;</td>
          <td class="paramname"><em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>iqa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>s_a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct the a priori covariance matrix \(\mathbf{S_a}\) for retrieval parameters. </p>
<p >Builds the full a priori covariance matrix based on specified retrieval error assumptions and correlation lengths defined in the <code><a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a></code> structure. Each diagonal element represents the variance of an individual state vector element, while off-diagonal terms encode spatial correlations between parameters of the same type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ret</td><td>Retrieval configuration and error parameters (<code><a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a></code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining retrieval setup and state vector mapping (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Atmospheric profile structure containing geolocation and altitude information (<code><a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a></code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iqa</td><td>Index array linking state vector elements to physical quantities (e.g. pressure, temperature, gas, extinction, etc.). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipa</td><td>Index array linking state vector elements to atmospheric grid points. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">s_a</td><td>Output a priori covariance matrix \(\mathbf{S_a}\) (<code>gsl_matrix</code>), dimension nn.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The function first converts atmospheric quantities to a state vector (<code>atm2x</code>) and scales them according to their a priori uncertainties:<ul>
<li>Pressure and trace gas errors are relative (% of nominal value).</li>
<li>Temperature, extinction, cloud, and surface errors are absolute.</li>
</ul>
</li>
<li>The diagonal of \(\mathbf{S_a}\) is filled with the variances \(\sigma_i^2\) of each element.</li>
<li>Off-diagonal elements are populated according to an exponential correlation model: <p class="formulaDsp">
\[
  \rho_{ij} = \exp\left(-\frac{d_{ij}}{L_h} - \frac{|z_i - z_j|}{L_v}\right)
  \]
</p>
 where:<ul>
<li>\(d_{ij}\) is the great-circle (horizontal) distance between state vector locations,</li>
<li>\(L_h\) and \(L_v\) are horizontal and vertical correlation lengths for the parameter type.</li>
</ul>
</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x</a>, <a class="el" href="jurassic_8h.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates.">geo2cart</a>, <a class="el" href="jurassic_8h.html#ae733a5a3a9e9a85474da2105655a0dc4" title="Compute Cartesian distance between two 3D vectors.">DIST</a>, <a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Parameters with identical type indices (<code>iqa[i] == iqa[j]</code>) are assumed to share correlation properties.</li>
<li>Correlation lengths are taken from <code><a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a></code>, differing by parameter type:<ul>
<li>Pressure: <code>err_press_cz</code>, <code>err_press_ch</code></li>
<li>Temperature: <code>err_temp_cz</code>, <code>err_temp_ch</code></li>
<li>Volume mixing ratio: <code>err_q_cz[]</code>, <code>err_q_ch[]</code></li>
<li>Extinction: <code>err_k_cz[]</code>, <code>err_k_ch[]</code></li>
</ul>
</li>
<li>Cloud and surface parameters are assumed uncorrelated (diagonal only).</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>A zero or negative variance triggers a runtime error.</li>
<li>The matrix is constructed in full (dense), which may be large for high-resolution retrieval grids.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06336">6336</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6342</span>                   {</div>
<div class="line"><span class="lineno"> 6343</span> </div>
<div class="line"><span class="lineno"> 6344</span>  <span class="comment">/* Get sizes... */</span></div>
<div class="line"><span class="lineno"> 6345</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = s_a-&gt;size1;</div>
<div class="line"><span class="lineno"> 6346</span> </div>
<div class="line"><span class="lineno"> 6347</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 6348</span>  gsl_vector *x_a = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 6349</span> </div>
<div class="line"><span class="lineno"> 6350</span>  <span class="comment">/* Get sigma vector... */</span></div>
<div class="line"><span class="lineno"> 6351</span>  <a class="code hl_function" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x</a>(ctl, atm, x_a, NULL, NULL);</div>
<div class="line"><span class="lineno"> 6352</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno"> 6353</span>    <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a>)</div>
<div class="line"><span class="lineno"> 6354</span>      gsl_vector_set(x_a, i, ret-&gt;<a class="code hl_variable" href="structret__t.html#a37a4b935012a65da5c1ad692ee74cefe">err_press</a> / 100 * gsl_vector_get(x_a, i));</div>
<div class="line"><span class="lineno"> 6355</span>    <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a>)</div>
<div class="line"><span class="lineno"> 6356</span>      gsl_vector_set(x_a, i, ret-&gt;<a class="code hl_variable" href="structret__t.html#a616ca08dddf3dfd071d523f052966b12">err_temp</a>);</div>
<div class="line"><span class="lineno"> 6357</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 6358</span>      <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a>(ig))</div>
<div class="line"><span class="lineno"> 6359</span>        gsl_vector_set(x_a, i, ret-&gt;<a class="code hl_variable" href="structret__t.html#ad7a4d797ec29d85e0f9e4b6a0c153acb">err_q</a>[ig] / 100 * gsl_vector_get(x_a, i));</div>
<div class="line"><span class="lineno"> 6360</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 6361</span>      <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a>(iw))</div>
<div class="line"><span class="lineno"> 6362</span>        gsl_vector_set(x_a, i, ret-&gt;<a class="code hl_variable" href="structret__t.html#af4eb3f8fad1ee4d4bd4ff4176ad3575f">err_k</a>[iw]);</div>
<div class="line"><span class="lineno"> 6363</span>    <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#a04eaf14380553f171f54680560527fe5">IDXCLZ</a>)</div>
<div class="line"><span class="lineno"> 6364</span>      gsl_vector_set(x_a, i, ret-&gt;<a class="code hl_variable" href="structret__t.html#a76cf97eefeca4904c682f93b3a9cd724">err_clz</a>);</div>
<div class="line"><span class="lineno"> 6365</span>    <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#a3b420330ad2457758ef539d8c9e0bd99">IDXCLDZ</a>)</div>
<div class="line"><span class="lineno"> 6366</span>      gsl_vector_set(x_a, i, ret-&gt;<a class="code hl_variable" href="structret__t.html#ab4447de9632efb35e2d9d82f1e69c2c3">err_cldz</a>);</div>
<div class="line"><span class="lineno"> 6367</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 6368</span>      <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#a809f947437669a6b3930302f30375d41">IDXCLK</a>(icl))</div>
<div class="line"><span class="lineno"> 6369</span>        gsl_vector_set(x_a, i, ret-&gt;<a class="code hl_variable" href="structret__t.html#a7c9d68bdc86d25320307770ea704d37b">err_clk</a>[icl]);</div>
<div class="line"><span class="lineno"> 6370</span>    <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#a7abc6f3d1a1993a0337a736d79cf6ecc">IDXSFT</a>)</div>
<div class="line"><span class="lineno"> 6371</span>      gsl_vector_set(x_a, i, ret-&gt;<a class="code hl_variable" href="structret__t.html#a795828c0c29f09adc759aa8d39eeeae9">err_sft</a>);</div>
<div class="line"><span class="lineno"> 6372</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 6373</span>      <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#a803581fe3fed7a56dacec94c5c860f35">IDXSFEPS</a>(isf))</div>
<div class="line"><span class="lineno"> 6374</span>        gsl_vector_set(x_a, i, ret-&gt;<a class="code hl_variable" href="structret__t.html#ae0ad7d1672eb774dab0f12cdccfa8b2f">err_sfeps</a>[isf]);</div>
<div class="line"><span class="lineno"> 6375</span>  }</div>
<div class="line"><span class="lineno"> 6376</span> </div>
<div class="line"><span class="lineno"> 6377</span>  <span class="comment">/* Check standard deviations... */</span></div>
<div class="line"><span class="lineno"> 6378</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; i++)</div>
<div class="line"><span class="lineno"> 6379</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(gsl_vector_get(x_a, i)) &lt;= 0)</div>
<div class="line"><span class="lineno"> 6380</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Check a priori data (zero standard deviation)!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6381</span> </div>
<div class="line"><span class="lineno"> 6382</span>  <span class="comment">/* Initialize diagonal covariance... */</span></div>
<div class="line"><span class="lineno"> 6383</span>  gsl_matrix_set_zero(s_a);</div>
<div class="line"><span class="lineno"> 6384</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; i++)</div>
<div class="line"><span class="lineno"> 6385</span>    gsl_matrix_set(s_a, i, i, <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(gsl_vector_get(x_a, i)));</div>
<div class="line"><span class="lineno"> 6386</span> </div>
<div class="line"><span class="lineno"> 6387</span>  <span class="comment">/* Loop over matrix elements... */</span></div>
<div class="line"><span class="lineno"> 6388</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; i++)</div>
<div class="line"><span class="lineno"> 6389</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; j++)</div>
<div class="line"><span class="lineno"> 6390</span>      <span class="keywordflow">if</span> (i != j &amp;&amp; iqa[i] == iqa[j]) {</div>
<div class="line"><span class="lineno"> 6391</span> </div>
<div class="line"><span class="lineno"> 6392</span>        <span class="comment">/* Initialize... */</span></div>
<div class="line"><span class="lineno"> 6393</span>        <span class="keywordtype">double</span> cz = 0;</div>
<div class="line"><span class="lineno"> 6394</span>        <span class="keywordtype">double</span> ch = 0;</div>
<div class="line"><span class="lineno"> 6395</span> </div>
<div class="line"><span class="lineno"> 6396</span>        <span class="comment">/* Set correlation lengths for pressure... */</span></div>
<div class="line"><span class="lineno"> 6397</span>        <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#a99c6798a64d9d5535a2b22b46ee31924">IDXP</a>) {</div>
<div class="line"><span class="lineno"> 6398</span>          cz = ret-&gt;<a class="code hl_variable" href="structret__t.html#a28b6420599cf7a0012082165d131acd6">err_press_cz</a>;</div>
<div class="line"><span class="lineno"> 6399</span>          ch = ret-&gt;<a class="code hl_variable" href="structret__t.html#ab8c7a6e941f1b6e41c095d1efbfab387">err_press_ch</a>;</div>
<div class="line"><span class="lineno"> 6400</span>        }</div>
<div class="line"><span class="lineno"> 6401</span> </div>
<div class="line"><span class="lineno"> 6402</span>        <span class="comment">/* Set correlation lengths for temperature... */</span></div>
<div class="line"><span class="lineno"> 6403</span>        <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#afb33f030ad4a44d5f638f3903d13fe70">IDXT</a>) {</div>
<div class="line"><span class="lineno"> 6404</span>          cz = ret-&gt;<a class="code hl_variable" href="structret__t.html#a55bb904242ed4b26f1c8f5a27a4ef50a">err_temp_cz</a>;</div>
<div class="line"><span class="lineno"> 6405</span>          ch = ret-&gt;<a class="code hl_variable" href="structret__t.html#a9d21bed9a5bbb7f044c0ed2c99c746ec">err_temp_ch</a>;</div>
<div class="line"><span class="lineno"> 6406</span>        }</div>
<div class="line"><span class="lineno"> 6407</span> </div>
<div class="line"><span class="lineno"> 6408</span>        <span class="comment">/* Set correlation lengths for volume mixing ratios... */</span></div>
<div class="line"><span class="lineno"> 6409</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 6410</span>          <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#af2f80a7a5ff9b54495c0c41d8571cafc">IDXQ</a>(ig)) {</div>
<div class="line"><span class="lineno"> 6411</span>            cz = ret-&gt;<a class="code hl_variable" href="structret__t.html#a61899a5b81d134ceff4a527383a3c55d">err_q_cz</a>[ig];</div>
<div class="line"><span class="lineno"> 6412</span>            ch = ret-&gt;<a class="code hl_variable" href="structret__t.html#ac7074498033f17991268df8300b6553a">err_q_ch</a>[ig];</div>
<div class="line"><span class="lineno"> 6413</span>          }</div>
<div class="line"><span class="lineno"> 6414</span> </div>
<div class="line"><span class="lineno"> 6415</span>        <span class="comment">/* Set correlation lengths for extinction... */</span></div>
<div class="line"><span class="lineno"> 6416</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 6417</span>          <span class="keywordflow">if</span> (iqa[i] == <a class="code hl_define" href="jurassic_8h.html#a511d4808c85a5b5e1e600cf413eabbd6">IDXK</a>(iw)) {</div>
<div class="line"><span class="lineno"> 6418</span>            cz = ret-&gt;<a class="code hl_variable" href="structret__t.html#a45f25383fd186884b8a51310837b43cd">err_k_cz</a>[iw];</div>
<div class="line"><span class="lineno"> 6419</span>            ch = ret-&gt;<a class="code hl_variable" href="structret__t.html#a53df3475ac7e045917bd54caef5058ee">err_k_ch</a>[iw];</div>
<div class="line"><span class="lineno"> 6420</span>          }</div>
<div class="line"><span class="lineno"> 6421</span> </div>
<div class="line"><span class="lineno"> 6422</span>        <span class="comment">/* Compute correlations... */</span></div>
<div class="line"><span class="lineno"> 6423</span>        <span class="keywordflow">if</span> (cz &gt; 0 &amp;&amp; ch &gt; 0) {</div>
<div class="line"><span class="lineno"> 6424</span> </div>
<div class="line"><span class="lineno"> 6425</span>          <span class="comment">/* Get Cartesian coordinates... */</span></div>
<div class="line"><span class="lineno"> 6426</span>          <span class="keywordtype">double</span> x0[3], x1[3];</div>
<div class="line"><span class="lineno"> 6427</span>          <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ipa[i]], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ipa[i]], x0);</div>
<div class="line"><span class="lineno"> 6428</span>          <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ipa[j]], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ipa[j]], x1);</div>
<div class="line"><span class="lineno"> 6429</span> </div>
<div class="line"><span class="lineno"> 6430</span>          <span class="comment">/* Compute correlations... */</span></div>
<div class="line"><span class="lineno"> 6431</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> rho =</div>
<div class="line"><span class="lineno"> 6432</span>            exp(-<a class="code hl_define" href="jurassic_8h.html#ae733a5a3a9e9a85474da2105655a0dc4">DIST</a>(x0, x1) / ch -</div>
<div class="line"><span class="lineno"> 6433</span>                fabs(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ipa[i]] - atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ipa[j]]) / cz);</div>
<div class="line"><span class="lineno"> 6434</span> </div>
<div class="line"><span class="lineno"> 6435</span>          <span class="comment">/* Set covariance... */</span></div>
<div class="line"><span class="lineno"> 6436</span>          gsl_matrix_set(s_a, i, j, gsl_vector_get(x_a, i)</div>
<div class="line"><span class="lineno"> 6437</span>                         * gsl_vector_get(x_a, j) * rho);</div>
<div class="line"><span class="lineno"> 6438</span>        }</div>
<div class="line"><span class="lineno"> 6439</span>      }</div>
<div class="line"><span class="lineno"> 6440</span> </div>
<div class="line"><span class="lineno"> 6441</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 6442</span>  gsl_vector_free(x_a);</div>
<div class="line"><span class="lineno"> 6443</span>}</div>
<div class="ttc" id="ajurassic_8h_html_ae733a5a3a9e9a85474da2105655a0dc4"><div class="ttname"><a href="jurassic_8h.html#ae733a5a3a9e9a85474da2105655a0dc4">DIST</a></div><div class="ttdeci">#define DIST(a, b)</div><div class="ttdoc">Compute Cartesian distance between two 3D vectors.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00447">jurassic.h:447</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_ae9a11e5f03e0a307add4daf864977cec_cgraph.png" border="0" usemap="#ajurassic_8h_ae9a11e5f03e0a307add4daf864977cec_cgraph" alt=""/></div>
<map name="ajurassic_8h_ae9a11e5f03e0a307add4daf864977cec_cgraph" id="ajurassic_8h_ae9a11e5f03e0a307add4daf864977cec_cgraph">
<area shape="rect" title="Construct the a priori covariance matrix &#160;for retrieval parameters." alt="" coords="5,31,99,57"/>
<area shape="rect" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements." alt="" coords="154,5,211,32"/>
<area shape="rect" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="147,56,219,83"/>
<area shape="rect" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f" title="Append a single atmospheric value to the state vector." alt="" coords="267,5,355,32"/>
</map>
</div>

</div>
</div>
<a id="a6bb69eac608c4019c689bf8280912c1f" name="a6bb69eac608c4019c689bf8280912c1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb69eac608c4019c689bf8280912c1f">&#9670;&nbsp;</a></span>set_cov_meas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_cov_meas </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structret__t.html">ret_t</a> *&#160;</td>
          <td class="paramname"><em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&#160;</td>
          <td class="paramname"><em>sig_noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&#160;</td>
          <td class="paramname"><em>sig_formod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&#160;</td>
          <td class="paramname"><em>sig_eps_inv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct measurement error standard deviations and their inverse. </p>
<p >Builds the total measurement uncertainty vector used in the optimal estimation retrieval, accounting for both instrument noise and forward model (systematic) errors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ret</td><td>Retrieval configuration and error parameters (<code><a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a></code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure defining spectral channels and setup (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs</td><td>Observation dataset (<code><a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a></code>), containing measured radiances or brightness temperatures. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sig_noise</td><td>Vector of instrument noise standard deviations (<code>gsl_vector</code>), length m. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sig_formod</td><td>Vector of forward model error standard deviations (<code>gsl_vector</code>), length m. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sig_eps_inv</td><td>Vector of inverse total standard deviations, \(\sigma_\epsilon^{-1}\), used for normalization.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The function computes the total measurement uncertainty for each observation element \(i\) as: <p class="formulaDsp">
\[
  \sigma_{\epsilon,i}^2 = \sigma_{\text{noise},i}^2 + \sigma_{\text{formod},i}^2
  \]
</p>
 and stores its reciprocal square root: <p class="formulaDsp">
\[
  (\sigma_{\epsilon,i}^{-1}) = \frac{1}{\sqrt{\sigma_{\epsilon,i}^2}}
  \]
</p>
</li>
<li>**Noise error (<code>sig_noise</code>)** <br  />
 Determined from the instrument noise level defined in <code>ret-&gt;err_noise[id]</code> for each spectral channel. The noise term is always included in the fit.</li>
<li>**Forward model error (<code>sig_formod</code>)** <br  />
 Computed as a fixed percentage (<code>ret-&gt;err_formod[id]</code>) of the measured radiance (or brightness temperature) per channel. This represents uncertainty due to imperfect forward modeling.</li>
<li>The inverse total standard deviation vector (<code>sig_eps_inv</code>) is used to normalize the measurement residuals \((y - F(x))\) in the cost function.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#ad6380c9458cf356667952f9651932e27" title="Convert observation radiances into a measurement vector.">obs2y</a>, <a class="el" href="jurassic_8h.html#aa855e52716bd4b479bb0d2446b300a4e" title="Copy or initialize observation geometry and radiance data.">copy_obs</a>, <a class="el" href="jurassic_8h.html#a092636f1592a6e34378a13f3e03e2f87" title="Compute the normalized quadratic cost function for optimal estimation.">cost_function</a>, <a class="el" href="jurassic_8h.html#ae9a11e5f03e0a307add4daf864977cec" title="Construct the a priori covariance matrix  for retrieval parameters.">set_cov_apr</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Only finite observation elements are considered; invalid values are set to <code>NAN</code>.</li>
<li>Units correspond to the observation quantity:<ul>
<li>Radiance: [W/(msrcm)]</li>
<li>Brightness temperature: [K]</li>
</ul>
</li>
<li>The forward model error is always relative, expressed in percent (%).</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>A zero or negative uncertainty triggers a runtime error.</li>
<li>Assumes <code>obs</code> and <code>ctl</code> are consistent in dimension and indexing.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06447">6447</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6453</span>                           {</div>
<div class="line"><span class="lineno"> 6454</span> </div>
<div class="line"><span class="lineno"> 6455</span>  <span class="keyword">static</span> <a class="code hl_struct" href="structobs__t.html">obs_t</a> obs_err;</div>
<div class="line"><span class="lineno"> 6456</span> </div>
<div class="line"><span class="lineno"> 6457</span>  <span class="comment">/* Get size... */</span></div>
<div class="line"><span class="lineno"> 6458</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> m = sig_eps_inv-&gt;size;</div>
<div class="line"><span class="lineno"> 6459</span> </div>
<div class="line"><span class="lineno"> 6460</span>  <span class="comment">/* Noise error (always considered in retrieval fit)... */</span></div>
<div class="line"><span class="lineno"> 6461</span>  <a class="code hl_function" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e">copy_obs</a>(ctl, &amp;obs_err, obs, 1);</div>
<div class="line"><span class="lineno"> 6462</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs_err.<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 6463</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 6464</span>      obs_err.<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir]</div>
<div class="line"><span class="lineno"> 6465</span>        = (isfinite(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir]) ? ret-&gt;<a class="code hl_variable" href="structret__t.html#a6d522896a7cb7ef82a84ca9b3c8e195b">err_noise</a>[<span class="keywordtype">id</span>] : NAN);</div>
<div class="line"><span class="lineno"> 6466</span>  <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, &amp;obs_err, sig_noise, NULL, NULL);</div>
<div class="line"><span class="lineno"> 6467</span> </div>
<div class="line"><span class="lineno"> 6468</span>  <span class="comment">/* Forward model error (always considered in retrieval fit)... */</span></div>
<div class="line"><span class="lineno"> 6469</span>  <a class="code hl_function" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e">copy_obs</a>(ctl, &amp;obs_err, obs, 1);</div>
<div class="line"><span class="lineno"> 6470</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs_err.<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 6471</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 6472</span>      obs_err.<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir]</div>
<div class="line"><span class="lineno"> 6473</span>        = fabs(ret-&gt;<a class="code hl_variable" href="structret__t.html#a56c0b2147bb67a0a1179b3a7c3a6af23">err_formod</a>[<span class="keywordtype">id</span>] / 100 * obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir]);</div>
<div class="line"><span class="lineno"> 6474</span>  <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, &amp;obs_err, sig_formod, NULL, NULL);</div>
<div class="line"><span class="lineno"> 6475</span> </div>
<div class="line"><span class="lineno"> 6476</span>  <span class="comment">/* Total error... */</span></div>
<div class="line"><span class="lineno"> 6477</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; i++)</div>
<div class="line"><span class="lineno"> 6478</span>    gsl_vector_set(sig_eps_inv, i, 1 / sqrt(<a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(gsl_vector_get(sig_noise, i))</div>
<div class="line"><span class="lineno"> 6479</span>                                            +</div>
<div class="line"><span class="lineno"> 6480</span>                                            <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(gsl_vector_get</div>
<div class="line"><span class="lineno"> 6481</span>                                                 (sig_formod, i))));</div>
<div class="line"><span class="lineno"> 6482</span> </div>
<div class="line"><span class="lineno"> 6483</span>  <span class="comment">/* Check standard deviations... */</span></div>
<div class="line"><span class="lineno"> 6484</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; i++)</div>
<div class="line"><span class="lineno"> 6485</span>    <span class="keywordflow">if</span> (gsl_vector_get(sig_eps_inv, i) &lt;= 0)</div>
<div class="line"><span class="lineno"> 6486</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Check measurement errors (zero standard deviation)!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6487</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a6bb69eac608c4019c689bf8280912c1f_cgraph.png" border="0" usemap="#ajurassic_8h_a6bb69eac608c4019c689bf8280912c1f_cgraph" alt=""/></div>
<map name="ajurassic_8h_a6bb69eac608c4019c689bf8280912c1f_cgraph" id="ajurassic_8h_a6bb69eac608c4019c689bf8280912c1f_cgraph">
<area shape="rect" title="Construct measurement error standard deviations and their inverse." alt="" coords="5,31,112,57"/>
<area shape="rect" href="jurassic_8c.html#aa855e52716bd4b479bb0d2446b300a4e" title="Copy or initialize observation geometry and radiance data." alt="" coords="160,5,237,32"/>
<area shape="rect" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27" title="Convert observation radiances into a measurement vector." alt="" coords="171,56,227,83"/>
</map>
</div>

</div>
</div>
<a id="ad1500cc96441cf118acda392366397cc" name="ad1500cc96441cf118acda392366397cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1500cc96441cf118acda392366397cc">&#9670;&nbsp;</a></span>sza()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sza </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the solar zenith angle for a given time and location. </p>
<p >Calculates the apparent solar zenith angle (SZA) [deg] based on the observers longitude, latitude, and time since 2000-01-01 T00:00 Z.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sec</td><td>Seconds since 2000-01-01 T00:00 Z. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon</td><td>Observer longitude [deg]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat</td><td>Observer latitude [deg].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Solar zenith angle [deg].</dd></dl>
<ul>
<li>Implements a simplified astronomical model based on the Suns apparent ecliptic longitude and the Earths mean obliquity.</li>
<li>Uses the following steps:<ol type="1">
<li>Compute the number of days since J2000 noon epoch.</li>
<li>Determine the Suns apparent ecliptic longitude and declination.</li>
<li>Compute the local hour angle from Greenwich Mean Sidereal Time.</li>
<li>Derive the solar zenith angle via spherical trigonometry: <p class="formulaDsp">
\[
     \cos(\theta) = \sin(\varphi)\sin(\delta)
                  + \cos(\varphi)\cos(\delta)\cos(h)
     \]
</p>
 where \(\varphi\) = latitude, \(\delta\) = declination, \(h\) = hour angle.</li>
</ol>
</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a9727c4e0e5bc85384762b6ad81a8c3be" title="Compute line-of-sight radiances using the pencil-beam forward model.">formod_pencil</a>, <a class="el" href="structctl__t.html#a8e7cd04d65ba7ae0efb60e09678a566c" title="Solar zenith angle at the surface [deg] (-999=auto).">ctl_t::sfsza</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Neglects atmospheric refraction and seasonal perturbations.</li>
<li>Accuracy is sufficient for radiative transfer applications (&lt;0.1).</li>
<li>Longitude positive eastward, latitude positive northward.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

</div>
</div>
<a id="a9020f32787ea7be08486d537a4f5c0fc" name="a9020f32787ea7be08486d537a4f5c0fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9020f32787ea7be08486d537a4f5c0fc">&#9670;&nbsp;</a></span>tangent_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tangent_point </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structlos__t.html">los_t</a> *&#160;</td>
          <td class="paramname"><em>los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tpz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tplon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tplat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the tangent point along a line of sight (LOS). </p>
<p >Computes the location of the tangent point  the point of minimum altitude  along the current line of sight, based on the LOS geometry stored in <a class="el" href="structlos__t.html">los_t</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">los</td><td>Pointer to the line-of-sight (LOS) structure containing altitude, longitude, latitude, and segment length data. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tpz</td><td>Pointer to variable receiving tangent point altitude [km]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tplon</td><td>Pointer to variable receiving tangent point longitude [deg]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tplat</td><td>Pointer to variable receiving tangent point latitude [deg].</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>For limb or occultation geometry, the routine:<ol type="1">
<li>Identifies the LOS grid point with minimum altitude.</li>
<li>Fits a quadratic interpolation polynomial: \( z = a x^2 + b x + c \) through the altitudes of the three neighboring LOS points.</li>
<li>Solves analytically for the vertex position \( x = -b / (2a) \), corresponding to the tangent point.</li>
<li>Converts this interpolated position back to geographic coordinates.</li>
</ol>
</li>
<li>For nadir or zenith viewing (minimum altitude at the LOS endpoint), the tangent point defaults to the last grid point.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a44e1e4b6ab44e79d049f99a04e79df9f" title="Perform line-of-sight (LOS) ray tracing through the atmosphere.">raytrace</a>, <a class="el" href="jurassic_8h.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates.">geo2cart</a>, <a class="el" href="jurassic_8h.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="Converts Cartesian coordinates to geographic coordinates.">cart2geo</a>, <a class="el" href="structlos__t.html" title="Line-of-sight data.">los_t</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The LOS segment lengths (<code>ds</code>) must be consistent with the geometric spacing between altitude points for the interpolation to be accurate.</li>
<li>The quadratic interpolation provides sub-kilometer precision for smooth limb rays.</li>
<li>Longitude and latitude are returned in degrees.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>If the LOS contains fewer than three valid points, or the geometry is strongly curved, the tangent point estimate may be unreliable.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06491">6491</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6495</span>                 {</div>
<div class="line"><span class="lineno"> 6496</span> </div>
<div class="line"><span class="lineno"> 6497</span>  <span class="keywordtype">double</span> dummy, v[3], v0[3], v2[3];</div>
<div class="line"><span class="lineno"> 6498</span> </div>
<div class="line"><span class="lineno"> 6499</span>  <span class="comment">/* Find minimum altitude... */</span></div>
<div class="line"><span class="lineno"> 6500</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> ip = gsl_stats_min_index(los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>, 1, (<span class="keywordtype">size_t</span>) los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a>);</div>
<div class="line"><span class="lineno"> 6501</span> </div>
<div class="line"><span class="lineno"> 6502</span>  <span class="comment">/* Nadir or zenith... */</span></div>
<div class="line"><span class="lineno"> 6503</span>  <span class="keywordflow">if</span> (ip &lt;= 0 || ip &gt;= (<span class="keywordtype">size_t</span>) los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1) {</div>
<div class="line"><span class="lineno"> 6504</span>    *tpz = los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1];</div>
<div class="line"><span class="lineno"> 6505</span>    *tplon = los-&gt;<a class="code hl_variable" href="structlos__t.html#a5f4f0f880e8649bd90459fe7c14811dc">lon</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1];</div>
<div class="line"><span class="lineno"> 6506</span>    *tplat = los-&gt;<a class="code hl_variable" href="structlos__t.html#ab1339541546c449911407fdabf0beea3">lat</a>[los-&gt;<a class="code hl_variable" href="structlos__t.html#a8a1dd4eed9a219b4dba98db4e22e6355">np</a> - 1];</div>
<div class="line"><span class="lineno"> 6507</span>  }</div>
<div class="line"><span class="lineno"> 6508</span> </div>
<div class="line"><span class="lineno"> 6509</span>  <span class="comment">/* Limb... */</span></div>
<div class="line"><span class="lineno"> 6510</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6511</span> </div>
<div class="line"><span class="lineno"> 6512</span>    <span class="comment">/* Determine interpolating polynomial y=a*x^2+b*x+c... */</span></div>
<div class="line"><span class="lineno"> 6513</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> yy0 = los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[ip - 1];</div>
<div class="line"><span class="lineno"> 6514</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> yy1 = los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[ip];</div>
<div class="line"><span class="lineno"> 6515</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> yy2 = los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[ip + 1];</div>
<div class="line"><span class="lineno"> 6516</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> x1 = sqrt(<a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[ip]) - <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(yy1 - yy0));</div>
<div class="line"><span class="lineno"> 6517</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> x2 = x1 + sqrt(<a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(los-&gt;<a class="code hl_variable" href="structlos__t.html#a6ba42c3d2673b0b2805c674b38680c16">ds</a>[ip + 1]) - <a class="code hl_define" href="jurassic_8h.html#a1ac0abc7c913167ecaf81778d57e7a17">POW2</a>(yy2 - yy1));</div>
<div class="line"><span class="lineno"> 6518</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> a = 1 / (x1 - x2) * (-(yy0 - yy1) / x1 + (yy0 - yy2) / x2);</div>
<div class="line"><span class="lineno"> 6519</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> b = -(yy0 - yy1) / x1 - a * x1;</div>
<div class="line"><span class="lineno"> 6520</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> c = yy0;</div>
<div class="line"><span class="lineno"> 6521</span> </div>
<div class="line"><span class="lineno"> 6522</span>    <span class="comment">/* Get tangent point location... */</span></div>
<div class="line"><span class="lineno"> 6523</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> x = -b / (2 * a);</div>
<div class="line"><span class="lineno"> 6524</span>    *tpz = a * x * x + b * x + c;</div>
<div class="line"><span class="lineno"> 6525</span>    <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[ip - 1], los-&gt;<a class="code hl_variable" href="structlos__t.html#a5f4f0f880e8649bd90459fe7c14811dc">lon</a>[ip - 1], los-&gt;<a class="code hl_variable" href="structlos__t.html#ab1339541546c449911407fdabf0beea3">lat</a>[ip - 1], v0);</div>
<div class="line"><span class="lineno"> 6526</span>    <a class="code hl_function" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(los-&gt;<a class="code hl_variable" href="structlos__t.html#a0699ee03023f12b348926fc8d6046c8e">z</a>[ip + 1], los-&gt;<a class="code hl_variable" href="structlos__t.html#a5f4f0f880e8649bd90459fe7c14811dc">lon</a>[ip + 1], los-&gt;<a class="code hl_variable" href="structlos__t.html#ab1339541546c449911407fdabf0beea3">lat</a>[ip + 1], v2);</div>
<div class="line"><span class="lineno"> 6527</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno"> 6528</span>      v[i] = <a class="code hl_define" href="jurassic_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(0.0, v0[i], x2, v2[i], x);</div>
<div class="line"><span class="lineno"> 6529</span>    <a class="code hl_function" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a>(v, &amp;dummy, tplon, tplat);</div>
<div class="line"><span class="lineno"> 6530</span>  }</div>
<div class="line"><span class="lineno"> 6531</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a9020f32787ea7be08486d537a4f5c0fc_cgraph.png" border="0" usemap="#ajurassic_8h_a9020f32787ea7be08486d537a4f5c0fc_cgraph" alt=""/></div>
<map name="ajurassic_8h_a9020f32787ea7be08486d537a4f5c0fc_cgraph" id="ajurassic_8h_a9020f32787ea7be08486d537a4f5c0fc_cgraph">
<area shape="rect" title="Determine the tangent point along a line of sight (LOS)." alt="" coords="5,31,105,57"/>
<area shape="rect" href="jurassic_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="Converts Cartesian coordinates to geographic coordinates." alt="" coords="153,5,225,32"/>
<area shape="rect" href="jurassic_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="153,56,225,83"/>
</map>
</div>

</div>
</div>
<a id="a578e7ebaa62304182de8fe7ddf144b8f" name="a578e7ebaa62304182de8fe7ddf144b8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a578e7ebaa62304182de8fe7ddf144b8f">&#9670;&nbsp;</a></span>time2jsec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void time2jsec </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>remain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>jsec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts time components to seconds since January 1, 2000, 12:00:00 UTC. </p>
<p >This function calculates the number of seconds elapsed since January 1, 2000, 12:00:00 UTC, based on the provided year, month, day, hour, minute, and second. It also includes a fractional part to represent the remaining seconds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">year</td><td>The year. </td></tr>
    <tr><td class="paramname">mon</td><td>The month (1-12). </td></tr>
    <tr><td class="paramname">day</td><td>The day of the month (1-31). </td></tr>
    <tr><td class="paramname">hour</td><td>The hour of the day (0-23). </td></tr>
    <tr><td class="paramname">min</td><td>The minute (0-59). </td></tr>
    <tr><td class="paramname">sec</td><td>The second (0-59). </td></tr>
    <tr><td class="paramname">remain</td><td>The fractional part of seconds. </td></tr>
    <tr><td class="paramname">jsec</td><td>Pointer to store the calculated number of seconds since January 1, 2000, 12:00:00 UTC.</td></tr>
  </table>
  </dd>
</dl>
<p>The function calculates the time elapsed since January 1, 2000, 12:00:00 UTC, up to the specified time and includes any fractional seconds indicated by the "remain" parameter.</p>
<dl class="section note"><dt>Note</dt><dd>The function uses the timegm function, which is similar to mktime but operates in UTC.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06535">6535</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6543</span>                {</div>
<div class="line"><span class="lineno"> 6544</span> </div>
<div class="line"><span class="lineno"> 6545</span>  <span class="keyword">struct </span>tm t0, t1;</div>
<div class="line"><span class="lineno"> 6546</span> </div>
<div class="line"><span class="lineno"> 6547</span>  t0.tm_year = 100;</div>
<div class="line"><span class="lineno"> 6548</span>  t0.tm_mon = 0;</div>
<div class="line"><span class="lineno"> 6549</span>  t0.tm_mday = 1;</div>
<div class="line"><span class="lineno"> 6550</span>  t0.tm_hour = 0;</div>
<div class="line"><span class="lineno"> 6551</span>  t0.tm_min = 0;</div>
<div class="line"><span class="lineno"> 6552</span>  t0.tm_sec = 0;</div>
<div class="line"><span class="lineno"> 6553</span> </div>
<div class="line"><span class="lineno"> 6554</span>  t1.tm_year = year - 1900;</div>
<div class="line"><span class="lineno"> 6555</span>  t1.tm_mon = mon - 1;</div>
<div class="line"><span class="lineno"> 6556</span>  t1.tm_mday = day;</div>
<div class="line"><span class="lineno"> 6557</span>  t1.tm_hour = hour;</div>
<div class="line"><span class="lineno"> 6558</span>  t1.tm_min = min;</div>
<div class="line"><span class="lineno"> 6559</span>  t1.tm_sec = sec;</div>
<div class="line"><span class="lineno"> 6560</span> </div>
<div class="line"><span class="lineno"> 6561</span>  *jsec = (double) timegm(&amp;t1) - (double) timegm(&amp;t0) + remain;</div>
<div class="line"><span class="lineno"> 6562</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14740e9d412eb3e810eb95e178be297b" name="a14740e9d412eb3e810eb95e178be297b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14740e9d412eb3e810eb95e178be297b">&#9670;&nbsp;</a></span>timer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple wall-clock timer for runtime diagnostics. </p>
<p >Provides a lightweight timing utility based on <code>omp_get_wtime()</code> to measure wall-clock durations between marked code regions. The function supports up to ten concurrent nested timers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>Name or label of the timed code section. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>Source file name (usually <code>__FILE__</code> macro). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">func</td><td>Function name (usually <code>__func__</code> macro). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">line</td><td>Source line number (usually <code>__LINE__</code> macro). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>Timer operation mode:<ul>
<li><code>1</code>: Start new timer.</li>
<li><code>2</code>: Write elapsed time since last start (without stopping).</li>
<li><code>3</code>: Write elapsed time and stop timer (pop one level).</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Each call with <code>mode == 1</code> starts a new timer instance and stores its start time and corresponding source line.</li>
<li>When <code>mode == 2</code> or <code>mode == 3</code> is called, the elapsed wall-clock time (in seconds) is computed using: <p class="formulaDsp">
\[
    \Delta t = t_{\text{now}} - t_{\text{start}}
  \]
</p>
 and written to the log via the <a class="el" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a> macro.</li>
<li>Supports nested timers (up to 10 levels). Exceeding this limit triggers a runtime error via <a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251" title="Print a log message with a specified logging level.">LOG</a>, <a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG</a>, omp_get_wtime</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The timing precision and resolution depend on the OpenMP runtime.</li>
<li>Intended for coarse profiling and diagnostic output; not thread-safe.</li>
<li>Lines reported in log messages indicate the startstop interval.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Exceeding 10 nested timers results in an error.</li>
<li>Calling <code>mode == 2</code> or <code>3</code> without a prior start causes an internal error.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06566">6566</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6571</span>            {</div>
<div class="line"><span class="lineno"> 6572</span> </div>
<div class="line"><span class="lineno"> 6573</span>  <span class="keyword">static</span> <span class="keywordtype">double</span> w0[10];</div>
<div class="line"><span class="lineno"> 6574</span> </div>
<div class="line"><span class="lineno"> 6575</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> l0[10], nt;</div>
<div class="line"><span class="lineno"> 6576</span> </div>
<div class="line"><span class="lineno"> 6577</span>  <span class="comment">/* Start new timer... */</span></div>
<div class="line"><span class="lineno"> 6578</span>  <span class="keywordflow">if</span> (mode == 1) {</div>
<div class="line"><span class="lineno"> 6579</span>    w0[nt] = omp_get_wtime();</div>
<div class="line"><span class="lineno"> 6580</span>    l0[nt] = line;</div>
<div class="line"><span class="lineno"> 6581</span>    <span class="keywordflow">if</span> ((++nt) &gt;= 10)</div>
<div class="line"><span class="lineno"> 6582</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many timers!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6583</span>  }</div>
<div class="line"><span class="lineno"> 6584</span> </div>
<div class="line"><span class="lineno"> 6585</span>  <span class="comment">/* Write elapsed time... */</span></div>
<div class="line"><span class="lineno"> 6586</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6587</span> </div>
<div class="line"><span class="lineno"> 6588</span>    <span class="comment">/* Check timer index... */</span></div>
<div class="line"><span class="lineno"> 6589</span>    <span class="keywordflow">if</span> (nt - 1 &lt; 0)</div>
<div class="line"><span class="lineno"> 6590</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Coding error!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6591</span> </div>
<div class="line"><span class="lineno"> 6592</span>    <span class="comment">/* Write elapsed time... */</span></div>
<div class="line"><span class="lineno"> 6593</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Timer &#39;%s&#39; (%s, %s, l%d-%d): %.3f sec&quot;</span>,</div>
<div class="line"><span class="lineno"> 6594</span>        name, file, func, l0[nt - 1], line, omp_get_wtime() - w0[nt - 1]);</div>
<div class="line"><span class="lineno"> 6595</span>  }</div>
<div class="line"><span class="lineno"> 6596</span> </div>
<div class="line"><span class="lineno"> 6597</span>  <span class="comment">/* Stop timer... */</span></div>
<div class="line"><span class="lineno"> 6598</span>  <span class="keywordflow">if</span> (mode == 3)</div>
<div class="line"><span class="lineno"> 6599</span>    nt--;</div>
<div class="line"><span class="lineno"> 6600</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a26be12322766162766071e8cd3587515" name="a26be12322766162766071e8cd3587515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26be12322766162766071e8cd3587515">&#9670;&nbsp;</a></span>write_atm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_atm </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write atmospheric data to a file. </p>
<p >This function writes the atmospheric dataset stored in <code>atm</code> to the file specified by <code>filename</code>, optionally prefixed by <code>dirname</code>. The output format (ASCII or binary) is selected based on the atmospheric format flag <code>ctl-&gt;atmfmt</code>. The function creates the output file, delegates the writing process to the appropriate format-specific routine, and logs summary statistics of the written atmospheric data.</p>
<p >Supported output formats:</p><ul>
<li>ASCII format (<code>ctl-&gt;atmfmt == 1</code>), written by <code><a class="el" href="jurassic_8h.html#aedaa4b13833a182bbff8034a3b2edae0" title="Write atmospheric data to an ASCII file.">write_atm_asc()</a></code></li>
<li>Binary format (<code>ctl-&gt;atmfmt == 2</code>), written by <code><a class="el" href="jurassic_8h.html#abb2306151e16b13ed93d84d379c8bb0e" title="Write atmospheric data to a binary file.">write_atm_bin()</a></code></li>
</ul>
<p >The function writes:</p><ul>
<li>Atmospheric profiles: time, altitude, longitude, latitude, pressure, temperature</li>
<li>Gas mixing ratios for each emitter (<code>ctl-&gt;ng</code>)</li>
<li>Extinction coefficients for each spectral window (<code>ctl-&gt;nw</code>)</li>
<li>Optional cloud layer or surface parameters if enabled in <code>ctl</code></li>
</ul>
<p >After writing, the function logs minimum and maximum values of the written fields for verification and diagnostic purposes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirname</td><td>Optional directory in which the output file will be created. If NULL, only <code>filename</code> is used.</td></tr>
    <tr><td class="paramname">filename</td><td>Name of the output file to be created and populated with atmospheric data.</td></tr>
    <tr><td class="paramname">ctl</td><td>Pointer to a control structure defining the output format and the sizes of gas, spectral, cloud, and surface parameter arrays.</td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure whose contents will be written. All required fields must be initialized and contain <code>atm-&gt;np</code> valid data points.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function aborts execution using <code>ERRMSG</code> if the file cannot be created or if an unsupported output format is requested.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06604">6604</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6608</span>                    {</div>
<div class="line"><span class="lineno"> 6609</span> </div>
<div class="line"><span class="lineno"> 6610</span>  FILE *out;</div>
<div class="line"><span class="lineno"> 6611</span> </div>
<div class="line"><span class="lineno"> 6612</span>  <span class="keywordtype">char</span> file[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 6613</span> </div>
<div class="line"><span class="lineno"> 6614</span>  <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 6615</span>  <span class="keywordflow">if</span> (dirname != NULL)</div>
<div class="line"><span class="lineno"> 6616</span>    sprintf(file, <span class="stringliteral">&quot;%s/%s&quot;</span>, dirname, filename);</div>
<div class="line"><span class="lineno"> 6617</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6618</span>    sprintf(file, <span class="stringliteral">&quot;%s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6619</span> </div>
<div class="line"><span class="lineno"> 6620</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6621</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write atmospheric data: %s&quot;</span>, file);</div>
<div class="line"><span class="lineno"> 6622</span> </div>
<div class="line"><span class="lineno"> 6623</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno"> 6624</span>  <span class="keywordflow">if</span> (!(out = fopen(file, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno"> 6625</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6626</span> </div>
<div class="line"><span class="lineno"> 6627</span>  <span class="comment">/* Write ASCII file... */</span></div>
<div class="line"><span class="lineno"> 6628</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0ff333a479f441f6f356f60ab0eeb577">atmfmt</a> == 1)</div>
<div class="line"><span class="lineno"> 6629</span>    <a class="code hl_function" href="jurassic_8c.html#aedaa4b13833a182bbff8034a3b2edae0">write_atm_asc</a>(out, ctl, atm);</div>
<div class="line"><span class="lineno"> 6630</span> </div>
<div class="line"><span class="lineno"> 6631</span>  <span class="comment">/* Write binary file... */</span></div>
<div class="line"><span class="lineno"> 6632</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0ff333a479f441f6f356f60ab0eeb577">atmfmt</a> == 2)</div>
<div class="line"><span class="lineno"> 6633</span>    <a class="code hl_function" href="jurassic_8c.html#abb2306151e16b13ed93d84d379c8bb0e">write_atm_bin</a>(out, ctl, atm);</div>
<div class="line"><span class="lineno"> 6634</span> </div>
<div class="line"><span class="lineno"> 6635</span>  <span class="comment">/* Error... */</span></div>
<div class="line"><span class="lineno"> 6636</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6637</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Unknown file format, check ATMFMT!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6638</span> </div>
<div class="line"><span class="lineno"> 6639</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 6640</span>  fclose(out);</div>
<div class="line"><span class="lineno"> 6641</span> </div>
<div class="line"><span class="lineno"> 6642</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6643</span>  <span class="keywordtype">double</span> mini, maxi;</div>
<div class="line"><span class="lineno"> 6644</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of data points: %d&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6645</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6646</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time range: %.2f ... %.2f s&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 6647</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6648</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Altitude range: %g ... %g km&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 6649</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6650</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 6651</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6652</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 6653</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6654</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Pressure range: %g ... %g hPa&quot;</span>, maxi, mini);</div>
<div class="line"><span class="lineno"> 6655</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6656</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Temperature range: %g ... %g K&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 6657</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 6658</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig], 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6659</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Emitter %s range: %g ... %g ppv&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig], mini, maxi);</div>
<div class="line"><span class="lineno"> 6660</span>  }</div>
<div class="line"><span class="lineno"> 6661</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++) {</div>
<div class="line"><span class="lineno"> 6662</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw], 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6663</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Extinction range (window %d): %g ... %g km^-1&quot;</span>, iw, mini, maxi);</div>
<div class="line"><span class="lineno"> 6664</span>  }</div>
<div class="line"><span class="lineno"> 6665</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &gt; 0 &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> == 0) {</div>
<div class="line"><span class="lineno"> 6666</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Cloud layer: z= %g km | dz= %g km | k= %g ... %g km^-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 6667</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[0], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> - 1]);</div>
<div class="line"><span class="lineno"> 6668</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6669</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Cloud layer: none&quot;</span>);</div>
<div class="line"><span class="lineno"> 6670</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &gt; 0 &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> == 0) {</div>
<div class="line"><span class="lineno"> 6671</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2,</div>
<div class="line"><span class="lineno"> 6672</span>        <span class="stringliteral">&quot;Surface layer: T_s = %g K | eps= %g ... %g&quot;</span>,</div>
<div class="line"><span class="lineno"> 6673</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[0], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> - 1]);</div>
<div class="line"><span class="lineno"> 6674</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6675</span>    <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Surface layer: none&quot;</span>);</div>
<div class="line"><span class="lineno"> 6676</span>}</div>
<div class="ttc" id="ajurassic_8c_html_abb2306151e16b13ed93d84d379c8bb0e"><div class="ttname"><a href="jurassic_8c.html#abb2306151e16b13ed93d84d379c8bb0e">write_atm_bin</a></div><div class="ttdeci">void write_atm_bin(FILE *out, const ctl_t *ctl, const atm_t *atm)</div><div class="ttdoc">Write atmospheric data to a binary file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06741">jurassic.c:6741</a></div></div>
<div class="ttc" id="ajurassic_8c_html_aedaa4b13833a182bbff8034a3b2edae0"><div class="ttname"><a href="jurassic_8c.html#aedaa4b13833a182bbff8034a3b2edae0">write_atm_asc</a></div><div class="ttdeci">void write_atm_asc(FILE *out, const ctl_t *ctl, const atm_t *atm)</div><div class="ttdoc">Write atmospheric data to an ASCII file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l06680">jurassic.c:6680</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a26be12322766162766071e8cd3587515_cgraph.png" border="0" usemap="#ajurassic_8h_a26be12322766162766071e8cd3587515_cgraph" alt=""/></div>
<map name="ajurassic_8h_a26be12322766162766071e8cd3587515_cgraph" id="ajurassic_8h_a26be12322766162766071e8cd3587515_cgraph">
<area shape="rect" title="Write atmospheric data to a file." alt="" coords="5,31,84,57"/>
<area shape="rect" href="jurassic_8c.html#aedaa4b13833a182bbff8034a3b2edae0" title="Write atmospheric data to an ASCII file." alt="" coords="132,5,239,32"/>
<area shape="rect" href="jurassic_8c.html#abb2306151e16b13ed93d84d379c8bb0e" title="Write atmospheric data to a binary file." alt="" coords="134,56,237,83"/>
</map>
</div>

</div>
</div>
<a id="aedaa4b13833a182bbff8034a3b2edae0" name="aedaa4b13833a182bbff8034a3b2edae0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedaa4b13833a182bbff8034a3b2edae0">&#9670;&nbsp;</a></span>write_atm_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_atm_asc </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write atmospheric data to an ASCII file. </p>
<p >This function writes the contents of an atmospheric structure <code>atm</code> to an ASCII-formatted output stream <code>out</code>. A descriptive column header is generated first, documenting the meaning, units, and ordering of each data field. Atmospheric data points are then written line by line, with optional cloud and surface layer parameters appended if they are enabled in the control structure <code>ctl</code>.</p>
<p >The output columns include, in order:</p><ol type="1">
<li>Time (seconds since 2000-01-01T00:00Z)</li>
<li>Altitude [km]</li>
<li>Longitude [deg]</li>
<li>Latitude [deg]</li>
<li>Pressure [hPa]</li>
<li>Temperature [K]</li>
</ol>
<ul>
<li>Gas/emitter mixing ratios for each species (<code>ctl-&gt;ng</code>) [ppv]</li>
<li>Extinction values for each spectral window (<code>ctl-&gt;nw</code>) [km^-1]</li>
</ul>
<p >If cloud layer properties are enabled (<code>ctl-&gt;ncl &gt; 0</code>), the following are added:</p><ul>
<li>Cloud layer height [km]</li>
<li>Cloud layer depth [km]</li>
<li>Cloud extinction values for each frequency (<code>ctl-&gt;ncl</code>) [km^-1]</li>
</ul>
<p >If surface layer properties are enabled (<code>ctl-&gt;nsf &gt; 0</code>), the following are added:</p><ul>
<li>Surface layer height [km]</li>
<li>Surface layer pressure [hPa]</li>
<li>Surface layer temperature [K]</li>
<li>Surface emissivity values (<code>ctl-&gt;nsf</code>)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>Pointer to an open output file stream where the ASCII data is written.</td></tr>
    <tr><td class="paramname">ctl</td><td>Pointer to a control structure defining the number of gases, spectral windows, and whether cloud or surface layer information should be included.</td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric structure containing the data to be written. The function writes all <code>atm-&gt;np</code> data points.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>A blank line is inserted each time the time coordinate changes, grouping data points belonging to different timestamps.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The function assumes that all arrays in <code>atm</code> are properly allocated and populated. No validation of data ranges is performed here.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06680">6680</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6683</span>                    {</div>
<div class="line"><span class="lineno"> 6684</span> </div>
<div class="line"><span class="lineno"> 6685</span>  <span class="keywordtype">int</span> n = 6;</div>
<div class="line"><span class="lineno"> 6686</span> </div>
<div class="line"><span class="lineno"> 6687</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno"> 6688</span>  fprintf(out,</div>
<div class="line"><span class="lineno"> 6689</span>          <span class="stringliteral">&quot;# $1 = time (seconds since 2000-01-01T00:00Z)\n&quot;</span></div>
<div class="line"><span class="lineno"> 6690</span>          <span class="stringliteral">&quot;# $2 = altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6691</span>          <span class="stringliteral">&quot;# $3 = longitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6692</span>          <span class="stringliteral">&quot;# $4 = latitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6693</span>          <span class="stringliteral">&quot;# $5 = pressure [hPa]\n&quot;</span> <span class="stringliteral">&quot;# $6 = temperature [K]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6694</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 6695</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = %s volume mixing ratio [ppv]\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 6696</span>            ++n, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 6697</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 6698</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = extinction (window %d) [km^-1]\n&quot;</span>, ++n, iw);</div>
<div class="line"><span class="lineno"> 6699</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 6700</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = cloud layer height [km]\n&quot;</span>, ++n);</div>
<div class="line"><span class="lineno"> 6701</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = cloud layer depth [km]\n&quot;</span>, ++n);</div>
<div class="line"><span class="lineno"> 6702</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 6703</span>      fprintf(out, <span class="stringliteral">&quot;# $%d = cloud layer extinction (%.4f cm^-1) [km^-1]\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 6704</span>              ++n, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f3c54e7d6c87fe31e3bd0f54df1fdf0">clnu</a>[icl]);</div>
<div class="line"><span class="lineno"> 6705</span>  }</div>
<div class="line"><span class="lineno"> 6706</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 6707</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = surface layer height [km]\n&quot;</span>, ++n);</div>
<div class="line"><span class="lineno"> 6708</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = surface layer pressure [hPa]\n&quot;</span>, ++n);</div>
<div class="line"><span class="lineno"> 6709</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = surface layer temperature [K]\n&quot;</span>, ++n);</div>
<div class="line"><span class="lineno"> 6710</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 6711</span>      fprintf(out, <span class="stringliteral">&quot;# $%d = surface layer emissivity (%.4f cm^-1)\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 6712</span>              ++n, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a29804fac77623ca3d1e32f92955ac501">sfnu</a>[isf]);</div>
<div class="line"><span class="lineno"> 6713</span>  }</div>
<div class="line"><span class="lineno"> 6714</span> </div>
<div class="line"><span class="lineno"> 6715</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno"> 6716</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 6717</span>    <span class="keywordflow">if</span> (ip == 0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] != atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip - 1])</div>
<div class="line"><span class="lineno"> 6718</span>      fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6719</span>    fprintf(out, <span class="stringliteral">&quot;%.2f %g %g %g %g %g&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip],</div>
<div class="line"><span class="lineno"> 6720</span>            atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip]);</div>
<div class="line"><span class="lineno"> 6721</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 6722</span>      fprintf(out, <span class="stringliteral">&quot; %g&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip]);</div>
<div class="line"><span class="lineno"> 6723</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 6724</span>      fprintf(out, <span class="stringliteral">&quot; %g&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip]);</div>
<div class="line"><span class="lineno"> 6725</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 6726</span>      fprintf(out, <span class="stringliteral">&quot; %g %g&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>);</div>
<div class="line"><span class="lineno"> 6727</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 6728</span>        fprintf(out, <span class="stringliteral">&quot; %g&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl]);</div>
<div class="line"><span class="lineno"> 6729</span>    }</div>
<div class="line"><span class="lineno"> 6730</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 6731</span>      fprintf(out, <span class="stringliteral">&quot; %g&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>);</div>
<div class="line"><span class="lineno"> 6732</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 6733</span>        fprintf(out, <span class="stringliteral">&quot; %g&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf]);</div>
<div class="line"><span class="lineno"> 6734</span>    }</div>
<div class="line"><span class="lineno"> 6735</span>    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6736</span>  }</div>
<div class="line"><span class="lineno"> 6737</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abb2306151e16b13ed93d84d379c8bb0e" name="abb2306151e16b13ed93d84d379c8bb0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb2306151e16b13ed93d84d379c8bb0e">&#9670;&nbsp;</a></span>write_atm_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_atm_bin </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write atmospheric data to a binary file. </p>
<p >This function writes the atmospheric dataset contained in <code>atm</code> to a binary file stream <code>out</code>. The output format is compact and includes a file header followed by the serialized atmospheric fields. The format is compatible with <code><a class="el" href="jurassic_8h.html#a0c68478f392d35086c456de7ce58a190" title="Read atmospheric data in binary format.">read_atm_bin()</a></code>, ensuring that files written by this function can be read back without loss of information.</p>
<p >The binary file structure written is as follows:</p><ol type="1">
<li><b>Magic identifier</b> <code>"ATM1"</code> (4 bytes)</li>
<li><b>Header integers</b> describing dataset layout:<ul>
<li>Number of gas/emitter species (<code>ctl-&gt;ng</code>)</li>
<li>Number of spectral windows (<code>ctl-&gt;nw</code>)</li>
<li>Number of cloud extinction values (<code>ctl-&gt;ncl</code>)</li>
<li>Number of surface emissivity values (<code>ctl-&gt;nsf</code>)</li>
</ul>
</li>
<li><b>Data payload</b>:<ul>
<li>Number of atmospheric points <code>np</code></li>
<li>Arrays of length <code>np</code> containing:<ul>
<li>Time</li>
<li>Altitude</li>
<li>Longitude</li>
<li>Latitude</li>
<li>Pressure</li>
<li>Temperature</li>
</ul>
</li>
<li>Gas mixing ratios for all emitters (<code>ctl-&gt;ng  np</code>)</li>
<li>Extinction coefficients for all spectral windows (<code>ctl-&gt;nw  np</code>)</li>
</ul>
</li>
<li><b>Optional parameters</b> written only if enabled in <code>ctl</code>:<ul>
<li>Cloud layer height, depth, and extinction values (<code>ctl-&gt;ncl</code>)</li>
<li>Surface temperature and emissivity values (<code>ctl-&gt;nsf</code>)</li>
</ul>
</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>Pointer to an already opened binary output file stream where the atmospheric data will be written.</td></tr>
    <tr><td class="paramname">ctl</td><td>Pointer to a control structure specifying the number of gases, spectral windows, and whether cloud or surface layer parameters must be included.</td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing values to be written. All arrays must be populated and <code>atm-&gt;np</code> must contain the number of valid atmospheric records.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function performs no range checking or validation of the <code>atm</code> contents. It assumes that the memory layout matches expectations.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The binary structure must remain consistent with <code><a class="el" href="jurassic_8h.html#a0c68478f392d35086c456de7ce58a190" title="Read atmospheric data in binary format.">read_atm_bin()</a></code>; modifying either implementation requires updating the other accordingly.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06741">6741</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6744</span>                    {</div>
<div class="line"><span class="lineno"> 6745</span> </div>
<div class="line"><span class="lineno"> 6746</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno"> 6747</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(<span class="stringliteral">&quot;ATM1&quot;</span>, <span class="keywordtype">char</span>,</div>
<div class="line"><span class="lineno"> 6748</span>         4,</div>
<div class="line"><span class="lineno"> 6749</span>         out);</div>
<div class="line"><span class="lineno"> 6750</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6751</span>         1,</div>
<div class="line"><span class="lineno"> 6752</span>         out);</div>
<div class="line"><span class="lineno"> 6753</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6754</span>         1,</div>
<div class="line"><span class="lineno"> 6755</span>         out);</div>
<div class="line"><span class="lineno"> 6756</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6757</span>         1,</div>
<div class="line"><span class="lineno"> 6758</span>         out);</div>
<div class="line"><span class="lineno"> 6759</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6760</span>         1,</div>
<div class="line"><span class="lineno"> 6761</span>         out);</div>
<div class="line"><span class="lineno"> 6762</span> </div>
<div class="line"><span class="lineno"> 6763</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno"> 6764</span>  <span class="keywordtype">size_t</span> np = (size_t) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>;</div>
<div class="line"><span class="lineno"> 6765</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;np, <span class="keywordtype">size_t</span>,</div>
<div class="line"><span class="lineno"> 6766</span>         1,</div>
<div class="line"><span class="lineno"> 6767</span>         out);</div>
<div class="line"><span class="lineno"> 6768</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6769</span>         np,</div>
<div class="line"><span class="lineno"> 6770</span>         out);</div>
<div class="line"><span class="lineno"> 6771</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6772</span>         np,</div>
<div class="line"><span class="lineno"> 6773</span>         out);</div>
<div class="line"><span class="lineno"> 6774</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6775</span>         np,</div>
<div class="line"><span class="lineno"> 6776</span>         out);</div>
<div class="line"><span class="lineno"> 6777</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6778</span>         np,</div>
<div class="line"><span class="lineno"> 6779</span>         out);</div>
<div class="line"><span class="lineno"> 6780</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6781</span>         np,</div>
<div class="line"><span class="lineno"> 6782</span>         out);</div>
<div class="line"><span class="lineno"> 6783</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6784</span>         np,</div>
<div class="line"><span class="lineno"> 6785</span>         out);</div>
<div class="line"><span class="lineno"> 6786</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 6787</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6788</span>           np,</div>
<div class="line"><span class="lineno"> 6789</span>           out);</div>
<div class="line"><span class="lineno"> 6790</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 6791</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6792</span>           np,</div>
<div class="line"><span class="lineno"> 6793</span>           out);</div>
<div class="line"><span class="lineno"> 6794</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 6795</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6796</span>           1,</div>
<div class="line"><span class="lineno"> 6797</span>           out);</div>
<div class="line"><span class="lineno"> 6798</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6799</span>           1,</div>
<div class="line"><span class="lineno"> 6800</span>           out);</div>
<div class="line"><span class="lineno"> 6801</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6802</span>             (<span class="keywordtype">size_t</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>,</div>
<div class="line"><span class="lineno"> 6803</span>           out);</div>
<div class="line"><span class="lineno"> 6804</span>  }</div>
<div class="line"><span class="lineno"> 6805</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 6806</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6807</span>           1,</div>
<div class="line"><span class="lineno"> 6808</span>           out);</div>
<div class="line"><span class="lineno"> 6809</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 6810</span>             (<span class="keywordtype">size_t</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>,</div>
<div class="line"><span class="lineno"> 6811</span>           out);</div>
<div class="line"><span class="lineno"> 6812</span>  }</div>
<div class="line"><span class="lineno"> 6813</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a675d14cbd1ae26f72e86f828d8367240" name="a675d14cbd1ae26f72e86f828d8367240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a675d14cbd1ae26f72e86f828d8367240">&#9670;&nbsp;</a></span>write_atm_rfm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_atm_rfm </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write atmospheric profile in RFM-compatible format. </p>
<p >Exports the current atmospheric state to a file formatted for use with the Reference Forward Model (RFM). The file includes altitude, pressure, temperature, and volume mixing ratio profiles for each active emitter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Output file name for the RFM atmosphere file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure defining active emitters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Pointer to the atmospheric profile to export.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Produces a plain-text RFM atmosphere file with the following sections: <div class="fragment"><div class="line">NLAYERS</div>
<div class="line">*HGT [km]</div>
<div class="line">&lt;altitude_1&gt;</div>
<div class="line">...</div>
<div class="line">*PRE [mb]</div>
<div class="line">&lt;pressure_1&gt;</div>
<div class="line">...</div>
<div class="line">*TEM [K]</div>
<div class="line">&lt;temperature_1&gt;</div>
<div class="line">...</div>
<div class="line">*&lt;EMITTER&gt; [ppmv]</div>
<div class="line">&lt;mixing_ratio_1&gt;</div>
<div class="line">...</div>
<div class="line">*END</div>
</div><!-- fragment --></li>
<li>The first line specifies the number of vertical layers (<code>atm-&gt;np</code>).</li>
<li>Each subsequent block begins with a keyword (e.g., <code>*HGT</code>, <code>*PRE</code>, etc.) and lists one value per line.</li>
<li>Mixing ratios are converted from parts per volume (ppv) to parts per million (ppmv).</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aa4a7b8ec913874ba418cfb4280fd3b84" title="Read atmospheric input data from a file.">read_atm</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Compatible with the RFM ATM input file format.</li>
<li>Units:<ul>
<li>Altitude in kilometers [km]</li>
<li>Pressure in millibars [mb]</li>
<li>Temperature in Kelvin [K]</li>
<li>Mixing ratios in parts per million by volume [ppmv]</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Existing files with the same name will be overwritten.</li>
<li>The function assumes consistent vertical ordering (surface  top of atmosphere).</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06817">6817</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6820</span>                    {</div>
<div class="line"><span class="lineno"> 6821</span> </div>
<div class="line"><span class="lineno"> 6822</span>  FILE *out;</div>
<div class="line"><span class="lineno"> 6823</span> </div>
<div class="line"><span class="lineno"> 6824</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6825</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write RFM data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6826</span> </div>
<div class="line"><span class="lineno"> 6827</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno"> 6828</span>  <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno"> 6829</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6830</span> </div>
<div class="line"><span class="lineno"> 6831</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno"> 6832</span>  fprintf(out, <span class="stringliteral">&quot;%d\n&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6833</span>  fprintf(out, <span class="stringliteral">&quot;*HGT [km]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6834</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 6835</span>    fprintf(out, <span class="stringliteral">&quot;%g\n&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip]);</div>
<div class="line"><span class="lineno"> 6836</span>  fprintf(out, <span class="stringliteral">&quot;*PRE [mb]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6837</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 6838</span>    fprintf(out, <span class="stringliteral">&quot;%g\n&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 6839</span>  fprintf(out, <span class="stringliteral">&quot;*TEM [K]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6840</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 6841</span>    fprintf(out, <span class="stringliteral">&quot;%g\n&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip]);</div>
<div class="line"><span class="lineno"> 6842</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 6843</span>    fprintf(out, <span class="stringliteral">&quot;*%s [ppmv]\n&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 6844</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 6845</span>      fprintf(out, <span class="stringliteral">&quot;%g\n&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip] * 1e6);</div>
<div class="line"><span class="lineno"> 6846</span>  }</div>
<div class="line"><span class="lineno"> 6847</span>  fprintf(out, <span class="stringliteral">&quot;*END\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6848</span> </div>
<div class="line"><span class="lineno"> 6849</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 6850</span>  fclose(out);</div>
<div class="line"><span class="lineno"> 6851</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4d82cfc384f2845f2bd5ebbe66b6b26" name="ae4d82cfc384f2845f2bd5ebbe66b6b26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d82cfc384f2845f2bd5ebbe66b6b26">&#9670;&nbsp;</a></span>write_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_matrix </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_matrix *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>rowspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>colspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a fully annotated matrix (e.g., Jacobian or gain matrix) to file. </p>
<p >Outputs a numerical matrix along with detailed metadata describing the row and column spaces. Depending on configuration, the rows and columns may correspond to measurement or state variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirname</td><td>Output directory path (may be <code>NULL</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Output file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to control structure defining model setup and metadata. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">matrix</td><td>Pointer to GSL matrix to write (e.g., Jacobian, kernel, or covariance). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Pointer to atmospheric data structure (used when state-space indexing applies). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs</td><td>Pointer to observation data structure (used when measurement-space indexing applies). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowspace</td><td>Selects row labeling: <code>"y"</code> = measurement space, otherwise state space. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colspace</td><td>Selects column labeling: <code>"y"</code> = measurement space, otherwise state space. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sort</td><td>Determines writing order: <code>"r"</code> = row-major, otherwise column-major.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>This routine writes one matrix element per line, including descriptive metadata: <div class="fragment"><div class="line">RowIndex RowMeta... ColIndex ColMeta... MatrixValue</div>
</div><!-- fragment --></li>
<li>The row and column metadata differ depending on space selection:<ul>
<li>**Measurement space (&lsquo;'y&rsquo;`)**:<ul>
<li>Channel wavenumber [cm]</li>
<li>Observation time [s since 2000-01-01T00:00Z]</li>
<li>View point altitude [km], longitude [], latitude []</li>
</ul>
</li>
<li><b>State space</b>:<ul>
<li>Quantity name (e.g., TEMPERATURE, H2O)</li>
<li>Time, altitude, longitude, latitude of the profile point</li>
</ul>
</li>
</ul>
</li>
<li>The header clearly documents all output columns for traceability.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a1380c5f839b8a1cca792a83de445a4b3" title="Read a numerical matrix from an ASCII file.">read_matrix</a>, <a class="el" href="jurassic_8h.html#ab49799958d13e57af5b20527f0990ce6" title="Compute the Jacobian (kernel) matrix by finite differences.">kernel</a>, <a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x</a>, <a class="el" href="jurassic_8h.html#ad6380c9458cf356667952f9651932e27" title="Convert observation radiances into a measurement vector.">obs2y</a>, <a class="el" href="jurassic_8h.html#a342f4954ef3678480cae2efb366a7b3e" title="Convert a quantity index to a descriptive name string.">idx2name</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function respects <code>ctl-&gt;write_matrix</code>  output is skipped if disabled.</li>
<li>Output is human-readable and can be post-processed using external tools (e.g., Python, MATLAB, GNU Octave).</li>
<li>Typically used for writing Jacobians, gain matrices, or averaging kernels.</li>
<li>Matrix orientation can be changed with <code>sort</code> to support row-major or column-major output.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Large matrices may produce very large output files.</li>
<li>Memory allocation is performed for temporary indexing arrays; ensure sufficient resources for large N, M.</li>
<li>The function overwrites existing files without confirmation.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l06855">6855</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6864</span>                    {</div>
<div class="line"><span class="lineno"> 6865</span> </div>
<div class="line"><span class="lineno"> 6866</span>  FILE *out;</div>
<div class="line"><span class="lineno"> 6867</span> </div>
<div class="line"><span class="lineno"> 6868</span>  <span class="keywordtype">char</span> file[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], quantity[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 6869</span> </div>
<div class="line"><span class="lineno"> 6870</span>  <span class="keywordtype">int</span> *cida, *ciqa, *cipa, *cira, *rida, *riqa, *ripa, *rira;</div>
<div class="line"><span class="lineno"> 6871</span> </div>
<div class="line"><span class="lineno"> 6872</span>  <span class="keywordtype">size_t</span> i, j, nc, nr;</div>
<div class="line"><span class="lineno"> 6873</span> </div>
<div class="line"><span class="lineno"> 6874</span>  <span class="comment">/* Check output flag... */</span></div>
<div class="line"><span class="lineno"> 6875</span>  <span class="keywordflow">if</span> (!ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a090c906958cc2f98fff69d4cc7c0f40c">write_matrix</a>)</div>
<div class="line"><span class="lineno"> 6876</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 6877</span> </div>
<div class="line"><span class="lineno"> 6878</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 6879</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(cida, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6880</span>        <a class="code hl_define" href="jurassic_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a>);</div>
<div class="line"><span class="lineno"> 6881</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(ciqa, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6882</span>        <a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><span class="lineno"> 6883</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(cipa, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6884</span>        <a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><span class="lineno"> 6885</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(cira, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6886</span>        <a class="code hl_define" href="jurassic_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a>);</div>
<div class="line"><span class="lineno"> 6887</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rida, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6888</span>        <a class="code hl_define" href="jurassic_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a>);</div>
<div class="line"><span class="lineno"> 6889</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(riqa, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6890</span>        <a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><span class="lineno"> 6891</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(ripa, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6892</span>        <a class="code hl_define" href="jurassic_8h.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><span class="lineno"> 6893</span>  <a class="code hl_define" href="jurassic_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rira, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 6894</span>        <a class="code hl_define" href="jurassic_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a>);</div>
<div class="line"><span class="lineno"> 6895</span> </div>
<div class="line"><span class="lineno"> 6896</span>  <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 6897</span>  <span class="keywordflow">if</span> (dirname != NULL)</div>
<div class="line"><span class="lineno"> 6898</span>    sprintf(file, <span class="stringliteral">&quot;%s/%s&quot;</span>, dirname, filename);</div>
<div class="line"><span class="lineno"> 6899</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6900</span>    sprintf(file, <span class="stringliteral">&quot;%s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6901</span> </div>
<div class="line"><span class="lineno"> 6902</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6903</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write matrix: %s&quot;</span>, file);</div>
<div class="line"><span class="lineno"> 6904</span> </div>
<div class="line"><span class="lineno"> 6905</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno"> 6906</span>  <span class="keywordflow">if</span> (!(out = fopen(file, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno"> 6907</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6908</span> </div>
<div class="line"><span class="lineno"> 6909</span>  <span class="comment">/* Write header (row space)... */</span></div>
<div class="line"><span class="lineno"> 6910</span>  <span class="keywordflow">if</span> (rowspace[0] == <span class="charliteral">&#39;y&#39;</span>) {</div>
<div class="line"><span class="lineno"> 6911</span> </div>
<div class="line"><span class="lineno"> 6912</span>    fprintf(out,</div>
<div class="line"><span class="lineno"> 6913</span>            <span class="stringliteral">&quot;# $1 = Row: index (measurement space)\n&quot;</span></div>
<div class="line"><span class="lineno"> 6914</span>            <span class="stringliteral">&quot;# $2 = Row: channel wavenumber [cm^-1]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6915</span>            <span class="stringliteral">&quot;# $3 = Row: time (seconds since 2000-01-01T00:00Z)\n&quot;</span></div>
<div class="line"><span class="lineno"> 6916</span>            <span class="stringliteral">&quot;# $4 = Row: view point altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6917</span>            <span class="stringliteral">&quot;# $5 = Row: view point longitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6918</span>            <span class="stringliteral">&quot;# $6 = Row: view point latitude [deg]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6919</span> </div>
<div class="line"><span class="lineno"> 6920</span>    <span class="comment">/* Get number of rows... */</span></div>
<div class="line"><span class="lineno"> 6921</span>    nr = <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, obs, NULL, rida, rira);</div>
<div class="line"><span class="lineno"> 6922</span> </div>
<div class="line"><span class="lineno"> 6923</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6924</span> </div>
<div class="line"><span class="lineno"> 6925</span>    fprintf(out,</div>
<div class="line"><span class="lineno"> 6926</span>            <span class="stringliteral">&quot;# $1 = Row: index (state space)\n&quot;</span></div>
<div class="line"><span class="lineno"> 6927</span>            <span class="stringliteral">&quot;# $2 = Row: name of quantity\n&quot;</span></div>
<div class="line"><span class="lineno"> 6928</span>            <span class="stringliteral">&quot;# $3 = Row: time (seconds since 2000-01-01T00:00Z)\n&quot;</span></div>
<div class="line"><span class="lineno"> 6929</span>            <span class="stringliteral">&quot;# $4 = Row: altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6930</span>            <span class="stringliteral">&quot;# $5 = Row: longitude [deg]\n&quot;</span> <span class="stringliteral">&quot;# $6 = Row: latitude [deg]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6931</span> </div>
<div class="line"><span class="lineno"> 6932</span>    <span class="comment">/* Get number of rows... */</span></div>
<div class="line"><span class="lineno"> 6933</span>    nr = <a class="code hl_function" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x</a>(ctl, atm, NULL, riqa, ripa);</div>
<div class="line"><span class="lineno"> 6934</span>  }</div>
<div class="line"><span class="lineno"> 6935</span> </div>
<div class="line"><span class="lineno"> 6936</span>  <span class="comment">/* Write header (column space)... */</span></div>
<div class="line"><span class="lineno"> 6937</span>  <span class="keywordflow">if</span> (colspace[0] == <span class="charliteral">&#39;y&#39;</span>) {</div>
<div class="line"><span class="lineno"> 6938</span> </div>
<div class="line"><span class="lineno"> 6939</span>    fprintf(out,</div>
<div class="line"><span class="lineno"> 6940</span>            <span class="stringliteral">&quot;# $7 = Col: index (measurement space)\n&quot;</span></div>
<div class="line"><span class="lineno"> 6941</span>            <span class="stringliteral">&quot;# $8 = Col: channel wavenumber [cm^-1]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6942</span>            <span class="stringliteral">&quot;# $9 = Col: time (seconds since 2000-01-01T00:00Z)\n&quot;</span></div>
<div class="line"><span class="lineno"> 6943</span>            <span class="stringliteral">&quot;# $10 = Col: view point altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6944</span>            <span class="stringliteral">&quot;# $11 = Col: view point longitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6945</span>            <span class="stringliteral">&quot;# $12 = Col: view point latitude [deg]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6946</span> </div>
<div class="line"><span class="lineno"> 6947</span>    <span class="comment">/* Get number of columns... */</span></div>
<div class="line"><span class="lineno"> 6948</span>    nc = <a class="code hl_function" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27">obs2y</a>(ctl, obs, NULL, cida, cira);</div>
<div class="line"><span class="lineno"> 6949</span> </div>
<div class="line"><span class="lineno"> 6950</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6951</span> </div>
<div class="line"><span class="lineno"> 6952</span>    fprintf(out,</div>
<div class="line"><span class="lineno"> 6953</span>            <span class="stringliteral">&quot;# $7 = Col: index (state space)\n&quot;</span></div>
<div class="line"><span class="lineno"> 6954</span>            <span class="stringliteral">&quot;# $8 = Col: name of quantity\n&quot;</span></div>
<div class="line"><span class="lineno"> 6955</span>            <span class="stringliteral">&quot;# $9 = Col: time (seconds since 2000-01-01T00:00Z)\n&quot;</span></div>
<div class="line"><span class="lineno"> 6956</span>            <span class="stringliteral">&quot;# $10 = Col: altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno"> 6957</span>            <span class="stringliteral">&quot;# $11 = Col: longitude [deg]\n&quot;</span> <span class="stringliteral">&quot;# $12 = Col: latitude [deg]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6958</span> </div>
<div class="line"><span class="lineno"> 6959</span>    <span class="comment">/* Get number of columns... */</span></div>
<div class="line"><span class="lineno"> 6960</span>    nc = <a class="code hl_function" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b">atm2x</a>(ctl, atm, NULL, ciqa, cipa);</div>
<div class="line"><span class="lineno"> 6961</span>  }</div>
<div class="line"><span class="lineno"> 6962</span> </div>
<div class="line"><span class="lineno"> 6963</span>  <span class="comment">/* Write header entry... */</span></div>
<div class="line"><span class="lineno"> 6964</span>  fprintf(out, <span class="stringliteral">&quot;# $13 = Matrix element\n\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 6965</span> </div>
<div class="line"><span class="lineno"> 6966</span>  <span class="comment">/* Write matrix data... */</span></div>
<div class="line"><span class="lineno"> 6967</span>  i = j = 0;</div>
<div class="line"><span class="lineno"> 6968</span>  <span class="keywordflow">while</span> (i &lt; nr &amp;&amp; j &lt; nc) {</div>
<div class="line"><span class="lineno"> 6969</span> </div>
<div class="line"><span class="lineno"> 6970</span>    <span class="comment">/* Write info about the row... */</span></div>
<div class="line"><span class="lineno"> 6971</span>    <span class="keywordflow">if</span> (rowspace[0] == <span class="charliteral">&#39;y&#39;</span>)</div>
<div class="line"><span class="lineno"> 6972</span>      fprintf(out, <span class="stringliteral">&quot;%d %.4f %.2f %g %g %g&quot;</span>,</div>
<div class="line"><span class="lineno"> 6973</span>              (<span class="keywordtype">int</span>) i, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[rida[i]],</div>
<div class="line"><span class="lineno"> 6974</span>              obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>[rira[i]], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[rira[i]],</div>
<div class="line"><span class="lineno"> 6975</span>              obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>[rira[i]], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>[rira[i]]);</div>
<div class="line"><span class="lineno"> 6976</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6977</span>      <a class="code hl_function" href="jurassic_8c.html#a342f4954ef3678480cae2efb366a7b3e">idx2name</a>(ctl, riqa[i], quantity);</div>
<div class="line"><span class="lineno"> 6978</span>      fprintf(out, <span class="stringliteral">&quot;%d %s %.2f %g %g %g&quot;</span>, (<span class="keywordtype">int</span>) i, quantity,</div>
<div class="line"><span class="lineno"> 6979</span>              atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ripa[i]], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ripa[i]],</div>
<div class="line"><span class="lineno"> 6980</span>              atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ripa[i]], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ripa[i]]);</div>
<div class="line"><span class="lineno"> 6981</span>    }</div>
<div class="line"><span class="lineno"> 6982</span> </div>
<div class="line"><span class="lineno"> 6983</span>    <span class="comment">/* Write info about the column... */</span></div>
<div class="line"><span class="lineno"> 6984</span>    <span class="keywordflow">if</span> (colspace[0] == <span class="charliteral">&#39;y&#39;</span>)</div>
<div class="line"><span class="lineno"> 6985</span>      fprintf(out, <span class="stringliteral">&quot; %d %.4f %.2f %g %g %g&quot;</span>,</div>
<div class="line"><span class="lineno"> 6986</span>              (<span class="keywordtype">int</span>) j, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[cida[j]],</div>
<div class="line"><span class="lineno"> 6987</span>              obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>[cira[j]], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[cira[j]],</div>
<div class="line"><span class="lineno"> 6988</span>              obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>[cira[j]], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>[cira[j]]);</div>
<div class="line"><span class="lineno"> 6989</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6990</span>      <a class="code hl_function" href="jurassic_8c.html#a342f4954ef3678480cae2efb366a7b3e">idx2name</a>(ctl, ciqa[j], quantity);</div>
<div class="line"><span class="lineno"> 6991</span>      fprintf(out, <span class="stringliteral">&quot; %d %s %.2f %g %g %g&quot;</span>, (<span class="keywordtype">int</span>) j, quantity,</div>
<div class="line"><span class="lineno"> 6992</span>              atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[cipa[j]], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[cipa[j]],</div>
<div class="line"><span class="lineno"> 6993</span>              atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[cipa[j]], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[cipa[j]]);</div>
<div class="line"><span class="lineno"> 6994</span>    }</div>
<div class="line"><span class="lineno"> 6995</span> </div>
<div class="line"><span class="lineno"> 6996</span>    <span class="comment">/* Write matrix entry... */</span></div>
<div class="line"><span class="lineno"> 6997</span>    fprintf(out, <span class="stringliteral">&quot; %g\n&quot;</span>, gsl_matrix_get(matrix, i, j));</div>
<div class="line"><span class="lineno"> 6998</span> </div>
<div class="line"><span class="lineno"> 6999</span>    <span class="comment">/* Set matrix indices... */</span></div>
<div class="line"><span class="lineno"> 7000</span>    <span class="keywordflow">if</span> (sort[0] == <span class="charliteral">&#39;r&#39;</span>) {</div>
<div class="line"><span class="lineno"> 7001</span>      j++;</div>
<div class="line"><span class="lineno"> 7002</span>      <span class="keywordflow">if</span> (j &gt;= nc) {</div>
<div class="line"><span class="lineno"> 7003</span>        j = 0;</div>
<div class="line"><span class="lineno"> 7004</span>        i++;</div>
<div class="line"><span class="lineno"> 7005</span>        fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7006</span>      }</div>
<div class="line"><span class="lineno"> 7007</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7008</span>      i++;</div>
<div class="line"><span class="lineno"> 7009</span>      <span class="keywordflow">if</span> (i &gt;= nr) {</div>
<div class="line"><span class="lineno"> 7010</span>        i = 0;</div>
<div class="line"><span class="lineno"> 7011</span>        j++;</div>
<div class="line"><span class="lineno"> 7012</span>        fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7013</span>      }</div>
<div class="line"><span class="lineno"> 7014</span>    }</div>
<div class="line"><span class="lineno"> 7015</span>  }</div>
<div class="line"><span class="lineno"> 7016</span> </div>
<div class="line"><span class="lineno"> 7017</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7018</span>  fclose(out);</div>
<div class="line"><span class="lineno"> 7019</span> </div>
<div class="line"><span class="lineno"> 7020</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 7021</span>  free(cida);</div>
<div class="line"><span class="lineno"> 7022</span>  free(ciqa);</div>
<div class="line"><span class="lineno"> 7023</span>  free(cipa);</div>
<div class="line"><span class="lineno"> 7024</span>  free(cira);</div>
<div class="line"><span class="lineno"> 7025</span>  free(rida);</div>
<div class="line"><span class="lineno"> 7026</span>  free(riqa);</div>
<div class="line"><span class="lineno"> 7027</span>  free(ripa);</div>
<div class="line"><span class="lineno"> 7028</span>  free(rira);</div>
<div class="line"><span class="lineno"> 7029</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a342f4954ef3678480cae2efb366a7b3e"><div class="ttname"><a href="jurassic_8c.html#a342f4954ef3678480cae2efb366a7b3e">idx2name</a></div><div class="ttdeci">void idx2name(const ctl_t *ctl, const int idx, char *quantity)</div><div class="ttdoc">Convert a quantity index to a descriptive name string.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l03933">jurassic.c:3933</a></div></div>
<div class="ttc" id="ajurassic_8h_html_a52037c938e3c1b126c6277da5ca689d0"><div class="ttname"><a href="jurassic_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a></div><div class="ttdeci">#define M</div><div class="ttdoc">Maximum size of measurement vector.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l00272">jurassic.h:272</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_ae4d82cfc384f2845f2bd5ebbe66b6b26_cgraph.png" border="0" usemap="#ajurassic_8h_ae4d82cfc384f2845f2bd5ebbe66b6b26_cgraph" alt=""/></div>
<map name="ajurassic_8h_ae4d82cfc384f2845f2bd5ebbe66b6b26_cgraph" id="ajurassic_8h_ae4d82cfc384f2845f2bd5ebbe66b6b26_cgraph">
<area shape="rect" title="Write a fully annotated matrix (e.g., Jacobian or gain matrix) to file." alt="" coords="5,56,97,83"/>
<area shape="rect" href="jurassic_8c.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements." alt="" coords="155,5,213,32"/>
<area shape="rect" href="jurassic_8c.html#a342f4954ef3678480cae2efb366a7b3e" title="Convert a quantity index to a descriptive name string." alt="" coords="145,56,223,83"/>
<area shape="rect" href="jurassic_8c.html#ad6380c9458cf356667952f9651932e27" title="Convert observation radiances into a measurement vector." alt="" coords="156,107,212,133"/>
<area shape="rect" href="jurassic_8c.html#a5ac332e50178e5439e72634fe03d191f" title="Append a single atmospheric value to the state vector." alt="" coords="271,5,359,32"/>
</map>
</div>

</div>
</div>
<a id="aaa92bd5536bbf6cb6b4f541e24dac461" name="aaa92bd5536bbf6cb6b4f541e24dac461"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa92bd5536bbf6cb6b4f541e24dac461">&#9670;&nbsp;</a></span>write_obs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_obs </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write observation data to an output file in ASCII or binary format. </p>
<p >This C function constructs the full output file path from the provided directory and filename, opens the file for writing, and exports the contents of the <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a> structure in either ASCII or binary format, depending on the observation format specified by <code>ctl-&gt;obsfmt</code>. The actual writing of formatted data is delegated to <a class="el" href="jurassic_8h.html#a78c1bf52aacddbf614a0c254868195f6" title="Write observation data to an ASCII text file.">write_obs_asc()</a> or <a class="el" href="jurassic_8h.html#a3c5b6b84f5c15574a22021a17a6afdca" title="Write observation data in binary format to an output file stream.">write_obs_bin()</a>.</p>
<p >After writing, the function prints diagnostic information showing ranges of times, observer coordinates, view point coordinates, tangent point coordinates, radiance or brightness temperature values (depending on <code>ctl-&gt;write_bbt</code>), and transmittances. These diagnostics provide useful verification that the output data is valid and consistent.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirname</td><td>Optional directory path. If NULL, only <code>filename</code> is used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Name of the output observation file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure specifying output format, spectral channel configuration, and brightness-temperature mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs</td><td>Observation structure containing the data to be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is a C function. The output file is always overwritten if it already exists.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The routine aborts with an error message if the output file cannot be created, or if <code>ctl-&gt;obsfmt</code> specifies an unsupported format.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a78c1bf52aacddbf614a0c254868195f6" title="Write observation data to an ASCII text file.">write_obs_asc()</a>, <a class="el" href="jurassic_8h.html#a3c5b6b84f5c15574a22021a17a6afdca" title="Write observation data in binary format to an output file stream.">write_obs_bin()</a>, <a class="el" href="jurassic_8h.html#aa92ca8109106ef5912a265d7c882038d" title="Read observation data from an input file.">read_obs()</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07033">7033</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7037</span>                    {</div>
<div class="line"><span class="lineno"> 7038</span> </div>
<div class="line"><span class="lineno"> 7039</span>  FILE *out;</div>
<div class="line"><span class="lineno"> 7040</span> </div>
<div class="line"><span class="lineno"> 7041</span>  <span class="keywordtype">char</span> file[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 7042</span> </div>
<div class="line"><span class="lineno"> 7043</span>  <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 7044</span>  <span class="keywordflow">if</span> (dirname != NULL)</div>
<div class="line"><span class="lineno"> 7045</span>    sprintf(file, <span class="stringliteral">&quot;%s/%s&quot;</span>, dirname, filename);</div>
<div class="line"><span class="lineno"> 7046</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7047</span>    sprintf(file, <span class="stringliteral">&quot;%s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 7048</span> </div>
<div class="line"><span class="lineno"> 7049</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7050</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write observation data: %s&quot;</span>, file);</div>
<div class="line"><span class="lineno"> 7051</span> </div>
<div class="line"><span class="lineno"> 7052</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno"> 7053</span>  <span class="keywordflow">if</span> (!(out = fopen(file, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno"> 7054</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7055</span> </div>
<div class="line"><span class="lineno"> 7056</span>  <span class="comment">/* Write ASCII data... */</span></div>
<div class="line"><span class="lineno"> 7057</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab313bb0c5f05e01cdda367977c39f29a">obsfmt</a> == 1)</div>
<div class="line"><span class="lineno"> 7058</span>    <a class="code hl_function" href="jurassic_8c.html#a78c1bf52aacddbf614a0c254868195f6">write_obs_asc</a>(out, ctl, obs);</div>
<div class="line"><span class="lineno"> 7059</span> </div>
<div class="line"><span class="lineno"> 7060</span>  <span class="comment">/* Write binary data... */</span></div>
<div class="line"><span class="lineno"> 7061</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab313bb0c5f05e01cdda367977c39f29a">obsfmt</a> == 2)</div>
<div class="line"><span class="lineno"> 7062</span>    <a class="code hl_function" href="jurassic_8c.html#a3c5b6b84f5c15574a22021a17a6afdca">write_obs_bin</a>(out, ctl, obs);</div>
<div class="line"><span class="lineno"> 7063</span> </div>
<div class="line"><span class="lineno"> 7064</span>  <span class="comment">/* Error... */</span></div>
<div class="line"><span class="lineno"> 7065</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7066</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Unknown observation file format, check OBSFMT!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7067</span> </div>
<div class="line"><span class="lineno"> 7068</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7069</span>  fclose(out);</div>
<div class="line"><span class="lineno"> 7070</span> </div>
<div class="line"><span class="lineno"> 7071</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7072</span>  <span class="keywordtype">double</span> mini, maxi;</div>
<div class="line"><span class="lineno"> 7073</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of ray paths: %d&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7074</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7075</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time range: %.2f ... %.2f s&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7076</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7077</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Observer altitude range: %g ... %g km&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7078</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7079</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Observer longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7080</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7081</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Observer latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7082</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7083</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;View point altitude range: %g ... %g km&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7084</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7085</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;View point longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7086</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7087</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;View point latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7088</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7089</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Tangent point altitude range: %g ... %g km&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7090</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7091</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Tangent point longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7092</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>, 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7093</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Tangent point latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 7094</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 7095</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>], 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7096</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af700a5fe670e013c550494cee733b60c">write_bbt</a>) {</div>
<div class="line"><span class="lineno"> 7097</span>      <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Brightness temperature (%.4f cm^-1) range: %g ... %g K&quot;</span>,</div>
<div class="line"><span class="lineno"> 7098</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], mini, maxi);</div>
<div class="line"><span class="lineno"> 7099</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7100</span>      <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Radiance (%.4f cm^-1) range: %g ... %g W/(m^2 sr cm^-1)&quot;</span>,</div>
<div class="line"><span class="lineno"> 7101</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], mini, maxi);</div>
<div class="line"><span class="lineno"> 7102</span>    }</div>
<div class="line"><span class="lineno"> 7103</span>  }</div>
<div class="line"><span class="lineno"> 7104</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 7105</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[<span class="keywordtype">id</span>], 1, (<span class="keywordtype">size_t</span>) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>);</div>
<div class="line"><span class="lineno"> 7106</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af700a5fe670e013c550494cee733b60c">write_bbt</a>) {</div>
<div class="line"><span class="lineno"> 7107</span>      <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Transmittance (%.4f cm^-1) range: %g ... %g&quot;</span>,</div>
<div class="line"><span class="lineno"> 7108</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], mini, maxi);</div>
<div class="line"><span class="lineno"> 7109</span>    }</div>
<div class="line"><span class="lineno"> 7110</span>  }</div>
<div class="line"><span class="lineno"> 7111</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a3c5b6b84f5c15574a22021a17a6afdca"><div class="ttname"><a href="jurassic_8c.html#a3c5b6b84f5c15574a22021a17a6afdca">write_obs_bin</a></div><div class="ttdeci">void write_obs_bin(FILE *out, const ctl_t *ctl, const obs_t *obs)</div><div class="ttdoc">Write observation data in binary format to an output file stream.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07163">jurassic.c:7163</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a78c1bf52aacddbf614a0c254868195f6"><div class="ttname"><a href="jurassic_8c.html#a78c1bf52aacddbf614a0c254868195f6">write_obs_asc</a></div><div class="ttdeci">void write_obs_asc(FILE *out, const ctl_t *ctl, const obs_t *obs)</div><div class="ttdoc">Write observation data to an ASCII text file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07115">jurassic.c:7115</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_aaa92bd5536bbf6cb6b4f541e24dac461_cgraph.png" border="0" usemap="#ajurassic_8h_aaa92bd5536bbf6cb6b4f541e24dac461_cgraph" alt=""/></div>
<map name="ajurassic_8h_aaa92bd5536bbf6cb6b4f541e24dac461_cgraph" id="ajurassic_8h_aaa92bd5536bbf6cb6b4f541e24dac461_cgraph">
<area shape="rect" title="Write observation data to an output file in ASCII or binary format." alt="" coords="5,31,84,57"/>
<area shape="rect" href="jurassic_8c.html#a78c1bf52aacddbf614a0c254868195f6" title="Write observation data to an ASCII text file." alt="" coords="132,5,239,32"/>
<area shape="rect" href="jurassic_8c.html#a3c5b6b84f5c15574a22021a17a6afdca" title="Write observation data in binary format to an output file stream." alt="" coords="134,56,237,83"/>
</map>
</div>

</div>
</div>
<a id="a78c1bf52aacddbf614a0c254868195f6" name="a78c1bf52aacddbf614a0c254868195f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78c1bf52aacddbf614a0c254868195f6">&#9670;&nbsp;</a></span>write_obs_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_obs_asc </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write observation data to an ASCII text file. </p>
<p >This C function writes the contents of the <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a> observation structure as human-readable ASCII text to the given output stream. It first prints a descriptive header that documents each column of the output format, including observation time, observer and view geometry, tangent point information, and spectral values. The number and meaning of spectral fields depend on <code>ctl-&gt;nd</code> and whether brightness temperature output is enabled via <code>ctl-&gt;write_bbt</code>.</p>
<p >The function then writes one line of data per ray path, including the base geometric information followed by radiance or brightness temperature values and transmittances for each spectral channel. Blank lines are inserted whenever the time stamp changes, providing visual separation of distinct observation groups.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">out</td><td>Output file stream opened in text mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure specifying the number of spectral channels (<code>nd</code>), wavenumbers (<code>nu</code>), and output mode (<code>write_bbt</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs</td><td>Observation structure containing the data to be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is a C routine that produces plain-text output intended for inspection, debugging, and compatibility with external processing tools.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The caller must ensure that <code>out</code> is valid and writable. No attempt is made to reopen or validate the file stream.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aaa92bd5536bbf6cb6b4f541e24dac461" title="Write observation data to an output file in ASCII or binary format.">write_obs()</a>, <a class="el" href="jurassic_8h.html#a3c5b6b84f5c15574a22021a17a6afdca" title="Write observation data in binary format to an output file stream.">write_obs_bin()</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07115">7115</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7118</span>                    {</div>
<div class="line"><span class="lineno"> 7119</span> </div>
<div class="line"><span class="lineno"> 7120</span>  <span class="keywordtype">int</span> n = 10;</div>
<div class="line"><span class="lineno"> 7121</span> </div>
<div class="line"><span class="lineno"> 7122</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno"> 7123</span>  fprintf(out,</div>
<div class="line"><span class="lineno"> 7124</span>          <span class="stringliteral">&quot;# $1 = time (seconds since 2000-01-01T00:00Z)\n&quot;</span></div>
<div class="line"><span class="lineno"> 7125</span>          <span class="stringliteral">&quot;# $2 = observer altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7126</span>          <span class="stringliteral">&quot;# $3 = observer longitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7127</span>          <span class="stringliteral">&quot;# $4 = observer latitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7128</span>          <span class="stringliteral">&quot;# $5 = view point altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7129</span>          <span class="stringliteral">&quot;# $6 = view point longitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7130</span>          <span class="stringliteral">&quot;# $7 = view point latitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7131</span>          <span class="stringliteral">&quot;# $8 = tangent point altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7132</span>          <span class="stringliteral">&quot;# $9 = tangent point longitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7133</span>          <span class="stringliteral">&quot;# $10 = tangent point latitude [deg]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7134</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 7135</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af700a5fe670e013c550494cee733b60c">write_bbt</a>)</div>
<div class="line"><span class="lineno"> 7136</span>      fprintf(out, <span class="stringliteral">&quot;# $%d = brightness temperature (%.4f cm^-1) [K]\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 7137</span>              ++n, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 7138</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7139</span>      fprintf(out, <span class="stringliteral">&quot;# $%d = radiance (%.4f cm^-1) [W/(m^2 sr cm^-1)]\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 7140</span>              ++n, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 7141</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 7142</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = transmittance (%.4f cm^-1) [-]\n&quot;</span>, ++n,</div>
<div class="line"><span class="lineno"> 7143</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>]);</div>
<div class="line"><span class="lineno"> 7144</span> </div>
<div class="line"><span class="lineno"> 7145</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno"> 7146</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++) {</div>
<div class="line"><span class="lineno"> 7147</span>    <span class="keywordflow">if</span> (ir == 0 || obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>[ir] != obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>[ir - 1])</div>
<div class="line"><span class="lineno"> 7148</span>      fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7149</span>    fprintf(out, <span class="stringliteral">&quot;%.2f %g %g %g %g %g %g %g %g %g&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>[ir],</div>
<div class="line"><span class="lineno"> 7150</span>            obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>[ir],</div>
<div class="line"><span class="lineno"> 7151</span>            obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>[ir],</div>
<div class="line"><span class="lineno"> 7152</span>            obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>[ir], obs-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>[ir]);</div>
<div class="line"><span class="lineno"> 7153</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 7154</span>      fprintf(out, <span class="stringliteral">&quot; %g&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir]);</div>
<div class="line"><span class="lineno"> 7155</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 7156</span>      fprintf(out, <span class="stringliteral">&quot; %g&quot;</span>, obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[<span class="keywordtype">id</span>][ir]);</div>
<div class="line"><span class="lineno"> 7157</span>    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7158</span>  }</div>
<div class="line"><span class="lineno"> 7159</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c5b6b84f5c15574a22021a17a6afdca" name="a3c5b6b84f5c15574a22021a17a6afdca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c5b6b84f5c15574a22021a17a6afdca">&#9670;&nbsp;</a></span>write_obs_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_obs_bin </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write observation data in binary format to an output file stream. </p>
<p >This C function serializes the contents of the <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a> structure into a compact binary format and writes it to the file stream provided via <code>out</code>. The binary format begins with a header consisting of a magic identifier ("OBS1") and the number of spectral channels (<code>ctl-&gt;nd</code>). This header is used by <a class="el" href="jurassic_8h.html#aa1a252223bd58c083b0ef8a8ff3391d0" title="Read binary-formatted observation data from an open file stream.">read_obs_bin()</a> to validate compatibility when reading.</p>
<p >Following the header, the function writes the number of ray paths and then sequentially outputs arrays of observation metadata, geometric parameters, radiance or brightness temperature values, and transmittances. All values are written in native binary representation using the <a class="el" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac" title="Write binary data to a file.">FWRITE()</a> macro, which performs buffered writes and error checking.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Output file stream opened in binary mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control structure specifying the number of spectral channels (<code>nd</code>) and corresponding configuration parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs</td><td>Observation structure containing the data to be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is a C routine that does not perform any formatting or conversion. The resulting file is portable only to systems with compatible binary layouts (integer size, floating-point format, and endianness).</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The caller must ensure that <code>out</code> is writable and already opened in binary mode. The function does not validate stream state.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#aaa92bd5536bbf6cb6b4f541e24dac461" title="Write observation data to an output file in ASCII or binary format.">write_obs()</a>, <a class="el" href="jurassic_8h.html#a78c1bf52aacddbf614a0c254868195f6" title="Write observation data to an ASCII text file.">write_obs_asc()</a>, <a class="el" href="jurassic_8h.html#aa1a252223bd58c083b0ef8a8ff3391d0" title="Read binary-formatted observation data from an open file stream.">read_obs_bin()</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07163">7163</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7166</span>                    {</div>
<div class="line"><span class="lineno"> 7167</span> </div>
<div class="line"><span class="lineno"> 7168</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno"> 7169</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(<span class="stringliteral">&quot;OBS1&quot;</span>, <span class="keywordtype">char</span>,</div>
<div class="line"><span class="lineno"> 7170</span>         4,</div>
<div class="line"><span class="lineno"> 7171</span>         out);</div>
<div class="line"><span class="lineno"> 7172</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7173</span>         1,</div>
<div class="line"><span class="lineno"> 7174</span>         out);</div>
<div class="line"><span class="lineno"> 7175</span> </div>
<div class="line"><span class="lineno"> 7176</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno"> 7177</span>  <span class="keywordtype">size_t</span> nr = (size_t) obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>;</div>
<div class="line"><span class="lineno"> 7178</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;nr, <span class="keywordtype">size_t</span>,</div>
<div class="line"><span class="lineno"> 7179</span>         1,</div>
<div class="line"><span class="lineno"> 7180</span>         out);</div>
<div class="line"><span class="lineno"> 7181</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#ad86987afb2b3307399b50383f4dbdc40">time</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7182</span>         nr,</div>
<div class="line"><span class="lineno"> 7183</span>         out);</div>
<div class="line"><span class="lineno"> 7184</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a992d21aae832400874f3f6bc3e7d1981">obsz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7185</span>         nr,</div>
<div class="line"><span class="lineno"> 7186</span>         out);</div>
<div class="line"><span class="lineno"> 7187</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a6623d4c4c139db8c86195751653ea716">obslon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7188</span>         nr,</div>
<div class="line"><span class="lineno"> 7189</span>         out);</div>
<div class="line"><span class="lineno"> 7190</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a8b9f2ae531c4d8693c7ce86f0387d290">obslat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7191</span>         nr,</div>
<div class="line"><span class="lineno"> 7192</span>         out);</div>
<div class="line"><span class="lineno"> 7193</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a5ad297ef892545d93168c57ed26f74b5">vpz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7194</span>         nr,</div>
<div class="line"><span class="lineno"> 7195</span>         out);</div>
<div class="line"><span class="lineno"> 7196</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#aba164760718f1c258c150ebbc93a39a9">vplon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7197</span>         nr,</div>
<div class="line"><span class="lineno"> 7198</span>         out);</div>
<div class="line"><span class="lineno"> 7199</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a62d326c0aa12f2f9208c6a5576e599da">vplat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7200</span>         nr,</div>
<div class="line"><span class="lineno"> 7201</span>         out);</div>
<div class="line"><span class="lineno"> 7202</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#ae058b1684cd96b157b1796a5b9be6c38">tpz</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7203</span>         nr,</div>
<div class="line"><span class="lineno"> 7204</span>         out);</div>
<div class="line"><span class="lineno"> 7205</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a4edcf8144a1c2babeae0f0c60b3ccb9e">tplon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7206</span>         nr,</div>
<div class="line"><span class="lineno"> 7207</span>         out);</div>
<div class="line"><span class="lineno"> 7208</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#ab6667e8396fbfe507ebc81545d390c66">tplat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7209</span>         nr,</div>
<div class="line"><span class="lineno"> 7210</span>         out);</div>
<div class="line"><span class="lineno"> 7211</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 7212</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7213</span>           nr,</div>
<div class="line"><span class="lineno"> 7214</span>           out);</div>
<div class="line"><span class="lineno"> 7215</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 7216</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a0f8aac57859ceccb50b258d487e74670">tau</a>[<span class="keywordtype">id</span>], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7217</span>           nr,</div>
<div class="line"><span class="lineno"> 7218</span>           out);</div>
<div class="line"><span class="lineno"> 7219</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abd649b0cdf3dc23af5ad95a0532c751b" name="abd649b0cdf3dc23af5ad95a0532c751b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd649b0cdf3dc23af5ad95a0532c751b">&#9670;&nbsp;</a></span>write_shape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_shape </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write tabulated shape function data to a text file. </p>
<p >Exports a shape function (typically a weighting or field-of-view profile) defined by paired arrays of <em>x</em> and <em>y</em> values to an ASCII file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Output file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Pointer to array of x-values (independent variable). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Pointer to array of y-values (dependent variable). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of data points to write.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Writes a plain-text table with two columns: <div class="fragment"><div class="line"><span class="preprocessor"># $1 = shape function x-value [-]</span></div>
<div class="line"><span class="preprocessor"># $2 = shape function y-value [-]</span></div>
</div><!-- fragment --></li>
<li>Each line contains one (<em>x</em>, <em>y</em>) pair written with high precision.</li>
<li>Typically used to export field-of-view functions, apodization kernels, or any other normalized shape profiles used by the model.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two-column shape function from an ASCII file.">read_shape</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Units are dimensionless unless otherwise defined by the application.</li>
<li>The file is fully compatible with <code><a class="el" href="jurassic_8h.html#ad6dc7f479ca53ad9866d0e1df8f5ffcd" title="Read a two-column shape function from an ASCII file.">read_shape()</a></code> for re-import.</li>
<li>Output precision is set to 10 significant digits for numerical stability.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Existing files with the same name will be overwritten.</li>
<li>The number of points <em>n</em> must be consistent with the size of <em>x</em> and <em>y</em> arrays.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07223">7223</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7227</span>               {</div>
<div class="line"><span class="lineno"> 7228</span> </div>
<div class="line"><span class="lineno"> 7229</span>  FILE *out;</div>
<div class="line"><span class="lineno"> 7230</span> </div>
<div class="line"><span class="lineno"> 7231</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7232</span>  <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write shape function: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 7233</span> </div>
<div class="line"><span class="lineno"> 7234</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno"> 7235</span>  <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno"> 7236</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7237</span> </div>
<div class="line"><span class="lineno"> 7238</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno"> 7239</span>  fprintf(out,</div>
<div class="line"><span class="lineno"> 7240</span>          <span class="stringliteral">&quot;# $1 = shape function x-value [-]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7241</span>          <span class="stringliteral">&quot;# $2 = shape function y-value [-]\n\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7242</span> </div>
<div class="line"><span class="lineno"> 7243</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno"> 7244</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)</div>
<div class="line"><span class="lineno"> 7245</span>    fprintf(out, <span class="stringliteral">&quot;%.10g %.10g\n&quot;</span>, x[i], y[i]);</div>
<div class="line"><span class="lineno"> 7246</span> </div>
<div class="line"><span class="lineno"> 7247</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7248</span>  fclose(out);</div>
<div class="line"><span class="lineno"> 7249</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aec8df2858073df466eb01b273cc888ab" name="aec8df2858073df466eb01b273cc888ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec8df2858073df466eb01b273cc888ab">&#9670;&nbsp;</a></span>write_stddev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_stddev </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>quantity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structret__t.html">ret_t</a> *&#160;</td>
          <td class="paramname"><em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_matrix *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write retrieval standard deviation profiles to disk. </p>
<p >Extracts the diagonal elements of a covariance matrix (a priori, posterior, or error covariance) to obtain the standard deviations of retrieved quantities and writes them as an atmospheric profile file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">quantity</td><td>Name of the retrieved quantity (e.g., <code>"apr"</code>, <code>"pos"</code>, <code>"err"</code>), used to label the output file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ret</td><td>Retrieval configuration structure (<code><a class="el" href="structret__t.html" title="Retrieval control parameters.">ret_t</a></code>), providing the working directory for output files. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Global control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) defining retrieval setup and quantities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Reference atmospheric state (<code><a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a></code>) for spatial/geometric metadata. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Covariance matrix (<code>gsl_matrix</code>, nn) from which standard deviations are derived (typically posterior covariance \(\mathbf{S}\)).</td></tr>
  </table>
  </dd>
</dl>
<p>This function performs the following operations:</p><ol type="1">
<li>Extracts the standard deviation vector \(\sigma_i = \sqrt{S_{ii}}\) from the diagonal of the covariance matrix \(\mathbf{S}\).</li>
<li>Copies the reference atmospheric structure (<code>atm</code>) into an auxiliary structure (<code>atm_aux</code>) to preserve coordinate and geometric metadata.</li>
<li>Converts the standard deviation vector into the atmospheric representation using <code><a class="el" href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure.">x2atm()</a></code>, thereby mapping elements of the state vector to the corresponding atmospheric quantities.</li>
<li>Writes the result to disk as a diagnostic file: <p class="formulaDsp">
\[
   \texttt{&lt;ret-&gt;dir&gt;/atm\_err\_&lt;quantity&gt;.tab}
   \]
</p>
 using the standard JURASSIC atmospheric file format.</li>
</ol>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure.">x2atm</a>, <a class="el" href="jurassic_8h.html#ad4d49729d85da58030daa13689c5edd1" title="Copy or initialize atmospheric profile data.">copy_atm</a>, <a class="el" href="jurassic_8h.html#a26be12322766162766071e8cd3587515" title="Write atmospheric data to a file.">write_atm</a>, <a class="el" href="jurassic_8h.html#ae9a11e5f03e0a307add4daf864977cec" title="Construct the a priori covariance matrix  for retrieval parameters.">set_cov_apr</a>, <a class="el" href="jurassic_8h.html#a6bb69eac608c4019c689bf8280912c1f" title="Construct measurement error standard deviations and their inverse.">set_cov_meas</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The file naming convention follows <code>atm_err_&lt;quantity&gt;.tab</code> (e.g., <code>atm_err_apr.tab</code>, <code>atm_err_pos.tab</code>).</li>
<li>The output profile includes all state quantities defined in <code>ctl</code>.</li>
<li>Only diagonal uncertainties are written; correlations are not stored.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>The covariance matrix <code>s</code> must be symmetric and positive-definite.</li>
<li>The state vector mapping (<code>x2atm</code>) must correspond to the matrix ordering.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07253">7253</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7258</span>                       {</div>
<div class="line"><span class="lineno"> 7259</span> </div>
<div class="line"><span class="lineno"> 7260</span>  <span class="keyword">static</span> <a class="code hl_struct" href="structatm__t.html">atm_t</a> atm_aux;</div>
<div class="line"><span class="lineno"> 7261</span> </div>
<div class="line"><span class="lineno"> 7262</span>  <span class="keywordtype">char</span> filename[<a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 7263</span> </div>
<div class="line"><span class="lineno"> 7264</span>  <span class="comment">/* Get sizes... */</span></div>
<div class="line"><span class="lineno"> 7265</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = s-&gt;size1;</div>
<div class="line"><span class="lineno"> 7266</span> </div>
<div class="line"><span class="lineno"> 7267</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 7268</span>  gsl_vector *x_aux = gsl_vector_alloc(n);</div>
<div class="line"><span class="lineno"> 7269</span> </div>
<div class="line"><span class="lineno"> 7270</span>  <span class="comment">/* Compute standard deviation... */</span></div>
<div class="line"><span class="lineno"> 7271</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; i++)</div>
<div class="line"><span class="lineno"> 7272</span>    gsl_vector_set(x_aux, i, sqrt(gsl_matrix_get(s, i, i)));</div>
<div class="line"><span class="lineno"> 7273</span> </div>
<div class="line"><span class="lineno"> 7274</span>  <span class="comment">/* Write to disk... */</span></div>
<div class="line"><span class="lineno"> 7275</span>  <a class="code hl_function" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1">copy_atm</a>(ctl, &amp;atm_aux, atm, 1);</div>
<div class="line"><span class="lineno"> 7276</span>  <a class="code hl_function" href="jurassic_8c.html#a59e72c7cead4b4b7aaf096803bc7360c">x2atm</a>(ctl, x_aux, &amp;atm_aux);</div>
<div class="line"><span class="lineno"> 7277</span>  sprintf(filename, <span class="stringliteral">&quot;atm_err_%s.tab&quot;</span>, quantity);</div>
<div class="line"><span class="lineno"> 7278</span>  <a class="code hl_function" href="jurassic_8c.html#a26be12322766162766071e8cd3587515">write_atm</a>(ret-&gt;<a class="code hl_variable" href="structret__t.html#ada64429504782319cf47ceb02e6ceb3f">dir</a>, filename, ctl, &amp;atm_aux);</div>
<div class="line"><span class="lineno"> 7279</span> </div>
<div class="line"><span class="lineno"> 7280</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 7281</span>  gsl_vector_free(x_aux);</div>
<div class="line"><span class="lineno"> 7282</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_aec8df2858073df466eb01b273cc888ab_cgraph.png" border="0" usemap="#ajurassic_8h_aec8df2858073df466eb01b273cc888ab_cgraph" alt=""/></div>
<map name="ajurassic_8h_aec8df2858073df466eb01b273cc888ab_cgraph" id="ajurassic_8h_aec8df2858073df466eb01b273cc888ab_cgraph">
<area shape="rect" title="Write retrieval standard deviation profiles to disk." alt="" coords="5,56,101,83"/>
<area shape="rect" href="jurassic_8c.html#ad4d49729d85da58030daa13689c5edd1" title="Copy or initialize atmospheric profile data." alt="" coords="149,5,228,32"/>
<area shape="rect" href="jurassic_8c.html#a26be12322766162766071e8cd3587515" title="Write atmospheric data to a file." alt="" coords="149,56,228,83"/>
<area shape="rect" href="jurassic_8c.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure." alt="" coords="160,107,217,133"/>
<area shape="rect" href="jurassic_8c.html#aedaa4b13833a182bbff8034a3b2edae0" title="Write atmospheric data to an ASCII file." alt="" coords="276,5,383,32"/>
<area shape="rect" href="jurassic_8c.html#abb2306151e16b13ed93d84d379c8bb0e" title="Write atmospheric data to a binary file." alt="" coords="278,56,381,83"/>
<area shape="rect" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992" title="Helper function to extract a single value from the retrieval state vector." alt="" coords="285,107,373,133"/>
</map>
</div>

</div>
</div>
<a id="a78815bfc5643350a3b2d2c04782ad93d" name="a78815bfc5643350a3b2d2c04782ad93d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78815bfc5643350a3b2d2c04782ad93d">&#9670;&nbsp;</a></span>write_tbl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_tbl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write all emissivity lookup tables in the format specified by the control structure. </p>
<p >This function dispatches to one of three table writers depending on <code>ctl-&gt;tblfmt</code>:</p>
<ul>
<li><code>1</code>: ASCII tables written by <a class="el" href="jurassic_8h.html#a5557d36bbbd2cb91a1e1d69c7ea8ecc5" title="Write all lookup tables in human-readable ASCII format.">write_tbl_asc()</a></li>
<li><code>2</code>: Binary tables written by <a class="el" href="jurassic_8h.html#a60b80f0d4d9036d4bf24f266258a86d0" title="Write all lookup tables in compact binary format.">write_tbl_bin()</a></li>
<li><code>3</code>: Per-gas binary tables written by <a class="el" href="jurassic_8h.html#a7dcdafceae19d83c22645217a4e765c7" title="Write lookup tables into per-gas binary table files with indexed blocks.">write_tbl_gas()</a></li>
</ul>
<p >If an unknown format is given, the function aborts via <a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Control structure specifying table format, filenames, number of gases, number of frequencies, etc. </td></tr>
    <tr><td class="paramname">tbl</td><td>Fully populated lookup-table structure to be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07286">7286</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7288</span>                    {</div>
<div class="line"><span class="lineno"> 7289</span> </div>
<div class="line"><span class="lineno"> 7290</span>  <span class="comment">/* Write ASCII look-up tables... */</span></div>
<div class="line"><span class="lineno"> 7291</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae9e580318eb04b3963daaa98a9651129">tblfmt</a> == 1)</div>
<div class="line"><span class="lineno"> 7292</span>    <a class="code hl_function" href="jurassic_8c.html#a5557d36bbbd2cb91a1e1d69c7ea8ecc5">write_tbl_asc</a>(ctl, tbl);</div>
<div class="line"><span class="lineno"> 7293</span> </div>
<div class="line"><span class="lineno"> 7294</span>  <span class="comment">/* Write binary look-up tables... */</span></div>
<div class="line"><span class="lineno"> 7295</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae9e580318eb04b3963daaa98a9651129">tblfmt</a> == 2)</div>
<div class="line"><span class="lineno"> 7296</span>    <a class="code hl_function" href="jurassic_8c.html#a60b80f0d4d9036d4bf24f266258a86d0">write_tbl_bin</a>(ctl, tbl);</div>
<div class="line"><span class="lineno"> 7297</span> </div>
<div class="line"><span class="lineno"> 7298</span>  <span class="comment">/* Write per-gas look-up tables... */</span></div>
<div class="line"><span class="lineno"> 7299</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae9e580318eb04b3963daaa98a9651129">tblfmt</a> == 3)</div>
<div class="line"><span class="lineno"> 7300</span>    <a class="code hl_function" href="jurassic_8c.html#a7dcdafceae19d83c22645217a4e765c7">write_tbl_gas</a>(ctl, tbl);</div>
<div class="line"><span class="lineno"> 7301</span> </div>
<div class="line"><span class="lineno"> 7302</span>  <span class="comment">/* Error message... */</span></div>
<div class="line"><span class="lineno"> 7303</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7304</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Unknown look-up table format!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7305</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a5557d36bbbd2cb91a1e1d69c7ea8ecc5"><div class="ttname"><a href="jurassic_8c.html#a5557d36bbbd2cb91a1e1d69c7ea8ecc5">write_tbl_asc</a></div><div class="ttdeci">void write_tbl_asc(const ctl_t *ctl, const tbl_t *tbl)</div><div class="ttdoc">Write all lookup tables in human-readable ASCII format.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07309">jurassic.c:7309</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a60b80f0d4d9036d4bf24f266258a86d0"><div class="ttname"><a href="jurassic_8c.html#a60b80f0d4d9036d4bf24f266258a86d0">write_tbl_bin</a></div><div class="ttdeci">void write_tbl_bin(const ctl_t *ctl, const tbl_t *tbl)</div><div class="ttdoc">Write all lookup tables in compact binary format.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07354">jurassic.c:7354</a></div></div>
<div class="ttc" id="ajurassic_8c_html_a7dcdafceae19d83c22645217a4e765c7"><div class="ttname"><a href="jurassic_8c.html#a7dcdafceae19d83c22645217a4e765c7">write_tbl_gas</a></div><div class="ttdeci">void write_tbl_gas(const ctl_t *ctl, const tbl_t *tbl)</div><div class="ttdoc">Write lookup tables into per-gas binary table files with indexed blocks.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07409">jurassic.c:7409</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a78815bfc5643350a3b2d2c04782ad93d_cgraph.png" border="0" usemap="#ajurassic_8h_a78815bfc5643350a3b2d2c04782ad93d_cgraph" alt=""/></div>
<map name="ajurassic_8h_a78815bfc5643350a3b2d2c04782ad93d_cgraph" id="ajurassic_8h_a78815bfc5643350a3b2d2c04782ad93d_cgraph">
<area shape="rect" title="Write all emissivity lookup tables in the format specified by the control structure." alt="" coords="5,56,76,83"/>
<area shape="rect" href="jurassic_8c.html#a5557d36bbbd2cb91a1e1d69c7ea8ecc5" title="Write all lookup tables in human&#45;readable ASCII format." alt="" coords="124,5,223,32"/>
<area shape="rect" href="jurassic_8c.html#a60b80f0d4d9036d4bf24f266258a86d0" title="Write all lookup tables in compact binary format." alt="" coords="126,56,221,83"/>
<area shape="rect" href="jurassic_8c.html#a7dcdafceae19d83c22645217a4e765c7" title="Write lookup tables into per&#45;gas binary table files with indexed blocks." alt="" coords="124,107,223,133"/>
<area shape="rect" href="jurassic_8c.html#adad0096f4559d524126d7b849cee0fb7" title="Close a per&#45;gas binary table file and optionally rewrite metadata." alt="" coords="275,31,409,57"/>
<area shape="rect" href="jurassic_8c.html#ae21efb7a5b4d98c52355ee78cd4d0df5" title="Open a per&#45;gas binary table file for reading and writing." alt="" coords="277,81,407,108"/>
<area shape="rect" href="jurassic_8c.html#affb6bd5214f6579580cf5882f5ed4a64" title="Create a new per&#45;gas table file with an empty index." alt="" coords="271,132,413,159"/>
<area shape="rect" href="jurassic_8c.html#a323a3d7eb6a7c3ffe9736a4b66ff385f" title="Append or overwrite a single frequency&#45;table block in a per&#45;gas file." alt="" coords="272,183,412,209"/>
</map>
</div>

</div>
</div>
<a id="a5557d36bbbd2cb91a1e1d69c7ea8ecc5" name="a5557d36bbbd2cb91a1e1d69c7ea8ecc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5557d36bbbd2cb91a1e1d69c7ea8ecc5">&#9670;&nbsp;</a></span>write_tbl_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_tbl_asc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write all lookup tables in human-readable ASCII format. </p>
<p >For every gas index (<code>ig</code>) and frequency index (<code>id</code>), the function generates a file of the form: </p><pre class="fragment">&lt;base&gt;_&lt;nu[id]&gt;_&lt;emitter[ig]&gt;.tab
</pre><p> The ASCII file contains four columns: </p><pre class="fragment">1. pressure [hPa]
2. temperature [K]
3. column density [molecules/cm]
4. emissivity [-]
</pre><p> Table dimensions are taken from the <code><a class="el" href="structtbl__t.html" title="Emissivity look-up tables.">tbl_t</a></code> structure. <br  />
 Missing files cause the program to abort via <a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Control structure providing grid metadata and filename base. </td></tr>
    <tr><td class="paramname">tbl</td><td>Table data to be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07309">7309</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7311</span>                    {</div>
<div class="line"><span class="lineno"> 7312</span> </div>
<div class="line"><span class="lineno"> 7313</span>  <span class="comment">/* Loop over emitters and detectors... */</span></div>
<div class="line"><span class="lineno"> 7314</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 7315</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 7316</span> </div>
<div class="line"><span class="lineno"> 7317</span>      <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 7318</span>      <span class="keywordtype">char</span> filename[2 * <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 7319</span>      sprintf(filename, <span class="stringliteral">&quot;%s_%.4f_%s.tab&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">tblbase</a>,</div>
<div class="line"><span class="lineno"> 7320</span>              ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 7321</span> </div>
<div class="line"><span class="lineno"> 7322</span>      <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7323</span>      <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write emissivity table: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 7324</span> </div>
<div class="line"><span class="lineno"> 7325</span>      <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno"> 7326</span>      FILE *out;</div>
<div class="line"><span class="lineno"> 7327</span>      <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno"> 7328</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7329</span> </div>
<div class="line"><span class="lineno"> 7330</span>      <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno"> 7331</span>      fprintf(out,</div>
<div class="line"><span class="lineno"> 7332</span>              <span class="stringliteral">&quot;# $1 = pressure [hPa]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7333</span>              <span class="stringliteral">&quot;# $2 = temperature [K]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7334</span>              <span class="stringliteral">&quot;# $3 = column density [molecules/cm^2]\n&quot;</span></div>
<div class="line"><span class="lineno"> 7335</span>              <span class="stringliteral">&quot;# $4 = emissivity [-]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7336</span> </div>
<div class="line"><span class="lineno"> 7337</span>      <span class="comment">/* Save table file... */</span></div>
<div class="line"><span class="lineno"> 7338</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]; ip++)</div>
<div class="line"><span class="lineno"> 7339</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 0; it &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][ip]; it++) {</div>
<div class="line"><span class="lineno"> 7340</span>          fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7341</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iu = 0; iu &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[id][ig][ip][it]; iu++)</div>
<div class="line"><span class="lineno"> 7342</span>            fprintf(out, <span class="stringliteral">&quot;%g %g %e %e\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 7343</span>                    tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig][ip], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ip][it],</div>
<div class="line"><span class="lineno"> 7344</span>                    tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[<span class="keywordtype">id</span>][ig][ip][it][iu], tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[<span class="keywordtype">id</span>][ig][ip][it][iu]);</div>
<div class="line"><span class="lineno"> 7345</span>        }</div>
<div class="line"><span class="lineno"> 7346</span> </div>
<div class="line"><span class="lineno"> 7347</span>      <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7348</span>      fclose(out);</div>
<div class="line"><span class="lineno"> 7349</span>    }</div>
<div class="line"><span class="lineno"> 7350</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a60b80f0d4d9036d4bf24f266258a86d0" name="a60b80f0d4d9036d4bf24f266258a86d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60b80f0d4d9036d4bf24f266258a86d0">&#9670;&nbsp;</a></span>write_tbl_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_tbl_bin </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write all lookup tables in compact binary format. </p>
<p >For each gas index (<code>ig</code>) and frequency index (<code>id</code>), a binary file named </p><pre class="fragment">&lt;base&gt;_&lt;nu[id]&gt;_&lt;emitter[ig]&gt;.bin
</pre><p> is created. The format is:</p>
<ul>
<li>int np (number of pressure levels)</li>
<li>double p[np]</li>
<li>for each pressure:<ul>
<li>int nt (number of temperature levels)</li>
<li>double t[nt]</li>
<li>for each temperature:<ul>
<li>int nu (number of column-density points)</li>
<li>float u[nu]</li>
<li>float eps[nu]</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Control structure containing filename base and spectral grid. </td></tr>
    <tr><td class="paramname">tbl</td><td>Table data to be serialized.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07354">7354</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7356</span>                    {</div>
<div class="line"><span class="lineno"> 7357</span> </div>
<div class="line"><span class="lineno"> 7358</span>  <span class="comment">/* Loop over emitters and detectors... */</span></div>
<div class="line"><span class="lineno"> 7359</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 7360</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 7361</span> </div>
<div class="line"><span class="lineno"> 7362</span>      <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno"> 7363</span>      <span class="keywordtype">char</span> filename[2 * <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 7364</span>      sprintf(filename, <span class="stringliteral">&quot;%s_%.4f_%s.bin&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">tblbase</a>,</div>
<div class="line"><span class="lineno"> 7365</span>              ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 7366</span> </div>
<div class="line"><span class="lineno"> 7367</span>      <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7368</span>      <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write emissivity table: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 7369</span> </div>
<div class="line"><span class="lineno"> 7370</span>      <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno"> 7371</span>      FILE *out;</div>
<div class="line"><span class="lineno"> 7372</span>      <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno"> 7373</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7374</span> </div>
<div class="line"><span class="lineno"> 7375</span>      <span class="comment">/* Write binary data... */</span></div>
<div class="line"><span class="lineno"> 7376</span>      <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7377</span>             1,</div>
<div class="line"><span class="lineno"> 7378</span>             out);</div>
<div class="line"><span class="lineno"> 7379</span>      <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7380</span>               (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig],</div>
<div class="line"><span class="lineno"> 7381</span>             out);</div>
<div class="line"><span class="lineno"> 7382</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]; ip++) {</div>
<div class="line"><span class="lineno"> 7383</span>        <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7384</span>               1,</div>
<div class="line"><span class="lineno"> 7385</span>               out);</div>
<div class="line"><span class="lineno"> 7386</span>        <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ip], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7387</span>                 (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip],</div>
<div class="line"><span class="lineno"> 7388</span>               out);</div>
<div class="line"><span class="lineno"> 7389</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 0; it &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][ip]; it++) {</div>
<div class="line"><span class="lineno"> 7390</span>          <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7391</span>                 1,</div>
<div class="line"><span class="lineno"> 7392</span>                 out);</div>
<div class="line"><span class="lineno"> 7393</span>          <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 7394</span>                   (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it],</div>
<div class="line"><span class="lineno"> 7395</span>                 out);</div>
<div class="line"><span class="lineno"> 7396</span>          <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 7397</span>                   (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it],</div>
<div class="line"><span class="lineno"> 7398</span>                 out);</div>
<div class="line"><span class="lineno"> 7399</span>        }</div>
<div class="line"><span class="lineno"> 7400</span>      }</div>
<div class="line"><span class="lineno"> 7401</span> </div>
<div class="line"><span class="lineno"> 7402</span>      <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7403</span>      fclose(out);</div>
<div class="line"><span class="lineno"> 7404</span>    }</div>
<div class="line"><span class="lineno"> 7405</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7dcdafceae19d83c22645217a4e765c7" name="a7dcdafceae19d83c22645217a4e765c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dcdafceae19d83c22645217a4e765c7">&#9670;&nbsp;</a></span>write_tbl_gas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_tbl_gas </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write lookup tables into per-gas binary table files with indexed blocks. </p>
<p >This function creates (if necessary) and updates gas-specific files of the form: </p><pre class="fragment">&lt;base&gt;_&lt;emitter&gt;.tbl
</pre><p> Each file contains:</p>
<ul>
<li>A header ("GTL1")</li>
<li>A table count (ntables)</li>
<li>A fixed-size index of MAX_TABLES entries</li>
<li>One or more appended binary table blocks</li>
</ul>
<p >For each frequency index (<code>id</code>), a block is appended (or overwritten) using <a class="el" href="jurassic_8h.html#a323a3d7eb6a7c3ffe9736a4b66ff385f" title="Append or overwrite a single frequency-table block in a per-gas file.">write_tbl_gas_single()</a>, which stores both the serialized table and its offset/size in the on-disk index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Control structure containing spectral grid, emitters, and filenames. </td></tr>
    <tr><td class="paramname">tbl</td><td>Table data from which individual frequency blocks are extracted.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The file must have capacity for all required frequency entries (MAX_TABLES). Exceeding this capacity triggers a fatal error.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07409">7409</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7411</span>                    {</div>
<div class="line"><span class="lineno"> 7412</span> </div>
<div class="line"><span class="lineno"> 7413</span>  <span class="comment">/* Loop over emitters... */</span></div>
<div class="line"><span class="lineno"> 7414</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++) {</div>
<div class="line"><span class="lineno"> 7415</span> </div>
<div class="line"><span class="lineno"> 7416</span>    <span class="comment">/* Construct filename... */</span></div>
<div class="line"><span class="lineno"> 7417</span>    <span class="keywordtype">char</span> filename[2 * <a class="code hl_define" href="jurassic_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 7418</span>    sprintf(filename, <span class="stringliteral">&quot;%s_%s.tbl&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a333796df0ab2dc191cb6c7287d7487c8">tblbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad91bbf51ada1919a24e2c7a5fd666e23">emitter</a>[ig]);</div>
<div class="line"><span class="lineno"> 7419</span> </div>
<div class="line"><span class="lineno"> 7420</span>    <span class="comment">/* Try to open existing file first... */</span></div>
<div class="line"><span class="lineno"> 7421</span>    <a class="code hl_struct" href="structtbl__gas__t.html">tbl_gas_t</a> gas;</div>
<div class="line"><span class="lineno"> 7422</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="jurassic_8c.html#ae21efb7a5b4d98c52355ee78cd4d0df5">read_tbl_gas_open</a>(filename, &amp;gas) != 0) {</div>
<div class="line"><span class="lineno"> 7423</span>      <a class="code hl_define" href="jurassic_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Gas file does not exist, creating: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 7424</span> </div>
<div class="line"><span class="lineno"> 7425</span>      <span class="comment">/* Create with capacity for all frequencies... */</span></div>
<div class="line"><span class="lineno"> 7426</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="jurassic_8c.html#affb6bd5214f6579580cf5882f5ed4a64">write_tbl_gas_create</a>(filename) != 0)</div>
<div class="line"><span class="lineno"> 7427</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create gas table file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7428</span> </div>
<div class="line"><span class="lineno"> 7429</span>      <span class="comment">/* Now open it... */</span></div>
<div class="line"><span class="lineno"> 7430</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="jurassic_8c.html#ae21efb7a5b4d98c52355ee78cd4d0df5">read_tbl_gas_open</a>(filename, &amp;gas) != 0)</div>
<div class="line"><span class="lineno"> 7431</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open newly created gas table file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7432</span>    }</div>
<div class="line"><span class="lineno"> 7433</span> </div>
<div class="line"><span class="lineno"> 7434</span>    <span class="comment">/* Loop over frequencies... */</span></div>
<div class="line"><span class="lineno"> 7435</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno"> 7436</span> </div>
<div class="line"><span class="lineno"> 7437</span>      <span class="comment">/* Write one frequency table block into the gas file... */</span></div>
<div class="line"><span class="lineno"> 7438</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="jurassic_8c.html#a323a3d7eb6a7c3ffe9736a4b66ff385f">write_tbl_gas_single</a>(&amp;gas, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a16a7e8119bff09ce8de3ee89d6ca0044">nu</a>[<span class="keywordtype">id</span>], tbl, <span class="keywordtype">id</span>, ig) != 0)</div>
<div class="line"><span class="lineno"> 7439</span>        <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error writing table block!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7440</span>    }</div>
<div class="line"><span class="lineno"> 7441</span> </div>
<div class="line"><span class="lineno"> 7442</span>    <span class="comment">/* Close gas-table file (flushes index)... */</span></div>
<div class="line"><span class="lineno"> 7443</span>    <a class="code hl_function" href="jurassic_8c.html#adad0096f4559d524126d7b849cee0fb7">read_tbl_gas_close</a>(&amp;gas);</div>
<div class="line"><span class="lineno"> 7444</span>  }</div>
<div class="line"><span class="lineno"> 7445</span>}</div>
<div class="ttc" id="ajurassic_8c_html_a323a3d7eb6a7c3ffe9736a4b66ff385f"><div class="ttname"><a href="jurassic_8c.html#a323a3d7eb6a7c3ffe9736a4b66ff385f">write_tbl_gas_single</a></div><div class="ttdeci">int write_tbl_gas_single(tbl_gas_t *g, const double freq, const tbl_t *tbl, const int id, const int ig)</div><div class="ttdoc">Append or overwrite a single frequency-table block in a per-gas file.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07480">jurassic.c:7480</a></div></div>
<div class="ttc" id="ajurassic_8c_html_affb6bd5214f6579580cf5882f5ed4a64"><div class="ttname"><a href="jurassic_8c.html#affb6bd5214f6579580cf5882f5ed4a64">write_tbl_gas_create</a></div><div class="ttdeci">int write_tbl_gas_create(const char *path)</div><div class="ttdoc">Create a new per-gas table file with an empty index.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07449">jurassic.c:7449</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a7dcdafceae19d83c22645217a4e765c7_cgraph.png" border="0" usemap="#ajurassic_8h_a7dcdafceae19d83c22645217a4e765c7_cgraph" alt=""/></div>
<map name="ajurassic_8h_a7dcdafceae19d83c22645217a4e765c7_cgraph" id="ajurassic_8h_a7dcdafceae19d83c22645217a4e765c7_cgraph">
<area shape="rect" title="Write lookup tables into per&#45;gas binary table files with indexed blocks." alt="" coords="5,81,104,108"/>
<area shape="rect" href="jurassic_8c.html#adad0096f4559d524126d7b849cee0fb7" title="Close a per&#45;gas binary table file and optionally rewrite metadata." alt="" coords="156,5,291,32"/>
<area shape="rect" href="jurassic_8c.html#ae21efb7a5b4d98c52355ee78cd4d0df5" title="Open a per&#45;gas binary table file for reading and writing." alt="" coords="158,56,289,83"/>
<area shape="rect" href="jurassic_8c.html#affb6bd5214f6579580cf5882f5ed4a64" title="Create a new per&#45;gas table file with an empty index." alt="" coords="152,107,295,133"/>
<area shape="rect" href="jurassic_8c.html#a323a3d7eb6a7c3ffe9736a4b66ff385f" title="Append or overwrite a single frequency&#45;table block in a per&#45;gas file." alt="" coords="153,157,293,184"/>
</map>
</div>

</div>
</div>
<a id="affb6bd5214f6579580cf5882f5ed4a64" name="affb6bd5214f6579580cf5882f5ed4a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affb6bd5214f6579580cf5882f5ed4a64">&#9670;&nbsp;</a></span>write_tbl_gas_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_tbl_gas_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new per-gas table file with an empty index. </p>
<p >Writes the GTL1 magic header, initializes the table count to zero, and creates a MAX_TABLES-sized index whose entries are zeroed.</p>
<p >The resulting file layout is: </p><pre class="fragment">magic[4] = "GTL1"
ntables  = 0
index[MAX_TABLES]  (all zero)
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>Path to the table file to create.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 if the file cannot be opened.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07449">7449</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7450</span>                    {</div>
<div class="line"><span class="lineno"> 7451</span> </div>
<div class="line"><span class="lineno"> 7452</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 7453</span>  FILE *fp = fopen(path, <span class="stringliteral">&quot;wb+&quot;</span>);</div>
<div class="line"><span class="lineno"> 7454</span>  <span class="keywordflow">if</span> (!fp)</div>
<div class="line"><span class="lineno"> 7455</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 7456</span> </div>
<div class="line"><span class="lineno"> 7457</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> magic[4] = { <span class="charliteral">&#39;G&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;L&#39;</span>, <span class="charliteral">&#39;1&#39;</span> };</div>
<div class="line"><span class="lineno"> 7458</span>  int32_t ntables = 0;</div>
<div class="line"><span class="lineno"> 7459</span> </div>
<div class="line"><span class="lineno"> 7460</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno"> 7461</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(magic, <span class="keywordtype">char</span>,</div>
<div class="line"><span class="lineno"> 7462</span>         4,</div>
<div class="line"><span class="lineno"> 7463</span>         fp);</div>
<div class="line"><span class="lineno"> 7464</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;ntables, int32_t, 1, fp);</div>
<div class="line"><span class="lineno"> 7465</span> </div>
<div class="line"><span class="lineno"> 7466</span>  <span class="comment">/* Zeroed index... */</span></div>
<div class="line"><span class="lineno"> 7467</span>  <a class="code hl_struct" href="structtbl__gas__index__t.html">tbl_gas_index_t</a> zero = { 0 };</div>
<div class="line"><span class="lineno"> 7468</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="jurassic_8h.html#a6f4cdd0162e9f2ab251fa5b23410c8da">MAX_TABLES</a>; i++)</div>
<div class="line"><span class="lineno"> 7469</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;zero, <a class="code hl_struct" href="structtbl__gas__index__t.html">tbl_gas_index_t</a>, 1, fp);</div>
<div class="line"><span class="lineno"> 7470</span> </div>
<div class="line"><span class="lineno"> 7471</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7472</span>  fflush(fp);</div>
<div class="line"><span class="lineno"> 7473</span>  fclose(fp);</div>
<div class="line"><span class="lineno"> 7474</span> </div>
<div class="line"><span class="lineno"> 7475</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7476</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a323a3d7eb6a7c3ffe9736a4b66ff385f" name="a323a3d7eb6a7c3ffe9736a4b66ff385f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a323a3d7eb6a7c3ffe9736a4b66ff385f">&#9670;&nbsp;</a></span>write_tbl_gas_single()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_tbl_gas_single </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtbl__gas__t.html">tbl_gas_t</a> *&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtbl__t.html">tbl_t</a> *&#160;</td>
          <td class="paramname"><em>tbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Append or overwrite a single frequency-table block in a per-gas file. </p>
<p >Searches the in-memory index for an entry matching <code>freq</code>. If found, the corresponding block is updated. Otherwise a new entry is created (subject to the MAX_TABLES limit) and the block is appended to the end of the file.</p>
<p >The block format written is identical to the binary format used in <a class="el" href="jurassic_8h.html#a60b80f0d4d9036d4bf24f266258a86d0" title="Write all lookup tables in compact binary format.">write_tbl_bin()</a>:</p>
<ul>
<li>int np</li>
<li>double p[np]</li>
<li>for each pressure:<ul>
<li>int nt</li>
<li>double t[nt]</li>
<li>for each temperature:<ul>
<li>int nu</li>
<li>float u[nu]</li>
<li>float eps[nu]</li>
</ul>
</li>
</ul>
</li>
</ul>
<p >The index entry is then updated with:</p><ul>
<li>freq</li>
<li>offset (byte offset of the block)</li>
<li>size (block size in bytes)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">g</td><td>Open gas-table handle obtained from <a class="el" href="jurassic_8h.html#ae21efb7a5b4d98c52355ee78cd4d0df5" title="Open a per-gas binary table file for reading and writing.">read_tbl_gas_open()</a>. </td></tr>
    <tr><td class="paramname">freq</td><td>Frequency associated with the table block. </td></tr>
    <tr><td class="paramname">tbl</td><td>Full lookup table from which one block is extracted. </td></tr>
    <tr><td class="paramname">id</td><td>Frequency index into tbl. </td></tr>
    <tr><td class="paramname">ig</td><td>Gas index into tbl.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, non-zero on write failure.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Aborts via <a class="el" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG()</a> if MAX_TABLES is exceeded or file seek fails.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07480">7480</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7485</span>                {</div>
<div class="line"><span class="lineno"> 7486</span> </div>
<div class="line"><span class="lineno"> 7487</span>  <span class="keywordtype">int</span> idx = -1;</div>
<div class="line"><span class="lineno"> 7488</span> </div>
<div class="line"><span class="lineno"> 7489</span>  <span class="comment">/* Check if a table for this frequency already exists... */</span></div>
<div class="line"><span class="lineno"> 7490</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#abd58d0435bed20bf327a61082b379f2c">ntables</a>; i++) {</div>
<div class="line"><span class="lineno"> 7491</span>    <span class="keywordflow">if</span> (g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>[i].<a class="code hl_variable" href="structtbl__gas__index__t.html#ae92df1b397eddf22dd991d6a9f5e4853">freq</a> == freq) {</div>
<div class="line"><span class="lineno"> 7492</span>      idx = i;</div>
<div class="line"><span class="lineno"> 7493</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7494</span>    }</div>
<div class="line"><span class="lineno"> 7495</span>  }</div>
<div class="line"><span class="lineno"> 7496</span> </div>
<div class="line"><span class="lineno"> 7497</span>  <span class="comment">/* New entry if not found... */</span></div>
<div class="line"><span class="lineno"> 7498</span>  <span class="keywordflow">if</span> (idx &lt; 0) {</div>
<div class="line"><span class="lineno"> 7499</span>    idx = g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#abd58d0435bed20bf327a61082b379f2c">ntables</a>++;</div>
<div class="line"><span class="lineno"> 7500</span>    <span class="keywordflow">if</span> (g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#abd58d0435bed20bf327a61082b379f2c">ntables</a> &gt; <a class="code hl_define" href="jurassic_8h.html#a6f4cdd0162e9f2ab251fa5b23410c8da">MAX_TABLES</a>)</div>
<div class="line"><span class="lineno"> 7501</span>      <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Gas table index overflow!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7502</span>  }</div>
<div class="line"><span class="lineno"> 7503</span> </div>
<div class="line"><span class="lineno"> 7504</span>  <span class="comment">/* Append payload block at end of file... */</span></div>
<div class="line"><span class="lineno"> 7505</span>  <span class="keywordflow">if</span> (fseek(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>, 0, SEEK_END) != 0)</div>
<div class="line"><span class="lineno"> 7506</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Seek error in write_tbl_gas_single_flat!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7507</span> </div>
<div class="line"><span class="lineno"> 7508</span>  int64_t offset = (int64_t) ftell(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7509</span>  <span class="keywordflow">if</span> (offset &lt; 0)</div>
<div class="line"><span class="lineno"> 7510</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;ftell failed in write_tbl_gas_single_flat!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7511</span> </div>
<div class="line"><span class="lineno"> 7512</span>  <span class="keywordtype">long</span> start = ftell(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7513</span>  <span class="keywordflow">if</span> (start &lt; 0)</div>
<div class="line"><span class="lineno"> 7514</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;ftell failed at payload start!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7515</span> </div>
<div class="line"><span class="lineno"> 7516</span>  <span class="comment">/* Write number of pressures... */</span></div>
<div class="line"><span class="lineno"> 7517</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7518</span>         1,</div>
<div class="line"><span class="lineno"> 7519</span>         g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7520</span> </div>
<div class="line"><span class="lineno"> 7521</span>  <span class="comment">/* Write pressure grid... */</span></div>
<div class="line"><span class="lineno"> 7522</span>  <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a100378aeb57261da41b95604b10af6fd">p</a>[<span class="keywordtype">id</span>][ig], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7523</span>           (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[<span class="keywordtype">id</span>][ig],</div>
<div class="line"><span class="lineno"> 7524</span>         g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7525</span> </div>
<div class="line"><span class="lineno"> 7526</span>  <span class="comment">/* Loop over pressure levels... */</span></div>
<div class="line"><span class="lineno"> 7527</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#adc68798047aad09d90b16c84aba2117c">np</a>[id][ig]; ip++) {</div>
<div class="line"><span class="lineno"> 7528</span> </div>
<div class="line"><span class="lineno"> 7529</span>    <span class="comment">/* Write number of temperatures... */</span></div>
<div class="line"><span class="lineno"> 7530</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7531</span>           1,</div>
<div class="line"><span class="lineno"> 7532</span>           g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7533</span> </div>
<div class="line"><span class="lineno"> 7534</span>    <span class="comment">/* Write temperature grid... */</span></div>
<div class="line"><span class="lineno"> 7535</span>    <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#ab9ecd0fd977282440f479d0e01d6a2bc">t</a>[<span class="keywordtype">id</span>][ig][ip], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7536</span>             (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[<span class="keywordtype">id</span>][ig][ip],</div>
<div class="line"><span class="lineno"> 7537</span>           g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7538</span> </div>
<div class="line"><span class="lineno"> 7539</span>    <span class="comment">/* Loop over temperature levels... */</span></div>
<div class="line"><span class="lineno"> 7540</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 0; it &lt; tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a454a107571770aaaf5cbdd9d6ee27aab">nt</a>[id][ig][ip]; it++) {</div>
<div class="line"><span class="lineno"> 7541</span> </div>
<div class="line"><span class="lineno"> 7542</span>      <span class="comment">/* Write number of u points... */</span></div>
<div class="line"><span class="lineno"> 7543</span>      <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7544</span>             1,</div>
<div class="line"><span class="lineno"> 7545</span>             g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7546</span> </div>
<div class="line"><span class="lineno"> 7547</span>      <span class="comment">/* Write u array... */</span></div>
<div class="line"><span class="lineno"> 7548</span>      <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a9514535df8449c5188e687a2747bfba0">u</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 7549</span>               (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it],</div>
<div class="line"><span class="lineno"> 7550</span>             g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7551</span> </div>
<div class="line"><span class="lineno"> 7552</span>      <span class="comment">/* Write emissivity array... */</span></div>
<div class="line"><span class="lineno"> 7553</span>      <a class="code hl_define" href="jurassic_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a47489f640511083a74d6271a12141ce8">eps</a>[<span class="keywordtype">id</span>][ig][ip][it], <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 7554</span>               (<span class="keywordtype">size_t</span>) tbl-&gt;<a class="code hl_variable" href="structtbl__t.html#a1675f08cd8ed441e415ec83b9bf010b3">nu</a>[<span class="keywordtype">id</span>][ig][ip][it],</div>
<div class="line"><span class="lineno"> 7555</span>             g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7556</span>    }</div>
<div class="line"><span class="lineno"> 7557</span>  }</div>
<div class="line"><span class="lineno"> 7558</span> </div>
<div class="line"><span class="lineno"> 7559</span>  <span class="comment">/* Update index entry... */</span></div>
<div class="line"><span class="lineno"> 7560</span>  <span class="keywordtype">long</span> end = ftell(g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#a77a2f96cfd1070640367c4b9f2c1bffd">fp</a>);</div>
<div class="line"><span class="lineno"> 7561</span>  <span class="keywordflow">if</span> (end &lt; 0)</div>
<div class="line"><span class="lineno"> 7562</span>    <a class="code hl_define" href="jurassic_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;ftell failed at payload end!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7563</span> </div>
<div class="line"><span class="lineno"> 7564</span>  int64_t size = (int64_t) (end - start);</div>
<div class="line"><span class="lineno"> 7565</span> </div>
<div class="line"><span class="lineno"> 7566</span>  g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>[idx].<a class="code hl_variable" href="structtbl__gas__index__t.html#ae92df1b397eddf22dd991d6a9f5e4853">freq</a> = freq;</div>
<div class="line"><span class="lineno"> 7567</span>  g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>[idx].<a class="code hl_variable" href="structtbl__gas__index__t.html#a570ddd33828869a540ff5618c7d7efa7">offset</a> = offset;</div>
<div class="line"><span class="lineno"> 7568</span>  g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#afa705677b8b06479da2ed90e900cdb91">index</a>[idx].<a class="code hl_variable" href="structtbl__gas__index__t.html#ab193f1054a9cac976d5ea6d76403df09">size</a> = size;</div>
<div class="line"><span class="lineno"> 7569</span> </div>
<div class="line"><span class="lineno"> 7570</span>  g-&gt;<a class="code hl_variable" href="structtbl__gas__t.html#aac7c1e9ad2362734fdab0720e8f8f7a7">dirty</a> = 1;</div>
<div class="line"><span class="lineno"> 7571</span> </div>
<div class="line"><span class="lineno"> 7572</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7573</span>}</div>
<div class="ttc" id="astructtbl__gas__index__t_html_ab193f1054a9cac976d5ea6d76403df09"><div class="ttname"><a href="structtbl__gas__index__t.html#ab193f1054a9cac976d5ea6d76403df09">tbl_gas_index_t::size</a></div><div class="ttdeci">int64_t size</div><div class="ttdoc">Size of the serialized block (in bytes).</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8h_source.html#l01457">jurassic.h:1457</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59e72c7cead4b4b7aaf096803bc7360c" name="a59e72c7cead4b4b7aaf096803bc7360c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e72c7cead4b4b7aaf096803bc7360c">&#9670;&nbsp;</a></span>x2atm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void x2atm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map retrieval state vector back to atmospheric structure. </p>
<p >Updates the atmospheric data structure (<code><a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a></code>) from the contents of a retrieval state vector (<code>x</code>). This function performs the inverse transformation of <code><a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x()</a></code>, assigning retrieved quantities such as pressure, temperature, gas volume mixing ratios, extinction, and cloud/surface parameters to the corresponding atmospheric fields.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to control structure defining retrieval settings, vertical range limits, and active retrieval flags. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Pointer to retrieval state vector containing the updated values. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">atm</td><td>Pointer to atmospheric data structure to be updated.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Each atmospheric quantity is updated only within its respective retrieval altitude range (<code>ctl-&gt;ret*_zmin</code>/<code>ctl-&gt;ret*_zmax</code>).</li>
<li>For each retrievable parameter, the helper routine <code><a class="el" href="jurassic_8h.html#aaeed7544a87d85474e33d05fe0adc992" title="Helper function to extract a single value from the retrieval state vector.">x2atm_help()</a></code> is called to sequentially read the next element from the state vector.</li>
<li>The order of assignments must match that in <code><a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x()</a></code> to ensure one-to-one correspondence between state vector indices and atmospheric fields.</li>
</ul>
<p >Quantities mapped:</p><ul>
<li>Pressure (<code>p[zmin:zmax]</code>)</li>
<li>Temperature (<code>t[zmin:zmax]</code>)</li>
<li>Gas volume mixing ratios (<code>q[ig][zmin:zmax]</code>)</li>
<li>Extinction coefficients (<code>k[iw][zmin:zmax]</code>)</li>
<li>Cloud parameters (<code>clz</code>, <code>cldz</code>, <code>clk</code>)</li>
<li>Surface parameters (<code>sft</code>, <code>sfeps</code>)</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x</a>, <a class="el" href="jurassic_8h.html#aaeed7544a87d85474e33d05fe0adc992" title="Helper function to extract a single value from the retrieval state vector.">x2atm_help</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>, <a class="el" href="structatm__t.html" title="Atmospheric profile data.">atm_t</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Only parameters marked as retrievable in <code>ctl</code> (e.g. <code>ret_sft</code>, <code>ret_clk</code>) are modified.</li>
<li>The state vector index (<code>n</code>) advances automatically as each element is read.</li>
<li>The helper function <code><a class="el" href="jurassic_8h.html#aaeed7544a87d85474e33d05fe0adc992" title="Helper function to extract a single value from the retrieval state vector.">x2atm_help()</a></code> abstracts sequential access to vector elements.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>The atmospheric profile must be initialized before calling this function.</li>
<li>Retrieval ranges and flags in <code>ctl</code> must correspond exactly to those used in the forward-model configuration.</li>
<li>Mismatch between <code><a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x()</a></code> and <code><a class="el" href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure.">x2atm()</a></code> ordering will cause incorrect mappings.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07577">7577</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7580</span>              {</div>
<div class="line"><span class="lineno"> 7581</span> </div>
<div class="line"><span class="lineno"> 7582</span>  <span class="keywordtype">size_t</span> n = 0;</div>
<div class="line"><span class="lineno"> 7583</span> </div>
<div class="line"><span class="lineno"> 7584</span>  <span class="comment">/* Get pressure... */</span></div>
<div class="line"><span class="lineno"> 7585</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 7586</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1184388515bcde02af618c43495164a1">retp_zmin</a> &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &lt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb1ec420b7e90ebf056640417572a225">retp_zmax</a>)</div>
<div class="line"><span class="lineno"> 7587</span>      <a class="code hl_function" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], x, &amp;n);</div>
<div class="line"><span class="lineno"> 7588</span> </div>
<div class="line"><span class="lineno"> 7589</span>  <span class="comment">/* Get temperature... */</span></div>
<div class="line"><span class="lineno"> 7590</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 7591</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8df8e6875b7fe5ab5e2805390b3f9c3f">rett_zmin</a> &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &lt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4ceaa6f495415c535223541d957491d3">rett_zmax</a>)</div>
<div class="line"><span class="lineno"> 7592</span>      <a class="code hl_function" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a306826df6fe870ab371fb945544cc13a">t</a>[ip], x, &amp;n);</div>
<div class="line"><span class="lineno"> 7593</span> </div>
<div class="line"><span class="lineno"> 7594</span>  <span class="comment">/* Get volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 7595</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ig = 0; ig &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7e0035514fe22254130c64c9fa317c8d">ng</a>; ig++)</div>
<div class="line"><span class="lineno"> 7596</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 7597</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7d487af5fe0e4d378d90865f589c7ddc">retq_zmin</a>[ig]</div>
<div class="line"><span class="lineno"> 7598</span>          &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &lt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a785678f0cb53cbf59f390ad671f262f3">retq_zmax</a>[ig])</div>
<div class="line"><span class="lineno"> 7599</span>        <a class="code hl_function" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa87ac5feb176468221bef178ae364d00">q</a>[ig][ip], x, &amp;n);</div>
<div class="line"><span class="lineno"> 7600</span> </div>
<div class="line"><span class="lineno"> 7601</span>  <span class="comment">/* Get extinction... */</span></div>
<div class="line"><span class="lineno"> 7602</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iw = 0; iw &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a094e10d6d25abb248ee383a3da02181a">nw</a>; iw++)</div>
<div class="line"><span class="lineno"> 7603</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 7604</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aab99fb086f49aee8e2aa5fd1c517a221">retk_zmin</a>[iw]</div>
<div class="line"><span class="lineno"> 7605</span>          &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a84dad6b8069641faddf06baad38b82f8">z</a>[ip] &lt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26933d7ba71ac03f208a4c3b59c6c12a">retk_zmax</a>[iw])</div>
<div class="line"><span class="lineno"> 7606</span>        <a class="code hl_function" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a18d3460f12bb187e3ae50e9f2547ede3">k</a>[iw][ip], x, &amp;n);</div>
<div class="line"><span class="lineno"> 7607</span> </div>
<div class="line"><span class="lineno"> 7608</span>  <span class="comment">/* Get cloud data... */</span></div>
<div class="line"><span class="lineno"> 7609</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a59116b56f658e88f16fdadd8f8573b9b">ret_clz</a>)</div>
<div class="line"><span class="lineno"> 7610</span>    <a class="code hl_function" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a467184c9e87a139e18fa656c565ab8a6">clz</a>, x, &amp;n);</div>
<div class="line"><span class="lineno"> 7611</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae25be11810f5e53581c26f20fe22fe7d">ret_cldz</a>)</div>
<div class="line"><span class="lineno"> 7612</span>    <a class="code hl_function" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a49c74ec000bd9884836d6e8ae2b96a3a">cldz</a>, x, &amp;n);</div>
<div class="line"><span class="lineno"> 7613</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad6e4dce394bf7b0dd53d37cd9417cbd2">ret_clk</a>)</div>
<div class="line"><span class="lineno"> 7614</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl = 0; icl &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaca3446ebb40caf6519044b624bc87d5">ncl</a>; icl++)</div>
<div class="line"><span class="lineno"> 7615</span>      <a class="code hl_function" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a8c50a0221df51f13b2f07987aab6ab19">clk</a>[icl], x, &amp;n);</div>
<div class="line"><span class="lineno"> 7616</span> </div>
<div class="line"><span class="lineno"> 7617</span>  <span class="comment">/* Get surface data... */</span></div>
<div class="line"><span class="lineno"> 7618</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5771f0852888a5ac64c5cdcc588f684b">ret_sft</a>)</div>
<div class="line"><span class="lineno"> 7619</span>    <a class="code hl_function" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a651f52626605a4dd79dd147ee245014f">sft</a>, x, &amp;n);</div>
<div class="line"><span class="lineno"> 7620</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a563edaaec6157678618fed9fbc85b79c">ret_sfeps</a>)</div>
<div class="line"><span class="lineno"> 7621</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isf = 0; isf &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb746bb71f7a71dffed2bfa519037c3">nsf</a>; isf++)</div>
<div class="line"><span class="lineno"> 7622</span>      <a class="code hl_function" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a09f5c1a2a0ecac7b481f3ea138b8a750">sfeps</a>[isf], x, &amp;n);</div>
<div class="line"><span class="lineno"> 7623</span>}</div>
<div class="ttc" id="ajurassic_8c_html_aaeed7544a87d85474e33d05fe0adc992"><div class="ttname"><a href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992">x2atm_help</a></div><div class="ttdeci">void x2atm_help(double *value, const gsl_vector *x, size_t *n)</div><div class="ttdoc">Helper function to extract a single value from the retrieval state vector.</div><div class="ttdef"><b>Definition:</b> <a href="jurassic_8c_source.html#l07627">jurassic.c:7627</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="jurassic_8h_a59e72c7cead4b4b7aaf096803bc7360c_cgraph.png" border="0" usemap="#ajurassic_8h_a59e72c7cead4b4b7aaf096803bc7360c_cgraph" alt=""/></div>
<map name="ajurassic_8h_a59e72c7cead4b4b7aaf096803bc7360c_cgraph" id="ajurassic_8h_a59e72c7cead4b4b7aaf096803bc7360c_cgraph">
<area shape="rect" title="Map retrieval state vector back to atmospheric structure." alt="" coords="5,5,63,32"/>
<area shape="rect" href="jurassic_8c.html#aaeed7544a87d85474e33d05fe0adc992" title="Helper function to extract a single value from the retrieval state vector." alt="" coords="111,5,199,32"/>
</map>
</div>

</div>
</div>
<a id="aaeed7544a87d85474e33d05fe0adc992" name="aaeed7544a87d85474e33d05fe0adc992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeed7544a87d85474e33d05fe0adc992">&#9670;&nbsp;</a></span>x2atm_help()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void x2atm_help </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to extract a single value from the retrieval state vector. </p>
<p >Retrieves the next element from the state vector <code>x</code> and assigns it to the provided scalar variable. This function is used by <code><a class="el" href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure.">x2atm()</a></code> to sequentially map the contents of the retrieval vector into the corresponding fields of the atmospheric structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">value</td><td>Pointer to the scalar variable to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Pointer to the retrieval state vector (<code>gsl_vector</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Pointer to the current index in the state vector. The index is incremented after each extraction.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Acts as a lightweight iterator over the state vector elements.</li>
<li>Ensures consistent and sequential assignment order between <code><a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x()</a></code> and <code><a class="el" href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure.">x2atm()</a></code>.</li>
<li>Increments the index counter <code>*n</code> after reading a value, maintaining the correct position in the vector for subsequent calls.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="jurassic_8h.html#a59e72c7cead4b4b7aaf096803bc7360c" title="Map retrieval state vector back to atmospheric structure.">x2atm</a>, <a class="el" href="jurassic_8h.html#adfbb04487aa1c1d4175afca6e521e20b" title="Convert atmospheric data to state vector elements.">atm2x</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function performs no range checking; it assumes that the index is within valid bounds of the state vector length.</li>
<li>Typically used only internally by retrieval mapping routines.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07627">7627</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7630</span>             {</div>
<div class="line"><span class="lineno"> 7631</span> </div>
<div class="line"><span class="lineno"> 7632</span>  <span class="comment">/* Get state vector element... */</span></div>
<div class="line"><span class="lineno"> 7633</span>  *value = gsl_vector_get(x, *n);</div>
<div class="line"><span class="lineno"> 7634</span>  (*n)++;</div>
<div class="line"><span class="lineno"> 7635</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad656b032866d6c7f93ca8cb4f3cace5e" name="ad656b032866d6c7f93ca8cb4f3cace5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad656b032866d6c7f93ca8cb4f3cace5e">&#9670;&nbsp;</a></span>y2obs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void y2obs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structobs__t.html">obs_t</a> *&#160;</td>
          <td class="paramname"><em>obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy elements from the measurement vector <code>y</code> into the observation structure. </p>
<p >Decomposes the 1-D measurement vector <code>y</code> into its radiance components and writes them into the 2-D observation array <code>obs-&gt;rad</code>[id][ir], using the same ordering as produced by the corresponding forward model.</p>
<p >Only entries for which <code>obs-&gt;rad</code>[id][ir] is finite are updated. This allows missing or masked radiances to remain untouched in the observation structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control settings defining the number of detector channels (<code>ctl-&gt;nd</code>) and other retrieval configuration parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Measurement vector containing radiances in forward-model order. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">obs</td><td>Observation structure whose radiance array (<code>obs-&gt;rad</code>) is to be filled with values from <code>y</code>.</td></tr>
  </table>
  </dd>
</dl>
<p>The function loops over all ray paths (<code>obs-&gt;nr</code>) and detector channels (<code>ctl-&gt;nd</code>). For each pair (detector <code>id</code>, ray <code>ir</code>) where an existing value in <code>obs-&gt;rad</code>[id][ir] is finite, the next element from the measurement vector <code>y</code> is inserted. The counter <code>m</code> tracks progression through <code>y</code>.</p>
<p >This function is the inverse operation of the packing performed when constructing the measurement vector from an <a class="el" href="structobs__t.html">obs_t</a> structure.</p>
<dl class="section note"><dt>Note</dt><dd>The measurement vector <code>y</code> must contain as many finite elements as the number of finite entries in <code>obs-&gt;rad</code>, in the same scanning order.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structobs__t.html" title="Observation geometry and radiance data.">obs_t</a>, <a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="jurassic_8c_source.html#l07639">7639</a> of file <a class="el" href="jurassic_8c_source.html">jurassic.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7642</span>              {</div>
<div class="line"><span class="lineno"> 7643</span> </div>
<div class="line"><span class="lineno"> 7644</span>  <span class="keywordtype">size_t</span> m = 0;</div>
<div class="line"><span class="lineno"> 7645</span> </div>
<div class="line"><span class="lineno"> 7646</span>  <span class="comment">/* Decompose measurement vector... */</span></div>
<div class="line"><span class="lineno"> 7647</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ir = 0; ir &lt; obs-&gt;<a class="code hl_variable" href="structobs__t.html#aebd5d0d6c2d1dba7a769c4d506570fa0">nr</a>; ir++)</div>
<div class="line"><span class="lineno"> 7648</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8f5acb554ff044a1c3212c40fff9eec1">nd</a>; <span class="keywordtype">id</span>++)</div>
<div class="line"><span class="lineno"> 7649</span>      <span class="keywordflow">if</span> (isfinite(obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[<span class="keywordtype">id</span>][ir])) {</div>
<div class="line"><span class="lineno"> 7650</span>        obs-&gt;<a class="code hl_variable" href="structobs__t.html#a3703f37920744c9d01cbc5c65b1dc7c3">rad</a>[id][ir] = gsl_vector_get(y, m);</div>
<div class="line"><span class="lineno"> 7651</span>        m++;</div>
<div class="line"><span class="lineno"> 7652</span>      }</div>
<div class="line"><span class="lineno"> 7653</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
